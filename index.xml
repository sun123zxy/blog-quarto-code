<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>sun123zxy&#39;s blog</title>
<link>https://blog.sun123zxy.top/</link>
<atom:link href="https://blog.sun123zxy.top/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.56</generator>
<lastBuildDate>Sat, 21 Sep 2024 16:00:00 GMT</lastBuildDate>
<item>
  <title>原根、原根存在定理和模 m 剩余类环的乘法结构</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20240922-pr/</link>
  <description><![CDATA[ 




<section id="序" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="序"><span class="header-section-number">1</span> 序</h2>
<p>这次来聊聊原根．何谓原根？本原单位根是也．何谓本原单位根？自乘若干次而归于一者，谓之单位根．若兼为乘法生成元，则称其本原，以示强调．原根有三定理，一是判定原根的方法，二是原根存在的条件，三是对原根的计数<sup>1</sup>．其中原根判定定理最难证明．固然有初等数论的证法，然而技巧性较强，或有碍阅读，亦难于记忆．使用代数方法研究原根，虽对基础有一定要求，证明亦不短，但胜在自然流畅，更具启发性．本文宗旨，应用代数工具，对模 <img src="https://latex.codecogs.com/png.latex?m"> 剩余类环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z%20/%20m%20%5Cmathbb%20Z"> 的乘法结构做出流畅的刻画，兼以部分随性的发散讨论，原根存在定理则作为推论导出．我们介绍的内容对有经验的读者或属“自证不难”，但完整证明的逻辑链条较长，需要了解原根的人群亦不一定有系统的代数基础（如 OI / XCPC 算法竞赛选手），故整理于此，供略知代数一二的同学按图索骥．</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;这三个定理的提法来自 <a href="https://oi-wiki.org/math/number-theory/primitive-root/">OI Wiki 的原根介绍</a>．</p></div></div><p>篇幅所限，无法完全做到 self-contained，故如下阅读建议供读者参考：</p>
<ul>
<li><p>完全没有抽象代数基础：</p>
<p>可能在阅读中遇到较大的困难。</p></li>
<li><p>有朴素的抽象代数基础：</p>
<ul>
<li>如数学基础不错的 OIer / XCPCer</li>
<li>如上过一学期计算机系离散数学课程</li>
<li>如会证 Polya 计数 / 理解群论的 Lagrange 定理 / 用抽代观点思考过初等数论问题</li>
</ul>
<p>小节&nbsp;2 讨论原根三定理，小节&nbsp;3 讨论中国剩余定理，小节&nbsp;4 介绍了看待模 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 乘法的 <img src="https://latex.codecogs.com/png.latex?p"> 进制观点，小节&nbsp;5 用 Dirichlet 卷积和 Möbius 反演证明了很强的结果，小节&nbsp;6 讨论了二项式系数的含 <img src="https://latex.codecogs.com/png.latex?p"> 量，大部分内容基础要求不高，有料有用，亦可提升观点，敬请放心食用．其余涉及 Sylow 定理、直积识别等进阶知识的内容，请据个人基础、兴趣和胆识酌情阅读．</p></li>
<li><p>有抽象代数基础：</p>
<ul>
<li>如上过一学期抽象代数课程</li>
</ul>
<p>应可顺畅阅读全文．模 <img src="https://latex.codecogs.com/png.latex?m"> 剩余类环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z%20/%20m%20%5Cmathbb%20Z"> 有较简单的显式表达，其乘法结构却不甚平凡，是操练抽象代数的良好玩具．本文大部分内容整合改编自 <span class="citation" data-cites="dummit_abstract_2003">[1]</span>，有经验的读者可参考本文查漏补缺、按图索骥．</p></li>
</ul>
</section>
<section id="sec-prthm" class="level2 page-columns page-full" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="sec-prthm"><span class="header-section-number">2</span> 原根三定理：代数观点速通</h2>
<p>研究模 <img src="https://latex.codecogs.com/png.latex?m"> 加法和乘法的结构，便是研究模 <img src="https://latex.codecogs.com/png.latex?m"> 剩余类环 <img src="https://latex.codecogs.com/png.latex?Z_m%20:=%20%5Cmathbb%20Z%20/%20m%20%5Cmathbb%20Z"> 的性质．特别地，若仅关心其上乘法的结构，可取 <img src="https://latex.codecogs.com/png.latex?Z_m"> 全体乘法可逆元构成的乘法群（亦作简化剩余系） <img src="https://latex.codecogs.com/png.latex?%0AZ_m%5E%5Ctimes%20=%20%5C%7B%20a%20%5Cin%20Z_m%20:%20%5Cgcd(a,m)%20=%201%20%5C%7D%0A"> 做研究，事实上，<img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 恰由全体 <img src="https://latex.codecogs.com/png.latex?Z_m"> 作为加法群的生成元构成，而 Euler totient 函数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 恰为此群的大小——这些都是数论中经典的 Bézout 定理的简单推论．</p>
<div class="proof remark page-columns page-full">
<p><span class="proof-title"><em>注记</em>. </span>值得一提，我们现在虽专注于模 <img src="https://latex.codecogs.com/png.latex?m"> 乘法的研究，但 <img src="https://latex.codecogs.com/png.latex?Z_m"> 乘法与加法并非相互割裂．环上的每一乘法可逆元 <img src="https://latex.codecogs.com/png.latex?a"> 自然诱导出加法群的自同构 <img src="https://latex.codecogs.com/png.latex?x%20%5Cmapsto%20ax">，故有 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes%20%5Chookrightarrow%20%5Coperatorname%7BAut%7D(Z_m)"><sup>2</sup>．事实上，由于 <img src="https://latex.codecogs.com/png.latex?Z_m"> 作为 <img src="https://latex.codecogs.com/png.latex?m"> 阶加法循环群结构简单，仅乘法可逆元便可诱导出其加法群的全部自同构，因此上述单同态亦具有满性：<img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes%20%5Ccong%20%5Coperatorname%7BAut%7D(Z_m)"><sup>3</sup>．综上，<img src="https://latex.codecogs.com/png.latex?Z_m"> 上的可逆乘除操作，同 <img src="https://latex.codecogs.com/png.latex?Z_m"> 作为加法群的自同构存在一一对应关系；探明模 <img src="https://latex.codecogs.com/png.latex?m"> 乘法的结构，亦对研究模 <img src="https://latex.codecogs.com/png.latex?m"> 加法有所裨益．这种观点将立刻在 定理&nbsp;2（原根个数定理）的证明中发挥效用．</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;以后使用 <img src="https://latex.codecogs.com/png.latex?%5Chookrightarrow"> 表单同态，<img src="https://latex.codecogs.com/png.latex?%5Ctwoheadrightarrow"> 表满同态，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BAut%7D(Z_m)"> 为 <img src="https://latex.codecogs.com/png.latex?Z_m"> 作为加法群的全体自同构所构成的群．</p></div><div id="fn3"><p><sup>3</sup>&nbsp;读者自证不难．亦可参见 <span class="citation" data-cites="dummit_abstract_2003">[1, section 4.4, proposition 16, p.&nbsp;135]</span></p></div></div></div>
<p>柿子挑软的捏，我们自然关心那些较为简单的模 <img src="https://latex.codecogs.com/png.latex?m"> 乘法的结构．何谓简单？<img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 是循环群便是简单——因其只需一个元素便可生成——而这一元素，即（定义）为原根．译为白话，模 <img src="https://latex.codecogs.com/png.latex?m"> 意义下的原根 <img src="https://latex.codecogs.com/png.latex?g"> 定义为满足 <img src="https://latex.codecogs.com/png.latex?%0Ag%5E%7Bk%7D%20=%201%20%5Cpmod%20m%20%5Ciff%20%5Cvarphi(m)%20%5Cmid%20k%0A"> 的某一非零整数．</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BP%7D%20%5Csubseteq%20%5Cmathrm%7BNP%7D">，故在寻找原根前先讨论如何判定原根．原根判定定理给出了判定某一 <img src="https://latex.codecogs.com/png.latex?g%20%5Cin%20Z_m%5E%5Ctimes"> 是否为原根的简易方法：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-test" class="theorem">
<p><span class="theorem-title"><strong>定理 1 (原根判定定理)</strong></span> <img src="https://latex.codecogs.com/png.latex?g"> 是乘法群 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 的生成元当且仅当对每个 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 的素因子 <img src="https://latex.codecogs.com/png.latex?p">，都有 <img src="https://latex.codecogs.com/png.latex?g%5E%7B%5Cvarphi(m)/p%7D%20%5Cneq%201">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>读者自证不难．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>这一定理可以认为是有限循环群上的 Lagrange 定理的一个应用：对任意 <img src="https://latex.codecogs.com/png.latex?d%20%5Cmid%20n">，任意 <img src="https://latex.codecogs.com/png.latex?n"> 阶循环群都保有一个 <img src="https://latex.codecogs.com/png.latex?d"> 阶子群；反之，任意子群的阶一定是 <img src="https://latex.codecogs.com/png.latex?n"> 的因子．</p>
</div>
<p>假定已知模数 <img src="https://latex.codecogs.com/png.latex?m"> 保有一原根，我们进而关心其所有原根之间的相互结构．特别地，我们关心原根有多少个：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-number" class="theorem">
<p><span class="theorem-title"><strong>定理 2 (原根个数定理)</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 是循环群，则其恰有 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(%5Cvarphi(m))"> 个生成元．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>在我们的叙述下，原根个数定理成为一句废话．根据条件，作为乘法群的 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 与加法群 <img src="https://latex.codecogs.com/png.latex?Z_%7B%5Cvarphi(m)%7D"> 同构，而 <img src="https://latex.codecogs.com/png.latex?Z_%7B%5Cvarphi(m)%7D"> 当然可以根据其上的加法定义出乘法，进而升级为环．正如前文提到的，<img src="https://latex.codecogs.com/png.latex?Z_%7B%5Cvarphi(m)%7D"> 全体（加法）生成元恰为 <img src="https://latex.codecogs.com/png.latex?Z_%7B%5Cvarphi(m)%7D%5E%5Ctimes"> ．再通过上述同构关系，我们便得到 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 中的所有生成元的数量及其相互关系．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>从计算原根的角度来看，上述结果并未给出显式给出 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 的生成元，这是因为 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 与 <img src="https://latex.codecogs.com/png.latex?Z_%7B%5Cvarphi(m)%7D"> 之间同构的具体形式尚不明确．但我们可以利用原根判定定理（和快速幂）从小到大逐一验证．由于原根数量高达 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(%5Cvarphi(m))"> 个，一般很快就能找到．事实上当模数为质数 <img src="https://latex.codecogs.com/png.latex?p"> 时，最小原根有渐进上界估计 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B1/4%20+%20%5Cvarepsilon%7D)"> 和下界估计 <img src="https://latex.codecogs.com/png.latex?%5COmega(%5Clog%20p)">．<a href="https://oi-wiki.org/math/number-theory/primitive-root/">OI Wiki</a> 给出了上述结果的一些参考文献．</p>
</div>
<p>当然，并非每个 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 都是循环群，因此不是所有模数 <img src="https://latex.codecogs.com/png.latex?m"> 都保有原根．原根存在定理给出了使得 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 确为循环群的所有 <img src="https://latex.codecogs.com/png.latex?m">：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-exist" class="theorem">
<p><span class="theorem-title"><strong>定理 3 (原根存在定理)</strong></span> 使得 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 成为循环群的正整数 <img src="https://latex.codecogs.com/png.latex?m"> 有且只有 <img src="https://latex.codecogs.com/png.latex?2,4,%20p%5E%5Calpha,%202%20p%5E%5Calpha">，这里 <img src="https://latex.codecogs.com/png.latex?p"> 是奇质数，<img src="https://latex.codecogs.com/png.latex?%5Calpha"> 是正整数．</p>
</div>
</div>
</div>
</div>
<p>这一定理不如前两个定理显然，需要我们对环 <img src="https://latex.codecogs.com/png.latex?Z_m"> 的结构做更深的探讨．事实上，与其只关心 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 是不是循环群，不如更进一步，看看 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 究竟同构于哪些循环群的直积；与其只关心 <img src="https://latex.codecogs.com/png.latex?Z_m"> 的乘法结构，不如将本来就与乘法紧密相关的加法结构一并纳入考虑．在之后的讨论中，我们将先解剖出模 <img src="https://latex.codecogs.com/png.latex?m"> 剩余类环 <img src="https://latex.codecogs.com/png.latex?Z_m"> 的结构，随后具体讨论 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 的结构，顺带产生关于原根存在性的结果．</p>
</section>
<section id="sec-crt" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="sec-crt"><span class="header-section-number">3</span> <img src="https://latex.codecogs.com/png.latex?Z_m"> 的结构：中国剩余定理</h2>
<p>既然是研究环与同余的结构，就必然要提到中国剩余定理．回忆数论中最常见的中国剩余定理：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-crt-number-theory" class="theorem">
<p><span class="theorem-title"><strong>定理 4 (中国剩余定理：数论)</strong></span> 给定 <img src="https://latex.codecogs.com/png.latex?n"> 个同余方程 <img src="https://latex.codecogs.com/png.latex?%0Ax%20%5Cequiv%20a_i%20%5Cpmod%7Bm_i%7D%0A"></p>
<p>其中各 <img src="https://latex.codecogs.com/png.latex?m_i"> 两两互质，<img src="https://latex.codecogs.com/png.latex?i%20=%201,%20%5Cdots,%20n">．记 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20=%20%5Cprod_%7Bj%20%5Cneq%20i%7D%20m_j%20%5Coperatorname%7Binv%7D_%7Bm_i%7D(m_j)%0A"> 则上述方程组等价于 <img src="https://latex.codecogs.com/png.latex?%0Ax%20%5Cequiv%20%5Csum_%7Bi=1%7D%5En%20a_i%20%5Cdelta_i%20%5Cpmod%7B%5Cprod_%7Bi=1%7D%5En%20m_i%7D%0A"> 这里 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Binv%7D_%7Bm_i%7D(m_j)"> 代表 <img src="https://latex.codecogs.com/png.latex?m_j"> 在模 <img src="https://latex.codecogs.com/png.latex?m_i"> 意义下的逆元．</p>
</div>
</div>
</div>
</div>
<p>注意到<sup>4</sup> <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20%5Cbmod%20m_k%20=%20%5Cdelta%20(i=k)%0A"> 这是中国剩余定理的神髓所在：构造一组强力的“基底”，其中每一元素在其对应模数下的表现恰似单位元，而在其它模数下全无效力．我们指出，这一构造在中国剩余定理的环论版本中同样管用．先将数论中的中国剩余定理用环论的语言重述：</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;这里我们记 <img src="https://latex.codecogs.com/png.latex?%5Cdelta(P)%20=%20%5Cbegin%7Bcases%7D1%20&amp;%20P%20%5Ctext%7B%20is%20true%7D%20%5C%5C%200%20&amp;%20%5Ctext%7Botherwise%7D%5Cend%7Bcases%7D"></p></div></div><div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-crt-ringish-number-theory" class="theorem">
<p><span class="theorem-title"><strong>定理 5 (中国剩余定理：数论，但环论语言)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?m_1%20%5Cmathbb%20Z,%20m_2%20%5Cmathbb%20Z,%20%5Cdots,%20m_n%20%5Cmathbb%20Z"> 是环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z"> 的若干（双边）理想，且 <img src="https://latex.codecogs.com/png.latex?m_1,m_2,%5Cdots,m_n"> 两两互素．由 Bézout 定理，可设对任意互异的 <img src="https://latex.codecogs.com/png.latex?i,j">，存在 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20%5Cin%20m_i%20%5Cmathbb%20Z"> 和 <img src="https://latex.codecogs.com/png.latex?y_%7Bi,j%7D%20%5Cin%20m_j%20%5Cmathbb%20Z"> 满足 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20+%20y_%7Bi,j%7D%20=%201">．我们声称如下环同态 <img src="https://latex.codecogs.com/png.latex?%0A%5Cpi:%20%5Cbegin%7Baligned%7D%0A%5Cmathbb%20Z%20&amp;%5Cto%20%5Cmathbb%20Z%20/%20m_1%20%5Cmathbb%20Z%20%5Ctimes%20%5Cmathbb%20Z%20/%20m_2%20%5Cmathbb%20Z%20%5Ctimes%20%5Cdots%20%5Ctimes%20%5Cmathbb%20Z%20/%20m_n%20%5Cmathbb%20Z%20%5C%5C%0Aa%20&amp;%5Cmapsto%20(a+m_1%20%5Cmathbb%20Z,a+m_2%20%5Cmathbb%20Z,%5Cdots,a+m_n%20%5Cmathbb%20Z)%0A%5Cend%7Baligned%7D%0A"> 具有满性，这一满性由如下构造给出： <img src="https://latex.codecogs.com/png.latex?%0Aa%20:=%20%5Csum_%7Bi=1%7D%5En%20a_i%20%5Cdelta_i%0A"> 是使得 <img src="https://latex.codecogs.com/png.latex?%5Cpi(a)%20=%20(a_1,a_2,%5Cdots,a_n)"> 成立的一个解，这里 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20:=%20%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D%0A"> 经由上述环同态，我们有（由环的第一同构定理） <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cmathbb%20Z%20/%20(%5Cprod_%7Bi=1%7D%5En%20m_i)%20%5Cmathbb%20Z%20=%20%5Cmathbb%20Z%20/%20(%5Cbigcap_%7Bi=1%7D%5En%20m_i%20%5Cmathbb%20Z)%20%5Ccong%20%5Cprod_%7Bi=1%7D%5En%20(%5Cmathbb%20Z%20/m_i%20%5Cmathbb%20Z)%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>仅需对构造中使用的“基底” <img src="https://latex.codecogs.com/png.latex?%5Cdelta_i"> 作一点说明．请读者关注以下等式 <img src="https://latex.codecogs.com/png.latex?%0A1%20=%20%5Cprod_%7Bj%20%5Cneq%20i%7D%20(x_%7Bi,j%7D%20+%20y_%7Bi,j%7D)%0A"> 注意到右侧乘积展开后，除 <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D"> 一项外，其余各项均至少含有一个 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20%5Cin%20m_i%20%5Cmathbb%20Z">，故 <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D%20=%201%20%5Cpmod%7Bm_i%20%5Cmathbb%20Z%7D">．同时，由于 <img src="https://latex.codecogs.com/png.latex?y_%7Bi,j%7D%20%5Cin%20m_j%20%5Cmathbb%20Z">，亦有 <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D%20=%200%20%5Cpmod%7Bm_k%20%5Cmathbb%20Z%7D"> 对所有 <img src="https://latex.codecogs.com/png.latex?k%20%5Cneq%20i"> 成立．综上知 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20=%20%5Cdelta(i=k)%20%5Cpmod%7Bm_k%20%5Cmathbb%20Z%7D%0A"></p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-crt-ring-theory" class="theorem">
<p><span class="theorem-title"><strong>定理 6 (中国剩余定理：环论)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?R"> 是任意有单位元的环，<img src="https://latex.codecogs.com/png.latex?I_1,I_2,%5Cdots,I_n"> 是 <img src="https://latex.codecogs.com/png.latex?R"> 的若干（双边）理想，且 <img src="https://latex.codecogs.com/png.latex?I_1,I_2,%5Cdots,I_n"> 两两“互素”（comaximal，即 <img src="https://latex.codecogs.com/png.latex?i%20%5Cneq%20j%20%5Cimplies%20I_i%20+%20I_j%20=%20R">），此时可设对任意互异的 <img src="https://latex.codecogs.com/png.latex?i,j">，存在 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20%5Cin%20I_i"> 和 <img src="https://latex.codecogs.com/png.latex?y_%7Bi,j%7D%20%5Cin%20I_j"> 满足 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20+%20y_%7Bi,j%7D%20=%201">．则如下环同态 <img src="https://latex.codecogs.com/png.latex?%0A%5Cpi:%20%5Cbegin%7Baligned%7D%0AR%20&amp;%5Cto%20R/I_1%20%5Ctimes%20R/I_2%20%5Ctimes%20%5Cdots%20%5Ctimes%20R/I_n%20%5C%5C%0Ar%20&amp;%5Cmapsto%20(r+I_1,r+I_2,%5Cdots,r+I_n)%0A%5Cend%7Baligned%7D%0A"> 具有满性，这一满性由如下构造给出： <img src="https://latex.codecogs.com/png.latex?%0Aa%20:=%20%5Csum_%7Bi=1%7D%5En%20a_i%20%5Cdelta_i%0A"> 是使得 <img src="https://latex.codecogs.com/png.latex?%5Cpi(a)%20=%20(a_1,a_2,%5Cdots,a_n)"> 成立的一个解，这里 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20:=%20%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D%0A"> 经由上述环同态，我们有（由环的第一同构定理） <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AR/(%5Cbigcap_%7Bi=1%7D%5En%20I_i)%20%5Ccong%20%5Cprod_%7Bi=1%7D%5En%20(R/I_i)%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>请读者仿照上例练习．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>这里得到的环论版本的中国剩余定理的证明将是构造式的．常见的代数书目在叙述证明时一般诉诸数学归纳法——固然是严谨的选择，但牺牲了一点神韵．我们给出两个参考：</p>
<ul>
<li><p><span class="citation" data-cites="dummit_abstract_2003">[1, section 7.17, theorem 17, p.&nbsp;265]</span>：是本文主要参考的证明，但是有单位元的交换环上的特化版本．环上的交换性并不是中国剩余定理的本质要求，其作用仅为使得环上理想 <img src="https://latex.codecogs.com/png.latex?I,J"> 满足 <img src="https://latex.codecogs.com/png.latex?I%20J%20=%20I%20%5Ccap%20J">．特别地，这使得应用在整数环上的中国剩余定理的在计算上更为简洁： <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20Z%20/%20(%5Cprod_%7Bi=1%7D%5En%20m_i)%20%5Cmathbb%20Z%20=%20%5Cmathbb%20Z%20/%20(%5Cbigcap_%7Bi=1%7D%5En%20m_i%20%5Cmathbb%20Z)%0A"></p></li>
<li><p><span class="citation" data-cites="hungerford_algebra_1980">[2, theorem 2.25, p.&nbsp;131]</span>：给出了不要求环上单位元存在的更加一般的中国剩余定理．</p></li>
</ul>
<p>环论版本的中国剩余定理功用强大．除了在数论领域的经典应用，在多项式环上，中国剩余定理将多项式多点求值与多点插值联系起来，某种程度上为离散 Fourier 变换提供了同构视角下的理解．感兴趣的读者敬请移步<a href="../..\posts/20240513-isodft/">此处</a>．最强大的中国剩余定理可以扩展到模上：</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-module-theory" class="theorem">
<p><span class="theorem-title"><strong>定理 7 (中国剩余定理：模论)</strong></span> 设环 <img src="https://latex.codecogs.com/png.latex?R">、理想 <img src="https://latex.codecogs.com/png.latex?I_1,I_2,%5Cdots,I_n">、元素 <img src="https://latex.codecogs.com/png.latex?x_%7Bi,j%7D%20%5Cin%20I_i"> 和 <img src="https://latex.codecogs.com/png.latex?y_%7Bi,j%7D%20%5Cin%20I_j"> 的要求与 定理&nbsp;6 中一致．设 <img src="https://latex.codecogs.com/png.latex?M"> 为一 <img src="https://latex.codecogs.com/png.latex?R">-模，则如下模同态 <img src="https://latex.codecogs.com/png.latex?%0A%5Cpi:%20%5Cbegin%7Baligned%7D%0AM%20&amp;%5Cto%20M%20/%20I_1%20M%20%5Coplus%20M/I_2%20M%20%5Coplus%20%5Cdots%20%5Coplus%20M%20/%20I_n%20M%20%5C%5C%0Ar%20&amp;%5Cmapsto%20(r+I_1%20M,r+I_2%20M,%5Cdots,r+I_n%20M)%0A%5Cend%7Baligned%7D%0A"> 具有满性，这一满性由如下构造给出： <img src="https://latex.codecogs.com/png.latex?%0Aa%20:=%20%5Csum_%7Bi=1%7D%5En%20%5Cdelta_i%20a_i%0A"> 是使得 <img src="https://latex.codecogs.com/png.latex?%5Cpi(a)%20=%20(a_1,a_2,%5Cdots,a_n)"> 成立的一个解，这里 <img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta_i%20:=%20%5Cprod_%7Bj%20%5Cneq%20i%7D%20y_%7Bi,j%7D%20%5Cin%20R%0A"> 经由上述模同态，我们有（由模的第一同构定理） <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AM/(%5Cbigcap_%7Bi=1%7D%5En%20I_i%20M)%20%5Ccong%20%5Cbigoplus_%7Bi=1%7D%5En%20(M/I_i%20M)%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>回到正题．我们在研究环 <img src="https://latex.codecogs.com/png.latex?Z_m%20=%20%5Cmathbb%20Z%20/%20m%5Cmathbb%20Z"> 的结构，而 定理&nbsp;5 已经做出了巨大的贡献：设 <img src="https://latex.codecogs.com/png.latex?m"> 有质因子分解 <img src="https://latex.codecogs.com/png.latex?m%20=%20p_1%5E%7B%5Calpha_1%7D%20p_2%5E%7B%5Calpha_2%7D%20%5Cdots%20p_k%5E%7B%5Calpha_k%7D">，则环 <img src="https://latex.codecogs.com/png.latex?Z_m"> 便可被拆分成若干大小互素的环的直积： <img src="https://latex.codecogs.com/png.latex?%0AZ_m%20%5Ccong%20Z_%7Bp_1%5E%7B%5Calpha_1%7D%7D%20%5Ctimes%20Z_%7Bp_2%5E%7B%5Calpha_2%7D%7D%20%5Ctimes%20%5Cdots%20%5Ctimes%20Z_%7Bp_k%5E%7B%5Calpha_k%7D%7D%0A"> 作为环的附属结构，<img src="https://latex.codecogs.com/png.latex?Z_m"> 的乘法群也得到自然的拆解： <img src="https://latex.codecogs.com/png.latex?%0AZ_m%5E%5Ctimes%0A%5Ccong%20%5Cleft(%20Z_%7Bp_1%5E%7B%5Calpha_1%7D%7D%20%5Ctimes%20Z_%7Bp_2%5E%7B%5Calpha_2%7D%7D%20%5Ctimes%20%5Cdots%20%5Ctimes%20Z_%7Bp_k%5E%7B%5Calpha_k%7D%7D%20%5Cright)%5E%5Ctimes%0A=%20Z_%7Bp_1%5E%7B%5Calpha_1%7D%7D%5E%5Ctimes%20%5Ctimes%20Z_%7Bp_2%5E%7B%5Calpha_2%7D%7D%5E%5Ctimes%20%5Ctimes%20%5Cdots%20%5Ctimes%20Z_%7Bp_k%5E%7B%5Calpha_k%7D%7D%5E%5Ctimes%0A"> 余下的工作，是解剖环 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%7B%5Calpha%7D%7D"> 的乘法群 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%7B%5Calpha%7D%7D%5E%5Ctimes"> 的结构．</p>
</section>
<section id="sec-zpat" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="sec-zpat"><span class="header-section-number">4</span> <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 的结构：分裂的商同态</h2>
<p>加法和乘法运算，但对 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 取模，似乎不太熟悉？事实上，将 <img src="https://latex.codecogs.com/png.latex?0"> 到 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha%20-1"> 间的所有整数写为 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=0%7D%5E%7B%5Calpha%20-%201%7D%20a_i%20p%5Ei"> 的 <img src="https://latex.codecogs.com/png.latex?p"> 进制形式，是刻画该剩余类环的一种良好方法，其实质为以 <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20Z_%7Bp%5E%5Calpha%7D"> 带入整系数多项式环得到的一个 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z%5Bx%5D%20%5Cto%20Z_%7Bp%5E%5Calpha%7D"> 的环同态．读者可在接下来的探究中借其指导直觉．</p>
<p>首先，粗略地看看哪些环 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D"> 元素（在乘法意义下）可逆——自然是与 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 互素——即不被 <img src="https://latex.codecogs.com/png.latex?p"> 整除——即 <img src="https://latex.codecogs.com/png.latex?p"> 进制表示下 <img src="https://latex.codecogs.com/png.latex?a_0%20%5Cneq%200"> 的那些数——即 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20=%20Z_%7Bp%5E%5Calpha%7D%20%5Csetminus%20p%20Z_%7Bp%5E%5Calpha%7D">．简单的计数就得到其大小为 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(p%5E%5Calpha)%20=%20p%5E%5Calpha%20-%20p%5E%7B%5Calpha%20-%201%7D%20=%20p%5E%7B%5Calpha%20-%201%7D%20(p%20-%201)">．一个受此启发的想法是，如果仅在模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下考虑 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D"> 中的运算——即只看 <img src="https://latex.codecogs.com/png.latex?p"> 进制表示下 <img src="https://latex.codecogs.com/png.latex?a_0"> 的变化情况，自然得到商同态 <img src="https://latex.codecogs.com/png.latex?%5Cpi">： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AZ_%7Bp%5E%5Calpha%7D%20&amp;%5Ctwoheadrightarrow%20Z_%7Bp%5E%5Calpha%7D%20/%20p%20Z_%7Bp%5E%5Calpha%7D%20%5Ccong%20Z_p%20%5C%5C%0Aa%20%5Cbmod%20p%5E%5Calpha%20&amp;%5Cmapsto%20a%20%5Cbmod%20p%0A%5Cend%7Baligned%7D%0A"> 注意环同态保持可逆元，故若只考虑乘法结构，<img src="https://latex.codecogs.com/png.latex?%5Cpi"> 也给出了交换群 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ctwoheadrightarrow%20Z_p%5E%5Ctimes"> 的一个满同态，其核 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi"> 为模 <img src="https://latex.codecogs.com/png.latex?p"> 余 <img src="https://latex.codecogs.com/png.latex?1">——即 <img src="https://latex.codecogs.com/png.latex?p"> 进制表示下 <img src="https://latex.codecogs.com/png.latex?a_0%20=%201">，其余位置任取——的那些数构成的 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha-1%7D"> 阶乘法子群．此外我们还有 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20/%20%5Cker%20%5Cpi%20%5Ccong%20Z_p%5E%5Ctimes">．</p>
<p>使用商同态研究交换群的结构，最好的情况是这个同态分裂<sup>5</sup>——在这里即希望 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20/%20%5Cker%20%5Cpi"> 或者说 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 在 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 中有一个同构的拷贝．此时由子群直积的识别定理 <span class="citation" data-cites="dummit_abstract_2003">[1, section 5.4, theorem 9, p.&nbsp;171]</span> 我们有 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20%5Cker%20%5Cpi%20%5Ctimes%20Z_p%5E%5Ctimes">．但真的可以吗？我们另从 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 的大小——<img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha%20-%201%7D%20(p%20-%201)">——的角度下手试试．固然 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 与 <img src="https://latex.codecogs.com/png.latex?p-1"> 互素，故</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;关于正合列，见 <span class="citation" data-cites="dummit_abstract_2003">[1, section 10.5]</span></p></div></div><ul>
<li><p>如果你了解有限交换群的基本结构：由有限交换群的结构性定理 <span class="citation" data-cites="dummit_abstract_2003">[1, section 5.2]</span></p></li>
<li><p>如果你学过有限群的 Sylow 定理 <span class="citation" data-cites="dummit_abstract_2003">[1, section 4.5]</span>：考虑到 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 是交换群，其所有子群均为正规子群，熟记如下结果 <span class="citation" data-cites="dummit_abstract_2003">[1, section 6.1, theorem 3, p.&nbsp;191]</span></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-sylow-normal" class="theorem">
<p><span class="theorem-title"><strong>定理 8 (有限幂零群的部分等价条件)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?G"> 是一有限群，则如下条件等价：</p>
<ul>
<li><p>对任意质数 <img src="https://latex.codecogs.com/png.latex?p%20%5Cmid%20%7CG%7C">，<img src="https://latex.codecogs.com/png.latex?G"> 的 Sylow <img src="https://latex.codecogs.com/png.latex?p">-子群存在且唯一．</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?G"> 的 Sylow 子群均为正规子群．</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?G"> 是其全体 Sylow 子群的（内）直积．</p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>考虑 Sylow 定理关于 Sylow <img src="https://latex.codecogs.com/png.latex?p">-子群共轭性的结果和子群直积的识别定理，有经验的读者应不难证明，此处略去．</p>
</div></li>
</ul>
<p>便知道 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 是其两个大小分别为 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha%20-%201%7D"> 和 <img src="https://latex.codecogs.com/png.latex?p-1"> 的子群（记为 <img src="https://latex.codecogs.com/png.latex?Q"> 和 <img src="https://latex.codecogs.com/png.latex?S">）的（内）直积．现在结合上一段构造的乘法群商同态 <img src="https://latex.codecogs.com/png.latex?%5Cpi:%20Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Cto%20Z_p%5E%5Ctimes"> 对 <img src="https://latex.codecogs.com/png.latex?Q"> 和 <img src="https://latex.codecogs.com/png.latex?S"> 作考察：</p>
<ul>
<li>考虑到 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20Q%20%5Ctimes%20S">，故 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D"> 的 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 阶子群只有 <img src="https://latex.codecogs.com/png.latex?Q"> 唯一一个．而已经知道 <img src="https://latex.codecogs.com/png.latex?%7C%5Cker%20%5Cpi%7C%20=%20p%5E%7B%5Calpha-1%7D%20=%20%7CQ%7C">，故立得 <img src="https://latex.codecogs.com/png.latex?Q%20=%20%5Cker%20%5Cpi">．</li>
<li>将 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> 限制在 <img src="https://latex.codecogs.com/png.latex?S"> 上得到新同态 <img src="https://latex.codecogs.com/png.latex?%5Cpi%20%5Cvert_S%20:%20S%20%5Cto%20Z_p%5E%5Ctimes">，其核为 <img src="https://latex.codecogs.com/png.latex?S%20%5Ccap%20%5Cker%20%5Cpi">．注意 <img src="https://latex.codecogs.com/png.latex?%7CS%7C%20=%20p-1"> 且 <img src="https://latex.codecogs.com/png.latex?%7C%5Cker%20%5Cpi%7C%20=%20p%5E%5Calpha">，故这个核只能是平凡的，即 <img src="https://latex.codecogs.com/png.latex?%5Cpi%20%5Cvert_S"> 是单同态．再考虑到 <img src="https://latex.codecogs.com/png.latex?%7CZ_p%5E%5Ctimes%7C%20=%20p%20-%201%20=%20%7CS%7C">，我们得到 <img src="https://latex.codecogs.com/png.latex?S%20%5Ccong%20Z_p%5E%5Ctimes">．</li>
</ul>
<p>故真的有 <img src="https://latex.codecogs.com/png.latex?%0AZ_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20%5Cker%20%5Cpi%20%5Ctimes%20Z_p%5E%5Ctimes%0A"> 而 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 在 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D"> 中的像恰为 <img src="https://latex.codecogs.com/png.latex?p"> 进制表示下 <img src="https://latex.codecogs.com/png.latex?a_0%20%5Cin%20Z_p%5E%5Ctimes">，其余为 <img src="https://latex.codecogs.com/png.latex?0"> 的那些数．接下来的工作是分别研究 <img src="https://latex.codecogs.com/png.latex?%5Cker%5Cpi"> 和 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes">．</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>本节内容，另可参考 <span class="citation" data-cites="dummit_abstract_2003">[1, section 9.5, corollary 20, p.&nbsp;314]</span>．</p>
</div>
</section>
<section id="sec-zpt" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="sec-zpt"><span class="header-section-number">5</span> <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 的结构：域的有限乘法子群</h2>
<p>因为 <img src="https://latex.codecogs.com/png.latex?Z_2%5E%5Ctimes"> 是平凡群，故只需研究 <img src="https://latex.codecogs.com/png.latex?p%20%5Cge%203"> 的情况．事实上我们已经比较清楚环 <img src="https://latex.codecogs.com/png.latex?Z_p"> 的结构——它是一个域．<span class="citation" data-cites="dummit_abstract_2003">[1, section 9.5, pp.&nbsp;313–314]</span> 给出了一种利用域上多项式环性质证明 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 是循环群的神奇做法．我们知道，域上的 <img src="https://latex.codecogs.com/png.latex?n"> 阶多项式至多只能有 <img src="https://latex.codecogs.com/png.latex?n"> 个根（又名 Lagrange 定理），而 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 内满足 <img src="https://latex.codecogs.com/png.latex?x%5Ed%20=%201"> 的元素（即 <img src="https://latex.codecogs.com/png.latex?d"> 阶单位根）都是多项式 <img src="https://latex.codecogs.com/png.latex?x%5Ed%20-%201"> 的根，故 <img src="https://latex.codecogs.com/png.latex?d"> 阶单位根的个数至多为 <img src="https://latex.codecogs.com/png.latex?d"> 个．令人惊奇的是，如此松弛的估计足以确定 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 的结构．请看如下定理 <span class="citation" data-cites="dummit_abstract_2003">[1, section 6.1, proposition 5, p.&nbsp;192]</span>．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-zpt-cyclic" class="theorem">
<p><span class="theorem-title"><strong>定理 9 (循环群判定：基于单位根数量上限)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?G"> 是一有限群，满足对任意正整数 <img src="https://latex.codecogs.com/png.latex?n">，<img src="https://latex.codecogs.com/png.latex?n"> 阶单位根的个数至多为 <img src="https://latex.codecogs.com/png.latex?n"> 个，则 <img src="https://latex.codecogs.com/png.latex?G"> 是循环群．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em> (Sylow 定理向). </span>首先注意到对任意正整数 <img src="https://latex.codecogs.com/png.latex?n">，<img src="https://latex.codecogs.com/png.latex?G"> 中若存在 <img src="https://latex.codecogs.com/png.latex?n"> 阶子群则必定唯一，且恰为 <img src="https://latex.codecogs.com/png.latex?G_n%20:=%20%5C%7B%20g%20%5Cin%20G:%20g%5En%20=%201%20%5C%7D">．这是因为任何 <img src="https://latex.codecogs.com/png.latex?n"> 阶子群内的元素均为 <img src="https://latex.codecogs.com/png.latex?n"> 阶单位根，数量已达到条件中给出的 <img src="https://latex.codecogs.com/png.latex?n"> 个的上限，故无法再支撑另一 <img src="https://latex.codecogs.com/png.latex?n"> 阶子群的存在．特别地，<img src="https://latex.codecogs.com/png.latex?G"> 的 Sylow <img src="https://latex.codecogs.com/png.latex?p">-子群 <img src="https://latex.codecogs.com/png.latex?S_p"> 存在且唯一．由 定理&nbsp;8，<img src="https://latex.codecogs.com/png.latex?G"> 为 <img src="https://latex.codecogs.com/png.latex?G"> 的各个 Sylow <img src="https://latex.codecogs.com/png.latex?p">-子群 <img src="https://latex.codecogs.com/png.latex?S_p"> 的（内）直积．于是只需证每个 <img src="https://latex.codecogs.com/png.latex?S_p"> 都是循环群．记 <img src="https://latex.codecogs.com/png.latex?%5Calpha"> 是 <img src="https://latex.codecogs.com/png.latex?p"> 在 <img src="https://latex.codecogs.com/png.latex?n"> 中的指数．由 Sylow 定理，<img src="https://latex.codecogs.com/png.latex?S_p"> 有一个 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha%20-%201%7D"> 阶子群 <img src="https://latex.codecogs.com/png.latex?H_p">，据前述观察 <img src="https://latex.codecogs.com/png.latex?%0AH_p%20=%20%5C%7B%20g%20%5Cin%20G%20:%20g%5E%7Bp%5E%7B%5Calpha-1%7D%7D%20=%201%5C%7D%20%3C%20%5C%7Bg%20%5Cin%20G%20:%20g%5E%7Bp%5E%5Calpha%7D%20=%201%5C%7D%20=%20S_p%0A"> 故任取 <img src="https://latex.codecogs.com/png.latex?g%20%5Cin%20S_p%20%5Csetminus%20H_p"> 就得到一个 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha%7D"> 阶元，故 <img src="https://latex.codecogs.com/png.latex?S_p"> 是循环群．</p>
</div>
<p>我们再提供一个使用 Dirichlet 卷积 / Möbius 反演的数论风格的证明 <span class="citation" data-cites="dummit_abstract_2003">[1, section 9.5, exercise 6, p.&nbsp;315]</span>．</p>
<div class="proof">
<p><span class="proof-title"><em>证明</em> (数论向). </span>对所有 <img src="https://latex.codecogs.com/png.latex?n%20%5Cmid%20%7CG%7C">，记 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ag(n)%20&amp;:=%20%5C#%5C%7B%20x%20%5Cin%20G:%20x%5En%20=%201%20%5C%7D%20%5C%5C%0Ah(n)%20&amp;:=%20%5C#%5C%7B%20x%20%5Cin%20G:%20x%20%5Ctext%7B%20is%20of%20order%20%7Dn%20%5C%7D%0A%5Cend%7Baligned%7D%0A"> 则 <img src="https://latex.codecogs.com/png.latex?%0Ag(n)%20=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20h(n)%0A"> 依次应用 Möbius 反演、条件假设和 Dirichlet 卷积 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi%20=%20%5Cmu%20*%20%5Cmathrm%7Bid%7D"> 得 <img src="https://latex.codecogs.com/png.latex?%0Ah(n)%20=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20%5Cmu(%5Cfrac%20n%20d)g(d)%20%5Cleq%20%5Csum_%7Bd%20%5Cmid%20n%7D%20%5Cmu(%5Cfrac%20n%20d)%20d%20=%20%5Cvarphi(n)%0A"> 但根据 <img src="https://latex.codecogs.com/png.latex?h"> 的定义和 Dirichlet 卷积 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi%20*%20I%20=%20%5Cmathrm%7Bid%7D"> 有 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bn%20%5Cmid%20%7CG%7C%7D%20h(n)%20=%20%7CG%7C%20=%20%5Csum_%7Bn%20%5Cmid%20%7CG%7C%7D%20%5Cvarphi(n)%0A"> 这逼迫 <img src="https://latex.codecogs.com/png.latex?h(n)=%5Cvarphi(n)"> 对所有 <img src="https://latex.codecogs.com/png.latex?n%20%5Cmid%20%7CG%7C"> 成立．特别地，<img src="https://latex.codecogs.com/png.latex?h(%7CG%7C)%20=%20%5Cvarphi(%7CG%7C)%20%5Cgeq%201">，故 <img src="https://latex.codecogs.com/png.latex?G"> 是循环群．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>结合前述讨论，我们已经证明 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 是循环群．事实上 定理&nbsp;9 将导出如下更广泛的结果 <span class="citation" data-cites="dummit_abstract_2003">[1, section 9.5, proposition 18, p.&nbsp;314]</span></p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-field-mul-subgroup" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 1</strong></span> 域 <img src="https://latex.codecogs.com/png.latex?F"> 的任意有限乘法子群 <img src="https://latex.codecogs.com/png.latex?G%20%5Cle%20F%5E%5Ctimes"> 均为循环群．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>与本节开始的讨论相仿．考察 <img src="https://latex.codecogs.com/png.latex?G"> 中所有 <img src="https://latex.codecogs.com/png.latex?d"> 阶单位根，它们均为 <img src="https://latex.codecogs.com/png.latex?F%5Bx%5D"> 中多项式 <img src="https://latex.codecogs.com/png.latex?x%5Ed%20-%201"> 的根，但域上的 <img src="https://latex.codecogs.com/png.latex?d"> 次多项式至多只有 <img src="https://latex.codecogs.com/png.latex?d"> 个根，故 定理&nbsp;9 的条件得到满足．</p>
</div>
</section>
<section id="sec-nup" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sec-nup"><span class="header-section-number">6</span> <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi"> 的结构：二项式定理与含 <img src="https://latex.codecogs.com/png.latex?p"> 量估计</h2>
<p>这里处理 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi"> 的结构的办法相当暴力 <span class="citation" data-cites="dummit_abstract_2003">[1, section 2.4, exercises 21–23, p.&nbsp;60]</span>：</p>
<ul>
<li>当 <img src="https://latex.codecogs.com/png.latex?p"> 是奇质数时，我们将直接找到一个 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20%5Cle%20Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 中的一个 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha-1%7D"> 阶元，据此得到 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20%5Ccong%20Z_%7Bp%5E%7B%5Calpha%20-%201%7D%7D">；</li>
<li>当 <img src="https://latex.codecogs.com/png.latex?p%20=%202"> 时（此时 <img src="https://latex.codecogs.com/png.latex?Z_p%5E%5Ctimes"> 是平凡群，故 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20=%20Z_%7B2%5E%5Calpha%7D%5E%5Ctimes">），我们将直接找到一个 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi"> 中的 <img src="https://latex.codecogs.com/png.latex?2%5E%7B%5Calpha-2%7D"> 阶元，再找到两个不同的 <img src="https://latex.codecogs.com/png.latex?2"> 阶元，据此证明 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20%5Ccong%20Z_2%20%5Ctimes%20Z_%7B2%5E%7B%5Calpha%20-%202%7D%7D">．</li>
</ul>
<p>先介绍一个关于二项式含 <img src="https://latex.codecogs.com/png.latex?p"> 量的有趣结果．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-kummer-special" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 1 (Kummer 定理的一个特例)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?p"> 是质数，<img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%200"> 是非负整数，<img src="https://latex.codecogs.com/png.latex?1%20%5Cle%20k%5Cle%20p%5E%5Calpha">，则 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p%20(%5Cbinom%7Bp%5E%5Calpha%7D%7Bk%7D)%20=%20%5Calpha%20-%20%5Cnu_p%20(k)%0A"> 这里 <img src="https://latex.codecogs.com/png.latex?%5Cnu_p"> 是所谓的 <img src="https://latex.codecogs.com/png.latex?p">-adic valuation 函数，其返回因子分解中素因子 <img src="https://latex.codecogs.com/png.latex?p"> 对应的指数，以后简称含 <img src="https://latex.codecogs.com/png.latex?p"> 量．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>基本的想法是将二项式系数展开写为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbinom%7Bp%5E%5Calpha%7D%7Bk%7D%20=%20%5Cfrac%7Bp%5E%5Calpha%20(p%5E%5Calpha%20-1)%20%5Cdots%20(p%5E%5Calpha%20-k+1)%7D%7B1%20%5Ctimes%202%5Ctimes%20%20%5Cdots%20%5Ctimes%20k%7D%0A"> 并观察从 <img src="https://latex.codecogs.com/png.latex?%5Cnu_p"> 从 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bp%5E%5Calpha%7D%7Bk-1%7D"> 到 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bp%5E%5Calpha%7D%7Bk%7D"> 取值的变化．注意到 <img src="https://latex.codecogs.com/png.latex?%5Cnu_p(k)%20=%20%5Cnu_p%20(p%5E%5Calpha%20-%20k)"> 对 <img src="https://latex.codecogs.com/png.latex?1%20%5Cle%20k%20%5Cle%20p%5E%5Calpha%20-%201"> 成立，故 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p%20(%5Cbinom%7Bp%5E%5Calpha%7D%7Bk%7D)%20-%20%5Cnu_p%20(%5Cbinom%7Bp%5E%5Calpha%7D%7Bk-1%7D)%20=%20%5Cnu_p%20(p%5E%5Calpha%20-k+1)%20-%20%5Cnu_p(k)%20=%20%5Cnu_p(k-1)%20-%20%5Cnu_p(k)%0A"> 连同初值 <img src="https://latex.codecogs.com/png.latex?%5Cnu_p%20(%5Cbinom%7Bp%5E%5Calpha%7D%7B0%7D)%20=%20%5Calpha">，命题得证．</p>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> nu(p,x):</span>
<span id="cb1-5">  cnt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-6">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb1-7">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//=</span> p</span>
<span id="cb1-8">    cnt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-9">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> cnt</span>
<span id="cb1-10"></span>
<span id="cb1-11"></span>
<span id="cb1-12">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-13">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">npk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-17">  npk.append(a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>nu(p,k))</span>
<span id="cb1-18"></span>
<span id="cb1-19">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb1-20">ax.plot(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),npk)</span>
<span id="cb1-21">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-22">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span>
<span id="cb1-23">ax.set_xticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-24">ax.set_yticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-25">ax.set_xlim((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>))</span>
<span id="cb1-26">ax.set_ylim((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))</span>
<span id="cb1-27">plt.show()  </span></code></pre></div>
</details>
<div id="fig-kummer" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-kummer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="24c74294" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20240922-pr/index_files/figure-html/cell-2-output-1.png" width="566" height="104" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-kummer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;1: <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha%20=%203%5E3"> 时 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bp%5E%5Calpha%7D%7Bk%7D"> 的含 <img src="https://latex.codecogs.com/png.latex?p"> 量
</figcaption>
</figure>
</div>
<p>继续证明前我们再做一些观察：</p>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">lim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb2-2">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb2-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,lim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb2-4">ax.plot(x,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> k: nu(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,k), x)), label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nu_3(k)$"</span>)</span>
<span id="cb2-5">ax.plot(x,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> k: nu(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,k), x)), label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">nu_2(k)$"</span>)</span>
<span id="cb2-6">ax.plot(x,x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$k-1$"</span>)</span>
<span id="cb2-7">ax.plot(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dotted"</span>, label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$2k-2$"</span>)</span>
<span id="cb2-8">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-9">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span>
<span id="cb2-10">ax.set_xticks(x)</span>
<span id="cb2-11">ax.set_yticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb2-12">ax.set_xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,lim)</span>
<span id="cb2-13">ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-14">ax.legend()</span>
<span id="cb2-15">plt.show()</span></code></pre></div>
</details>
<div id="fig-compare" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="c322755c" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20240922-pr/index_files/figure-html/cell-3-output-1.png" width="578" height="206" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;2: 若干含 <img src="https://latex.codecogs.com/png.latex?p"> 量比较
</figcaption>
</figure>
</div>
<p>受 图&nbsp;2 启发，容易证明：</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?k-1%20%5Cge%20%5Cnu_p%20(k)"> 对所有质数 <img src="https://latex.codecogs.com/png.latex?p"> 和 <img src="https://latex.codecogs.com/png.latex?k%20%5Cge%201"> 成立；</li>
<li><img src="https://latex.codecogs.com/png.latex?k-2%20%5Cge%20%5Cnu_p%20(k)"> 对所有奇质数 <img src="https://latex.codecogs.com/png.latex?p%20%5Cge%203"> 和 <img src="https://latex.codecogs.com/png.latex?k%20%5Cge%202"> 成立；</li>
<li><img src="https://latex.codecogs.com/png.latex?2k-2%20%5Cge%20%5Cnu_2%20(k)"> 对所有 <img src="https://latex.codecogs.com/png.latex?k%20%5Cge%201"> 成立．</li>
<li><img src="https://latex.codecogs.com/png.latex?2k-3%20%5Cge%20%5Cnu_2%20(k)"> 对所有 <img src="https://latex.codecogs.com/png.latex?k%20%5Cge%202"> 成立．</li>
</ul>
<p>这四个不等式的微妙区别是导致奇质数和 <img src="https://latex.codecogs.com/png.latex?2"> 需要分别讨论的罪魁祸首之一．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-kerphi-oddp" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 2</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?p"> 是奇质数，<img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%201"> 是正整数，则元素 <img src="https://latex.codecogs.com/png.latex?1+p%20%5Cin%20%5Cker%20%5Cpi%20%5Cle%20Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> 的阶为 <img src="https://latex.codecogs.com/png.latex?p%5E%7B%5Calpha-1%7D">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>首先考察 <img src="https://latex.codecogs.com/png.latex?%0A(1+p)%5E%7Bp%5E%7B%5Calpha-1%7D%7D%20=%201%20+%20%5Csum_%7Bk=1%7D%5E%7Bp%5E%7B%5Calpha-1%7D%7D%20%5Cbinom%7Bp%5E%7B%5Calpha-1%7D%7D%7Bk%7D%20p%5Ek%0A"> 应用 命题&nbsp;1 大力考察求和每一项的含 <img src="https://latex.codecogs.com/png.latex?p"> 量，得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p(%5Cbinom%7Bp%5E%7B%5Calpha-1%7D%7D%7Bk%7D%20p%5Ek)%20=%20%5Calpha%20-%201%20-%20%5Cnu_p%20(k)%20+%20k%0A"> 注意 <img src="https://latex.codecogs.com/png.latex?k-1%20%5Cge%20%5Cnu_p%20(k)"> 对 <img src="https://latex.codecogs.com/png.latex?k%20%5Cge%201"> 永远成立，故求和每一项的含 <img src="https://latex.codecogs.com/png.latex?p"> 量均至少为 <img src="https://latex.codecogs.com/png.latex?%5Calpha">，故 <img src="https://latex.codecogs.com/png.latex?%0A(1+p)%5E%7Bp%5E%7B%5Calpha-1%7D%7D%20%5Cequiv%201%20%5Cpmod%7Bp%5E%5Calpha%7D%0A"> 若 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%201">，则命题已经得证．下面来看为什么 <img src="https://latex.codecogs.com/png.latex?p%20%5Cge%203">, <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%202"> 时会有 <img src="https://latex.codecogs.com/png.latex?%0A1%20+%20%5Csum_%7Bk=1%7D%5E%7Bp%5E%7B%5Calpha-2%7D%7D%20%5Cbinom%7Bp%5E%7B%5Calpha-2%7D%7D%7Bk%7D%20p%5Ek%20=%20(1+p)%5E%7Bp%5E%7B%5Calpha-2%7D%7D%20%5Cnot%20%5Cequiv%201%20%5Cpmod%7Bp%5E%5Calpha%7D%0A"> 同样的方法计算含 <img src="https://latex.codecogs.com/png.latex?p"> 量 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p(%5Cbinom%7Bp%5E%7B%5Calpha-2%7D%7D%7Bk%7D%20p%5Ek)%20=%20%5Calpha%20-%202%20-%20%5Cnu_p%20(k)%20+%20k%0A"> 由上述不等式关系，右式仅在 <img src="https://latex.codecogs.com/png.latex?k=1"> 时小于 <img src="https://latex.codecogs.com/png.latex?%5Calpha">，因此和式中只有 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bp%5E%7B%5Calpha-2%7D%7D%7B1%7D%20p%20=%20p%5E%7B%5Calpha%20-%201%7D"> 一项在模 <img src="https://latex.codecogs.com/png.latex?p%5E%5Calpha"> 意义下产生了额外贡献——当然 <img src="https://latex.codecogs.com/png.latex?1%20+%20p%5E%7B%5Calpha-1%7D%20%5Cnot%20%5Cequiv%201%20%5Cpmod%7Bp%5E%5Calpha%7D">，得证．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-kerphi-oddp" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 2</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?p"> 是奇质数，<img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%201"> 是正整数，则 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20%5Ccong%20Z_%7Bp%5E%7B%5Calpha-1%7D%7D">．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-kerphi-evenp" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 3</strong></span> 设正整数 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%202">．元素 <img src="https://latex.codecogs.com/png.latex?5%20=%201+%202%5E2%20%5Cin%20%5Cker%20%5Cpi%20=%20Z_%7B2%5E%5Calpha%7D%5E%5Ctimes"> 的阶为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B%5Calpha-2%7D">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>请读者仿照上例练习．考虑利用二项式定理展开 <img src="https://latex.codecogs.com/png.latex?(1+2%5E2)%5E%7B2%5E%7B%5Calpha-2%7D%7D"> 和 <img src="https://latex.codecogs.com/png.latex?(1+2%5E2)%5E%7B2%5E%7B%5Calpha-3%7D%7D"> 并利用 图&nbsp;2 下方的后两个不等式．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-kerphi-notcyc" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 4</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%202"> 是正整数，则元素 <img src="https://latex.codecogs.com/png.latex?-1"> 和 <img src="https://latex.codecogs.com/png.latex?1+2%5E%7B%5Calpha-1%7D"> 在 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi%20=%20Z_%7B2%5E%5Calpha%7D%5E%5Ctimes"> 的阶为 <img src="https://latex.codecogs.com/png.latex?2">．当 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%203"> 时两者互异．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>显然 <img src="https://latex.codecogs.com/png.latex?-1"> 阶为 <img src="https://latex.codecogs.com/png.latex?2">．而 <img src="https://latex.codecogs.com/png.latex?%0A(1+2%5E%7B%5Calpha-1%7D)%5E2%20%5Cequiv%201%20+%202%20%5Ctimes%202%5E%7B%5Calpha-1%7D%20+%202%5E%7B2(%5Calpha-1)%7D%20%5Cequiv%201%20%5Cpmod%7B2%5E%5Calpha%7D%0A"></p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-kerphi-notcyc" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 3</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%202"> 是正整数，则 <img src="https://latex.codecogs.com/png.latex?Z_%7B2%5E%5Calpha%7D%5E%5Ctimes%20=%20%5Cker%20%5Cpi%20%5Ccong%20Z_2%20%5Ctimes%20Z_%7Bp%5E%7B%5Calpha-2%7D%7D">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>当 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%202">，<img src="https://latex.codecogs.com/png.latex?%7C%5Cker%20%5Cpi%7C%20=%202">，平凡．当 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cge%203">，命题&nbsp;4 给出了两个无交且生成整个 <img src="https://latex.codecogs.com/png.latex?%5Cker%20%5Cpi"> 的循环群，使用子群直积的识别定理即可．</p>
</div>
</section>
<section id="结论" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="结论"><span class="header-section-number">7</span> 结论</h2>
<p>综合 小节&nbsp;5 和 小节&nbsp;6 的结果，我们将结果总结如下 <span class="citation" data-cites="dummit_abstract_2003">[1, section 9.5, corollary 20, p.&nbsp;314]</span>：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-zm-final" class="theorem">
<p><span class="theorem-title"><strong>定理 10 (模 <img src="https://latex.codecogs.com/png.latex?m"> 剩余类乘法群 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 的结构性定理)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?n%20%5Cgeq%202"> 为一正整数，其质因子分解为 <img src="https://latex.codecogs.com/png.latex?n%20=%20%5Cprod_%7Bi=1%7D%5Ek%20p_i%5E%7B%5Calpha_i%7D">，则有如下群同构 <img src="https://latex.codecogs.com/png.latex?%0AZ_m%5E%5Ctimes%20%5Ccong%20%5Cprod_%7Bi=1%7D%5Ek%20Z_%7Bp_i%5E%7B%5Calpha_i%7D%7D%5E%5Ctimes%20%5C%5C%0A"> 对分解中满足 <img src="https://latex.codecogs.com/png.latex?p%20%5Cgeq%203"> 的 <img src="https://latex.codecogs.com/png.latex?Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes"> ，有 <img src="https://latex.codecogs.com/png.latex?%0AZ_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20Z_%7Bp-1%7D%20%5Ctimes%20Z_%7Bp%5E%7B%5Calpha-1%7D%7D%20%5Ccong%20Z_%7Bp%5E%7B%5Calpha-1%7D(p-1)%7D%0A"> 对分解中的 <img src="https://latex.codecogs.com/png.latex?Z_%7B2%5E%5Calpha%7D%5E%5Ctimes">，有 <img src="https://latex.codecogs.com/png.latex?%0AZ_%7B2%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20Z_2%20%5Ctimes%20Z_%7B2%5E%7B%5Calpha-2%7D%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>据此，原根存在定理成为简单的推论．</p>
<div class="proof">
<p><span class="proof-title"><em>证明</em> (定理&nbsp;3). </span>注意群同构 <img src="https://latex.codecogs.com/png.latex?Z_a%20%5Ctimes%20Z_b%20%5Ccong%20Z_%7Bab%7D"> 当且仅当 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,b)%20=%201">，这将组成证明各项讨论的核心．</p>
<p>对奇质数 <img src="https://latex.codecogs.com/png.latex?p%20%5Cgeq%203"> 和正整数 <img src="https://latex.codecogs.com/png.latex?%5Calpha">，有如下群同构关系 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AZ_2%5E%5Ctimes%20&amp;%5Ccong%20Z_1%20%5C%5C%0AZ_4%5E%5Ctimes%20&amp;%5Ccong%20Z_2%20%5C%5C%0AZ_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20&amp;%5Ccong%20Z_%7Bp%5E%7B%5Calpha-1%7D(p-1)%7D%20%5C%5C%0AZ_%7B2p%5E%5Calpha%7D%5E%5Ctimes%20&amp;%5Ccong%20Z_2%5E%5Ctimes%20%5Ctimes%20Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ccong%20Z_1%20%5Ctimes%20Z_%7Bp%5E%7B%5Calpha-1%7D(p-1)%7D%20%5Ccong%20Z_%7Bp%5E%7B%5Calpha-1%7D(p-1)%7D%0A%5Cend%7Baligned%7D%0A"> 故 <img src="https://latex.codecogs.com/png.latex?m%20=%202,4,p%5E%5Calpha,2p%5E%5Calpha"> 时 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 为循环群．</p>
<p>对任意互异的奇质数 <img src="https://latex.codecogs.com/png.latex?p,q%20%5Cge%203"> 和正整数 <img src="https://latex.codecogs.com/png.latex?%5Calpha,%20%5Cbeta">，有 <img src="https://latex.codecogs.com/png.latex?%0AZ_%7Bp%5E%5Calpha%20q%5E%5Cbeta%7D%5E%5Ctimes%20%5Ccong%20Z_%7Bp%5E%5Calpha%7D%5E%5Ctimes%20%5Ctimes%20Z_%7Bq%5E%5Cbeta%7D%5E%5Ctimes%20%5Ccong%20Z_%7Bp-1%7D%20%5Ctimes%20Z_%7Bp%5E%7B%5Calpha-1%7D%7D%20%5Ctimes%20Z_%7Bq-1%7D%20%5Ctimes%20Z_%7Bq%5E%7B%5Calpha-1%7D%7D%0A"> 但 <img src="https://latex.codecogs.com/png.latex?p-1"> 和 <img src="https://latex.codecogs.com/png.latex?q-1"> 均为偶数，故含有两个互异奇质因子的 <img src="https://latex.codecogs.com/png.latex?m"> 对应的 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 都不是循环群．</p>
<p>对奇质数 <img src="https://latex.codecogs.com/png.latex?p%20%5Cgeq%203">、正整数 <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cgeq%203"> 和正整数 <img src="https://latex.codecogs.com/png.latex?%5Cbeta">，有如下群同构关系 <img src="https://latex.codecogs.com/png.latex?%0AZ_%7B2%5E%5Calpha%20p%5E%5Cbeta%7D%5E%5Ctimes%0A%5Ccong%20Z_%7B2%5E%5Calpha%7D%5E%5Ctimes%20%5Ctimes%20Z_%7Bp%5E%5Cbeta%7D%5E%5Ctimes%0A%5Ccong%20Z_2%20%5Ctimes%20Z_%7B2%5E%7B%5Calpha-2%7D%7D%5E%5Ctimes%20%5Ctimes%20Z_%7Bp-1%7D%20%5Ctimes%20Z_%7Bp%5E%7B%5Cbeta-1%7D%7D%0A"> 但 <img src="https://latex.codecogs.com/png.latex?p-1"> 和 <img src="https://latex.codecogs.com/png.latex?2"> 均为偶数，故含有一个奇质因子和质因子 <img src="https://latex.codecogs.com/png.latex?2"> 的 <img src="https://latex.codecogs.com/png.latex?m"> 对应的 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 也不是循环群．</p>
<p>综上，仅当 <img src="https://latex.codecogs.com/png.latex?m%20=%202,4,p%5E%5Calpha,2p%5E%5Calpha"> 时 <img src="https://latex.codecogs.com/png.latex?Z_m%5E%5Ctimes"> 为循环群．</p>
</div>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-dummit_abstract_2003" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">D. S. Dummit 和 R. M. Foote, <em>Abstract Algebra</em>, 3rd edition. New York: Wiley, 2003.</div>
</div>
<div id="ref-hungerford_algebra_1980" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">T. W. Hungerford, <em>Algebra</em>, 8th edition. New York: Springer, 1980.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <guid>https://blog.sun123zxy.top/posts/20240922-pr/</guid>
  <pubDate>Sat, 21 Sep 2024 16:00:00 GMT</pubDate>
</item>
<item>
  <title>代数同构视角下的离散 Fourier 变换</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20240513-isodft/</link>
  <description><![CDATA[ 




<section id="从-fourier-变换到-dft" class="level1 page-columns page-full" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> 从 Fourier 变换到 DFT</h1>
<section id="fourier-变换及其卷积性质" class="level3">
<h3 class="anchored" data-anchor-id="fourier-变换及其卷积性质">Fourier 变换及其卷积性质</h3>
<ul>
<li><p>Fourier 变换：将给定函数 <img src="https://latex.codecogs.com/png.latex?f"> 映为函数 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20F%5Bf%5D">： <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%20F%5Bf%5D(%5Clambda)%20:=%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20f(t)%20e%5E%7B-%20%5Cmathrm%7Bi%7D%5Clambda%20t%7D%20%5Coperatorname%7Bd%7D%5C!t%0A"></p></li>
<li><p>定义函数 <img src="https://latex.codecogs.com/png.latex?f"> 和 <img src="https://latex.codecogs.com/png.latex?g"> 的卷积 <img src="https://latex.codecogs.com/png.latex?%0A(f*g)(%5Clambda)%20:=%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20f(%5Clambda-x)%20g(x)%20%5Coperatorname%7Bd%7D%5C!x%0A"> 则 Fourier 变换将两个函数的卷积化为逐点乘积，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%20F%5Bf*g%5D%20=%20%5Cmathcal%20F%5Bf%5D%20%5Cmathcal%20F%5Bg%5D%0A"></p></li>
</ul>
</section>
<section id="复数域上的-dft-及其卷积性质" class="level3">
<h3 class="anchored" data-anchor-id="复数域上的-dft-及其卷积性质">复数域上的 DFT 及其卷积性质</h3>
<ul>
<li><p><em>离散 Fourier 变换</em>（Discrete Fourier Transform, DFT）：线性空间 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En%20%5Cto%20%5Cmathbb%20C%5En"> 上的线性变换 <img src="https://latex.codecogs.com/png.latex?F">，将向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a%20%20=%20(a_0,a_1,%5Cdots,a_%7Bn-1%7D)%5E%5Cmathrm%7BT%7D%5Cin%20%5Cmathbb%20C%5En"> 映为 <img src="https://latex.codecogs.com/png.latex?F%20%5Cboldsymbol%20a">，其第 <img src="https://latex.codecogs.com/png.latex?i"> 个分量如下所示 <img src="https://latex.codecogs.com/png.latex?%0A(F%20%5Cboldsymbol%20a)_i%20:=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20a_i%0A"> 这里分量下标从 <img src="https://latex.codecogs.com/png.latex?0"> 开始计数，<img src="https://latex.codecogs.com/png.latex?%5Comega_n%20:=%20e%5E%7B2%20%5Cpi%20%5Cmathrm%7Bi%7D/%20n%7D"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上的一个 <img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根．</p></li>
<li><p>相仿的卷积性：两个向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a,%20%5Cboldsymbol%20b%20%5Cin%20%5Cmathbb%20C%5En"> 的<em>循环卷积</em>定义为 <img src="https://latex.codecogs.com/png.latex?%0A(%5Cboldsymbol%20a%20*%20%5Cboldsymbol%20b)_k%20:=%20%5Csum_%7Bi%20+%20j%20=%20k%20%5Cpmod%7Bn%7D%7D%20a_i%20b_j%0A"> 则 DFT 将两个向量的循环卷积化为<em>逐项乘积</em> <img src="https://latex.codecogs.com/png.latex?%5Ctimes">，即 <img src="https://latex.codecogs.com/png.latex?%0AF(%5Cboldsymbol%20a%20*%20%5Cboldsymbol%20b)%20=%20(F%20%5Cboldsymbol%20a)%20%5Ctimes%20(F%20%5Cboldsymbol%20b)%0A"></p></li>
</ul>
</section>
<section id="矩阵表示" class="level3">
<h3 class="anchored" data-anchor-id="矩阵表示">矩阵表示</h3>
<p>在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 的自然基下，变换 <img src="https://latex.codecogs.com/png.latex?F"> 有矩阵表示 <img src="https://latex.codecogs.com/png.latex?%0AF%20=%20%5Cbegin%7Bpmatrix%7D%20%5Comega_n%5E%7Bij%7D%20%5Cend%7Bpmatrix%7D_%7B(i,j)%5Cin%20n%20%5Ctimes%20n%7D%20=%20%5Cbegin%7Bpmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A1%20&amp;%20%5Comega_n%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A1%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B(n-1)(n-1)%7D%0A%5Cend%7Bpmatrix%7D%0A"></p>
<ul>
<li>卷积性：系数为全体复平面 <img src="https://latex.codecogs.com/png.latex?n"> 次单位根的可逆 Vandermonde 矩阵</li>
<li>正交性：适当单位化后为酉矩阵</li>
</ul>
</section>
<section id="问题" class="level3">
<h3 class="anchored" data-anchor-id="问题">问题<sup>1</sup></h3>
<ul>
<li><p>DFT 化卷为乘的本质？</p>
<ul>
<li>我们给出一大类具备卷积性的线性映射的构造，DFT 将作为特例推出．</li>
</ul></li>
<li><p>如何从代数角度理解 DFT？</p>
<ul>
<li>两个视角：多项式环、矩阵代数</li>
<li>两种表现：求值插值、相似对角化</li>
<li>一致观点：保加法、保数乘、保乘法的代数同构</li>
</ul></li>
<li><p>DFT 是否是唯一一类化卷为乘的变换？作为底层结构的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 是否可以放宽？</p>
<ul>
<li><p>工程上复数乘法运算较慢且具有浮点误差，更换底层代数结构具有实际意义．例如，被称为数论变换（number theoretic transforms, NTT）的 DFT 变种就将 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 替换为有限域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20F_p"> 而同时保留了其卷积性质．</p></li>
<li><p>我们将其 DFT 扩展至任意整环并证明特定含义下的唯一性．</p></li>
</ul></li>
</ul>
</section>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;<span class="citation" data-cites="agarwal_number_1975">[1]</span>; <span class="citation" data-cites="nicholson_algebraic_1971">[2]</span>; <span class="citation" data-cites="furer_faster_2009">[3]</span>; <span class="citation" data-cites="amiot_music_2016">[4]</span>; <span class="citation" data-cites="baraquin_uniqueness_2023">[5]</span></p></div></div></section>
<section id="dft-与多项式环" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> DFT 与多项式环</h1>
<section id="引例mathbb-cx求值插值与复数域-dft" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="引例mathbb-cx求值插值与复数域-dft"><span class="header-section-number">2.1</span> 引例：<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D">、求值插值与复数域 DFT</h2>
<section id="mathbb-cx-与循环卷积" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-cx-与循环卷积"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 与循环卷积</h3>
<p>设不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式 <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20x%5Ek">，<img src="https://latex.codecogs.com/png.latex?g(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20b_k%20x%5Ek">．二者的多项式乘积由 <em>Cauchy 乘积</em>给出 <img src="https://latex.codecogs.com/png.latex?%0Af(x)%20g(x)%20=%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20a_i%20x%5Ei%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20b_j%20x%5Ej%20=%20%5Csum_%7Bk=0%7D%5E%7B2n-2%7D%20x%5Ek%20%5Csum_%7Bi+j%20=%20k%7D%20a_i%20b_j%0A"> 令 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a%20:=%20(a_0,a_1,%5Cdots,a_%7Bn-1%7D)%5E%5Cmathrm%7BT%7D">，<img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20b%20:=%20(b_0,b_1,%5Cdots,b_%7Bn-1%7D)%5E%5Cmathrm%7BT%7D">，回顾循环卷积定义 <img src="https://latex.codecogs.com/png.latex?%0A(%5Cboldsymbol%20a%20*%20%5Cboldsymbol%20b)_k%20:=%20%5Csum_%7Bi%20+%20j%20=%20k%20%5Cpmod%7Bn%7D%7D%20a_i%20b_j%0A"> 可见 Cauchy 乘积与循环卷积尚有区别．稍加改动，若在模 <img src="https://latex.codecogs.com/png.latex?x%5En%20-%201"> 的意义下——即商环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D/(x%5En-1)"> 中计算，则二者相合： <img src="https://latex.codecogs.com/png.latex?%0Af(x)%20g(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20x%5Ek%20%5Csum_%7Bi%20+%20j%20=%20k%20%5Cpmod%7Bn%7D%7D%20a_i%20b_j%20%5Cpmod%7Bx%5En%20-%201%7D%0A"></p>
</section>
<section id="mathbb-cx-与复数域-dft" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-cx-与复数域-dft"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 与复数域 DFT</h3>
<p>DFT 亦有在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 上的表示．给定 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a%20:=%20(a_0,a_1,%5Cdots,a_%7Bn-1%7D)%5E%5Cmathrm%7BT%7D%5Cin%20%5Cmathbb%20C%5En">，其对应多项式 <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20x%5Ek"> 次数不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次，则 <img src="https://latex.codecogs.com/png.latex?%0A(F%20%5Cboldsymbol%20a)_i%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20%5Cboldsymbol%20a_i%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Cboldsymbol%20a_i%20(%5Comega_n%5Ei)%5Ek%20=%20f(%5Comega_n%5Ei)%0A"> 恰为 <img src="https://latex.codecogs.com/png.latex?f(x)"> 分别在 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上 <img src="https://latex.codecogs.com/png.latex?n"> 次单位根处<em>多点求值</em>的结果．</p>
<ul>
<li>可逆性：<img src="https://latex.codecogs.com/png.latex?n"> 点唯一确定一个不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式（<em>Lagrange 插值</em>）</li>
<li>线性性：<img src="https://latex.codecogs.com/png.latex?(af+bg)%20(%5Comega_n%5Ei)%20=%20a%20f(%5Comega_n%5Ei)%20+%20b%20g(%5Comega_n%5Ei)"></li>
<li>卷积性：将取模乘法化为点值逐项相乘，再次与 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上的表现相合 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AF(%5Cboldsymbol%20a%20*%20%5Cboldsymbol%20b)%20&amp;=%20(F%20%5Cboldsymbol%20a)%20%5Ctimes%20(F%20%5Cboldsymbol%20b)%20%5C%5C%0A(fg)(%5Comega_n%5Ei)%20&amp;=%20f(%5Comega_n%5Ei)%20g(%5Comega_n%5Ei)%0A%5Cend%7Baligned%7D%0A"></li>
</ul>
</section>
<section id="小结" class="level3">
<h3 class="anchored" data-anchor-id="小结">小结</h3>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 与 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 视角下的 DFT：</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En">：作为以单位根为参数的 Vandermonde 矩阵，DFT 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上的可逆线性变换，将向量间的循环卷积 <img src="https://latex.codecogs.com/png.latex?*"> 化为逐项乘积 <img src="https://latex.codecogs.com/png.latex?%5Ctimes">．</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D">：作为单位根处的多点求值插值，DFT 在全体不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式和 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 间建立起线性同构关系，将多项式乘积化为函数值逐点乘积．</p></li>
</ul></li>
<li><p>化卷为乘，就是把多项式环上的取模乘法变为 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上的逐项乘积，DFT 保持了两个代数结构间的乘法．</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 作为环结构乘法自然，在多项式环上刻画 DFT 较在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上强行定义循环卷积具有优越性．</li>
</ul></li>
</ul>
</section>
</section>
<section id="整环上的推广" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="整环上的推广"><span class="header-section-number">2.2</span> 整环上的推广</h2>
<section id="代数代数同构与直积" class="level3">
<h3 class="anchored" data-anchor-id="代数代数同构与直积">代数、代数同构与直积</h3>
<ul>
<li><p>整环：无零因子交换幺环</p></li>
<li><p>设 <img src="https://latex.codecogs.com/png.latex?R"> 是一整环，若 <img src="https://latex.codecogs.com/png.latex?(A,+,%5Ctimes)"> 为一环且配备了与乘法 <img src="https://latex.codecogs.com/png.latex?%5Ctimes"> 相容的 <img src="https://latex.codecogs.com/png.latex?R">-数乘 <img src="https://latex.codecogs.com/png.latex?%5Ccdot">，则称 <img src="https://latex.codecogs.com/png.latex?A"> 是一 <img src="https://latex.codecogs.com/png.latex?R">-代数，不至混淆时简称代数．</p>
<ul>
<li>整环 <img src="https://latex.codecogs.com/png.latex?R"> 自身也可视为一个代数．</li>
</ul></li>
<li><p>我们将 <img src="https://latex.codecogs.com/png.latex?R%5En"> 理解为作为代数的 <img src="https://latex.codecogs.com/png.latex?R"> 的直积，即 <img src="https://latex.codecogs.com/png.latex?R%5En%20=%20R%20%5Ctimes%20R%20%5Ctimes%20%5Cdots%20%5Ctimes%20R">．直积的加法、数乘和乘法均在逐项意义下定义．</p></li>
<li><p>保持代数间加法、数乘和乘法的双射被称为代数同构．</p></li>
</ul>
</section>
<section id="几个观察与整环的优势" class="level3">
<h3 class="anchored" data-anchor-id="几个观察与整环的优势">几个观察与整环的优势</h3>
<ul>
<li><p>关于引例的若干观察：</p>
<ul>
<li><p>DFT 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D%20/%20(x%5En-1)%20%5Cto%20R%5En"> 的一个代数同构，具体做法是在单位根处多点求值插值</p></li>
<li><p>求值插值在任意 <img src="https://latex.codecogs.com/png.latex?n"> 个不同位置进行即可，单位根不是本质要求</p></li>
<li><p>商环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D%20/%20(x%5En-1)"> 带来了与循环卷积对应的多项式取模乘法，还蕴含着“不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次”为求值插值带来的单与满</p></li>
<li><p><em>第一同构定理</em>：设 <img src="https://latex.codecogs.com/png.latex?f:%20R%20%5Cto%20S"> 是环同态，则 <img src="https://latex.codecogs.com/png.latex?f"> 诱导出环同构 <img src="https://latex.codecogs.com/png.latex?R%20/%20%5Coperatorname%7BKer%7Df%20%5Ccong%20%5Coperatorname%7BIm%7Df"></p></li>
</ul></li>
<li><p>选取整环作为底层代数结构的理由：</p>
<ul>
<li>交换：确保求值操作是同态</li>
<li>保留环上整除的结构和多项式根与因子的关系（带余除法、余式定理）</li>
<li>在唯一性证明中发挥作用</li>
</ul></li>
</ul>
</section>
<section id="商环到直积的代数同构" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="商环到直积的代数同构">商环到直积的代数同构</h3>
<p>下面固定 <img src="https://latex.codecogs.com/png.latex?R"> 是一整环．令 <img src="https://latex.codecogs.com/png.latex?C"> 是 <img src="https://latex.codecogs.com/png.latex?R"> 的一有限子集，由若干不同一次多项式乘积 <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bc%20%5Cin%20C%7D%20(x-c)"> 生成的 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 上的理想记为 <img src="https://latex.codecogs.com/png.latex?%5Cleft(%20%5Cprod_%7Bc%20%5Cin%20C%7D%20(x-c)%20%5Cright)">．</p>
<p>用记号 <img src="https://latex.codecogs.com/png.latex?R%5EC"> 代表全体 <img src="https://latex.codecogs.com/png.latex?C"> 上的 <img src="https://latex.codecogs.com/png.latex?R"> 值函数构成的集合．<img src="https://latex.codecogs.com/png.latex?R%5EC"> 与其上定义的函数逐点加法、数乘和乘法构成一个代数，自然也与 <img src="https://latex.codecogs.com/png.latex?R%5En"> 代数同构．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-dft-exist" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 1</strong></span> 多项式商环 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D%20/%20%5Cleft(%20%5Cprod_%7Bc%20%5Cin%20C%7D%20(x-c)%20%5Cright)"> 与代数直积 <img src="https://latex.codecogs.com/png.latex?R%5EC"> 代数同构．</p>
</div>
</div>
</div>
</div>
<div id="fig-dft-exist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dft-exist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="253.425pt" height="83.085pt" viewbox="0 0 168.95 55.39">
<style type="text/css">
@font-face{font-family:OWMFFL-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAPIAAoAAAAABjgAAAN+AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqFSIQtCwoAATYCJAMQBCAFgmgHIBviBACOwrZtE8OZTL7OElRFPPx3b943M/9vaymd0qkS7QkGAxZfgohEoQq+qdxsQ4CaaEpVKDVDK67hVOGgasrcS/4u838z/i/refGYICEluKYm0KY1hAIMMOsW3iY6PaBJJ3RAeM9TzTyatVqFowOHC9TiAT0BOMon5vC/NHg8XOgtsQAhBACkBw2+yvtHcQrA2yqtIFGF395MUFCxV7E9WA+PDA0VbCUozdTm8iub8z4IgxtrCNM/IDbW26YIsfJDGBl0IR7PqJ8HXfnqbhGJLC6j81IDlVdvANxBoc5jAkdOhi2DGssPEFnWXbpzVKaSWn0zVL9GFaTLsye3UZYslSz7QpbJkdnsV4phClp39LsTubykXJAvUur2BCcujEcuALpqxfaS26dxZNioI0v7gHx1BfFo/UY82uapCndB8F6fIrNerj+FrM4F6OAmj8YRkmED1Jwrv0CeOlJk6Q8Q7x2p1g/r3e9Ee7TZMjrT52o8HtQ0p911QWbJbuKvJNQbLdO6L5H6c5vuXRXuzFQfxOzX65LV3TCWHqgpdBcqIALypc4rRbIy7I6Q7rudvHn6yPAW0dpQzjYNURAWl1enkoTGQtz4RRin26zRWm3Fm7CruPdg6C0R5UMiVO4uqiHseV1lK5eJQTG5bnxiVydPzgIe2Eooh6wpX33USgZlr5A77O9JIFkA9o0JKaUWP5sHrUolWmbLH8caL0YcienBrfIv9xS4MXAQRIn3xsS5BmM1/DyjMLkfO1GMnFgwBk9eCAGUF837G5biSpxrIbaKgUIisW780iftHx+5wSfZjQpDI1LaTyQEXucKPzZc0Pr1SUPcYFk5TTFfVtEXtAbbKAcptQSx8NKnbeI1P5TrpuJ6nTq28k9X1CFWW0R6OYz/DSJF9/EFAALB7lClP0bM8Rs/jAXwvdfbIlfyv+IwCwCkoU+QyvwRuABXHAiZzOJx/D7mgGHxAaogNG+zDDB/bAdCsIDCb2YWOtWZOKN6Mzf7x05YgkUTAOFCYKGaE5lU58AtqneiIRh7MXVYEv9C2x1ECyCR/E08AgJ8EPNLyBgxNbd1npaXEovTCopTstQJphb8auAhR5ZcRQolyacuQI5EzGYLQhOABFx/JjwEpH0gzFG9PrVAmhzZ1CFMmccALyM7zohbDSR68cokbqJiaQo2pciijsCURRMIAwA=) format('woff2');}
@font-face{font-family:NKRXYK-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJ8AAoAAAAABLQAAAIyAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqCNIIACw4AATYCJAMWBCAFgmIHIBu9AwCeA25bDE+LDR3CmUvvZfhGncEIvt/vt+c++apotCYeme6heGgkDwlCoRVoREoghffz4/L9E1nXSCcBqawd21CVloQyuGUYkATgGT2vqYv/7yZ/kTugqX6CZ6s0CiwPE8ysbWNjWIK9QNOsl7nrZCklLZcb3+Vhgiw+0SIUpC/M0z/PwvTR++DAGw1QCQ4e5eGxpxYINhRnUCETutYqkJBhbPvGcI6Aprok2eRUqLgKG/x2n6+rLgX1iBK0UeAMeAIgBwSuPhcx6vXbselATiCgDcgNBmd4PN/ZvnC2eK3S78vy+aaRMChnPJBjWRduzPiz/f7Gvk3duWRdOrhjPBOvlVPILc2ydU2iRKvWjKtviqCi3FViypVe0eBk6VCf5aqorhJQv4vLYn/gpi8SlVQ+a8FYUWzh0/6KyuN/0dRRxldiEluLGpNzGuEnxH+LrVaz0QWpllcfPrbyvhKOwxlmAAgEW6eM/FJmxHcdm4N/3tUh2DdUkgzqEggyFRIzwvgFxMWLhPiEh/6K48RRLEM/IYTSHAKhhE3vCugpTnJtPVJoWSKltrX2pkUeWJE3hFVJILm5BlKYmiCluc2oac9jNqA++6pNSczIy0+0RyZnuF1JdsrtcG0lXk6zqnrqO3tqm1Veh8fPhkitmrXp1qVaB5Vkrar432uRIlGGPPkS2UVKlsHNJUe1Dp3qtWqh4ubgioBY3RKly2+CqqBC/0qs0qNeZ1mtZipeDp4miQUA) format('woff2');}
@font-face{font-family:DBZQHP-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAANsAAoAAAAABYwAAAMiAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqEIINJCwoAATYCJAMQBCAFgmIHIBt4BBEVm98AfiTYNm8yTMPC4Z3Rj0lsiYfP2/v7a7cbDy3SSDIKgxCDLND9T172k0wtp00heqHBcd9duGEQlWuWqQzoAP6Jm2ljARXQVE9g2lgWFY4J2iUUYIDZ/Dns6c0nKb7qHFkIgQNoGGv14VAPr5DpRTqBAZRHX/3nh45hI5+RA3oICwDZAHUC3OvIyU8ARnbYPQZ0ICFAgx1cdIACJDBpv5pAog2gY4YCO8Rg93S610U/p0/8tQAEiDoYVGtfAP7ocwkIdFo6nCWBvb2sgv2CQmJUakAz2ZuMDwqTRSj+FIJGIwbYBPqG9h2y4XRpBIYUC4EzgaCYg4Tle36NrX5Z11e+c+hzUnrwG+jrg0p3+Zd4AhBiRenCA4rM6CFr87Jo1UYUPjo4Ozsv2i9FUMpVNLuBAYE+PIOfLM0/KTBF8dcjZogNrQ/EnRuQ8UXlHgYY0Aih/J+qeu9IxU/JBj9vLEEzgX3Kh1mcHYjI9GDEtds22C1QiMjV5fQSxPId9ex1cYiErXzZZCnurige9fg9L+sGhekWZGUMqUDriAwjJ0/dIq8ONBh777cd6uJ5FvUeLhvw5EtFV2VKgkQlq45V5I8X/PR7+HKFkVN4gpaDRaBhSQ5YlIMnKuVjn4heEopyaBofZyWJpxrsmIXqS/aKuVtJaJdWX7RgdJKjnHLl4sf9Hz7MWKOJ4z+Vz3zCUc44m7CQ03clR/+3ob6kTWdPcEBTvPDC2UiHYpTfASowX8tP7jaIh0qStxc4hmhKRANAAAGeTHmWCC7zP8wYCQAv/9LkeuGSxSLR9wA6VGnAMQsPrOgfQ+2VA6LFuOCMsoIVpjmx/MrqKjWQDeWAMEAuOLKKHZdPb9iI0Q07xcODKOgCBikLICTBPdEkwpBMMxCEapqRMAzmrBp9mw8y6n/KFtrbBvs4e2vYeXi4GL0fNHQ0tUOVj759sflJOfkJadJ6mrp4M9jJkCZTnlxxsknzkCHWHklnz1YwH868abDjwYMLIwGcV8uRJEM6aTo0aStAJy1dpUXdCYz1ohWt+LHyJcmZSpBGmh5NukUgBgAA) format('woff2');}
@font-face{font-family:MEQCZM-CMEX10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAKcAAoAAAAABLwAAAJQAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqCVIIcCwoAATYCJAMQBCAFgmgHIBvJAwiOkVuMqBj1HC/iIwjWWLN3h7hm09JVMskzIZNI3TRpJjSq/Pv04+r9NQ60p7sqKTlR+eLu/F9TL+n7gUXxIZ3g0TVWcuQ22jvB4XBixZHW5ns+bVtJFbToGOcYYjQbvv0F0mQh5kAnOaPc/ZOZRSv+O4NjsCFyEQbm4K6NvZZSMPR3Cql1igFI67jPKuCq//9BghTVqALZNP0gtx0SA51CQ+nHpf+fn4pdQIbnr66CU+H7hBBtBnrtSyorgyu1Pk9vqc/vqav3qqs1y9UPL+h7TH589F7efXhJWjLbrpbtutP3OpvS/5Ty9OSzEu2RgeUa78fXdh55v9Bgbl6kEDEeztQZa+fJiBQe+7pG07rVwPdLkXNn/pCvKqXWXoYgZuF0/G/ASrQ/X5BrcBkmXBUF63emTQU4wnVKg4SVg7u7vzmNtGU/fli73Hg1tkKX5/XaUqaSkhgac3vXQzXD6EAkoQ3wzGlzbp5oHsGgCMUlTsezT7LL/wACwb0y+S5X6KXMTzPwJds5x7t+MqhTsAL5EhBcTXzDklU6BQJQsjQTr9bJI0tZdReDTKcx8mCTUOhECspgZKZEGZmjSDOZq0Tf/kKNnFBFViC0imFkplEVmaPWCJmr0VZRaMjhWyD/+zUVHRwfmBFtHYhBmr3du71ob2MXjz5R1xW1lDe2lFbrOdo4DFcjUK1qdZo1KdZAT7RaRQyu2R0sXqAM0awF8nYae3ZSxF9tVK5WDT32bNh5cKha46r5B+Eip0A7sIu0KNe4q1Q1PY5sOGSJVAAAAAA=) format('woff2');}
@font-face{font-family:TMQDCB-CMSY7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIkAAoAAAAAA8wAAAHbAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAp8gQkLBgABNgIkAwgEIAWCYgcgGyADAC4LzMNF+GEszQw3nrzIMc/yi4XdCOr3Q/fehwCDRJ0IC2zjUSVF14lQBQXoUNVVKCRFwtXRxdzmaSV8KBPHkopVrdDg+iJ4yUQKjh2acSH9VQGOdOmZmt8XX4+68gpae/qbz+/SMNCFUeIBJrZpbVvnXaAJhhDI2LgG0f/mLfcYxaTadhMR6VcFWTqNs4J0Lf3+tTo1IyrBbFRBK0EWIaTdo2ULoYYrM9nQnxmInpY9RwDw/z9IyNAKF2hFGITI5YLhSq4Mp39bAEggR2AcYgECckCM79H/d2s1lzsXb7dXv1+fLtEHlxHJm7x9u1pnDT3z61q3Oo7ny8uj9549uZTKy4lUDjum3frO7co65W80eHAcVJZ+1OeujNwHAsFTS6c2WH5XZjn43tp181b/HyU9hSEqJRBsC7XFyCjpAsZNGD9BkYxDQejCaucBGqD4JlerQYBCjR4oKNUah4Jq3US4yKuEfn4bzXXqooV2W7TU6ZpWm/M6cOJ3mkvjgYjdZmUuEMto99hCcCj3OLnMLzuzZWsAo1Q2IwNjC3MNUyBgpI45Q3EBEXY2VgybgJgMTZLzbzMdI0NAwOIzgEseZsmVlUB9TtUGqFvqmFlqGQASljjiODACAAA=) format('woff2');}
@font-face{font-family:HUHFBB-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAGoAAoAAAAAA2QAAAFeAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAocNwsGAAE2AiQDCAQgBYJcByAbyAIALgpscE0xojg5IfJoIzo2vzvHczzE3/c7M29a1h1kWT0PZLcwjyAK7AtGCaUbpd2Dec0lXyiDO4CPkEN1SV8JkImZGl8UsmY7fhhoAe0qCzXxnQcWWBJQYnHkgaSBR4lFlKc3bHmXSJRLyWdClztRH/maH/88NcYXLWJA9aMT3+PzYYhQegd0GjoBAUBrINFhFi4wi7AJUUqg1xp77RraD+UGioeAAkQ9jcbYz6kDQCB43/pm4vJvEC/wqTfZkfIWYlCCoNOQV2pN/EIBAJkVV1CkEiCYNOwFmJCYy4gJ9NEy+mkvDsuMObioIWGdBy7zRuijB/rpl4cd+o+HPL88ckrH0jRaDzN16Wx5hkN1SPw1vcN4exjOQWQERkB0S3Mrezt9GyC01NO3seAoOSwaDU0XyqgqfRtbY0sLgMfg6mGXC30b7S7orXScgZ6Dsa2DoTkgYgje4BAEAAAAAA==) format('woff2');}
@font-face{font-family:AYEXPD-CMSY10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAHUAAoAAAAAA4gAAAGMAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAo0RwsGAAE2AiQDCAQgBYJoByAb5AIArgZsYxL6EB51Lka8shh6fxdRCNGzEQ8/5u79bYhbhagt0LVbKCSSeWorbYkIlWaDp/ZrQQOSX5Du0rvYcx7IdCATno+pnaBxeS05IJvzKzW4KN7/9xZ/Hw70wtHEBzjx2d3FgfUCTTCE8Dgp0CzBgBLPbna8JRKSx2rttw0q5SJRKVflPz6a8iWc9YDSBN4lCHvHfSBoc30t2Z9VgtxYGQHgfwYFFQyQBQMUMwRVVWGub57xjEYBUEAVQQe6AFVAOva7Lt/O3wf1Xs9enj7Xfnj88Z0gQBDu7xvT9M3vFrkKPvTAJ0o9QwQtCghLyRPu7qUuiKqoeEVE0SEgTN3mhKDbxKSqUzepaTdBmnRaHm8zxiBLtVVM2YNUjUlJzZA3aTLm27TZ8Dsu5jPMw+Zr/Tyu4HJ3eVFyDe1TRHKdx8U/1+2jpg8ywBFDTFgqZEqdlqcG7BRcnlrO9LL2dLQCLe1cvFDEnafWiBRyAIWQHtjavM9a08C9YpsArl6k0QtkAA5hnsmgBQAA) format('woff2');}

</style>
<g id="page1">
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="61.56093" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">R</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="69.200935" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">[</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="71.967213" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">x</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="77.659727" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">]</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="169.919643" y="-80.475992" transform="matrix(.999739 0 0 .999739 -19.648005 92.53)">R</text>
<text font-family="DBZQHP-CMMI7" font-size="6.97" x="177.508234" y="-84.067167" transform="matrix(.999455 0 0 .999455 -19.648005 92.53)">C</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="61.56093" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">R</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="69.200935" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">[</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="71.967213" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">x</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="77.659727" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">]/</text>
<text font-family="MEQCZM-CMEX10" font-size="9.96" x="87.06628" y="-52.362331" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">(<tspan y="-51.764487">∏</tspan></text>
<text font-family="DBZQHP-CMMI7" font-size="6.97" x="101.00993" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">c</text>
<text font-family="TMQDCB-CMSY7" font-size="6.97" x="104.56799" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">∈</text>
<text font-family="DBZQHP-CMMI7" font-size="6.97" x="109.934065" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">C</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="116.664555" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">(</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="120.537544" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">x</text>
<text font-family="AYEXPD-CMSY10" font-size="9.96" x="128.443471" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">−</text>
<text font-family="OWMFFL-CMMI10" font-size="9.96" x="138.40387" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">c</text>
<text font-family="NKRXYK-CMR10" font-size="9.96" x="142.713745" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">)</text>
<text font-family="MEQCZM-CMEX10" font-size="9.96" x="146.586734" y="-52.362331" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">)</text>
<path d="M63.02864 9.54155H145.42525" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M143.55237 7.15064C143.93094 8.58522 144.77455 9.26262 145.6245 9.54155C144.77455 9.82048 143.93094 10.49788 143.55237 11.93246" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="DBZQHP-CMMI7" font-size="6.97" x="12.469202" y="-44.281858" transform="matrix(.999455 0 0 .999455 89.33 50.144998)">φ</text>
<path d="M49.1002 18.37206V35.50807" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M51.491108 33.63517C50.056528 34.01374 49.379128 34.85735 49.100198 35.7073C48.821268 34.85735 48.143868 34.01374 46.709288 33.63517" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M78.52072 35.90656L145.44579 13.55992" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray="2.78941 1.59395"></path>
<path d="M142.912154 11.885318C143.725556 13.12611 144.740244 13.501446 145.63475 13.496829C144.916918 14.03057 144.331295 14.940249 144.426557 16.420827" stroke="#000" fill="none" stroke-width=".398466" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="HUHFBB-CMR7" font-size="6.97" x="13.746505" y="-44.281858" transform="matrix(.999455 0 0 .999455 92.11 65.274)">¯</text>
<text font-family="DBZQHP-CMMI7" font-size="6.97" x="12.469202" y="-44.281858" transform="matrix(.999455 0 0 .999455 92.11 65.274)">φ</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dft-exist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;1: 命题&nbsp;1 构造示意图
</figcaption>
</figure>
</div>
</section>
<section id="构造" class="level3">
<h3 class="anchored" data-anchor-id="构造">构造</h3>
<p>考察 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 到 <img src="https://latex.codecogs.com/png.latex?R%5EC"> 上的代数同态 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi:%20f%20%5Cmapsto%20(C%20%5Cni%20x%20%5Cmapsto%20f(x))">，其含义为在每一 <img src="https://latex.codecogs.com/png.latex?c%20%5Cin%20C"> 处对多项式 <img src="https://latex.codecogs.com/png.latex?f"> 进行求值．</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 的核：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BKer%7D%5Cvarphi%20=%20%5C%7Bf%20%5Cin%20R%5Bx%5D:%20f(C)=%5C%7B0%5C%7D%5C%7D%20=%20%5Cleft(%20%5Cprod_%7Bc%20%5Cin%20C%7D%20(x-c)%20%5Cright)%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 的像：对每个 <img src="https://latex.codecogs.com/png.latex?c%20%5Cin%20C"> 对应的理想 <img src="https://latex.codecogs.com/png.latex?(x-c)"> 应用中国剩余定理就有 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7D%5Cvarphi%20=%20R%5EC">．</p></li>
</ul>
<p>故由第一同构定理，<img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 诱导的 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%20%5Cvarphi:%20R%5Bx%5D%20/%20%5Cleft(%20%5Cprod_%7Bc%20%5Cin%20C%7D%20(x-c)%20%5Cright)%20%5Cto%20R%5EC%0A"> 是一同构映射．</p>
</section>
<section id="dft代数同构的特例" class="level3">
<h3 class="anchored" data-anchor-id="dft代数同构的特例">DFT：代数同构的特例</h3>
<p>作为上一定理的特例，DFT 在单位根处求值插值．若 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 为内嵌于 <img src="https://latex.codecogs.com/png.latex?R"> 的某一 <img src="https://latex.codecogs.com/png.latex?n"> 阶循环（乘法）群的生成元，则称其为 <em><img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根</em>．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-dft-exist" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 1</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?R"> 上存在 <img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n">，则多项式 <img src="https://latex.codecogs.com/png.latex?%0Ax%5En%20-%201%20=%20%5Cprod_%7Bk=0%7D%5E%7Bn-1%7D%20(x%20-%20%5Comega_n%5Ek)%0A"> 故 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D%20/%20%5Cleft(%20x%5En%20-%201%20%5Cright)"> 与 <img src="https://latex.codecogs.com/png.latex?R%5En"> 代数同构．我们便称二者间的代数同构为 <em><img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT</em>．</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="唯一性的讨论" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="唯一性的讨论"><span class="header-section-number">2.3</span> 唯一性的讨论</h2>
<section id="全体代数同构的结构" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="全体代数同构的结构">全体代数同构的结构</h3>
<div id="fig-big-picture-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-big-picture-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="228.15pt" height="52.59pt" viewbox="0 0 152.1 35.06">
<style type="text/css">
@font-face{font-family:XPATVX-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAARcAAoAAAAABuAAAAQTAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqGcIUuCwoAATYCJAMQBCAFgmgHIBtjBQiehbEzLTkaRgoL+n8q1obg4dWZX5LjEPnycoglIJqOaCvSsLQesstmA50VQKU1gVUBxH/RyG5wGuYBehTJ4ssTfQYtVs7/Nfm/A2+KBDmkE6vWa6C7ha+FJnhgS1zjbGAptiammbu05LMlWuhaUr57SX72QMlbYisWkPtl9n+DLTkUP0VADWEHWAdEwE8xckZqGBCiO+kKE1AIdKVpAiABBRiRNNCoGtuwIW10J4Z0i96oNa+Ymy0NwQqhUK1IAoi+wHmDRCD81jEeUe6o0tIKo4+ipH3a65Yt6/Z69BcnZtHF28DeS6hTuTUaaZR6SpYyfcykrvaA7IprdjSvtRM58Ly3o2941/zh0lBdIXU3NbuRsn9BftmO2n1895ji4l5FPYv69JE6gCw7T+67S6iro1IbGh6jGzcfs2NbH/tsuCUz3A6ulG4YDvaEbTFtcouP8Y2NqIj6LOUm+TGThcfc7FbWpNtjfOuE7l3DOvoYGcKms3tR2Sw3t87uvuQ1ujhkh+v6xNZHscKg+F6w9NJ+aZ9pJwRLqzbR1+BCTlSd/JhJSU5c66RcaX/WkHQ9RWbxNv6xVBy+Lz1w13NnaIu/DK1WpU23weJqrbd1Bo9jm5YWRpBlF+QGqLJ7FcljmclGqBktAUxJ/RgF2ap5tdalza7ebbNigYluFk0/QiMS7aOLu5qhrnczFHH3y3+zs5qlmfn8TX1tx7sXuGPOW4r5zbGJ6FYrYg+mLpNL5dRmwt6SvK3baWNdAttxJ+bhb/JokNETaa46ttJqrUm/Bg0+vU7AxmpOTUkYHDZx8/fXcPoM3qaEWyMdO+x1bmrMZ5xWNlp23euqP+OkOpdiLDvpe0gu3a5pv1rBTHhoM0Jck8LnGU3fNU/fqagIU0oLrmscpmr976sdLVHIirXgkaU3j57GnvWuOwb4WvHPby41YOR5etdEma+NWLSiJOhVM6l0ryae1ZjjqB9lh3IPbSZiXJ0448+bfChyYookXUUQfTvVtSVrTer/J/oUNtkRzOnUKCvQ3VUvxp511N9QyLg+zkxD/qnNOE1ze888/ZfmaeAv7TY2nUXeVSO5W1q55VMCyqfG3PDDNfwNpQHwwRju0R3mFzVSPgQvlCDAT9IVxKGpkSC6KBzbyQIJ2Q5uoTFp0oiidLAYBAJetcVquPGyFpzEsDpu0lc7iKImCqHZEcTRObAaUUxkLYRYzepEcbByUJPbB5v6kW25u4MhdHVXaWFra6lR9RIar6aqPh54b08amRqRlBoWI15DVbM6GLQgjhjiSSGZEBIRpxNxBNNxsbjjgCEQV9xRoQW22GKJBlXpDT5qEhHEEYs41ahMVRto48RanYCFIDgaToYSjySVCJLmhRGDODWoTPUkUwEA) format('woff2');}
@font-face{font-family:DGVTPE-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJ4AAoAAAAABLQAAAIsAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqCNIIACw4AATYCJAMWBCAFgmIHIBu9AwCO0SdjDiKOuCaC44mKePj/+3773HvfaxgGnLgZA2m1fKAPFs3Uigoki2igMI4T7xysufuZaqXNUbFoIqUQadOGVEsk+L+b/EXugKb6CZ6t0iiwPEwws7aNjWEJ9gJNs17mrpOllLRcbnyXhwlqzMeSjvJWXv45Fqcfn4OzFyMA9eDgUQbX/Q2As6OsQqIKXWsmKKiYt33zMI6BUcOKYpddibJM7PDb+ZvhvM4rQT2iB+PocAbcANAAgasvC2jDhKrJmWh+NKqOxgpisdl5TjicF07kCddrIuHccHgm+LFY/lQ037TB35yN5EUiLYNbmgvRhnhkV38uXK8iEckw2pMrCCSEjCch2b+ji9VVjnJDgfiaAqdrR9pcR3VdLY/8cVkZ+PMcgx6kvOZVDfqk2MKl/FxUhf7j6T37JyWVqUZGuOc0wmec+/HMVCqZyDmp1vLFy27NQw2cJM4wAkAguPoSzVbQk36HKwbgj3N9AvYNqagwrICgShSW8ONbcPGuAPFq0F9xUjiOdRjCh6C3DAGhhKMeFTClOGnGTZHOmDXSG7fVPmqVC1o0IoRNqSDNsmbSWTRNesu2olH7nrIB9dlXrTeQn5vps3rSsp2OJDvltDm2Ei+nWbX9TT39DW0Kt83lZ4NHhzad+vSq000hTYda/vfaeQXky5XJx8ojTTYnh3x1uvVo0qGdgpONIwICuj1KV90EtUG1oZVYq1+TnrIGbRTcbFxNEg0AAAA=) format('woff2');}
@font-face{font-family:PYFQET-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAMEAAoAAAAABRgAAAK5AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqDPIJ4CwgAATYCJAMMBCAFgmIHIBsbBECO0UvPmPNOmfCSJnQE1LLVM7O3pJh1lngk6OyTw0VHIWx0GB/+y7/xv0N52aR0UIFZIqjFE/nk05i6yS3Kpo+pnuBHW4vXAO8SCiPb2MbEEo4Yep6qxiPTzCoehzlckOJLGFUiPse7/43ASHPDO1XwDeowOcwNBzi6qM4BKo7TtQQKVCgARtwqChCR0ExRILWScUDuB3GNoCiATvH0L0xwCcvZO3yxkBF46763Dk1bWi5Abc8OmxfMZicRZHr6uevC+edPrfc/Zx9/Si56GR3AFhfBy8jAY98FTXhqzm3W6Qyj/55FG2q6Qj+3XTgUcOXJhUWMIGYnNze3maQRi7PQP21JP3sGtf3FZ2bgKT1s9MTKaBVee0r60hv0fs/H9NWn5BNih1NJKP/nNMp/R9sj1jPizJPGKJd95/dSevBbqweWe/H80TWpjmGUdvthDIQ7Z6ZSIZ8/SXcFjnko7HLqwqi+9UGrfWb6+mNSlZJtyu6PnZrVtCbPv4Gj4Rg9fZ/1Nl7o3geFZpWGYnxYeCASgM1ytLvhaL3eoJLCw9xUOpKex7J1at3x4thnabni7Qbrv/M7QyyNQ2hiKPuTI4t8kChTOrAnAsxYICZqN1OZ9QpGTNCSZBFvBdGQ0DlPIgasAw/zdAAgILD82vczpS7se3nKwD+jneukKAbjjXCtVC6K089CEszzttekF6SI+A1sguyqJPviG3pZ6RKEUB2YiZlqdWJJlS4xV210vVInH4pCViHoJUhipl2+WNKqXcy1m60qLTtw0wAfiS1K4lhSJuGOC4XcwAt8y9vDy1B7le3LrM6rqM4psvL18NHbAFeiSKkqlbKUsyJUIhOfFJOIwyLFRHCHExLiCkR5fK1CnhLFrHjz4OUPsY3iGCNtHyjTS1c3qjNVy1MxlaOIFV8efLJGRQAAAA==) format('woff2');}
@font-face{font-family:DUSPSN-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAI8AAoAAAAABBAAAAHwAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqBPIEsCwgAATYCJAMMBCAFglwHIBtJA0AeA+7MiMc1pHW8+fOEty2Kh/+/77fPnf5vHq3Z5pkksDyChAIOLMBW2srS3v+v996X5EOFjJXWRAxTt57mP+WA5Y4PHrSA2moeWoLZS5pI4ImlkbW1QIq00AKLgPqmcbgkEomTdmxCTjLRAJX0ht3+86iXED+s2QsaEA2Z2c/zS148kF2ZDzpkAQFA14GEjGm4wDTCJtAUIbkyD1B1H7y7WDJof3YIPABQAElsDBHx0HpVGz+qfHJvn3969Du5F1jt5emYGNkSqnzyfzDl3b0/4Lm5D6yYkanaGpqXr95MZiIWb5UeSxYIZFO+0CtSu4zDXZUsvFGGneyDzB154G+RV0wv0j0MFWOv991EwN3/inOKHDv/1wK/OPbzLsAOvwYd8h0AAsHO2Ud9OLvJHzUC4JtncgheI0mf6EsgyDqkJ3BgG78CAJATkDY4JHvwh5DtwkDQkwa9QiCMIUAxZEyAasgiBJohaxAYtEgDLgoNwiqnSBWzElCpDI1a0qB9U9vZf741svH19vB2U7V29dK/eUtNNY189o7ZislLzM6LT5XQVtOyZbCWLlWGXDliZZHgKl0M3k0aG768efDmRpU1V170+YmVJVuidGkkaFKjUQ17TuvHkTMQE6MUejNGnkTZvXipJGhTo0WOOAAAAAA=) format('woff2');}

</style>
<g id="page1">
<text font-family="XPATVX-CMMI10" font-size="9.96" x="25.107446" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">R</text>
<text font-family="DGVTPE-CMR10" font-size="9.96" x="32.747451" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">[</text>
<text font-family="XPATVX-CMMI10" font-size="9.96" x="35.513729" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">x</text>
<text font-family="DGVTPE-CMR10" font-size="9.96" x="41.206243" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">]/(</text>
<text font-family="XPATVX-CMMI10" font-size="9.96" x="52.82621" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">m</text>
<text font-family="DGVTPE-CMR10" font-size="9.96" x="61.571927" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">(</text>
<text font-family="XPATVX-CMMI10" font-size="9.96" x="65.444916" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">x</text>
<text font-family="DGVTPE-CMR10" font-size="9.96" x="71.13743" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">))</text>
<text font-family="XPATVX-CMMI10" font-size="9.96" x="114.920001" y="-45.564106" transform="matrix(.999739 0 0 .999739 -.458003 74.496)">R</text>
<text font-family="PYFQET-CMMI7" font-size="6.97" x="122.525199" y="-49.164196" transform="matrix(.999455 0 0 .999455 -.458003 74.496)">n</text>
<path d="M62.57686 26.429005H109.60103" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M107.72813 24.038095C108.1067 25.472675 108.95031 26.150075 109.80026 26.429005C108.95031 26.707935 108.1067 27.385335 107.72813 28.819915" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="DUSPSN-CMR7" font-size="6.97" x="-4.794386" y="-45.551166" transform="matrix(.999455 0 0 .999455 89.743 68.303)">¯</text>
<text font-family="PYFQET-CMMI7" font-size="6.97" x="-6.07169" y="-45.551166" transform="matrix(.999455 0 0 .999455 89.743 68.303)">φ</text>
<path d="M132.05055 27.393145C151.90007 29.130325 133.25415 .203965 125.00044 17.901585" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray="2.78941 1.59395"></path>
<path d="M127.958856 17.214755C126.498736 16.951516 125.528277 17.429752 124.91626 18.082146C125.022705 17.193972 124.76535 16.143131 123.625236 15.193719" stroke="#000" fill="none" stroke-width=".398472" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="DUSPSN-CMR7" font-size="6.97" x="-6.07169" y="-45.551166" transform="matrix(.999455 0 0 .999455 147.46399 59.937005)">?</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-big-picture-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;2
</figcaption>
</figure>
</div>
<p>已经建立 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D/(m(x))%20%5Cto%20R%5En"> 的同构关系，这里 <img src="https://latex.codecogs.com/png.latex?m(x)"> 是若干不同一次因式的乘积．但这种同构或不止一种．为研究其是否在某种意义下具有唯一性，需研究全体同构 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIso%7D(R%5Bx%5D/(m(x)),R%5En)"> 的结构．该问题化归为研究 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上全体自同构 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BAut%7D(R%5En)"> 的结构．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-dft-unique" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 2</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 是一与 <img src="https://latex.codecogs.com/png.latex?R%5En"> 同构的任一代数．固定代数同构 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi:%20%5Cmathcal%20A%20%5Cto%20R%5En">，则任一 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20%5Cto%20R%5En"> 的代数同构 <img src="https://latex.codecogs.com/png.latex?f"> 都具有形式 <img src="https://latex.codecogs.com/png.latex?f%20=%20p%20%5Cvarphi">，这里 <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20%5Coperatorname%7BAut%7D(R%5En)">．</p>
</div>
</div>
</div>
</div>
</section>
<section id="rn-上的自同构" class="level3">
<h3 class="anchored" data-anchor-id="rn-上的自同构"><img src="https://latex.codecogs.com/png.latex?R%5En"> 上的自同构</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20e_1,%5Cdots,%5Cboldsymbol%20e_n"> 是 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的自然基，设 <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%5Cin%20S_n"> 是有限集 <img src="https://latex.codecogs.com/png.latex?%5C%7B0,1,%5Cdots,n-1%20%5C%7D"> 上的一个置换．定义 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上由置换 <img src="https://latex.codecogs.com/png.latex?%5Csigma"> 诱导的模自同构 <img src="https://latex.codecogs.com/png.latex?%0AP_%5Csigma:%20%5Cboldsymbol%20e_k%20%5Cmapsto%20%5Cboldsymbol%20e_%7B%5Csigma(k)%7D%0A"> 容易验证 <img src="https://latex.codecogs.com/png.latex?P_%5Csigma"> 保持逐项乘法，因此它也是 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的代数自同构．</p>
<p>下面的引理刻画了 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上代数自同构的形式．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="lem-perm" class="theorem lemma">
<p><span class="theorem-title"><strong>引理 1</strong></span> 全体 <img src="https://latex.codecogs.com/png.latex?P_%5Csigma"> 构成 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上全体代数自同构，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7BAut%7D(R%5En)%20=%20%5C%7B%20P_%5Csigma%20:%20%5Csigma%20%5Cin%20S_n%20%5C%7D%0A"></p>
</div>
</div>
</div>
</div>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<p>只需证对任意 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上任意代数自同构 <img src="https://latex.codecogs.com/png.latex?P">，其都可被某一置换 <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%5Cin%20S_n"> 诱导得到．不妨考察 <img src="https://latex.codecogs.com/png.latex?P"> 在 <img src="https://latex.codecogs.com/png.latex?R%5En"> 自然基下的矩阵表示 <img src="https://latex.codecogs.com/png.latex?(p_%7Bi,j%7D)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D">．则 <img src="https://latex.codecogs.com/png.latex?%0AP(%5Cboldsymbol%20e_i)%20%5Ctimes%20P(%5Cboldsymbol%20e_i)%20=%20P(%5Cboldsymbol%20e_i%20%5Ctimes%20%5Cboldsymbol%20e_i)%20=%20P(%5Cboldsymbol%20e_i)%0A"> 可分行写为对 <img src="https://latex.codecogs.com/png.latex?k%20=%200,1,%5Cdots,n-1">，都有 <img src="https://latex.codecogs.com/png.latex?p_%7Bk,i%7D%5E2%20=%20p_%7Bk,i%7D">，因为 <img src="https://latex.codecogs.com/png.latex?R"> 是整环，故 <img src="https://latex.codecogs.com/png.latex?p_%7Bk,i%7D"> 为 <img src="https://latex.codecogs.com/png.latex?0"> 或 <img src="https://latex.codecogs.com/png.latex?1">，即矩阵各元素只能取 <img src="https://latex.codecogs.com/png.latex?0"> 或 <img src="https://latex.codecogs.com/png.latex?1">．又对 <img src="https://latex.codecogs.com/png.latex?i%20%5Cneq%20j"> 将 <img src="https://latex.codecogs.com/png.latex?%0AP(%5Cboldsymbol%20e_i)%20%5Ctimes%20P(%5Cboldsymbol%20e_j)%20=%20P(%5Cboldsymbol%20e_i%20%5Ctimes%20%5Cboldsymbol%20e_j)%20=%20P(%5Cboldsymbol%200)%20=%20%5Cboldsymbol%200%0A"> 分行写开，得对 <img src="https://latex.codecogs.com/png.latex?k%20=%200,1,%5Cdots,n-1">，都有 <img src="https://latex.codecogs.com/png.latex?p_%7Bk,i%7D%20p_%7Bk,j%7D%20=%200">．于是（由 <img src="https://latex.codecogs.com/png.latex?R"> 是整环）矩阵任一行至多只能由一个 <img src="https://latex.codecogs.com/png.latex?1">．假如存在第 <img src="https://latex.codecogs.com/png.latex?k"> 行全为 <img src="https://latex.codecogs.com/png.latex?0">，则 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20e_k%20%5Cnotin%20%5Coperatorname%7BIm%7DP">，与 <img src="https://latex.codecogs.com/png.latex?P"> 作为自同构的满性矛盾，故 <img src="https://latex.codecogs.com/png.latex?P"> 的矩阵表示每行有且只有一个 <img src="https://latex.codecogs.com/png.latex?1">，其余为 <img src="https://latex.codecogs.com/png.latex?0">．<img src="https://latex.codecogs.com/png.latex?P"> 的某两行亦不能完全相同，否则（由鸽巢原理）矩阵某列一定全为 <img src="https://latex.codecogs.com/png.latex?0">，与 <img src="https://latex.codecogs.com/png.latex?P"> 作为自同构的单性矛盾．因此 <img src="https://latex.codecogs.com/png.latex?P"> 的矩阵表示是一个置换矩阵，即 <img src="https://latex.codecogs.com/png.latex?P"> 由一置换诱导．</p>
</section>
<section id="dft-的唯一性" class="level3">
<h3 class="anchored" data-anchor-id="dft-的唯一性">DFT 的唯一性</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-dft-unique" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 2</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?f"> 是任一 <img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT，则任何 <img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT <img src="https://latex.codecogs.com/png.latex?g"> 都具有形式 <img src="https://latex.codecogs.com/png.latex?g%20=%20P_%5Csigma%20f">，这里 <img src="https://latex.codecogs.com/png.latex?f"> 是一事先固定的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT．</p>
</div>
</div>
</div>
</div>
<p>作为推论，<img src="https://latex.codecogs.com/png.latex?n"> 点 DFT 共有 <img src="https://latex.codecogs.com/png.latex?n!"> 种．这一结果的显著性在于，只要不计求值得到的 <img src="https://latex.codecogs.com/png.latex?n"> 个点值在 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的排列顺序，DFT 是唯一满足卷积性质的可逆线性映射．</p>
</section>
</section>
</section>
<section id="dft-与矩阵代数" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> DFT 与矩阵代数</h1>
<section id="第二个视角矩阵代数" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="第二个视角矩阵代数">第二个视角：矩阵代数</h3>
<p>我们建立了</p>
<div id="fig-big-picture-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-big-picture-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="230.025pt" height="52.59pt" viewbox="0 0 153.35 35.06">
<style type="text/css">
@font-face{font-family:UMDCPD-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAARYAAoAAAAABuAAAAQOAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqGcIUuCwoAATYCJAMQBCAFgmgHIBtjBQgehXGbk/TJHSeFIsyTKgQPZff1unu+PLv1V8IBcmZEdkpXfjdDetXkoIWz1FEl4QoA/1008tMTyhKOCy3A0tpaEsUJXODzf03+78CbIkEO6cSq9RrobuFroQke2BLXOBtYiq2JaeYuLflsiRa6lpTvXpKfPVDynGhMIHfK/19nXQ7FDxFQIGwAmwER8FMMnpQRCWToSJbCABQCXWkYAEhAAXokdTRyYytWpI2OxJNl0Ru1xgljjFwaghVCoVoRDxDdgfMGiUD4bOO9Y70Qr19nTLyIVy2TbzU2NrZ6Dz3F5VI4nWD7McQ9Lmghk5pIuaqUSbNG/WHRukcend3RA+21rvbuwS1LJ/M3wx5u8FY4r4V0dCQiME+BBvnuUS9fdnnR+UW3bvxdkB8mDj7GNjbCcHPzS0TLzsvDqI6XbquWhGNd4MTrVU/Z3dmtk9EpXnmJaWlBQFOuaqvipNnyNiuvgz7j+RLTMa3/WNlImSS6ubWOHobn0T09e7r7EjcpHDdGsHFQIcLpkW6c7WD+saPX3aadEMzPbaVsui1fhzcqTpqVX0d3zIgrhnJHBU0k4cpDzMtrsfeyYPix82Z4i78MnQ6VHc+Rp7yOh5KRs6jW1eVxyI+Ih2HRYSZxMifNBDGpEbglJn0Md2Oo+rymFca3bzesVS42008nG0ZrhSG9FI6HBeJ0B2M5V4+ntzefahPQiiTZ23zKpRiFV41iZj06DtlkEfN4/AIJk1on63n1ZP2zNqsNcQzn/cjnPwlDQXZnqF61bqLTVJseFRWfbsWio7RnZ7lGJzWeQUFaDq/Ru3HBplDrVodta00l9ItskzXka2846TyfRTIVjfkeKudv1HbcULGQ7V+Hi25V+jyp9r3m7j4eEWJOamA5R2CuVv46+SCCW0JPsGKTbq6PmMCY8t5s7+VtIjmznt9rfD+ld7oywE4hQpkHuhTGVxwWYukt+c6G4Q4IV/86Of320J8SySdj91CnZwmCWpz8m/HOdemb/P9/47xKO4xo2kQ43Ab0tTeIdKTvDzKW0e8OenOMJcfXMWsLPOZ3/yW7K4IELn3HVe5tHsHL2sYtnxIQXZi1EYip/G1VGgDv9bEB3WF8VoPlVfBCCQL8JF1ENJoaDKSLwrGNdJCQLWAVGmMmjShKO3OBIOBRW6yGCw9rwkEka8ZFymo74RSiEJoNQTRtA6sRzmjWRChLWTPh7K7sFHL+YFM/si13tzczdTJTa7C3t9bKvYTG89Q1xwPv7UmDM6JTMyLjOQXq2tXBoIFE4kkinTTCSYFDGxIJo+MScMceM0xxwgw1GrDHHmu0yKUr+KipRJNIAhzyyCbXBpo5CVYneCEIiwaSrcSDySCa1HmRxMOhgGzyk0wFAAA=) format('woff2');}
@font-face{font-family:OVKORY-CMMI5;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIoAAoAAAAAA+QAAAHeAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBFIEYCwYAATYCJAMIBCAFgmIHIBsvAwAeh+lGI3/UJEkPvxHU32c9L9dxaTwmEU6t0JKt6IrcYv/nx+X7928QIsyTEoQ0tCXQGU5Mp1K2eA0jkt3tN6FME0wws0z7v5v83+lxAd3Qpnni2Sa5tLSXUGYbx6QDaYEHku2MoldSTp2xz2aPrZDLXswKI730E0qFmYjRr3NQW1FAKaK+AWg9r00O4f3+PmQAcgICgOwfAAk59GGBPqI1kJcX5P7/v58Y6AAEIIE8Em7AA4A8IK0kc/QVN3Nxr7zXy/ZxLm6ZuJWPrNXUQwn6WI4P7X9Gu7se5rtZHs+rejzUjhVjg3+xrDY5YoHhEKgERjd5wELrMeOyl6jwoo+yA6oAN/S4qgZJ+L9VSnxXP/+n4l5SBQAEgveljWl+Qps/EhMBvlLPDsAOZX5CEN0BZQkEu2TfoDKQICBMmIk0QnJjFyRR9YIEWihEXl0Lk4KaGSmqOw5XTdXAYqIgLI1hkjemIgVDU6RobDWpurs9f93vtXop7FEKnVfeSyIN119rS9UVVa3cW2WVxKY02+TawtqKmrwZeulpGVhZSJkUItGTiIwOBdsoCjqecr1ISIbVY8/8zUxJT6dQtQpVDBj0dCxPuBJIZEScCknYKJnZyGkVqlWhpjIMjgAA) format('woff2');}
@font-face{font-family:JZIYBO-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJ8AAoAAAAABLQAAAIyAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqCNIIACw4AATYCJAMWBCAFgmIHIBu9AwCeA27LDOeSHXoIz2SrvQzfkRUMIVq2zF75XkE2TZcIU4XpwqG6UCAMzoBDYgRK3A/7y/cnsi6diNFJQCprxzZUJRhlcMswIAnAM3peUxf/303+IndAU/0Ez1ZpFFgeJphZ28bGsAR7gaZZL3PXyVJKWi43vsvDBFl8IjNQkL4Cbv+TTE8feRoc7EUDVIKDR3l4bNdDiB3SDCpkQtdaBRIyjG3fWJBjoKkuSXbVEpNWYYff7nN12omgHlGCNgqcAU8A5IDA1edpMfX67eCYh+fxFHrwvd7xcZJrrsvPTV9Uu10cl2ssUr14Qx5exVLq8rib63abO1eKjjKWMnvWSw/TF5UR4S3NsnUdFhGtWjOu3iJSVMo6WRk/8zQKTlc7xZw6lVaTEvktVeB/4KYTjcjUd4VQWlFsSY76kyiJv8joLuuVTIkvRBqTcxrhx5f8WHx+fjxyQarl1YSPVV+pYS+cUQ4AgeDh9btPHtv0Vg/MwX/S6T7YN1SSDOoSCDIVEjOp8QvBxYuE+ISH/oqTxHGsoUsqBKU5BIQSNr0roKc4ybX1SKFlRUptW+1NSw0CRd4QNlFAcnMmUpgaJqW5lahp3002oD77qiWJiEIUvRpNZdXXJdmp+pq6rcTLaZam3djSrrfmNdY0+NmAZmfl0KaVVrM8VHYa/vdsSESIhFDoqqFRsdSrw6PVrIWRnU2eejXqIgCvbVFaeRNoApWulajRzqilTM8qT6MaDU0yEAAA) format('woff2');}
@font-face{font-family:ZNKYWP-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAOgAAoAAAAABeQAAANVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqEeIQDCwoAATYCJAMQBCAFgmIHIBuyBFFULGoUHwm5idZLiNLKEkMwlE0MZfnoFEG1bD27d0eIQaWss3yPRTh8clgsxlAIg8fobATFDq+X/3JXKimloJC8wRk/gK0TN+PGPC8eUz3BbGtgbbC2UITZxl/bKPsFSg9OvzvlUGppowVriXOn4rWHnF6iSU16Tpf/w6AxOfEVZDSDEaqBfgCOdX2TEQnotPJFBgVZIEKIUuZIyBgeZIbR2HqmXbuEloR8UQpvK6+l7c8YQJCsLG9HjXcg6v4PIwlpjc1NnS1yFuVra5fWnixqQ3AU7UCQ4k74fFYwULCzA5FhWiuehFkfH7EHtI3nAfXxYiY9D0mBkScmpok2ghAV7YWKe2TGjoS62hCko4NU7D0kH8UXSdvNR6xPjWeJr68P9EnX3mv2MsPt3UpdcntWNVcixbyCgwQp2buic/Zw1MeHol1tY2MTAsFoXxfr7hAlnp6gYtKysxNupz14HsR4huDhR0yTGCUWVe+J863wKTkP1yYJ3uyvVnxn84TuPfgZGf7QoYsAwX8k37uFUsMhC2hIGuH8f9O04lchqE2X/lODmypB9zIyGkrzAeYUd3fTynEvgzxqoo41PJYEJaMCgYy07qp2WS+f5ZkpLBzO4xzwF7Eb0XnLmKZhdzZuM9aSUAvIUj4sCDf4tYwpU+yEDWGFnaMmTvFlsQUhTs5md7rECVrle7kCBhaFwzewOWzBwakxUuxgOH8TJ5TGLe1q2eC8ZArASTtvRe56DkcdDeVpsz0ECYm2kZQrmnqx8cu9nfp4bPMs/5WbL9gOZebjtf0pa4Pd+HnQLF26AOsU64pmjQVZ51B4rEFh9jD54mQOOctHu7kCmysV4RAAIBC8yQ8oBrIb/WvPFfgYnh5lqbKYccoe9ooJLLo4bJWWjAMIAKSL0i/7dE8tQy5AqLTm1GDc6RYkAfqgiCvd+ipCrcuU0Oi2urrTJA1UUXUIs5ycUBkXI9RGlQiNcV1Jpz1LR5D242zWx8XRm3BTtnR2tte9LRrqKmrN0sO4KywjOjUjMl5MU0WDDgaWEsVLki5NuBRinCUK848k8OHCkTeCG2WWnDmzpwsXfVuqaIkSiFGnQk0D2OoJOj14FRDmhsgulWEyREsdixRPjCYVGkElFQAAAA==) format('woff2');}
@font-face{font-family:GZNIEF-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAGkAAoAAAAAA2QAAAFdAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAocNwsGAAE2AiQDCAQgBYJcByAbyAIAngd2DBljmzCI6JpfxAd68fDf0e++N9Oy7iDbTnlAq2XlEaQd/0QJpRuljeWNvaKV2/sP8YPNpqo2E5QkVIKSHJ1bCx/I8wOt034RwbDCTDXb8cNAC2hXWaiJ7zywwJKAEosjDyQNPEosojy9Ycu7RKJcSj4TSm7E1UW+5cf/pKMxvmjRiKhudOJ7fLkbStA5oGgoAgKA1kCiYBIJTApWOVUV6LTGXrtB90N1A5WHgAqI+jQYQz+HdgCBoPN89feR07/eUsHn5HfZkfIWpVeCoGjIa7EkfnkAQGbFFRqpChBM6vcKjEjM1YARdNE8umkr9suMGYnaJywr4GraQhdtdNPL/Xb98ZDnl0dyZqmihMz08NLZJjCqQ+KvmXd33M0ECoE4s5isLqfKDlSLUmU3k2UsKpEEMSYP1lR2h85iBhLgeuRyVtmRLihXhg+Ybp3DrTEBCsQbgiAA) format('woff2');}

</style>
<g id="page1">
<text font-family="UMDCPD-CMMI10" font-size="9.96" x="25.107446" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">R</text>
<text font-family="JZIYBO-CMR10" font-size="9.96" x="32.747451" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">[</text>
<text font-family="UMDCPD-CMMI10" font-size="9.96" x="35.513729" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">x</text>
<text font-family="JZIYBO-CMR10" font-size="9.96" x="41.206243" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">]/(</text>
<text font-family="UMDCPD-CMMI10" font-size="9.96" x="52.82621" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">m</text>
<text font-family="JZIYBO-CMR10" font-size="9.96" x="61.571927" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">(</text>
<text font-family="UMDCPD-CMMI10" font-size="9.96" x="65.444916" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">x</text>
<text font-family="JZIYBO-CMR10" font-size="9.96" x="71.13743" y="-45.564106" transform="matrix(.999739 0 0 .999739 -20.821003 74.496)">))</text>
<text font-family="UMDCPD-CMMI10" font-size="9.96" x="114.920001" y="-45.564106" transform="matrix(.999739 0 0 .999739 -.458003 74.496)">R</text>
<text font-family="ZNKYWP-CMMI7" font-size="6.97" x="122.525199" y="-49.164196" transform="matrix(.999455 0 0 .999455 -.458003 74.496)">n</text>
<path d="M62.57686 26.429005H109.60103" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M107.72813 24.038095C108.1067 25.472675 108.95031 26.150075 109.80026 26.429005C108.95031 26.707935 108.1067 27.385335 107.72813 28.819915" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="GZNIEF-CMR7" font-size="6.97" x="-4.794386" y="-45.551166" transform="matrix(.999455 0 0 .999455 89.743 68.303)">¯</text>
<text font-family="ZNKYWP-CMMI7" font-size="6.97" x="-6.07169" y="-45.551166" transform="matrix(.999455 0 0 .999455 89.743 68.303)">φ</text>
<path d="M132.05055 27.393145C151.90007 29.130325 133.25415 .203965 125.00044 17.901585" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M127.958856 17.214755C126.498736 16.951516 125.528277 17.429752 124.91626 18.082146C125.022705 17.193972 124.76535 16.143131 123.625236 15.193719" stroke="#000" fill="none" stroke-width=".398472" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="ZNKYWP-CMMI7" font-size="6.97" x="-6.07169" y="-45.551166" transform="matrix(.999455 0 0 .999455 147.46399 58.941007)">P</text>
<text font-family="OVKORY-CMMI5" font-size="4.98" x="-1.001738" y="-44.568366" transform="matrix(.999739 0 0 .999739 147.46399 58.941007)">σ</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-big-picture-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3
</figcaption>
</figure>
</div>
<p>这一交换图可以继续扩展．将视角从多项式环转向矩阵代数，我们将看到，DFT 不仅是多项式环上的求值插值，更体现为矩阵代数上的相似对角化．</p>
<p>简单起见，下面只考察代数闭域的情况，并用域的常用记号 <img src="https://latex.codecogs.com/png.latex?K"> 替代 <img src="https://latex.codecogs.com/png.latex?R">．</p>
</section>
<section id="相似对角化" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="相似对角化">相似对角化</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?C"> 是域 <img src="https://latex.codecogs.com/png.latex?K"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 阶可对角化矩阵，特征值两两不同．设其特征多项式（或最小多项式）为 <img src="https://latex.codecogs.com/png.latex?m(x)">，<img src="https://latex.codecogs.com/png.latex?%5CLambda"> 为其对角化得到的矩阵．<img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 和 <img src="https://latex.codecogs.com/png.latex?K%5B%5CLambda%5D"> 分别是矩阵 <img src="https://latex.codecogs.com/png.latex?C"> 和 <img src="https://latex.codecogs.com/png.latex?%5CLambda"> 在 <img src="https://latex.codecogs.com/png.latex?K%5E%7Bn%20%5Ctimes%20n%7D"> 上生成的代数．</p>
<div id="fig-big-picture-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-big-picture-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="239.31pt" height="105.375pt" viewbox="0 0 159.54 70.25">
<style type="text/css">
@font-face{font-family:RYZTIO-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAI8AAoAAAAABBAAAAHwAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqBPIEsCwgAATYCJAMMBCAFglwHIBtJA0CeA+7OIpTB4rlvi3n2GYZpa4zga+y37+w7akmzNtHUrDRiJmRSY6gMDSJ3NKf3SVoeEJNFJtWym1CzIzTvkyt5CYcws6kt/ykHLHd88KAF1Fbz0BLMXtJEAk8sjaytBVKkhRZYBNQ3jcMlkUictGMTcvejHyrpYT//0vokxDdrTkNDNGRmP0+3Ng/Iru0FHVlAANA7SMhYgQusIBwDTRGSa3sAVf8Q1cWSQfuzC+ARgAJIYifEK4zcOSqHOnhhY3s8buwzW/5kRnp8fflSsYMXx3GRuWHfS3+zE9q3tTsvF/f0ui6KmGi2WrXmi+QTRI0ubRtNP3LxEEP3KFTuq8PRZpFHfwcyqrYZYamoCRM+TBHxrP/joGJdMbnPfTk17PddXgx+7Mf1xgEEgs183aaJOf9SK+BLemMFXiNJH0MJBFlHOuDPJ38CAJCLtPzrB3EQshMYCHrS2BsEwjwCFBPzAlQTWxBoJg4gMLbFHC5mJOwJjFSxJh+VWtFoOI2d2dzO/vOtUWRCYnRAmIlXSKTdzVtamJrns3fMVnZtQVVtXom6lamlLYOXMiXK1aiWo5K6EGWy8W5KRUqQKFqAMCa8hIhkJ1aOSlUKlCmlzoIp82r4cWk/zpiB7JipwZvZahWo6uUpoc6KKUtyxAEAAAA=) format('woff2');}
@font-face{font-family:XDFDYR-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAS8AAoAAAAAB5QAAARyAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqIGIYvCwwAATYCJAMUBCAFgmgHIBvwBQAehU3ZMt4mPJLfkzd5E/r5d9M/ucgoUk0yRipuaM1SUplUVGBMBZuKI8/0z42oPDd/mSBFMhEraQEr1plyFWrQ/gdI9z3/1+SvZ0dJkQBeuSgaRuPe2b0DXZp1WaT4wEYjpqmbFhV9VILSxLGjsO3YEcCqV9gG4AB0oxf/4bB+etg3PQ9xzQEAAS4EAz8FTedIK3DJjQX+D7BgvNj/MokAsGgcCwazJa/i40EQuQLdxhTq3mcuMVqjCgLEsYYPgA2wAwB7weJsEMPgc1dFd/VklV7PJ43kXC+tTW2xZFtoscXDamUu2Ete2SkTQRgMFvq6hbYxonYG66wZNwjG5MoPVm85IkgaHJEh1XRr0JoOXKLIGrrkDBcemR1nEg+OUYtM6v3bTEQlY9qiD3x4WFzVajo2d1ugkTTZJxhwjZ6/ykLTOMP4bcO0R/H9Fm+9niSNRjtlumV/4bHNzqy+EHBkB5yyr34D22l6u/v2oEt2L5NJQBg04ebg44qLNz2126hTjN1r28lES7pefBynafPh+xItxTC77Fj8utibdhfr9/NXSahW2tsMmhMP7MxJbwRNtFl8nb74UqIPPq5Y9dJz26mg1Qc0h/0NRMCld152O7bzqv9BC60n7+wfKG5b2C3mkDVm27ukQ088zJcvHsW0x4IOkoH3w/Hj0XsfZ7Ej1HyNlOvJqalsLwaFJbLflYxkIUPUClnDk3W5WN9Cn+qM8FomVVMnDQvvUkqX9MXKYLS2GtAsWlE+GJeXFzdQpkPlLN3Qgpzij7GzwHs2lmx96/m63kFki25EU6hPOsfpocsWgq8NN41EXvETKnXCh3U6pEXabJ7T1683vC1ak+wkQ2+FD0p1aDG6Pe837+z7qWW562Ibr3uwfzjtIHpY2ody0Rme6CKXzJOoYh+azVC907556O3oEXv6tE/2oyymri5G4Jz9Ua9YhRUW3C/OliP8WaTsivBKafLg01hPQh7Y/SOJNJtiS66FqebUSV08zSHfDmZ/zHas6hMQSkLuKWwHZVZ9d/o55bOc6sn1gtAho/rdhz/m8mudlawJmV/t0btBu0+uWVjIp0J9oXL6rr4f70yZFpclS4oFojopD3+974d1Utbrnh3zTp5289/g4vBZn3B96HW/P3/0cQ655d4uGSAl+bCnNMm9hNpdJ+Xib/Y6z0pZfVKPbJ367O1/Ax3T6vxF+K0K3ucxblV5+SG7AgOf7X+5bZFT+q+8sF25L/EjB9bT4f9nPbIAAA9SykGdv8Dzf80ICUNQPvRBXJohiElUHnhWOLphIwSyfDMM4CTtWTYRJ5ZDwJ3lEgnazCcRjwXrDoDxVGwsm0QXy0FaxnJJbK/yxbv46Cj9GW5ylUKlqC6PkBcV5cVEv5L1xkRG+wIf2vs1jbQPjrR2e8dFxuLJINerW59hQ5oN8FakV1O6rEcVBRWFauUiyBUpkidGNDXrWwe169XDW4xI0RqQY/bozPqrgaZMg/GVuMmIdoOjWnXzFidSbG2eBQAA) format('woff2');}
@font-face{font-family:IKMPYT-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAALcAAoAAAAABTQAAAKSAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAVAqDKIJQCxAAATYCJAMcBCAFgmIHIBsbBAAGHvg86/2kTDuWd91Zw1cJV/ikXN3inbMbP7CnMPQEz3o1umm8wBPMrN+eH+FAe8cbjwCzebWGeZgdUTz6NA8TkMUJsQwtSBuk2/8dWdp98alpSBBGIDog0+EBsIwc0xcdofJGGRWQEQBCq1VVAZAAGXDMTzmiIRcwY0BCQxgxdNBV3qiqQOiKWvW5+kjdr+77OxABYD311oAOGAbsYqSRIPAHCVdXa4PBv+e0BU+anzwJePK05enThY6Ojx41PXre5La69+NHjY8eLRAuT582T3/SHL7GZe3Cx02PHw8cty5wj/saj4kbQ3a7re6pGE0oOlN3gyJMekUM7Lp+fwnNSqPYfdWjW+s6p2nHk2hOXBAorp716L52rWlt/W/FuVfP2G6hLR77zeR5bAtqjO3VaXE2ne3ao+QPc8S4AtGt97sAQlSNLU7mu116lv0Vs7bXf62otAsQRqdzGjn3zOnjZTs/PztRK1SjURexKKz3kd7sUOlbwphw9dbEjm89fCdLFaWSb49rQbuV9a/qZYfu031HSrXe233jTrZc6hkxz/QTAAQg4NZdQ1J3m8zfBlkDwEfH/btTo4q0WwYwIFkK7yuUruKCi7Qb4SeQQrEYy2hMkyBVeDJ+Jy7SVfwQgB5/BACCKhWmaIANEpEGMzYy1WLCg+owE9yu4E48MkJjROBNJVENrgygWpyZQXW4si5WSORYrCG+Eqstq6iqbWuMKqiqj4sN4VNx0bFbiXfZLMuY/iPH9B3smxAdj7MpYCiDGcZoRtHJCHypYigWfntDKKOCKmppo5EoCqiinjhiaaaTEYykP0MZgi9xRBNrASXWECur501gCXoxfqa3MIb+jCzry2B8SSCa+GJSBgAA) format('woff2');}
@font-face{font-family:BDWUSF-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAOoAAoAAAAABeQAAANcAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqEeIQDCwoAATYCJAMQBCAFgmIHIBuyBFFULGoUHwm5idZLLEFpxNCGsonJ8tEpHvj2+3Vn5r2PqCTzjLef0EpodGtEiYRG4lCiliS7W8IeZr68/JldF05KKaigT1f0Ecz7J0C3TtyMG/O8eEz1BLOtgbXB2kIRZht/baPsFyg9OP3ulEOppY0WrCXOnYrXHlJ8DndK4mP8/O0Ej5ITvoLMcuBCVaBvONb5RVEyYKmm/QQykoAIIXKeIyKhc5DpxLDwTK1aEVVZaT9n3pZfcu1/WwAhWVheixKvhLL/w4iCOCMQYCiQPItJ1Napmg7U1KIEhtWj6JUGZG9EOlq6oR5V45m9MoDwn5/jZ1it2BkWFsJLBW9QUt0XPDz9tSQpL98CrzSr9W7KNNaiaH09pd2yQZ0rTlDuC+d4q4HYpERrK2hVvXdq3MKL1DXpNGqsutw9kLsiLt1BUsot02a7Z5utEhjWWNvb2y8Vi7U2su56efLiAl6hnBsakDraQ+xMQawT6TrHjckeckL/lNzbCh/U8AhTihTP/mpXTtwusNWzCBvrH2asJBD7R/l9QDw9ETrBTlVU+P/R4+mIm9KmrMKfRqJ0JdbL5FRYEAYcaYGB9rf6Qqwq6NlmrkhvDszFpKK5zEB9j5KXlyoctMY3xggh5IvCkfyYc9rjrkABUQf+q/FO0FkzIYaw+jWF69I8ZK0RreXNx8KKUwrjMsLCTwJZ2f1M3VONKg6f1sYbxBFxEhI26r7iZT12lCFTICrt7/zQd9IegK1a8Zvlc2VC9xnxfr4uDo1LdVPWqBl8Mf8rsJZ+u+l2qflVtDfWA+OVEHf/qe6GH0UEMSb3/YBrTPfHSnpjXMtoYq6gOgXZffFxhL6aqQH+wO1MTzYOAAgI/D4fj48WtPlXmwrw1fnUx1J5PBG0VewVE7Do4mAhP6RDAAFAvCj+cxBPLSRoD0ShOqcG43qXoARogUJcaNRSEUoNBoSKRtOr6/UzQheKOsEwHycUeqUJpW5XhYpejUm9FZNHkPbjbNbJhcSD3XSdfX09zW+LhqGeQbP0MO5KKErNL0rOVDDWM6KDgbNsmXIUKpAojwJf2RL8I1mcuCDhgrnR5cyXL0/mCNG35UuVLYsCQ3oMNIC7nqXTY1cBCW6c0lKZoEiq/LFkmRQY02MUVNIBAAAA) format('woff2');}
@font-face{font-family:EKGZMI-LMRoman7-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAUwAAoAAAAACMgAAATnAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAdAqJXIc2CxYAATYCJAMoBCAFgw8HIBvaBgAehXEbPVBpzvp2KXT8O1fzkmBJkbsNLRTVFnEr5sXMi6+KRE5U/nZ5yL+9u336kmGAJQkF2LIgCiSqLcEMmsd5/Q8A6nL+L6c3Jo9Jd232QMaaIIs+tzHrhZNwD/E4sQQSyjXMduHT85/lbX1dMYjZ7AHA4w80D0oAO7Fnb2mYW1H0i5iBS6gB8MpAQGA3yKfWMlBWqLP0vWUBpA+ywyXeIRUDgOtoOMQQCh7VgiMUkitToVqtOs06Y7t65rrtttq0bu1sHYW5EAiQGkzXawK0AKDPGyJ0H0Y+nBQE+V2tmg7tJdTYorbFTiA0ENft9FTQZ4XnrxseZELvRj823c6nP+E9EMeRK4z1vnXoPzh5WLyDp/ikS7v0QbHN4sAOIaJkiGEMtj1jeU0ZUjChHJfG8+lsEtpxOBSlE1sPRaQh8Yrwdtp+xv4oo8tK1p+5PeCb1vaS+8WbopW7ntdMdjKy84+FirX+YxapPMuyOsaX5TjTHW88Du8WbZ4QXTfdw6ezfld47X3HZJuG4uPhey/Sazu11wx0j4UduCLa3JO5O9ySk5F3X8I2dopXv0/KXNG5A2J8x2FXlI6t7fPI6z86eXz3ialjfkgJCoWJpGbaYYl2cBwjAxwCOA5IPcFHTLHOaB2zXDf5f7OyHZzt4efukw+tjzL9rM0x1ooPOcIX72RCz3JpOIl4HlFAIVNhoL3NbeqOGaKKZQLFCloRlZHcSxmZrr66D5ZpOcXy6fbZ3mb7z1g7OfYaa0a6vOo/cNgfd4sKETfJyXljFBjpLSkIUnkd/qOG9obtJRWNLNfoTLij97nKGera7tPH1DzMruOlYyryTHviejzKcIeUSy3gRYz9KzkaHcAKsaLZwXKUChMMfU7LfI2qoO9qbQv/GNOeehiLCoKEf9xXzyAg9//+/k6taBeQHChAcNOBLnpZadVqKyhOS0QnWy6ENtjsbwmBKCVVJtUPVpUshsmh0nSkteh0zPn/KfXqsg/tBcXpiSgc/s4L1nr58uX9Xq3VYYu/T7YcZQoFW9rt6+exBa01rsdHAlWDkA96z0Cn3HtvmRfoju6RaMHij080SWLPHxYrVLPG1Z2ewaIv3b6AL13/AOPdGzNDQJ8zNl+nWjU/8cg5Mx41/6nmj9aGQZUoLxZLvMheix6MjnhEjb6rZbFCQXGf7PVFckQUhLzBX87gwQpm+itQJZruxwpQ0dR4NVaFTY9nZRKCSH/RVzetfrVYoBLDyagERbjuywR4lCCIhr5V4Bcb+CrHA0+h8w0ilUJaosyu7bTYqW004n36a6NR3MMMXtx//377F6y68JhrS7sMbmAJZoLD1ScJgcqGa3NvDvgNREaFgdAyz5uF/Mb3X1WcoKmv6UP79I3vljnYAwBQhUU6a1ADtoEh3cwZLlYByDDKdSBB+Rz0snXEgNfVZkM9vI+ilVQFSx0pF94bVZZSL4SAVVFUI4io7g1KKEYGZSK250liQXCoqAGiJbsZCFJVBiVC6wZlUidAkqtPY+O+mW3wCIuJyIqLknBI8rc514PlME5SR1Tbi4NPLm+taGotqzF2kTpLnSFWnGR1ahSq5SFMjAhZ4kSRkE9imV+iTItqhRqltffZqEmFOrWMOZFyzANHBGpzWRZqVkKeK9KhWcq1qtDkK8sAGnMh5SyD4yY=) format('woff2');}
@font-face{font-family:QGCUGK-CMMI5;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAI8AAoAAAAAA+QAAAHzAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBFIEYCwYAATYCJAMIBCAFgmIHIBsvAwAuB3gyGp6hpHjrASE8Wq3wOq79Po/QOVo8UGu/t3uLqUSxqp0qFn9nKNksJUpguodC5eb/mhct9J8vmkbX5ZHL0IEMN5ECH+CEBxgT51pT80QG3EC7GQ40Eqt4/aVNC6C317f/DkhgqVY7YEmhQNVWX2vB/u8m/3d6XEA3tGmeeLZJLi3tJZTZxjHpQFrggWQ7o+iVlFNn7LPZYytk8RE0AJR4BT3/OUccPs5ZCGUoxaiXAK2Dwq6AiOztfSBHJkAAIM8BiMjQCBXQCNMLkiSB7C3P/cTfChhABAkREyCrIJAAsZ0pMDdg2RlUftvYtWYiQ1zatqAxPUAfY9+JXy1rh86wbf3033J2siV9cHXpGA4s9hE7euumuHHYNVq7iI1eS/aiA/7NKQb6d4i9zs+/4M3tBggCArdz76WG31I4gQ/VKzuU/8V/mABAqQgCu2TfNCLGLzBhnEjDiCbYBUmUuwAL1KAgkko1mBSp0EGKVRoeLteuAxVSmaCbjknSakSKNDuRYq2uSblFz/PX/V6r15G4QNLqm4ah9K+1pbnp2VburbLqYFetd8UULEzP5804c1MLWxuZFcAwl4rMjEPCCUg0dRyDQdEXzvxtrTI3A7Q1tBggeTOWF60EqUzsCEjtVNZ2ClNAV0OnMhQcAQA=) format('woff2');}

</style>
<g id="page1">
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="30.919929" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">K</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="40.091533" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">[</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="42.858812" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">x</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="48.551326" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">]/(</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="60.171293" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">m</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="68.91601" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">(</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="72.788999" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">x</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="78.481513" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">))</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="125.779166" y="-63.157513" transform="matrix(.999739 0 0 .999739 -6.272999 92.088)">K</text>
<text font-family="BDWUSF-CMMI7" font-size="6.97" x="134.912447" y="-66.752607" transform="matrix(.999455 0 0 .999455 -6.272999 92.088)">n</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="30.919929" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">K</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="40.091533" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">[</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="42.858812" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">C</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="50.689768" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">]</text>
<text font-family="XDFDYR-CMMI10" font-size="9.96" x="125.779166" y="-27.971698" transform="matrix(.999739 0 0 .999739 -9.787999 92.088)">K</text>
<text font-family="IKMPYT-CMR10" font-size="9.96" x="134.950772" y="-27.971698" transform="matrix(.999739 0 0 .999739 -9.787999 92.088)">[Λ]</text>
<path d="M64.10963 26.42324H114.64903" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M112.77613 24.03233C113.1547 25.46691 113.99831 26.14431 114.84826 26.42324C113.99831 26.70217 113.1547 27.37957 112.77613 28.81415" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="RYZTIO-CMR7" font-size="6.97" x=".250863" y="-27.963754" transform="matrix(.999455 0 0 .999455 87.985 50.7)">¯</text>
<text font-family="BDWUSF-CMMI7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 87.985 50.7)">φ</text>
<path d="M31.95472 35.25376V52.38977" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray="2.78941 1.59395"></path>
<path d="M34.34563 50.516884C32.91105 50.895454 32.23365 51.739064 31.95472 52.589014C31.67579 51.739064 30.99839 50.895454 29.56381 50.516884" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="RYZTIO-CMR7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 35.328 74.421)">?</text>
<path d="M126.83924 32.76307V52.38977" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M129.23015 50.516884C127.79557 50.895454 127.11817 51.739064 126.83924 52.589014C126.56031 51.739064 125.88291 50.895454 124.44833 50.516884" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="EKGZMI-LMRoman7-Regular" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 130.212 72.46)">diag</text>
<path d="M138.63099 27.45458C158.48052 29.19161 139.06837 .1982 130.81467 17.89582" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M133.773086 17.208979C132.312966 16.94574 131.342507 17.423976 130.73049 18.07637C130.836935 17.188196 130.57958 16.137355 129.439466 15.187943" stroke="#000" fill="none" stroke-width=".398472" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BDWUSF-CMMI7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 148.614 41.372)">P</text>
<text font-family="QGCUGK-CMMI5" font-size="4.98" x="4.043944" y="-26.974958" transform="matrix(.999739 0 0 .999739 148.614 41.372)">σ</text>
<path d="M47.71899 61.61876H111.13381" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M109.26092 59.22785C109.63949 60.66243 110.4831 61.33983 111.33305 61.61876C110.4831 61.89769 109.63949 62.57509 109.26092 64.00967" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="EKGZMI-LMRoman7-Regular" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 54.316 85.822)">diagonalization</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-big-picture-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;4
</figcaption>
</figure>
</div>
<p>对角化 <img src="https://latex.codecogs.com/png.latex?C"> 的矩阵也同时对角化了 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 中的任意矩阵．若设这一对角化矩阵为 <img src="https://latex.codecogs.com/png.latex?F">，则 <img src="https://latex.codecogs.com/png.latex?A%20%5Cmapsto%20F%5E%7B-1%7D%20A%20F"> 便规定了一个 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D%20%5Cto%20K%5B%5CLambda%5D"> 的代数同构．<img src="https://latex.codecogs.com/png.latex?K%5En"> 与 <img src="https://latex.codecogs.com/png.latex?K%5B%5CLambda%5D"> 的代数同构是平凡的．下面来建立 <img src="https://latex.codecogs.com/png.latex?K%5Bx%5D%20/%20m(x)"> 与 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 间的联系．</p>
</section>
<section id="section-1" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="section-1"></h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-minpoly-iso" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 3</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?C"> 是域 <img src="https://latex.codecogs.com/png.latex?K"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 阶矩阵，<img src="https://latex.codecogs.com/png.latex?m(x)"> 是其最小多项式，则 <img src="https://latex.codecogs.com/png.latex?K%5Bx%5D%20/%20m(x)"> 与 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 代数同构．</p>
</div>
</div>
</div>
</div>
<p>仍然考察 <img src="https://latex.codecogs.com/png.latex?K%5Bx%5D%20%5Cto%20K%5BC%5D"> 自然的“代入” <img src="https://latex.codecogs.com/png.latex?%5Cpsi%20:%20f%20%5Cmapsto%20f(C)">．<img src="https://latex.codecogs.com/png.latex?C"> 的全体零化多项式恰为 <img src="https://latex.codecogs.com/png.latex?m(x)"> 生成的 <img src="https://latex.codecogs.com/png.latex?K%5Bx%5D"> 上的理想，因此 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BKer%7D%5Cpsi%20=%20(m(x))">．<img src="https://latex.codecogs.com/png.latex?%5Cpsi"> 的满射性平凡．用第一同构定理就得到结论．</p>
<div id="fig-dft-exist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dft-exist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="216.78pt" height="81.78pt" viewbox="0 0 144.52 54.52">
<style type="text/css">
@font-face{font-family:MKKSTM-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAGoAAoAAAAAA2QAAAFgAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAocNwsGAAE2AiQDCAQgBYJcByAbyAIAngm2rYa1Qg0FJ1nsZeWDCL7f77fnvPs/ohaKaIZOSNqIdFJgunhKlES1ROWut9sVrXy/Z+nBZlNVmwlKEipBSQw697XpQA/k+QVWqRFZmKnwfDv5wQctoK6yUBPvPLDAkoASiyOaBLJw4KOJRTS7ZccqkVyZlH77G5pciatF3ubH/6jjOb7MoRFQbXQSurx+WqJ7/0CjohEQANQKEg1GocAobxEoisB7rTarJ+g8ih8o/AgogChXvdH3s2sDEAiej1LqxuFfZ1PA5+g7fSPlKaJTgqBRkcdSWfxyAIBMxhGKVAQIoXS7AQOpNkWPAVoyTVvWcrfOmqEoXcK8AlOMW7Rk05ZXu23665E+v7yyTTOMbGl2oI7OUYjRPSRezac/n3aGUozbYFazze1SO0C1qoRlz2QKRWySsQWUxjh/6q0WIAirfHK7qB3yKVRPhh9Mj97p0ZqBIjFbhCgAAA==) format('woff2');}
@font-face{font-family:ZBXBFO-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAS4AAoAAAAAB5QAAARvAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqIGIYvCwwAATYCJAMUBCAFgmgHIBvwBQAehXGz00VxVL5TF991PG76l4eMItUkY6TiBlQlJbSdVFRgTAWbiiPbF1ei8tz8ZYIUyUSspAWsWGfKVahBy/d//q/JX8+OkiIBvHJRNIzGvbN7B7o067JI8YGNRkxTNy0q+qgEpYljR2HbsSOAVc+wNcAB6EZP/sNh9fSwb3oeopoNAAJcCAZ+ChrOoWbgkhsJ/A+ABePF/v8/kwgAi8axYDBb/Co+HgSRy9dpRKHufT1Xf4UqCBDHGj4ANsAOAOwFi7NBDIPPXeWdleNKrZZP6smZbmqLwmRKN9Fik4vZzJyxFj+zUgaC0OlM9GUTbWFErQzWmVOuEIzBle+v3HBAkDQ4IkMq6NagNuw5R5FVdMnpztwzOs4k7hyi5hkUuzcZiArGsEHre3e/WNlsODRzk6+eNNgn6HCVlr/MRNM4w3htwtQH8d0md62WJPV6K2W4Zn3issnKLD/jc2ALHLMufwGbaXqz82a/c1Y3g0FA6FTBRv/DGWevuqo3UccYq9umo7GmZK34ME7Txv23JWqKYbbZsfhlsTvtLNbu5i+TUM20uxFUR+5YmZPeCKpwo/gyffapROt/OGPZU9dNx/yW71Ht99YRPudeuVmt2NaL3ntNtJa8s3+gqE1B15h95ohNr+L2PXAxnj97EFMf8ttL+t4Oxg+H77yfxg5R8FVSriunqqK1CDIskP2eyUjmMkS1kDU4XpOD9cz1qEwJrmYSVTXSoOCOTOmCnkgZDNdGHZpGS8r6o3Jzo/pKNaiMpRmYk130LnYSeM/a4o0vXZ/X2ogs4fVoAvVIZ9jdddhA8NXBhqHQC17CTI3wbo0GqZE6nWf36fM1LwtXxNvJ0EvhnRINmo+uz/rNPf12YmnOqsj6yy7sH47biO6W9KAcdIInOsslcyVZkXeNRqjcSd/cdbd1iTx+3CP9XhpTUxMhsE9/p1uchRXk3y5KlyP8UajsgvBCSXz/w0hXQu7b+SOJVOsiiy8FZc2okTq4GgO+7U9/l22r7BEQmYTcVdgKmVn23fHHlMdiqivHDQKHjOp1HnyXy6+2z2SNybyqD9702350xdwCPhXoCRXTc/ntaHvKML80XlIkENVIefjzXT+skrKed22ZdfS4k/caB5sPeoSrAy97/fmjh33ANedWSR8pyYMdJXHOxdT2GikXf7HTflrK6pG6pGsUJ6//62ubVOMtwq+V8z6McFLm5oXsCgx8yf4of55d8q+8sF25j/EDe9fT4f8vsxqZAIAHKeWgzl/g+j9nhIQhKB/6ICqN4MckKhdcKxydsBECWb4pBrCT9iybiB3LIeDMcon4beaTiMaCdRvAuCoylk2ig+UgLWK5JDZX+aKdfXSU/gw3uUqmlGUVh8gLC3Mjwl/JeiNCw32BD+39GoZa+4eaO92jQiPxZJDr1qnHoAGN+rgr1K0hXdalioySTJZiIeQKFcoVIZyC9a39WnXr4i5CqHANyDa7dGbt1UBDps7oStxgSKv+Uc06uYsSKrI2zwI=) format('woff2');}
@font-face{font-family:SMVDBM-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJ8AAoAAAAABLQAAAIxAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqCNIIACw4AATYCJAMWBCAFgmIHIBu9AwCeg3FDX0K0wWSeRV5fWYQSQrRsmb3yvYJsvkuEqcJ04VBdKBAGjfHgkBiBEvfz4/L9kzDWJYhIZe3Yhqq0JFThMsML4o2a19TF/3eTv8gd0FQ/wbNVGgWWhwlm1raxMSzBXqBp1svcdbKUkpbLje/yMEEWH2gRCtIn5umfBwvTR++Dg8BogEpw8Cj3D+0VQLAjL4MKmdC1VoGEDGPbN4ZzBDTVJckuXznyqrDDb/c5uupSUI8oQRsFToFHAHJA4OpzEaNevxmcdqW7XFqXDLd7hsdznObwponXSpyOVIdjGgnd0odc6ZZ14caMM83prOnc1J1L1qU9O8Yz8VoRhdzSLFtXJEq0as24/KYIiov88k0Z0isanKwO9al+xWWlAup3XmHED4yvMwTllzxrwViBYguf9pdbFPWLRo+Sv2Ji2VrUmJzTCD8e/ltstZqNzkm1vJr1fiX3JXAczjADQCB4+frfK2AGfZOwOfjnXZ2DfUMlyaAugSBTITEjjF9AXLxIiA+47684ThzFGroIIZTmEAglbHpTQE9xkmvrkULLipTattqblgJgRd4QNsWC5OaqSWFqmJTmNqOmPY/ZgPrsqzYlLj00OM4eEpfs75dkp/x9/LYSL6dZpe1VLe0VdapAnwA/G0I0qNOoTasyzVTiNCjlf69eijjpQgWLYxciTjJ/ftKVadaiSoN6Kv58+EVAhK6P0kU3QWlQrGsllmpXpaWsQh2VQD4CmiQWAAAA) format('woff2');}
@font-face{font-family:TSVINP-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJsAAoAAAAABEgAAAIiAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBeIFdCwYAATYCJAMIBCAFgmIHIBt0A1FUDRoAPxN4E6vjkMqICJ8mVMc53I8GruLhayx9f3cDBCoOyTGNz5yKhdahMLXko2tcz/jauk5dYHDenVQfGb+8/ChXCJlA9j2wLl9kBzy6baHdrg52gpv8KnlHN/k8LqBf2DRP/K2pUWAPHnCU2d5iEUYMvdMqupKUyhhj9u2EnL7EmBrSj/Tx2u2rhfFXKfMBuRblE2qV+6dFqFx93xuygADg7Q0kZHTLAt2KcRRFkKtvbyqeVwX3yyRQEDiBuIWAAoiT972GcvWDuSxfOWHN8BYf1LNX0qUCp2ArFFS5ORVrhiWvfoyoXqtmytWnfFAx8G2ZwrFmWKB5Uf8QHPwQzgkKBWYx3zw7i2dOMw0H23M9iIC9ZccaREP2XichgmJx72uQrPZrgec6HQMk//ozthRMY14EsK/SACASPIpH0cAlK/vF90YydT2NIfWeI4wFDYDGfCv1FLttPvrAPP1Ua+lP54BAUP13rKXcxv/6XMCf7v0nfvQ2mU6/US+BYKutNWZMpIWEnzr0geQEmhI4bvQBoY3nqGjWhmo0GUK1mk0sNxo0J4vSIIw6AlT0u0M1en1Btfp9E40W/DrE/IvOjVGY6I4HNm1bh3fjzOzUTCnx4JlXefrzaWdhfmrOX7ZpNdvcLrWD4NiqoqFFJJTQOTygX2+z6aCbr516q4Vg1pSZCdh1liknXwmq6NYfsRWP3lnVmgnmTZkTksEWAAA=) format('woff2');}

</style>
<g id="page1">
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="33.037376" y="-78.884408" transform="matrix(.999739 0 0 .999739 -10.462002 92.09)">K</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="42.208982" y="-78.884408" transform="matrix(.999739 0 0 .999739 -10.462002 92.09)">[</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="44.975259" y="-78.884408" transform="matrix(.999739 0 0 .999739 -10.462002 92.09)">x</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="50.667773" y="-78.884408" transform="matrix(.999739 0 0 .999739 -10.462002 92.09)">]</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="129.183277" y="-78.884408" transform="matrix(.999739 0 0 .999739 -11.532002 92.09)">K</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="138.354873" y="-78.884408" transform="matrix(.999739 0 0 .999739 -11.532002 92.09)">[</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="141.121151" y="-78.884408" transform="matrix(.999739 0 0 .999739 -11.532002 92.09)">C</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="148.952117" y="-78.884408" transform="matrix(.999739 0 0 .999739 -11.532002 92.09)">]</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="33.037376" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">K</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="42.208982" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">[</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="44.975259" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">x</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="50.667773" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">]/<tspan x="60.060057">(</tspan></text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="63.948307" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">m</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="72.693024" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">(</text>
<text font-family="ZBXBFO-CMMI10" font-size="9.96" x="76.567013" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">x</text>
<text font-family="SMVDBM-CMR10" font-size="9.96" x="82.258527" y="-43.698593" transform="matrix(.999739 0 0 .999739 -28.753003 92.09)">))</text>
<path d="M47.48007 10.69424H112.7947" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M110.92183 8.303331C111.3004 9.737911 112.14401 10.415311 112.99396 10.694241C112.14401 10.973171 111.3004 11.650571 110.92183 13.085151" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="TSVINP-CMMI7" font-size="6.97" x=".260858" y="-43.686183" transform="matrix(.999455 0 0 .999455 77.315 50.702)">ψ</text>
<path d="M32.78541 19.52476V36.66077" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M35.17632 34.78788C33.74174 35.16645 33.06434 36.01006 32.78541 36.86001C32.50648 36.01006 31.82908 35.16645 30.3945 34.78788" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M56.90571 37.05924L112.819 16.59246" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray="2.78941 1.59395"></path>
<path d="M110.238473 14.991052C111.08706 16.208058 112.112079 16.554198 113.00609 16.52398C112.303827 17.078051 111.744479 18.004123 111.882081 19.481373" stroke="#000" fill="none" stroke-width=".398468" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="MKKSTM-CMR7" font-size="6.97" x="1.892968" y="-45.526179" transform="matrix(.999455 0 0 .999455 76.92 66.765)">¯</text>
<text font-family="TSVINP-CMMI7" font-size="6.97" x=".260858" y="-43.686183" transform="matrix(.999455 0 0 .999455 76.92 66.765)">ψ</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dft-exist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;5: 命题&nbsp;3 证明示意图
</figcaption>
</figure>
</div>
</section>
<section id="友矩阵" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="友矩阵">友矩阵</h3>
<p>为显式刻画上述对角化过程，我们选取一类特殊的矩阵<sup>2</sup>作为 <img src="https://latex.codecogs.com/png.latex?C"> 进行研究： <img src="https://latex.codecogs.com/png.latex?%0AC%20=%0A%5Cbegin%7Bpmatrix%7D%0A0%20&amp;%201%20&amp;%200%20&amp;%5Cldots%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%201%20&amp;%5Cldots%20&amp;%200%20%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%5Cldots%20&amp;%200%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;1%5C%5C%0A-c_0%20&amp;%20-c_1%20&amp;%20-c_2%20&amp;%20%5Cldots%20&amp;%20-c_%7Bn-1%7D%0A%5Cend%7Bpmatrix%7D%0A"> <img src="https://latex.codecogs.com/png.latex?C"> 被称为首一多项式 <img src="https://latex.codecogs.com/png.latex?m(x)%20=%20c%5En%20+%20a_%7Bn-1%7D%20c%5E%7Bn-1%7D%20+%20%5Cdots%20+%20c_0"> 的<em>友矩阵</em>（companion matrix）．</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;这类矩阵在高阶常系数线性 ODE 和常系数齐次线性递推中也有重要应用．</p></div></div><ul>
<li><p>直接计算，<img src="https://latex.codecogs.com/png.latex?C"> 的特征多项式恰为 <img src="https://latex.codecogs.com/png.latex?m(x)">．</p></li>
<li><p>直接验证，<img src="https://latex.codecogs.com/png.latex?(1,%5Clambda,%5Cdots,%5Clambda%5E%7Bn-1%7D)%5E%5Cmathrm%7BT%7D"> 是其特征值 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> 的一个特征向量．</p></li>
</ul>
</section>
<section id="友矩阵的最小多项式" class="level3">
<h3 class="anchored" data-anchor-id="友矩阵的最小多项式">友矩阵的最小多项式</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-companion-minimal-polynomial" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 4</strong></span> <img src="https://latex.codecogs.com/png.latex?C"> 的最小多项式也恰为 <img src="https://latex.codecogs.com/png.latex?m(x)">．等价地，友矩阵的特征多项式与最小多项式相同．</p>
</div>
</div>
</div>
</div>
<p>等价地，我们研究 <img src="https://latex.codecogs.com/png.latex?C%5E%5Cmathrm%7BT%7D"> 的最小多项式．注意到如下事实： <img src="https://latex.codecogs.com/png.latex?%0AC%5E%5Cmathrm%7BT%7D%5Cboldsymbol%20e_i%20=%20%5Cbegin%7Bcases%7D%0A%5Cboldsymbol%20e_%7Bi+1%7D%20&amp;%20i=0,1,%5Cdots,n-2%20%5C%5C%0A-%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20c_k%20%5Cboldsymbol%20e_k%20&amp;%20i=n-1%0A%5Cend%7Bcases%7D%0A"> 考察任意不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的 <img src="https://latex.codecogs.com/png.latex?C%5E%5Cmathrm%7BT%7D"> 的零化多项式 <img src="https://latex.codecogs.com/png.latex?f(x)%20:=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20x%5Ek">，有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cboldsymbol%200%20=%20f(C%5E%5Cmathrm%7BT%7D)%20%5Cboldsymbol%20e_0%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20(C%5E%5Cmathrm%7BT%7D)%5Ek%20%5Cboldsymbol%20e_0%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20%5Cboldsymbol%20e_k%0A"> 因此 <img src="https://latex.codecogs.com/png.latex?a_k%20=%200"> 对所有 <img src="https://latex.codecogs.com/png.latex?k"> 成立，即 <img src="https://latex.codecogs.com/png.latex?f%20=%200">．这说明 <img src="https://latex.codecogs.com/png.latex?C%5E%5Cmathrm%7BT%7D"> 的（非零）零化多项式次数至少为 <img src="https://latex.codecogs.com/png.latex?n">．再用零化多项式和最小多项式的整除关系就得到结论．</p>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<p>上述命题的逆命题在相似意义下成立．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-coincide-similar" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 5</strong></span> 若矩阵的特征多项式与最小多项式相同，则它与其特征多项式对应的友矩阵相似．</p>
</div>
</div>
</div>
</div>
<p>可在 Jordan 标准型下理解．此时每个特征值对应的 Jordan 块有且只有一个．</p>
<p>当友矩阵 <img src="https://latex.codecogs.com/png.latex?C"> 可对角化时，其最小多项式可分解为不同一次因式的乘积．又其最小多项式与特征多项式相同，故其必有 <img src="https://latex.codecogs.com/png.latex?n"> 个两两不同的特征值 <img src="https://latex.codecogs.com/png.latex?%5Clambda_0,%5Clambda_1,%5Cdots,%5Clambda_%7Bn-1%7D">．结合上述命题可以看到，我们特殊地取 <img src="https://latex.codecogs.com/png.latex?C"> 为友矩阵做研究是不失一般性的．</p>
</section>
<section id="友矩阵对角化的显式表达" class="level3">
<h3 class="anchored" data-anchor-id="友矩阵对角化的显式表达">友矩阵对角化的显式表达</h3>
<p>前面已经得到友矩阵特征向量的形式，因此 Vandermonde 矩阵 <img src="https://latex.codecogs.com/png.latex?%0AF%20=%20%5Cbegin%7Bpmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A%5Clambda_0%20&amp;%20%5Clambda_1%20&amp;%20%5Cdots%20&amp;%20%5Clambda_%7Bn-1%7D%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A%5Clambda_0%5E%7Bn-1%7D%20&amp;%20%5Clambda_1%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Clambda_%7Bn-1%7D%5E%7Bn-1%7D%0A%5Cend%7Bpmatrix%7D%0A"> 正是将 <img src="https://latex.codecogs.com/png.latex?C"> 对角化的矩阵． <img src="https://latex.codecogs.com/png.latex?%0AF%5E%7B-1%7D%20C%20F%20=%20%5CLambda%20=%20%5Coperatorname%7Bdiag%7D(%5Clambda_0,%5Clambda_1,%5Cdots,%5Clambda_%7Bn-1%7D)%0A"> 注意到 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 也被对角化 <img src="https://latex.codecogs.com/png.latex?C"> 的矩阵同时对角化，故 <img src="https://latex.codecogs.com/png.latex?A%20%5Cmapsto%20F%5E%7B-1%7D%20A%20F"> 确为 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D%20%5Cto%20K%5B%5CLambda%5D"> 的代数同构，与先前的关于对角化的讨论结果一致．</p>
</section>
<section id="循环矩阵的对角化" class="level3">
<h3 class="anchored" data-anchor-id="循环矩阵的对角化">循环矩阵的对角化</h3>
<p>特别地，若取 <img src="https://latex.codecogs.com/png.latex?%0AC%20=%0A%5Cbegin%7Bpmatrix%7D%0A0%20&amp;%201%20&amp;%200%20&amp;%5Cldots%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%201%20&amp;%5Cldots%20&amp;%200%20%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%5Cldots%20&amp;%200%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;1%5C%5C%0A1%20&amp;%200%20&amp;%200%20&amp;%20%5Cldots%20&amp;%200%0A%5Cend%7Bpmatrix%7D%0A"> 它是基本循环矩阵，对应最小多项式 <img src="https://latex.codecogs.com/png.latex?m(x)%20=%20x%5En%20-%201">．<img src="https://latex.codecogs.com/png.latex?C"> 生成的代数 <img src="https://latex.codecogs.com/png.latex?K%5BC%5D"> 即 <img src="https://latex.codecogs.com/png.latex?K%5E%7Bn%20%5Ctimes%20n%7D"> 上的全体循环矩阵．此时 DFT 体现为利用 DFT 矩阵 <img src="https://latex.codecogs.com/png.latex?%0AF%20=%20%5Cbegin%7Bpmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A1%20&amp;%20%5Comega_n%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A1%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B(n-1)(n-1)%7D%0A%5Cend%7Bpmatrix%7D%0A"> 对循环矩阵进行对角化的过程．</p>
</section>
<section id="结语" class="level3 fragile">
<h3 class="fragile anchored" data-anchor-id="结语">结语</h3>
<p>以刻画 DFT 的卷积性质为目标，以代数同构为构造手段，我们为理解 DFT 的代数含义提供了两个视角：</p>
<ul>
<li>DFT 是多项式商环上的多点求值插值</li>
<li>DFT 是矩阵代数上的相似对角化</li>
</ul>
<p>可见 DFT 背后的代数理论非常丰富，不失为联系起本科阶段代数课程的有趣实例，亦体现出代数工具与视角在工程实践中的强大效用．</p>
<div id="fig-big-picture-final" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-big-picture-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="239.31pt" height="105.375pt" viewbox="0 0 159.54 70.25">
<style type="text/css">
@font-face{font-family:NXYUVX-LMRoman7-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAUwAAoAAAAACMgAAATmAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAdAqJXIc2CxYAATYCJAMoBCAFgw8HIBvaBgAehXEbPVBpzvp2KfTzePp/bpIp6fD/y9qtI9vBKgd2Ap/6KAdfAA9vt/f/jg7lAC9JKMCWBVEgUW0xNI/z+h8A1OX8X05vTB6T7trsgYw1QRZ9bmPWCyfhHuJxYgkklGuY7cKn5z/L2/q6YhCz2QOAxw9oBegA7MKe/EfD8hVF34gZ+IUBAK8LBAR2g2buqgZdZfrK8H8sgPRBHrjE/0jFAOA6Gg4xhNJHTeAIZTSq1WrQpFmHvtiunrluq8022WD92Tpay0MgQGowXW8M0AqAPm+I0H0Y+XBSEOR3NQMzOkRotMxgmYdAaCVu3h6spU8Lz1613s/E3059aL+VVz7igxDHkWsZ1z0bYGT/3EHxNp7icy7ssATtFqd924SIkiGGsdryhOWNZUjLxHOcgueVbA7adjAeKYnNB5IUSLxWeFOxl/E8zJizkg1PAu7x7et3k3vFm0RrbwdfsdvOyM4+FGrXjxxxkvMsy5oZX5bj7Le9Cjq4U7TpmOiq/S5eyUZc4k33HJFtshYfTdx9nl6/3XS9lfmRhH2XRJt2qXcmOnMy8vZz2MLO84Z3SZk/OrNPjG876I+U2Po9QcUjh+eO7jw2f8QP6UDxMJE0VhyWaBvHMTLAIYDjAPkxPmmedUabmeW6yf+blW3j3A8+DZy773qYGWHdjrAufNwhvmI7E3+aU+Ak4nlEAYVMrZXploD5Ww6IqpAJtGvRWlE1yT2XkUrDdXtgDa2hWF7pWRDqsPeUq4/3kK1xst+LkX0HI/GAlDhxu4ZcYYuik0MlpTF6LxO/NDLd6H5BzyjfP1UNtyze1ztFXdl58ohBkMNVvGpaT6P2JK5mIlUg5N0GUc/SPF9o0NQoVoaVL43VIDnMMvQZE8f1VC1922RL4tuY6fz9dFQaI/zhrqGKgKL/87vbTVL9QHKiKMF1L7r8eZ1Ll7ugQpGNjneei29129sZBykqq0xqGasvWZWggToLya6ik2lnf6cMG6rf9BRUKLNRIvxcHGvy/Pnzu0Mm6yacfj7eeZgpE2zpgI+fx5Z2NfofnYzWj0Fh6DUrs5rQ3dUhYD4FJqOVTj+8Y0wSu35wWkt1GF3eHhwr+jDgA/jQ/wewPUIxMwT0GVvHDVSX8TseuXDBU+Y/Nv7S1TqmDhWnY9nn2evUg6kRjxjQt02c1lJQMeSGfJCblAJxb/CXs3qw0sWRWlSHFkawUlQ+P9OA1WMLM/lqQpAcKfrousu3Tiup7EQyJUubaP48Cx5kCVJheBNEpEe/KAzC8+gSq2SduM4Uhyvbnbab2kyGnvzYZgoPcoBnd1+/2/MBayg84t/ZI4NrWJaD4GDDcUKgt9G/Y6gQIkZCVWEgtEw79c/dEuPwX/VxgqY+pg/s1zf+vyzE7gGAPizSWYMasB2smWfhcLEKQIZNroME5fPSy66RBiFXmw0N8j6IVlIfnHWkInhvVFlKQxAC1kdRjSCivzfooNgYdIm4nyeJxcChYgCIiYJmIEjVG3QIbTDokjoGkvy9m57xzWxDUKZKLVeoJByS/G3O9WA5jI/UG9X24uCTa7pq27uqG239pL5SX0iXIVezRmWaBMmkoianoCIhn8Qyv1K1Tg3KtFG099mmXa1mTWz5kPLOAycFmnJZlulQSZMr16tZanSp1e6rzgDa8iPlK4PjJgA=) format('woff2');}
@font-face{font-family:RZJFVY-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAS8AAoAAAAAB5QAAARxAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqIGIYvCwwAATYCJAMUBCAFgmgHIBvwBQAehU3ZMt4mPJLfkzd5E/r5d9M/ucjQapKxpOIGVCUllUlFBcZUsKk48kz/3IjKc/OXCVIkE7GSFrBinSlXoQbtf4B03/N/Tf56dpQUCeCVi6JhNO6d3TvQpVmXRYoPbDRimrppUdFHJShNHDsK244dAZx6hW0AHkA3evEfDuunh33T8xDdhAAI8CEY+CloOkdagU9pLPB/gAPjxf6XSQSAQ+M4MJgrYZWIAIIoFeg2plD3PnOJwRpVECCeNSIAXIAdANgLFueCGAafuyq6qyerdDoRaSDnumusKrM5w8zIzK4WC3vBVvLKRhsJQq83M9fNjJURtbFYZ0m9QbBGV36wessRcdLgiAypYlqDxnjgEk3WMCWnv/DI5DiTeHCMXmRU7d9mJCpZ4xad38PDsqpW47G52/wMpNE+QY+rdaJVZobBWdZ7G6Y5iu83e+h0JGkw2GjjLdsL1202dvUF3yM74JRt9RvYzjDbXbb7X7K5G41iQq8OMQUcz7x4002zjT7F2ty3nYwzp+hkx3GGMR2+T2lolt1lx+LXZR6Mi0y3X7SKolsZDxOoTzywsSe9EdQRJtl15uJLShdwPHPVS7dtp/xXH1Af9tETvpfeudts2M6rPgfNjI68s3+g6G3Bt9hDlsht7+IPPXE1Xb54FNMc8z9I+t0PwY9H7H2czg1VidRyvhuvprK9GDItUfyexVILWaJWwhmerMvF+hZ6VqeG1LJJ6jp5cEhXlnxJX5QCRmurHs2iFeWD0Xl50QNlWlTO0Q4tyCn+GDsLgmdjyda3bq/rhVJrRCOaQn3yOfYPHbcQIk2IcSTsirckSyt5WKdFGqTJENh//XrD26I1CfYK9FbyoFSLFqPb837zyLifVJa7Lqrxuiv3h9NC6cPSPpSLzgikF/lkHpUd9dBkguqd/M1DDzvXqNOnPTMepbN1dZFih4yPemXZWGHB/eIMJcKfhSmuSK6UJgw+jXIjlH7dP5JIvSmq5Fpw9pw6uaObKfDbwYyPuXZVfWIii1C6SdohK6u+O/2c9lxO9+S6Q9BQ0P0uwx/zRbUOWZwJhXft0bv+u0+uWVgoooO8oHJ6rb4f40AbF5clUMViaZ1cgL/e98M6Oed1z455J087+2xwFH7WJ1kfdN37zx89HQJvubRTAySVD3tK411K6N11cj7+Zq/DrJzTJ3fN0KrO3v7Xzy65zkeK36oQfB7pXJWXH7IrMPBeYc3mRfYpvwrCdeW+xI8cXk+H/5/1yAwAAkgpB3X+Arf/NSMkDEH50AfRaQZ/JlF54Fbh6YaNEMiKzDCAvbRnuaTsWR4xF5ZPyn+zCCUGB9aFgHFTbCwXpYvlIS1j+SjbqyIxLj46Sn+Gm1xek5+tqg5VFhXlRUa8kvVGhkX4Ah/a+zWNtA+OtHZ7RIdF4cmg1Ktbn2FDmg3wUKRXU7qsR7ka+bKpVAulVKRInkgRVKxvHdSuVw8PkcJEaECO2aMz668GmjINxlfiJiPaDY5q1c1DtDBRtXkOAAAA) format('woff2');}
@font-face{font-family:CZITOE-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAARkAAoAAAAABugAAAQYAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqGcIU2CwwAATYCJAMUBCAFgmIHIBtxBQAeB+WY0ypnUYOK74lFEPB29vN2kxwEfJOVUQKoDvOvhyWl80vpV9Ikhi+pfAKC8TRC+2WVJOXEzbgxrQ00NeQE19QCaoN3CWW2afzEB3rR5welF6DXbYJBl6QpzuoJqqMHkKWrYilKkNZLdweMWdIS8ZUVBAkN4FUgTIOc5hG9dQA1+fINmUFKRhgCkQ0OUnyJUjBmXxClIHxPE3UkJPJpla/JNzJs/xODxwbvi+mLRqBIJYHm4rTCDEQbCIgikxDyk7x18wM0ctugAU7Y+u4Zx0EuhCQA0yjs8QGrMmOKBHaaJ6cdYOpPn5bwxbgeX1yYr/q86K5kuS1qau5emVdmbr4BnbbebveeNY0DsJqUvNi70lOHs1LaVaGE89A7asBxyEaX2Y9BrKrJKsaFdrgVM/+N7YS+8Za8507sBb9HT65uNIeQxnd3940qIEfb46R5nvhMTHueRFEYwQ/o8fZ6W7EtocQ7byfviPvHssdLwg8d8lxfqUy/e+fEh1Sx+BY/plgqu+suOa2fAaQRe9eeum7J8eZ8NP/EFdJ2YDWwLnuSafeilJTKzhpP2My888dVIn8uE+6s8934Ba9taBP+iYlQUkZRqiarsOKQ4B+hCq1U/HF6n18l2yISxVYXYPD/wdLjxbONfVWjfgYayY6ql20N6MhKJFIqKAif3MuPHJYdEhqL7baLYcVGZcrKAr+E/s/9TIx3OnP3dK4+9sX+nd3p6M6lrUxdo3j16U2JaJJHdXlu0N9jfGTSbYJNPM/fW2pgeczijIm2wbJM1ZDd8j6P3UeVtD2vfDOJxKK0tAO3TyRFnX7XbdKtmx69kHo0HCFJ3Wz20KlB/Tk5aZkfUWla2RBn7TD18NPpXwXq8tyIuP8eX40MGhKgqrlZ2h+31Jx31VlyR9NzkVipKw/275anDMoYpyBjcmHs9+xINMejISMdiatyM21EXPbv0fWK1Jjyfc94RfbeWhEmp++fcOQgb9p0wyTqRmb2mMU/r6P6ltMy1W/aT7S/qB6Ty7XUSrQpNtR0mWp+x1XTYFumuu6Q03I+T9zHFNUfOBdpxRqgzZPVd29wKVCbWqABAAIQcOZH9ViZZvQ/dVkBwBvjo0NbMegol0rXG9SRyDT3Vq7EfzBEz24ApFnpIxnSY/xlQRrawcYhzh+pRzWaTAZFxHq4RoE2er6oRAsrUYU2rueaWBKIjFBoILAl2xcVmNMpKjFluqjCnLWtJsEcPcEZH7RtRhcmwvRY1+jU1ET/i9HA09c/1HntHqvubejqrWux8PYN1E+TRBsttNNDNzV0YkEObVT7r7QSTSGJQNKJxZUkUkklEX9KMd/WRQNttGJBAL74ZwBpfmuWXzETUJ02MmCpm+mlga6lOlqwIAhfAqtOGQAAAAA=) format('woff2');}
@font-face{font-family:QPHBZN-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAALcAAoAAAAABTQAAAKSAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAVAqDKIJQCxAAATYCJAMcBCAFgmIHIBsbBAAGHvg68/2ZrCap11LbbA1fIQQVrvBJc3WLd85u/MCewtATPOvV6KbxAk8ws357foQD7R1vPALM5tUa5mF2RPHo0zxMQBZnxCosQNoi3f9vy8rui09NQ4ywAWIJZDY8APqxEwZiSaC8VUYFZASA0GpVVQAkQAZs81O2aMgEdFgjoSGICFpok7eqKhC4olZ9rhrUw+qhv0MRALaivjtgCYwC9jHSSBD4g4SjY3dra+++s5aY6k0mH5O5wWxeamtrMNQZntc5re9vNNQaDEuEg9lcP9tUH7zBYeNSY53ROHTSJt8Dzhtcpm4N2O+0vq9io0Wx1HZYK0JrpYihbZsPF1Cv1Ir9N13aGzfZzTodR33sEl9x86JLx8aN2o3VvxX7fn0j2wMbXA7ryHLZ5Vcb2a9Lb6+92NZZ8IcFYlKOaO//zocAVWOLne5ha9+iv2Le7uqvJaW9fISN3TmNXHpm9/F6Ly+vXqJSqEajLmNZUP8T/dmj0rcEMeXmvakt3zo9p0slhZJn5y2//crmV9Vyn47ZnmOlSvfdnlFnG671DVmk/QkAAhBgMtp2dfRI/W0tawD4aHv4UGpUkfbLANZIlsL7CqWbOOAg7Uf4CaRQLEc/GpMkSBSuTN6Jg3QTLwRghTcCAEGVCjM0oAcSkQYdPWRqgRYXaokO/3YFZ6KRERobBO6UEtXgyBBqgT1zqCWObIoVYjkVa4ivxGqrKguzm8vDcsqqoyJD+FRUeORW4l02Sz9h8NgJA4d7xoRH42xyGMlwRjGecXQxBk/KGIme394IqqikkGyaKSeMHMqoJopI6uliDGMZzEhG4EkU4URaQIE1wsrqexPog35Mnun1TGAwY8sGMhxPYggnupiUAQAA) format('woff2');}
@font-face{font-family:ZGPOCH-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAGkAAoAAAAAA2QAAAFbAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAocNwsGAAE2AiQDCAQgBYJcByAbyAIAHgd2i0+I4knGcsWw+RcPzx/+zr3v/d9YG2xMzwOaFm4KOE7kC4UJpYvS3sW1rvVA144qxqu+MkBb4OcLM9Vsxw8DLaBdZaEmvvPAAksCSiyOPJA08CixiPL0hi3vEolyKflMKLkVrzrkW378T3tojC9a5BhAddGJ7+ZuP0AovQOKhiIgAGgNJAqm4QLTCOsQVRXotcZeO4f2Q3UDlYeACoh6OxwjP4cYCAgE788FvkGf/vWXCj6n/2RHyguIfgmCoiHPFBTjFwoAyKy4giJVAYJJg16AMYm5GjKGDi2iSztxUGYswEUdEFb54GrWEB26o0vfPGjXfzzk+eVR2UkmDJc1orS+dLYiJ6A6JP6a7n602Q9mIHMSJyGGhZmlna2eNRBZ6OpZmytzJCUYXCxDJE2X17O2MbIwB0QcoR5OOdez1uqC7krbCejaG9nYG5gBMo7kDQ5BAAAA) format('woff2');}
@font-face{font-family:AOIYLX-CMMI5;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJIAAoAAAAAA+QAAAH8AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBFIEYCwYAATYCJAMIBCAFgmIHIBsvAwCuA2xwfUMUZdQ1Vyljjhlt83Dl+XNxhpjlRpAN2+x979TuwDYhEY6uEJ6gLI5gLEIjVBfmLTf/17xoof/8omlRidfL1IEMN5ECH2AKDTAGzrlMHmk2DnxiA93fWMVV2lQi19tPJLvbb0KZJphgZpmWO42vSaFA1QwwV9bSai34/27yf6fHBXRDm+aJZ5vk0tJeQpltHJMOpAUeSLYzil5JOXXGPps9tkIhL2ABoKQH3f7ZRxwf5xwXiVJGfQZo3d+VBxH9/j6QURAQAOQMQEIBQ6jAEGYNpKgoKPyc/cTfGRhAAkUkHIKcg0ARkJY4Z07A4+qW8q+9mx5m2MNs1hz27tHHpHd07j0utkut2fPj8t9pIYuTH1LZg+vA5CAlqGoUEotyZI6yxxq2dzrqXl6junnXy6N/D9jt8fAHthIegiAQvM3vquP7VuEi+DR+ZYfyPP1jDQCqEgh2yb6BnkS+AhNmIg0jOWQXJFH3BBbooBBFTR1MShoWSVnTznDdAhkqpiasyGFSNNUjJWM7UjZ1TOpOXM9f93ut3nAx3c61uGg+n9autSWJF1u5t8oqe9Wdr7whUHg5b4aixoYmlhYcM0DemC0yI2FFaW05LZyovLw0TWPmb3NdYyOAhCcyIOmNWJ6xEtgypi3AttI1t+IZAhQ8uTIUHAEAAAA=) format('woff2');}

</style>
<g id="page1">
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="30.919929" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">K</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="40.091533" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">[</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="42.858812" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">x</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="48.551326" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">]/(</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="60.171293" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">m</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="68.91601" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">(</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="72.788999" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">x</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="78.481513" y="-63.157513" transform="matrix(.999739 0 0 .999739 -26.636 92.088)">))</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="125.779166" y="-63.157513" transform="matrix(.999739 0 0 .999739 -6.272999 92.088)">K</text>
<text font-family="CZITOE-CMMI7" font-size="6.97" x="134.912447" y="-66.752607" transform="matrix(.999455 0 0 .999455 -6.272999 92.088)">n</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="30.919929" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">K</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="40.091533" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">[</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="42.858812" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">C</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="50.689768" y="-27.971698" transform="matrix(.999739 0 0 .999739 -10.244999 92.088)">]</text>
<text font-family="RZJFVY-CMMI10" font-size="9.96" x="125.779166" y="-27.971698" transform="matrix(.999739 0 0 .999739 -9.787999 92.088)">K</text>
<text font-family="QPHBZN-CMR10" font-size="9.96" x="134.950772" y="-27.971698" transform="matrix(.999739 0 0 .999739 -9.787999 92.088)">[Λ]</text>
<path d="M64.10963 26.42324H114.64903" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M112.77613 24.03233C113.1547 25.46691 113.99831 26.14431 114.84826 26.42324C113.99831 26.70217 113.1547 27.37957 112.77613 28.81415" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="ZGPOCH-CMR7" font-size="6.97" x=".250863" y="-27.963754" transform="matrix(.999455 0 0 .999455 87.985 50.7)">¯</text>
<text font-family="CZITOE-CMMI7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 87.985 50.7)">φ</text>
<path d="M31.95472 35.25376V52.38977" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M34.34563 50.516884C32.91105 50.895454 32.23365 51.739064 31.95472 52.589014C31.67579 51.739064 30.99839 50.895454 29.56381 50.516884" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="ZGPOCH-CMR7" font-size="6.97" x=".60567" y="-29.802752" transform="matrix(.999455 0 0 .999455 35.328 74.244)">¯</text>
<text font-family="CZITOE-CMMI7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 35.328 74.244)">ψ</text>
<path d="M126.83924 32.76307V52.38977" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M129.23015 50.516884C127.79557 50.895454 127.11817 51.739064 126.83924 52.589014C126.56031 51.739064 125.88291 50.895454 124.44833 50.516884" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="NXYUVX-LMRoman7-Regular" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 130.212 72.46)">diag</text>
<path d="M138.63099 27.45458C158.48052 29.19161 139.06837 .1982 130.81467 17.89582" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M133.773086 17.208979C132.312966 16.94574 131.342507 17.423976 130.73049 18.07637C130.836935 17.188196 130.57958 16.137355 129.439466 15.187943" stroke="#000" fill="none" stroke-width=".398472" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="CZITOE-CMMI7" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 148.614 41.372)">P</text>
<text font-family="AOIYLX-CMMI5" font-size="4.98" x="4.043944" y="-26.974958" transform="matrix(.999739 0 0 .999739 148.614 41.372)">σ</text>
<path d="M47.71899 61.61876H111.13381" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M109.26092 59.22785C109.63949 60.66243 110.4831 61.33983 111.33305 61.61876C110.4831 61.89769 109.63949 62.57509 109.26092 64.00967" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="NXYUVX-LMRoman7-Regular" font-size="6.97" x="-1.02644" y="-27.963754" transform="matrix(.999455 0 0 .999455 54.316 85.822)">diagonalization</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-big-picture-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;6
</figcaption>
</figure>
</div>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-agarwal_number_1975" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">R. C. Agarwal 和 C. S. Burrus, <span>《Number theoretic transforms to implement fast digital convolution》</span>, <em>Proceedings of the IEEE</em>, 卷 63, 期 4, 页 550–560, 4月 1975, doi: <a href="https://doi.org/10.1109/PROC.1975.9791">10.1109/PROC.1975.9791</a>.</div>
</div>
<div id="ref-nicholson_algebraic_1971" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">P. J. Nicholson, <span>《Algebraic theory of finite fourier transforms》</span>, <em>Journal of Computer and System Sciences</em>, 卷 5, 期 5, 页 524–547, 10月 1971, doi: <a href="https://doi.org/10.1016/S0022-0000(71)80014-4">10.1016/S0022-0000(71)80014-4</a>.</div>
</div>
<div id="ref-furer_faster_2009" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">M. Fürer, <span>《Faster <span>Integer</span> <span>Multiplication</span>》</span>, <em>SIAM Journal on Computing</em>, 卷 39, 期 3, 页 979–1005, 1月 2009, doi: <a href="https://doi.org/10.1137/070711761">10.1137/070711761</a>.</div>
</div>
<div id="ref-amiot_music_2016" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">E. Amiot, <em>Music <span>Through</span> <span>Fourier</span> <span>Space</span></em>. 收入 Computational <span>Music</span> <span>Science</span>. Cham: Springer International Publishing, 2016. doi: <a href="https://doi.org/10.1007/978-3-319-45581-5">10.1007/978-3-319-45581-5</a>.</div>
</div>
<div id="ref-baraquin_uniqueness_2023" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">I. Baraquin 和 N. Ratier, <span>《Uniqueness of the discrete <span>Fourier</span> transform》</span>, <em>Signal Processing</em>, 卷 209, 页 109041, 8月 2023, doi: <a href="https://doi.org/10.1016/j.sigpro.2023.109041">10.1016/j.sigpro.2023.109041</a>.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <category>讲稿</category>
  <guid>https://blog.sun123zxy.top/posts/20240513-isodft/</guid>
  <pubDate>Sun, 12 May 2024 16:00:00 GMT</pubDate>
</item>
<item>
  <title>矩阵代数的 Burnside 定理</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20240121-burnside/</link>
  <description><![CDATA[ 




<p>我们详细重述并证明 <span class="citation" data-cites="radjavi_simultaneous_2000">[1, Sec. 1.2]</span> 中的 Burnside 定理及其相关推论．</p>
<p>下面设 <img src="https://latex.codecogs.com/png.latex?V"> 是复数域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上的有限维线性空间，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 是 <img src="https://latex.codecogs.com/png.latex?V"> 上的线性变换代数；<img src="https://latex.codecogs.com/png.latex?I"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的单位元．称线性变换族 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20C%20%5Csubset%20B(V)"> 可约，当且仅当其存在非平凡不变子空间——即存在非零且不是全空间的子空间 <img src="https://latex.codecogs.com/png.latex?M%20%5Csubset%20V">，使得对任意线性变换 <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathcal%20C">，都有 <img src="https://latex.codecogs.com/png.latex?AM%20:=%20%5C%7B%20Ax%20:%20x%20%5Cin%20M%20%5C%7D%20%5Csubset%20M">．</p>
<p>Burnside 定理证明较长．为使逻辑顺畅，先做一些准备工作．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="lem-cyclic-vector" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的乘法半群，若 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 不可约，则对任意非零的 <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20V">，都有 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20x%20:=%20%5C%7B%20Ax%20:%20A%20%5Cin%20%5Cmathcal%20A%20%5C%7D%20=%20V">（此时称 <img src="https://latex.codecogs.com/png.latex?x"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 的循环向量）．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>首先 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20%5Cneq%20%5C%7B%200%20%5C%7D">，因为任何 <img src="https://latex.codecogs.com/png.latex?V"> 的子空间都是后者的不变子空间．</p>
<ul>
<li>注意到 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BKer%7D%5Cmathcal%20A%20:=%20%5Cbigcap_%7BA%20%5Cin%20%5Cmathcal%20A%7D%20%5Coperatorname%7BKer%7DA"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 的一个不变子空间，而 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 不可约，故 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BKer%7D%5Cmathcal%20A%20=%20%5C%7B%200%20%5C%7D"> 或 <img src="https://latex.codecogs.com/png.latex?V">．因为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20%5Cneq%20%5C%7B0%5C%7D">，后者不可能发生，故 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BKer%7D%5Cmathcal%20A%20=%20%5C%7B%200%20%5C%7D">．</li>
<li>注意到 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20x%20:=%20%5C%7B%20A%20x%20:%20A%20%5Cin%20%5Cmathcal%20A%20%5C%7D"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 的一个不变子空间，而 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 不可约，故 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20x%20=%20%5C%7B%200%20%5C%7D"> 或 <img src="https://latex.codecogs.com/png.latex?V">．由 <img src="https://latex.codecogs.com/png.latex?x%20%5Cneq%200"> 和 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BKer%7D%5Cmathcal%20A%20=%20%5C%7B%200%20%5C%7D">，前者不可能发生，故 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20x%20=%20V">．</li>
</ul>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>事实上 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上半群的可约性等价于其线性生成的代数的可约性，见 <span class="citation" data-cites="radjavi_simultaneous_2000">[1], Definition 2.1.1</span>．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-cyclic-vector-dual" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?V%5E*"> 是 <img src="https://latex.codecogs.com/png.latex?V"> 的对偶空间．设 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的乘法半群，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%5E*%20:=%20%5C%7BA%5E*%20:%20A%20%5Cin%20%5Cmathcal%20A%20%5C%7D"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 的对偶线性变换构成的集合（显然它也是个半群）．若 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 不可约，则对任意非零的线性函数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi%20%5Cin%20V%5E*">，都有 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%5E*%20%5Cvarphi%20:=%20%5C%7B%20A%5E*%20%5Cvarphi%20:%20A%5E*%20%5Cin%20%5Cmathcal%20A%5E*%20%5C%7D%20=%20%5C%7B%20%20%5Cvarphi%20A%20:%20A%20%5Cin%20%5Cmathcal%20A%20%5C%7D%20=%20V%5E*">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>定义 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%5E*%20%5Cvarphi"> 的 annihilator <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%20A%5E*%20%5Cvarphi)%5E0%20:=%20%5C%7B%20x%5E%7B**%7D%20%5Cin%20V%5E%7B**%7D%20:%20(%5Cmathcal%20A%5E*%20%5Cvarphi)(x)%20=%200%20%5C%7D">．由 <img src="https://latex.codecogs.com/png.latex?%5Cdim%20(A%5E*%20%5Cvarphi)%5E0%20=%20%5Cdim%20V%5E*%20-%20%5Cdim%20(A%5E*%20%5Cvarphi)"> <span class="citation" data-cites="axler_linear_2015">见 [2, Sec. 3F]</span>， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cmathcal%20A%5E*%20%5Cvarphi%20=%20V%5E*%0A&amp;%5Ciff%20%5Cdim%20(%5Cmathcal%20A%5E*%20%5Cvarphi)%20=%20%5Cdim%20V%5E*%20%5C%5C%0A&amp;%5Ciff%20%5Cdim%20(%5Cmathcal%20A%5E*%20%5Cvarphi)%5E0%20=%200%20%5C%5C%0A&amp;%5Ciff%20(%5Cmathcal%20A%5E*%20%5Cvarphi)%5E0%20=%20%5C%7B0%5C%7D%0A%5Cend%7Baligned%7D%0A"> 由 annihilator 的定义和 Lemma&nbsp;1， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A(%5Cmathcal%20A%5E*%20%5Cvarphi)%5E0%20=%20%5C%7B0%5C%7D%0A&amp;%5Ciff%20(%5Cmathcal%20A%5E*%20%5Cvarphi)%20x%20%5Cneq%20%5C%7B0%5C%7D,%5Cquad%20%5Cforall%20x%20%5Cneq%200%20%5C%5C%0A&amp;%5Ciff%20%5Cvarphi%20%5Cmathcal%20A%20x%20%20%5Cneq%20%5C%7B0%5C%7D,%5Cquad%20%5Cforall%20x%20%5Cneq%200%20%5C%5C%0A&amp;%5Ciff%20%5Cvarphi%20V%20%5Cneq%20%5C%7B0%5C%7D%20%5C%5C%0A&amp;%5Ciff%20%5Cvarphi%20%5Cneq%200%0A%5Cend%7Baligned%7D%0A"> 故最终我们得到 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%5E*%20%5Cvarphi%20=%20V%5E*%20%5Ciff%20%5Cvarphi%20%5Cneq%200">．</p>
</div>
<p>若下面的猜想成立，则上述推论将具有更简单的推导．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cnj-cyclic-vector-dual" class="theorem conjecture">
<p><span class="theorem-title"><strong>Conjecture 1</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 不可约，则 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%5E*"> 也不可约．</p>
</div>
</div>
</div>
</div>
<p>我们暂未找到证明或证伪上述猜想的方法．</p>
<p>下面来证明 Burnside 定理．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-burnside" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Burnside 定理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的不可约子代数有且只有 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)">．</p>
</div>
</div>
</div>
</div>
<p>首先说明 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的不可约性．因为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)%20M%20=%20V"> 对任意非零不变子空间 <img src="https://latex.codecogs.com/png.latex?M"> 成立，故 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 不可约．下面设 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 是一任意给定的 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的一个不可约子代数．显然 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20%5Cneq%20%5C%7B%200%20%5C%7D">，原因在 Lemma&nbsp;1 中已述．我们的证明分三步进行：</p>
<ol type="1">
<li>证明 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 中存在一个秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换 <img src="https://latex.codecogs.com/png.latex?T_0">．</li>
<li>证明所有 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 中秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换都在 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 中．</li>
<li>证明任何 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 中的线性变换都可被分解为若干个秩不超过 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换的和，从而（利用代数对加法的封闭性）<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20=%20%5Cmathcal%20B(V)">．</li>
</ol>
<div class="proof">
<p><span class="proof-title"><em>Proof</em> (第一部分). </span>由 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A%20%5Cneq%20%5C%7B%200%20%5C%7D">，可以取 <img src="https://latex.codecogs.com/png.latex?T_0"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 中的一个秩最小的非零线性变换，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Brank%7DT_0%20%5Cgeq%201">．考虑反证，假设 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Brank%7DT_0%20%5Cgeq%202">，只要构造出一个非零线性变换 <img src="https://latex.codecogs.com/png.latex?S_*%20%5Cin%20%5Cmathcal%20A"> 使得 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DS_*%20%5Csubsetneq%20%5Coperatorname%7BIm%7DT_0">，就能推出矛盾．</p>
<p>由 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Brank%7DT_0%20%5Cgeq%202">，可设 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0"> 中存在两个线性无关的非零向量 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20T_0%20x_1,T_0%20x_2%20%5C%7D">（因此 <img src="https://latex.codecogs.com/png.latex?x_1"> 与 <img src="https://latex.codecogs.com/png.latex?x_2"> 也线性无关）．由 Lemma&nbsp;1，存在线性变换 <img src="https://latex.codecogs.com/png.latex?A_0%20%5Cin%20%5Cmathcal%20A"> 使得 <img src="https://latex.codecogs.com/png.latex?A_0%20T_0%20x_1%20=%20x_2">，于是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20T_0%20x_1,T_0%20x_2%20%5C%7D%20=%20%5C%7B%20T_0%20x_1,%20T_0%20A%20T_0%20x_1%20%5C%7D"> 线性无关．这意味着 <img src="https://latex.codecogs.com/png.latex?(%5Clambda%20T_0%20-%20T_0%20A_0%20T_0)x_1%20%5Cneq%200"> 对任意 <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cin%20%5Cmathbb%20C"> 成立，即线性变换 <img src="https://latex.codecogs.com/png.latex?S_%5Clambda%20:=%20%5Clambda%20T_0%20-%20T_0%20A_0%20T_0%20%5Cin%20%5Cmathcal%20A"> 非零．下面尝试从这些 <img src="https://latex.codecogs.com/png.latex?S_%5Clambda"> 中找到我们想要的 <img src="https://latex.codecogs.com/png.latex?S_*">．</p>
<ul>
<li>注意到 <img src="https://latex.codecogs.com/png.latex?S_%5Clambda%20=%20%20T_0(%5Clambda%20I%20-%20A_0%20T_0)">，故 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DS_%5Clambda%20%5Csubset%20%5Coperatorname%7BIm%7DT_0">．</li>
<li>注意到 <img src="https://latex.codecogs.com/png.latex?S_%5Clambda%20=%20%20(%5Clambda%20I%20-%20T_0%20A_0)%20T_0">，而 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0"> 是 <img src="https://latex.codecogs.com/png.latex?T_0%20A_0"> 的一个不变子空间．故可以取 <img src="https://latex.codecogs.com/png.latex?T_0%20A_0"> 在 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0"> 上的限制 <img src="https://latex.codecogs.com/png.latex?T_0%20A_0%20%7C_%7B%5Coperatorname%7BIm%7DT_0%7D">．设 <img src="https://latex.codecogs.com/png.latex?T_0%20A_0%20%7C_%7B%5Coperatorname%7BIm%7DT_0%7D"> 有一特征值 <img src="https://latex.codecogs.com/png.latex?%5Clambda_0">（由于 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0"> 是复数域上有限维线性空间），这样 <img src="https://latex.codecogs.com/png.latex?%5Clambda_0%20I%20-%20T_0%20A_0%20%7C_%7B%5Coperatorname%7BIm%7DT_0%7D"> 就不是单射，因此也不是满射（由于 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0"> 是有限维线性空间），即 <img src="https://latex.codecogs.com/png.latex?S_%7B%5Clambda_0%7D%20=%20(%5Clambda_0%20I%20-%20T_0%20A_0)%20T_0"> 不能映满 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DT_0">．</li>
</ul>
<p>综上 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7DS_%7B%5Clambda_0%7D%20%5Csubsetneq%20%5Coperatorname%7BIm%7DT_0"> 且 <img src="https://latex.codecogs.com/png.latex?0%20%5Cneq%20S_%7B%5Clambda_0%7D%20%5Cin%20%5Cmathcal%20A">，故 <img src="https://latex.codecogs.com/png.latex?S_%7B%5Clambda_0%7D"> 就是我们想要的 <img src="https://latex.codecogs.com/png.latex?S_*">．</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em> (第二部分). </span>对任意给定的某一秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换 <img src="https://latex.codecogs.com/png.latex?T%20%5Cin%20%5Cmathcal%20B(V)">，任取非零的 <img src="https://latex.codecogs.com/png.latex?y%20%5Cin%20%5Coperatorname%7BIm%7DT">，存在线性函数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi%20%5Cin%20V%5E*"> 使得 <img src="https://latex.codecogs.com/png.latex?T%20x%20=%20%5Cvarphi(x)%20y,%5C,%20%5Cforall%20x%20%5Cin%20V">．已经知道 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20A"> 中存在一个秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换 <img src="https://latex.codecogs.com/png.latex?T_0">，则任取非零的 <img src="https://latex.codecogs.com/png.latex?y_0%20%5Cin%20%5Coperatorname%7BIm%7DT_0">，存在线性函数 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi_0%20%5Cin%20V%5E*"> 使得 <img src="https://latex.codecogs.com/png.latex?T_0%20x%20=%20%5Cvarphi_0(x)%20y_0,%5C,%20%5Cforall%20x%20%5Cin%20V">．</p>
<ul>
<li>由 Lemma&nbsp;1，存在 <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathcal%20A"> 使得 <img src="https://latex.codecogs.com/png.latex?A%20y_0%20=%20y">．</li>
<li>由 Corollary&nbsp;1，存在 <img src="https://latex.codecogs.com/png.latex?B%20%5Cin%20%5Cmathcal%20A"> 使得 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi_0%20B%20=%20%5Cvarphi">．</li>
</ul>
<p>综上， <img src="https://latex.codecogs.com/png.latex?%0AT%20x%20=%20%5Cvarphi(x)%20y%20=%20%5Cvarphi_0(Bx)%20A%20y_0%20=%20A(%5Cvarphi_0(Bx)%20y_0)%20=%20A%20T_0%20B%20x,%5Cquad%20%5Cforall%20x%20%5Cin%20V%0A"> 故 <img src="https://latex.codecogs.com/png.latex?T%20=%20A%20T_0%20B%20%5Cin%20%5Cmathcal%20A">．</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em> (第三部分). </span>设 <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathcal%20B(V)"> 是任一给定的线性变换，任取 <img src="https://latex.codecogs.com/png.latex?V"> 中的一组基 <img src="https://latex.codecogs.com/png.latex?b_1,%5Cdots,b_n">，设其对偶基为 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi_1,%5Cdots,%5Cvarphi_n">．定义关于基 <img src="https://latex.codecogs.com/png.latex?b_1,%5Cdots,b_n"> 的 <img src="https://latex.codecogs.com/png.latex?n"> 个投影变换 <img src="https://latex.codecogs.com/png.latex?P_k:%20x%20%5Cmapsto%20%5Cvarphi_k(x)%20b_k">，由对偶基性质，显然有 <img src="https://latex.codecogs.com/png.latex?I%20=%20%5Csum_%7Bk=1%7D%5En%20P_k">，于是 <img src="https://latex.codecogs.com/png.latex?%0AA%20=%20A%20I%20=%20A%20%5Csum_%7Bk=1%7D%5En%20P_k%20=%20%5Csum_%7Bk=1%7D%5En%20A%20P_k%0A"> 其中每一个 <img src="https://latex.codecogs.com/png.latex?A%20P_k"> 都是秩不超过 <img src="https://latex.codecogs.com/png.latex?1"> 的线性变换．</p>
</div>
<p>至此，Theorem&nbsp;1 得到完整证明．</p>
<p>Burnside 定理可以为下面的定理提供一个较为简单的证明．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-bv-simple" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 是单代数，即 <img src="https://latex.codecogs.com/png.latex?%5C%7B%200%20%5C%7D"> 和 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 是代数 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上唯二的双边理想．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>显然 <img src="https://latex.codecogs.com/png.latex?%5C%7B%200%20%5C%7D"> 和 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5Cmathcal%20B(V)%20%5C%7D"> 都是双边理想．下面任取一 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的双边理想 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I%20%5Cneq%20%5C%7B%200%20%5C%7D">，我们证明它不可约．任取 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I"> 的一个非零不变子空间 <img src="https://latex.codecogs.com/png.latex?M">，由 <img src="https://latex.codecogs.com/png.latex?M,%5C,%20%5Cmathcal%20I"> 的非零性和 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I%20V"> 的非零性， <img src="https://latex.codecogs.com/png.latex?%0AM%20%5Csupset%20%5Cmathcal%20I%20M%20%5Csupset%20%5Cmathcal%20B(V)%20%5Cmathcal%20I%20%5Cmathcal%20B(V)%20M%20=%20%5Cmathcal%20B(V)%20%5Cmathcal%20I%20V%20=%20%5Cmathcal%20B(V)%20(%5Cmathcal%20I%20V)%20=%20V%0A"> 故只能有 <img src="https://latex.codecogs.com/png.latex?M%20=%20V">，因此 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I"> 确不可约．现在 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的不可约理想，理想一定是子代数，根据 Theorem&nbsp;1 就有 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20I%20=%20%5Cmathcal%20B(V)">．</p>
</div>
<p>下面的定理为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的全体代数自同构提供了表示方法．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-bv-inner-aut" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的全体代数自同构均为内自同构．即，任意 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的自同构 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi:%20%5Cmathcal%20B(V)%20%5Cto%20%5Cmathcal%20B(V)"> 都可写为 <img src="https://latex.codecogs.com/png.latex?A%20%5Cmapsto%20S%20A%20S%5E%7B-1%7D"> 的形式，其中 <img src="https://latex.codecogs.com/png.latex?S%20%5Cin%20%5Cmathcal%20B(V)"> 为与 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 相关的某一可逆线性变换．</p>
</div>
</div>
</div>
</div>
<p>将矩阵表示和线性空间的语言相结合，可以为该定理提供思路更清晰的证明．</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>取定 <img src="https://latex.codecogs.com/png.latex?V"> 上的一组基 <img src="https://latex.codecogs.com/png.latex?x_1,%5Cdots,x_n">，定义 <img src="https://latex.codecogs.com/png.latex?%0AE_%7Bi,j%7D(x_1,%5Cdots,x_n)%20:=%20(x_1,%5Cdots,x_n)%20%5Chat%20E_%7Bi,j%7D%20%5Cpod%7Bi=1,2,%5Cdots,n;%5C;%20j=1,2,%5Cdots,n%7D%0A"> 其中全体 <img src="https://latex.codecogs.com/png.latex?%5Chat%20E_%7Bi,j%7D%20%5Cin%20%5Cmathrm%20M_n(%5Cmathbb%20C)"> 代表 <img src="https://latex.codecogs.com/png.latex?n"> 阶矩阵空间的一组自然基．于是全体 <img src="https://latex.codecogs.com/png.latex?E_%7Bi,j%7D"> 自然也是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的一组基．现在只需研究自同构 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 将 <img src="https://latex.codecogs.com/png.latex?E_%7Bi,j%7D"> 映至何处．为显式地将 <img src="https://latex.codecogs.com/png.latex?S"> 确定出来，不妨先考虑 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)"> 的性质．</p>
<p>首先指出，<img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)"> 仍然是秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的投影变换，因为：</p>
<ul>
<li><p><img src="https://latex.codecogs.com/png.latex?E_%7Bi,i%7D"> 是投影变换，根据其幂等性和代数自同构保持乘法，<img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)"> 也是投影变换．</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?E_%7Bi,i%7D%20%5Cmathcal%20B(V)%20E_%7Bi,i%7D"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的 <img src="https://latex.codecogs.com/png.latex?1"> 维子空间（从矩阵表示角度考虑），因此 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D%20%5Cmathcal%20B(V)%20E_%7Bi,i%7D)%20=%20%5Cvarphi(E_%7Bi,i%7D)%20%5Cmathcal%20B(V)%20%5Cvarphi(E_%7Bi,i%7D)"> 也是 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 的 <img src="https://latex.codecogs.com/png.latex?1"> 维子空间．考虑到 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)"> 还是投影变换，故其秩只能为 <img src="https://latex.codecogs.com/png.latex?1">（同样从矩阵表示角度考虑）．</p></li>
</ul>
<p>现在设 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7BIm%7D%5Cvarphi(E_%7Bi,i%7D)%20=%20%5Coperatorname%7Bspan%7D%5C%7By_i%5C%7D">．因为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20%5Coperatorname%7Bspan%7D%5C%7By_i%5C%7D%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Cvarphi(E_%7Bi,i%7D)%20V%20%5C%5C%0A&amp;%5Csupset%20%5Cleft(%20%5Csum_%7Bi=1%7D%5En%20%5Cvarphi(E_%7Bi,i%7D)%20%5Cright)%20V%20%5C%5C%0A&amp;=%20%5Cvarphi%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20E_%7Bi,i%7D%20%5Cright)%20V%20%5C%5C%0A&amp;=%20%5Cvarphi(I)%20V%20=%20I%20V%20=%20V%0A%5Cend%7Baligned%7D%0A"> 故 <img src="https://latex.codecogs.com/png.latex?y_1,%5Cdots,y_n"> 仍是 <img src="https://latex.codecogs.com/png.latex?V"> 的一组基．定义可逆线性变换 <img src="https://latex.codecogs.com/png.latex?S(x_1,%5Cdots,x_n)%20:=%20(y_1,%5Cdots,y_n)">．至此，断言 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi"> 就是 <img src="https://latex.codecogs.com/png.latex?A%20%5Cmapsto%20S%20A%20S%5E%7B-1%7D">，为此下面证明 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,j%7D)%20=%20S%20E_%7Bi,j%7D%20S%5E%7B-1%7D">．</p>
<p>仍然先看 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)">．已经知道 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)"> 是秩为 <img src="https://latex.codecogs.com/png.latex?1"> 的投影变换，故 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A&amp;%5Cphantom%7B%5Cimplies%20.%7D%20%5Cvarphi(E_%7Bi,i%7D)%20y_i%20=%20y_i%20%5C%5C%0A&amp;%5Cimplies%20%5Cvarphi(E_%7Bi,i%7D)%20S%20x_i%20=%20S%20x_i%20%5C%5C%0A&amp;%5Cimplies%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,i%7D)%20S%20x_i%20=%20x_i%0A%5Cend%7Baligned%7D%0A"> 容易验证 <img src="https://latex.codecogs.com/png.latex?S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,i%7D)%20S"> 幂等且秩为 <img src="https://latex.codecogs.com/png.latex?1">，因此只能有 <img src="https://latex.codecogs.com/png.latex?S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,i%7D)%20S%20=%20E_%7Bi,i%7D">，即 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,i%7D)%20=%20S%20E_%7Bi,i%7D%20S%5E%7B-1%7D">．</p>
<p>现在看 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,j%7D)">，为此考察 <img src="https://latex.codecogs.com/png.latex?S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20S"> 将 <img src="https://latex.codecogs.com/png.latex?x_1,%20%5Cdots,%20x_n"> 映至何处．事实上 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A&amp;%5Cphantom%7B%5Cimplies%20.%7D%20%5Cvarphi(E_%7Bi,j%7D)%20%5Cvarphi(E_%7Bj,j%7D)%20=%20%5Cvarphi(E_%7Bi,j%7D%20E_%7Bj,j%7D)%20=%20%5Cvarphi(E_%7Bi,j%7D)%20%5C%5C%0A&amp;%5Cimplies%20%5Cvarphi(E_%7Bi,j%7D)%20S%20E_%7Bj,j%7D%20S%5E%7B-1%7D%20=%20S%20E_%7Bi,j%7D%20S%5E%7B-1%7D%5C%5C%0A&amp;%5Cimplies%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20S%20E_%7Bj,j%7D%20=%20E_%7Bi,j%7D%5C%5C%0A&amp;%5Cimplies%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20S%20x_j%20=%20x_i%0A%5Cend%7Baligned%7D%0A"> 且对任何 <img src="https://latex.codecogs.com/png.latex?k%20%5Cneq%20j">， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A(S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20S)%20x_k%0A&amp;=%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20y_k%20%5C%5C%0A&amp;=%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D%20E_%7Bj,j%7D)%20y_k%20%5C%5C%0A&amp;=%20S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20(%5Cvarphi(E_%7Bj,j%7D)%20y_k)%20%5C%5C%0A&amp;=%200%0A%5Cend%7Baligned%7D%0A"> 故可以断定 <img src="https://latex.codecogs.com/png.latex?S%5E%7B-1%7D%20%5Cvarphi(E_%7Bi,j%7D)%20S%20=%20E_%7Bi,j%7D">，即 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(E_%7Bi,j%7D)%20=%20S%5E%7B-1%7D%20E_%7Bi,j%7D%20S">．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>研究 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的自同态时，可能在应用线性变换关于其作用域 <img src="https://latex.codecogs.com/png.latex?V"> 的性质时遇到困难．这时需要将其合理转化为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的代数性质，如考虑投影变换的幂等性，将投影变换秩为 <img src="https://latex.codecogs.com/png.latex?1"> 转化为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20B(V)"> 上的 <img src="https://latex.codecogs.com/png.latex?1"> 维子空间等．这些技巧在证明中多次使用．</p>
</div>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-radjavi_simultaneous_2000" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">H. Radjavi and P. Rosenthal, <em>Simultaneous <span>Triangularization</span></em>. in Universitext. New York, NY: Springer, 2000. doi: <a href="https://doi.org/10.1007/978-1-4612-1200-3">10.1007/978-1-4612-1200-3</a>.</div>
</div>
<div id="ref-axler_linear_2015" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">S. Axler, <em>Linear <span>Algebra</span> <span>Done</span> <span>Right</span></em>. in Undergraduate <span>Texts</span> in <span>Mathematics</span>. Cham: Springer International Publishing, 2015. doi: <a href="https://doi.org/10.1007/978-3-319-11080-6">10.1007/978-3-319-11080-6</a>.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <guid>https://blog.sun123zxy.top/posts/20240121-burnside/</guid>
  <pubDate>Sat, 20 Jan 2024 16:00:00 GMT</pubDate>
  <media:content url="https://blog.sun123zxy.top/posts/20240121-burnside/cover.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>一元多项式的 Delta 判别式</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20231018-discriminant/</link>
  <description><![CDATA[ 




<section id="e-基m-基与-p-基" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <img src="https://latex.codecogs.com/png.latex?e">-基、<img src="https://latex.codecogs.com/png.latex?m">-基与 <img src="https://latex.codecogs.com/png.latex?p">-基</h1>
<section id="整数分拆" class="level3">
<h3 class="anchored" data-anchor-id="整数分拆">整数分拆</h3>
<p>设非负整数数列 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda%20:=%20(%5Clambda_1,%20%5Clambda_2,%20%5Cdots)"> 只有有限项非零且（不严格）单调递减．定义长度 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20L(%5Cboldsymbol%5Clambda)"> 为其非零项元素个数；定义 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20S(%5Cboldsymbol%5Clambda)"> 为其非零项元素之和．此时称 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda"> 是整数 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20S(%5Cboldsymbol%5Clambda)"> 的一个长度为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20L(%5Cboldsymbol%5Clambda)"> 的<em>分拆</em>．</p>
<p>由于分拆只有有限项非零，对大于等于 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20L(%5Cboldsymbol%5Clambda)"> 的非负整数 <img src="https://latex.codecogs.com/png.latex?k">，我们也常省略从第 <img src="https://latex.codecogs.com/png.latex?k+1"> 项开始的全为 <img src="https://latex.codecogs.com/png.latex?0"> 的项，将 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda"> 直接记为长度为 <img src="https://latex.codecogs.com/png.latex?k"> 的非负整数数组 <img src="https://latex.codecogs.com/png.latex?(%5Clambda_1,%20%5Clambda_2,%20%5Cdots,%20%5Clambda_k)">．</p>
<p>Ferrers diagram 和 Young diagram 是图示分拆的常见方法．</p>
<p>通过沿主对角线翻转分拆的 Ferrers diagram 或 Young diagram，可以定义<em>分拆的转置</em>．分拆 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> 的转置记为 <img src="https://latex.codecogs.com/png.latex?%5Clambda%5E%5Cmathrm%7BT%7D">．转置后分拆的长度变为原分拆的首项，而首项变为原分拆的长度．</p>
</section>
<section id="单项对称多项式" class="level3">
<h3 class="anchored" data-anchor-id="单项对称多项式">单项对称多项式</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?n"> 是正整数，<img src="https://latex.codecogs.com/png.latex?K"> 是一个域．记 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20x%20:=%20(x_1,%5Cdots,x_n)">．设 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda%20:=%20(%5Clambda_1,%20%5Clambda_2,%20%5Cdots%20%5Clambda_n)"> 是长度不超过 <img src="https://latex.codecogs.com/png.latex?n"> 的一个分拆．</p>
<p>定义 <img src="https://latex.codecogs.com/png.latex?n"> 元多项式环 <img src="https://latex.codecogs.com/png.latex?K%5B%5Cboldsymbol%20x%5D"> 上的关于分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda"> 的<em>单项对称多项式</em>（monomial symmetric polynomial）<img src="https://latex.codecogs.com/png.latex?m_%7B%5Cboldsymbol%5Clambda%7D(%5Cboldsymbol%20x)"> 为各项系数为 <img src="https://latex.codecogs.com/png.latex?1"> 的含有单项式 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20x%5E%7B%5Cboldsymbol%5Clambda%7D%20:=%20x_1%5E%7B%5Clambda_1%7D%20x_2%5E%7B%5Clambda_2%7D%20%5Cdots%20x_n%5E%7B%5Clambda_n%7D"> 的项数最少的对称多项式．</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?m_%7B(2,1,0)%7D(x_1,x_2,x_3)%20=%20x_1%5E2%20x_2%20+%20x_1%5E2%20x_3%20+%20x_1%20x_2%5E2%20+%20x_1%20x_3%5E2%20+%20x_2%5E2%20x_3%20+%20x_2%20x_3%5E2"></li>
<li><img src="https://latex.codecogs.com/png.latex?m_%7B(2,2,1)%7D(x_1,x_2,x_3)%20=%20x_1%5E2%20x_2%5E2%20x_3%20+%20x_1%5E2%20x_2%20x_3%5E2%20+%20x_1%20x_2%5E2%20x_3%5E2"></li>
</ul>
<p>易见 <img src="https://latex.codecogs.com/png.latex?m_%7B%5Cboldsymbol%5Clambda%7D(%5Cboldsymbol%20x)"> 是次数为 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20S(%5Cboldsymbol%5Clambda)"> 的齐次（homogeneous）多项式．全体单项对称多项式构成 <img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式环 <img src="https://latex.codecogs.com/png.latex?%5CLambda_n%20%5Csubset%20K%5B%5Cboldsymbol%20x%5D"> 作为 <img src="https://latex.codecogs.com/png.latex?K"> 上线性空间的一组基底．</p>
</section>
<section id="单项对称多项式-1" class="level3">
<h3 class="anchored" data-anchor-id="单项对称多项式-1">单项对称多项式</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-mono-term-count" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 1</strong></span> 对一给定的长度不超过 <img src="https://latex.codecogs.com/png.latex?n"> 的分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda%20:=%20(%5Clambda_1,%20%5Clambda_2,%20%5Cdots%20%5Clambda_n)">，<img src="https://latex.codecogs.com/png.latex?n"> 元单项对称多项式 <img src="https://latex.codecogs.com/png.latex?m_%5Clambda(%5Cboldsymbol%20x)"> 共有多少项？</p>
</div>
</div>
</div>
</div>
<p>在计数时根据分拆中重复项的分布情况进行消序．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-lambda-dim" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 2</strong></span> <img src="https://latex.codecogs.com/png.latex?n"> 元 <img src="https://latex.codecogs.com/png.latex?d"> 次单项对称多项式共有多少种可能的构型？设 <img src="https://latex.codecogs.com/png.latex?%5CLambda_n%5E%7B(d)%7D%20%5Csubset%20%5CLambda_n"> 由全体至多 <img src="https://latex.codecogs.com/png.latex?d"> 次的 <img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式构成，其作为 <img src="https://latex.codecogs.com/png.latex?K"> 上线性空间的维数是多少？</p>
</div>
</div>
</div>
</div>
<p>该问题等价于求满足 <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20S(%5Cboldsymbol%5Clambda)%20=%20d">，<img src="https://latex.codecogs.com/png.latex?%5Cmathcal%20L(%5Cboldsymbol%5Clambda)%20%5Cleq%20n"> 的所有可能分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda"> 的数量，也即“将 <img src="https://latex.codecogs.com/png.latex?d"> 个无标号球放入 <img src="https://latex.codecogs.com/png.latex?n"> 个可空置的无标号盒”的可行方案数．</p>
</section>
<section id="基本对称多项式" class="level3">
<h3 class="anchored" data-anchor-id="基本对称多项式">基本对称多项式</h3>
<p><img src="https://latex.codecogs.com/png.latex?n"> 元多项式环 <img src="https://latex.codecogs.com/png.latex?K%5B%5Cboldsymbol%20x%5D"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 个<em>基本对称多项式</em>（elementary symmetric polynomial）定义为 <img src="https://latex.codecogs.com/png.latex?%0Ae_k(x_1,%5Cdots,x_n)%20:=%20%5Csum_%7B1%20%5Cleq%20i_1%20%3C%20i_2%20%5Cdots%20%3C%20i_k%20%5Cleq%20n%7D%20x_%7Bi_1%7D%20x_%7Bi_2%7D%20%5Cdots%20x_%7Bi_k%7D,%20%5Cquad%20k%20=%201,2,%5Cdots,%20n%0A"> 使用单项对称多项式的记号，也可记为 <img src="https://latex.codecogs.com/png.latex?%0Ae_k(%5Cboldsymbol%20x)%20:=%20m_%7B%5Cboldsymbol%5Clambda_k%7D%20(%5Cboldsymbol%20x)%0A"> 其中分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda_k%20:=%20(1,%5Cdots,1,0,%5Cdots)"> 的前 <img src="https://latex.codecogs.com/png.latex?k"> 项为 <img src="https://latex.codecogs.com/png.latex?1">，其余项皆为 <img src="https://latex.codecogs.com/png.latex?0">．</p>
<p>设分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda%20:=%20(%5Clambda_1,%5Clambda_2,%5Cdots)"> 满足 <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%5Cleq%20n,%20%5Cquad%20%5Cforall%20i%20%5Cin%20%5Cmathbb%20N_+">．我们记 <img src="https://latex.codecogs.com/png.latex?e_%7B%5Cboldsymbol%5Clambda%7D(%5Cboldsymbol%20x)%20:=%20e_%7B%5Clambda_1%7D(%5Cboldsymbol%20x)%20e_%7B%5Clambda_2%7D(%5Cboldsymbol%20x)%20%5Cdots%20e_%7B%5Clambda_%7B%5Cmathcal%20L(%5Cboldsymbol%5Clambda)%7D%7D(%5Cboldsymbol%20x)">．</p>
</section>
<section id="基本对称多项式-1" class="level3">
<h3 class="anchored" data-anchor-id="基本对称多项式-1">基本对称多项式</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-e-decomp" class="theorem">
<p><span class="theorem-title"><strong>定理 1 (对称多项式基本定理)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?f(%5Cboldsymbol%20x)"> 是域 <img src="https://latex.codecogs.com/png.latex?K"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式，则存在唯一的 <img src="https://latex.codecogs.com/png.latex?g(%5Cboldsymbol%20x)%20%5Cin%20K%5B%5Cboldsymbol%20x%5D">，使得 <img src="https://latex.codecogs.com/png.latex?%0Af(%5Cboldsymbol%20x)%20=%20g(e_1(%5Cboldsymbol%20x),%5Cdots,e_n(%5Cboldsymbol%20x))%0A"></p>
</div>
</div>
</div>
</div>
<p>该定理对交换环上的对称多项式仍然成立．这意味着若 <img src="https://latex.codecogs.com/png.latex?f"> 是整系数对称多项式，则 <img src="https://latex.codecogs.com/png.latex?g"> 也是整系数多项式．</p>
<p>在定理的存在性证明中，为消去首项对应的单项对称多项式 <img src="https://latex.codecogs.com/png.latex?m_%7B%5Cboldsymbol%5Clambda%7D(%5Cboldsymbol%20x)">，我们构造的若干个基本对称多项式的乘积恰为 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20e_%7B%5Cboldsymbol%5Clambda%5E%5Cmathrm%7BT%7D%7D">．</p>
<p>考察全体满足 <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%5Cleq%20n,%20%5Cquad%20%5Cforall%20i%20%5Cin%20%5Cmathbb%20N_+"> 的分拆 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%5Clambda"> 对应的 <img src="https://latex.codecogs.com/png.latex?e_%7B%5Cboldsymbol%5Clambda%7D(%5Cboldsymbol%20x)">，它们构成了 <img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式环 <img src="https://latex.codecogs.com/png.latex?%5CLambda_n"> 作为 <img src="https://latex.codecogs.com/png.latex?K"> 上线性空间的另一组基底．</p>
</section>
<section id="幂和对称多项式" class="level3">
<h3 class="anchored" data-anchor-id="幂和对称多项式">幂和对称多项式</h3>
<p><img src="https://latex.codecogs.com/png.latex?n"> 元多项式环 <img src="https://latex.codecogs.com/png.latex?K%5B%5Cboldsymbol%20x%5D"> 上的<em>幂和对称多项式</em>（power sum symmetric polynomial）定义为 <img src="https://latex.codecogs.com/png.latex?%0Ap_k(x_1,%5Cdots,x_n)%20:=%20x_1%5Ek%20+%20x_2%5Ek%20+%20%5Cdots%20+%20x_n%5Ek,%5Cquad%20k%20%5Cin%20%5Cmathbb%20N%0A"> 使用单项对称多项式的记号，也可记为 <img src="https://latex.codecogs.com/png.latex?%0Ap_k(%5Cboldsymbol%20x)%20:=%20m_%7B(k,0,0,%5Cdots)%7D%0A"> 特别的，<img src="https://latex.codecogs.com/png.latex?p_0(%5Cboldsymbol%20x)%20=%20n">．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-p-decomp" class="theorem">
<p><span class="theorem-title"><strong>定理 2</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Q%20%5Csubset%20K%20%5Csubset%20%5Cmathbb%20C"> 是数域，设 <img src="https://latex.codecogs.com/png.latex?f(%5Cboldsymbol%20x)"> 是域 <img src="https://latex.codecogs.com/png.latex?K"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式，则存在唯一的 <img src="https://latex.codecogs.com/png.latex?g(%5Cboldsymbol%20x)%20%5Cin%20K%5B%5Cboldsymbol%20x%5D">，使得 <img src="https://latex.codecogs.com/png.latex?f(%5Cboldsymbol%20x)%20=%20g(p_1(%5Cboldsymbol%20x),%5Cdots,p_n(%5Cboldsymbol%20x))">．</p>
</div>
</div>
</div>
</div>
<p>一般地，结论对特征为 <img src="https://latex.codecogs.com/png.latex?0"> 的域 <img src="https://latex.codecogs.com/png.latex?K"> 也成立．</p>
</section>
<section id="幂和对称多项式-1" class="level3">
<h3 class="anchored" data-anchor-id="幂和对称多项式-1">幂和对称多项式</h3>
<p>以下定理递推地给出了幂和对称多项式 <img src="https://latex.codecogs.com/png.latex?p_1,%5Cdots,p_n"> 与基本对称多项式 <img src="https://latex.codecogs.com/png.latex?e_1,%5Cdots,e_n"> 间的关系．定理&nbsp;2 的存在性部分可由这一定理给出．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-newton" class="theorem">
<p><span class="theorem-title"><strong>定理 3 (Newton’s Identities)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ap_k%20&amp;=%20%5Csum_%7Bi=1%7D%5E%7Bk-1%7D%20(-1)%5E%7Bi-1%7D%20e_i%20p_%7Bk-i%7D%20+%20(-1)%5E%7Bk-1%7D%20k%20e_k%20&amp;%20k%20&amp;=%201,2,%5Cdots,n%20%5C%5C%0Ap_k%20&amp;=%20%5Csum_%7Bi=1%7D%5En%20(-1)%5E%7Bi-1%7D%20e_i%20p_%7Bk-i%7D%20&amp;%20k&amp;%3En%20%5C%5C%0Ak%20e_k%20&amp;=%20%5Csum_%7Bi=1%7D%5Ek%20(-1)%5E%7Bi-1%7D%20p_%7Bi%7D%20e_%7Bk-i%7D%20&amp;%20k%20&amp;=%201,2,%5Cdots,n%20%5C%5C%0A0%20&amp;=%20%5Csum_%7Bi=1%7D%5En%20(-1)%5E%7Bi-1%7D%20p_%7Bi%7D%20e_%7Bk-i%7D%20&amp;%20k%20&amp;%3E%20n%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
</section>
<section id="其它基底" class="level3">
<h3 class="anchored" data-anchor-id="其它基底">其它基底</h3>
<p>完全齐次对称多项式（Complete homogeneous symmetric polynomials）、Schur 多项式……</p>
<p>本节主要参考 <span class="citation" data-cites="wp_sympoly wp_e-basis wp_p-basis wp_newton">[1]–[4]</span>．</p>
</section>
</section>
<section id="delta-判别式" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Delta 判别式</h1>
<section id="vietas-formulas" class="level3">
<h3 class="anchored" data-anchor-id="vietas-formulas">Vieta’s formulas</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-vieta" class="theorem">
<p><span class="theorem-title"><strong>定理 4 (Vieta’s formulas)</strong></span> 设数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上 <img src="https://latex.codecogs.com/png.latex?n"> 次首一多项式（monic polynomial） <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20:=%20x%5En%20+%20a_%7Bn-1%7D%20x%5E%7Bn-1%7D%20+%20%5Cdots%20+%20a_0%20=%20(x-c_1)(x-c_2)%5Cdots(x-c_n)%0A"> 其 <img src="https://latex.codecogs.com/png.latex?n"> 个复根分别为 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20c%20:=%20(c_1,%20c_2,%5Cdots,c_n)">，则 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的系数可由关于根的 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?n"> 元基本对称多项式表示 <img src="https://latex.codecogs.com/png.latex?%0Aa_%7Bn-k%7D%20=%20e_k(-%5Cboldsymbol%20c)%20=%20(-1)%5Ek%20%5Csum_%7B1%20%5Cleq%20i_1%20%3C%20%5Cdots%20%3C%20i_k%20%5Cleq%20n%7D%20c_%7Bi_1%7D%20c_%7Bi_2%7D%20%5Cdots%20c_%7Bi_k%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?k%20=%201,2,%5Cdots,n">．特别的 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Aa_0%20&amp;=%20e_n(-%5Cboldsymbol%20c)%20=%20(-1)%5En%20c_1%20c_2%20%5Cdots%20c_n%20%5C%5C%0Aa_%7Bn-1%7D%20&amp;=%20e_1(-%5Cboldsymbol%20c)%20=%20-(c_1%20+%20c_2%20+%20%5Cdots%20+%20c_n)%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
</section>
<section id="vieta-定理与对称多项式基本定理" class="level3">
<h3 class="anchored" data-anchor-id="vieta-定理与对称多项式基本定理">Vieta 定理与对称多项式基本定理</h3>
<ul>
<li><p>即使尚未获知多项式 <img src="https://latex.codecogs.com/png.latex?n"> 个复根 <img src="https://latex.codecogs.com/png.latex?c_1,%5Cdots,c_n"> 的具体取值，我们也能通过已知的多项式系数 <img src="https://latex.codecogs.com/png.latex?a_0,%5Cdots,a_%7Bn-1%7D"> 获知 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?n"> 元基本对称多项式在根处的取值．</p></li>
<li><p>对称多项式基本定理指出，任何对称多项式都可被（唯一）表示为关于 <img src="https://latex.codecogs.com/png.latex?n"> 个基本对称多项式的一个多项式．</p></li>
<li><p>仅需知晓多项式的系数，就可获得任意给定对称多项式在根处的取值．</p></li>
<li><p>目标：构造一个（数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上的）<img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式，使得能通过代入求值的方式，快速检测 <img src="https://latex.codecogs.com/png.latex?n"> 个复数是否两两不同．</p></li>
</ul>
</section>
<section id="vandermonde-行列式" class="level3">
<h3 class="anchored" data-anchor-id="vandermonde-行列式">Vandermonde 行列式</h3>
<p>考察作为（数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上）<img src="https://latex.codecogs.com/png.latex?n"> 元多项式的 Vandermonde 行列式 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A%5Cdet%20V%20&amp;:=%20%5Cdet%20%5Cbegin%7Bpmatrix%7D%20x_j%5E%7Bi-1%7D%20%5Cend%7Bpmatrix%7D_%7Bi=1,j=1%7D%5E%7Bn,n%7D%20%5C%5C%0A&amp;=%0A%5Cdet%20%5Cbegin%7Bpmatrix%7D%0A1%20%20%20%20%20%20%20&amp;%201%20%20%20%20%20&amp;%20%5Cdots%20&amp;%201%20%20%20%20%20%5C%5C%0Ax_1%20%20%20%20%20&amp;%20x_2%20%20%20&amp;%20%5Cdots%20&amp;%20x_n%20%20%20%5C%5C%0A%5Cvdots%20%20&amp;%20%5Cvdots&amp;%20%5Cddots&amp;%20%5Cvdots%5C%5C%0Ax_1%5E%7Bn-1%7D%20&amp;%20x_2%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20x_n%5E%7Bn-1%7D%20%20%20%0A%5Cend%7Bpmatrix%7D%20=%20%5Cprod_%7B1%20%5Cleq%20i%20%3C%20j%20%5Cleq%20n%7D%20(x_j%20-%20x_i)%0A%5Cend%7Bsplit%7D%0A"> 它是否可用于判定重根？它是对称多项式吗？</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span><img src="https://latex.codecogs.com/png.latex?%5Cdet%20V"> 是一个斜对称多项式．事实上，<img src="https://latex.codecogs.com/png.latex?%5Cdet%20V"> 与所有对称多项式的乘积构成了全体斜对称多项式（alternating polynomials）．</p>
</div>
</section>
<section id="判别式" class="level3">
<h3 class="anchored" data-anchor-id="判别式">判别式</h3>
<p>设（数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上的）<img src="https://latex.codecogs.com/png.latex?n"> 元对称多项式 <img src="https://latex.codecogs.com/png.latex?%0AD(x_1,%5Cdots,x_n)%20:=%20(%5Cdet%20V)%5E2%20=%20%5Cprod_%7B1%20%5Cleq%20i%20%3C%20j%20%5Cleq%20n%7D%20(x_j%20-%20x_i)%5E2%0A"> 称其为（数域 <img src="https://latex.codecogs.com/png.latex?K"> 上）一元 <img src="https://latex.codecogs.com/png.latex?n"> 次首一多项式的<em>判别式</em>（Discriminant）．当代入的 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20x%20:=%20(x_1,%5Cdots,x_n)%20%5Csubset%20%5Cmathbb%20C"> 互不相同时，<img src="https://latex.codecogs.com/png.latex?D(%5Cboldsymbol%20x)%20%5Cneq%200">；否则 <img src="https://latex.codecogs.com/png.latex?D(%5Cboldsymbol%20x)%20=%200">．</p>
<p>根据对称多项式基本定理，存在唯一数域 <img src="https://latex.codecogs.com/png.latex?K"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 元多项式 <img src="https://latex.codecogs.com/png.latex?d">，使得 <img src="https://latex.codecogs.com/png.latex?d(e_1(%5Cboldsymbol%20x),%5Cdots,e_n(%5Cboldsymbol%20x))%20=%20D(%5Cboldsymbol%20x)">．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-discriminant" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 1</strong></span> 数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 次首一多项式 <img src="https://latex.codecogs.com/png.latex?f(x)%20:=%20x%5En%20+%20a_%7Bn-1%7D%20x%5E%7Bn-1%7D%20+%20%5Cdots%20+%20a_0"> 在复数域中有重根的充分必要条件是 <img src="https://latex.codecogs.com/png.latex?d(a_%7Bn-1%7D,%5Cdots,a_0)%20=%200">．</p>
</div>
</div>
</div>
</div>
<p>这是因为 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的 <img src="https://latex.codecogs.com/png.latex?n"> 个复根 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20c%20:=%20(c_1,%5Cdots,c_n)"> 满足 <img src="https://latex.codecogs.com/png.latex?%0AD(-%5Cboldsymbol%20c)%20=%20d(e_1(-%5Cboldsymbol%20c),%5Cdots,e_n(-%5Cboldsymbol%20c))%20=%20d(a_%7Bn-1%7D,%5Cdots,a_0)%0A"></p>
</section>
<section id="判别式-1" class="level3">
<h3 class="anchored" data-anchor-id="判别式-1">判别式</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-2-discriminant" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 3</strong></span> 写出数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上一元二次多项式 <img src="https://latex.codecogs.com/png.latex?x%5E2%20+%20bx%20+%20c"> 的判别式．</p>
</div>
</div>
</div>
</div>
<p>对次数更高的方程，直接使用消首项方法求解判别式 <img src="https://latex.codecogs.com/png.latex?D(%5Cboldsymbol%20x)"> 在基本对称多项式下的表示 <img src="https://latex.codecogs.com/png.latex?d(e_1,%5Cdots,e_n)"> 将变得相当繁琐．下面利用判别式与 Vandermonde 行列式的关系得到另一种分解方法．</p>
</section>
<section id="另一分解方法" class="level3">
<h3 class="anchored" data-anchor-id="另一分解方法">另一分解方法</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AD(%5Cboldsymbol%20x)%20&amp;=%20(%5Cdet%20V)%5E2%20=%20%5Cdet(V%20V%5ET)%20%5C%5C%0A&amp;=%20%5Cdet%20(%5Cbegin%7Bpmatrix%7D%0A1%20%20%20%20%20%20%20&amp;%201%20%20%20%20%20&amp;%20%5Cdots%20&amp;%201%20%20%20%20%20%5C%5C%0Ax_1%20%20%20%20%20&amp;%20x_2%20%20%20&amp;%20%5Cdots%20&amp;%20x_n%20%20%20%5C%5C%0A%5Cvdots%20%20&amp;%20%5Cvdots&amp;%20%5Cddots&amp;%20%5Cvdots%5C%5C%0Ax_1%5E%7Bn-1%7D%20&amp;%20x_2%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20x_n%5E%7Bn-1%7D%20%20%20%0A%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%0A1%20%20%20%20%20%20%20&amp;%20x_1%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20x_1%5E%7Bn-1%7D%20%5C%5C%0A1%20%20%20%20%20%20%20&amp;%20x_2%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20x_2%5E%7Bn-1%7D%20%5C%5C%0A%5Cvdots%20%20&amp;%20%5Cvdots&amp;%20%5Cddots%20%20%20%20&amp;%20%5Cvdots%20%20%20%20%5C%5C%0A1%20%20%20%20%20%20%20&amp;%20x_n%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20x_n%5E%7Bn-1%7D%0A%5Cend%7Bpmatrix%7D)%20%5C%5C%0A&amp;=%20%5Cdet%20%5Cbegin%7Bpmatrix%7D%0An%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20&amp;%20p_1(%5Cboldsymbol%20x)%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20p_%7Bn-1%7D(%5Cboldsymbol%20x)%20%20%20%5C%5C%0Ap_1(%5Cboldsymbol%20x)%20%20%20%20%20&amp;%20p_2(%5Cboldsymbol%20x)%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20p_n(%5Cboldsymbol%20x)%20%20%20%20%20%20%20%5C%5C%0A%5Cvdots%20%20%20%20%20%20%20%20%20%20&amp;%20%5Cvdots%20%20%20%20%20%20%20%20&amp;%20%5Cddots%20%20%20%20&amp;%20%5Cvdots%20%20%20%20%20%20%20%20%20%20%20%20%5C%5C%0Ap_%7Bn-1%7D(%5Cboldsymbol%20x)%20&amp;%20p_n(%5Cboldsymbol%20x)%20%20%20&amp;%20%5Cdots%20%20%20%20%20&amp;%20p_%7B2n-2%7D(%5Cboldsymbol%20x)%0A%5Cend%7Bpmatrix%7D%0A=%20%5Cdet%20%5Cbegin%7Bpmatrix%7D%20p_%7Bi+j-2%7D(%5Cboldsymbol%20x)%20%5Cend%7Bpmatrix%7D_%7Bi=1,j=1%7D%5E%7Bn,n%7D%0A%5Cend%7Baligned%7D%0A"> 而由 Newton’s Identities，幂和对称多项式 <img src="https://latex.codecogs.com/png.latex?p_k(%5Cboldsymbol%20x)"> 可较容易地递推分解为基本对称多项式的多项式组合，故我们找到了分解 <img src="https://latex.codecogs.com/png.latex?D(%5Cboldsymbol%20x)"> 的一种更易操作的方法．</p>
</section>
<section id="另一分解方法-1" class="level3">
<h3 class="anchored" data-anchor-id="另一分解方法-1">另一分解方法</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-3-discriminant" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 4</strong></span> 写出数域 <img src="https://latex.codecogs.com/png.latex?K%20%5Csubset%20%5Cmathbb%20C"> 上不完全三次多项式 <img src="https://latex.codecogs.com/png.latex?x%5E3%20+%20bx%20+%20c"> 的判别式．</p>
</div>
</div>
</div>
</div>
<p>本节主要参考 <span class="citation" data-cites="qiu-algebra lan-algebra wp_partition wp_alternating">[5]–[8]</span>．</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-wp_sympoly" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Wikipedia, <span>《Symmetric polynomial》</span>. <a href="https://en.wikipedia.org/wiki/Symmetric_polynomial" class="uri">https://en.wikipedia.org/wiki/Symmetric_polynomial</a>.</div>
</div>
<div id="ref-wp_e-basis" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Wikipedia, <span>《Elementary symmetric polynomial》</span>. <a href="https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial" class="uri">https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial</a>.</div>
</div>
<div id="ref-wp_p-basis" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">Wikipedia, <span>《Power sum symmetric polynomial》</span>. <a href="https://en.wikipedia.org/wiki/Power_sum_symmetric_polynomial" class="uri">https://en.wikipedia.org/wiki/Power_sum_symmetric_polynomial</a>.</div>
</div>
<div id="ref-wp_newton" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">Wikipedia, <span>《Newton’s identities》</span>. <a href="https://en.wikipedia.org/wiki/Newton%27s_identities" class="uri">https://en.wikipedia.org/wiki/Newton%27s_identities</a>.</div>
</div>
<div id="ref-qiu-algebra" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">丘维声, <span>《高等代数&nbsp;下册》</span>, 3 本北京: 高等教育出版社, 2015, 页 57–66.</div>
</div>
<div id="ref-lan-algebra" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">蓝以中, <span>《高等代数简明教程（下册）》</span>, 2 本北京: 北京大学出版社, 2007, 页 213–217.</div>
</div>
<div id="ref-wp_partition" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">Wikipedia, <span>《Partition (number theory)》</span>. <a href="https://en.wikipedia.org/wiki/Partition_(number_theory)" class="uri">https://en.wikipedia.org/wiki/Partition_(number_theory)</a>.</div>
</div>
<div id="ref-wp_alternating" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">Wikipedia, <span>《Alternating polynomial》</span>. <a href="https://en.wikipedia.org/wiki/Alternating_polynomial" class="uri">https://en.wikipedia.org/wiki/Alternating_polynomial</a>.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <category>讲稿</category>
  <category>slide</category>
  <guid>https://blog.sun123zxy.top/posts/20231018-discriminant/</guid>
  <pubDate>Tue, 17 Oct 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>A Convolution-Oriented FFT Tutorial</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230928-dft/</link>
  <description><![CDATA[ 




<section id="forewords" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Forewords</h1>
<section id="卷积但不止卷积---fft-漫谈" class="level3">
<h3 class="anchored" data-anchor-id="卷积但不止卷积---fft-漫谈">卷积，但不止卷积 - FFT 漫谈</h3>
<ul>
<li>先有 FT，再有 DFT，才有 FFT</li>
<li>时频转换是最初的用途</li>
<li>发现单位根优秀性质，James Cooley, John Tukey 发明现代 FFT 加速 DFT，但此前相似的发现早已有之</li>
<li>后来将 DFT 与卷积定理联系，FFT 才被用于计算多项式乘法</li>
<li>复数运算精度误差推动了 NTT 的发展</li>
<li>应用：任何需要频率和卷积的地方．频谱、滤波器、音乐、雷达、图像处理……</li>
<li>OI/XCPC 中主要关心卷积</li>
</ul>
</section>
<section id="推荐食用方法" class="level3">
<h3 class="anchored" data-anchor-id="推荐食用方法">推荐食用方法</h3>
<ul>
<li><p>初步要求</p>
<ul>
<li>知道 DFT、FFT 可用于快速计算多项式卷积</li>
<li>掌握 FFT 加速 DFT 计算的原理和实现</li>
<li>会应用结论改动 FFT 加速 NTT 计算</li>
<li>见识一些卷积解决的基本问题，初步了解生成函数在组合计数中的应用</li>
<li>题目可选择性完成，请多花时间消化原理和思想</li>
</ul></li>
<li><p>学有余力 / 集训后继续消化</p>
<ul>
<li>系统学习生成函数</li>
<li>实现多项式全家桶</li>
<li>对原理感兴趣的同学可对数学部分做进一步研究．本讲内容是线性代数、抽象代数、数论等多领域的综合应用．欢迎讨论．</li>
<li>学习集合幂级数相关知识点（FMT，FWT，……），体会其思想与 FFT 的同与异</li>
<li>学习 FFT 在信号、频谱等非算法竞赛向实际问题中的应用</li>
</ul></li>
<li><p>Learn for fun :)</p></li>
</ul>
</section>
<section id="记号说明" class="level3">
<h3 class="anchored" data-anchor-id="记号说明">记号说明</h3>
<ul>
<li><p>记 <img src="https://latex.codecogs.com/png.latex?%5Bn%5D%20=%20%5C%7B%200,1,%5Cdots,n-1%20%5C%7D">，此时可用 <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20%5Bn%5D"> 代替下标取值范围 <img src="https://latex.codecogs.com/png.latex?k=0,1,%5Cdots,n-1"> 的记法．</p>
<ul>
<li>集合论中已定义 <img src="https://latex.codecogs.com/png.latex?n%20=%20%5C%7B%200,1,%5Cdots,n-1%20%5C%7D">，这里的中括号是为了强调其集合含义．</li>
</ul></li>
<li><p>使用 Iverson 括号约定：设 <img src="https://latex.codecogs.com/png.latex?P"> 是一个命题，记 <img src="https://latex.codecogs.com/png.latex?%0A%5BP%5D%20:=%20%5Cbegin%7Bcases%7D%0A%20%20%20%20%20%20%20%201%20&amp;%20%5Ctext%7B$P$%20is%20true%7D%20%5C%5C%0A%20%20%20%20%20%20%20%200%20&amp;%20%5Ctext%7Botherwise%7D%0A%20%20%20%20%20%20%20%20%5Cend%7Bcases%7D%0A"></p></li>
<li><p>多项式的规模定义为多项式的次数加一．特别的，零多项式的规模为 <img src="https://latex.codecogs.com/png.latex?0">．</p>
<ul>
<li>以后会混用 <img src="https://latex.codecogs.com/png.latex?n-1"> 次多项式和规模为 <img src="https://latex.codecogs.com/png.latex?n"> 的多项式的说法．</li>
</ul></li>
</ul>
</section>
</section>
<section id="fftntt-in-a-nutshell" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> FFT/NTT in a nutshell</h1>
<section id="fft" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="fft"><span class="header-section-number">2.1</span> FFT</h2>
<section id="多项式卷积" class="level3">
<h3 class="anchored" data-anchor-id="多项式卷积">多项式卷积</h3>
<p>给定两个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20x%5Ek,%5Cquad%20B(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20b_k%20x%5Ek%0A"> 如何快速计算两者的卷积，即它们相乘得到的多项式的系数？ <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20%20%20%20%20(A*B)(x)%20=%20A(x)B(x)%20&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20a_i%20x%5Ei%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20b_j%20x%5Ej%20%5C%5C%0A%20%20%20%20%20%20%20%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7B2n-2%7D%20x%5Ek%20%5Csum_%7Bi+j=k%7D%20a_i%20b_j%0A%20%20%20%20%5Cend%7Baligned%7D%0A"> 上式给出了 <img src="https://latex.codecogs.com/png.latex?O(n%5E2)"> 的朴素做法．</p>
</section>
<section id="系数---点值---系数" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="系数---点值---系数">系数 - 点值 - 系数</h3>
<ul>
<li><p>代入任意 <img src="https://latex.codecogs.com/png.latex?x"> 可得到多项式在 <img src="https://latex.codecogs.com/png.latex?x"> 处的点值</p></li>
<li><p>点值意义下的多项式乘法是 <img src="https://latex.codecogs.com/png.latex?O(n)"> 的 <img src="https://latex.codecogs.com/png.latex?%0A(A*B)(x)%20=%20A(x)B(x)%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?n"> 点确定一个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式<sup>1</sup></p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;一种常见的证法是使用 Vandermonde 行列式证明矩阵可逆．后面会介绍多项式环风格的证明．</p></div></div><p>若计算至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式的某 <img src="https://latex.codecogs.com/png.latex?n"> 个点值存在快速算法，而通过多项式的某 <img src="https://latex.codecogs.com/png.latex?n"> 个点值确定原多项式系数亦存在快速算法，就有通过 <img src="https://latex.codecogs.com/png.latex?O(n)"> 的点值乘法加速多项式乘法计算的可能．</p>
</section>
<section id="系数---点值---系数---快速转换" class="level3">
<h3 class="anchored" data-anchor-id="系数---点值---系数---快速转换">系数 - 点值 - 系数 - 快速转换？</h3>
<ul>
<li><p>朴素计算任意指定 <img src="https://latex.codecogs.com/png.latex?n"> 个位置点值需要 <img src="https://latex.codecogs.com/png.latex?O(n%5E2)">．</p></li>
<li><p>Lagrange<span class="citation" data-cites="oiwiki-lagrange">[1]</span> 插值给出了 <img src="https://latex.codecogs.com/png.latex?O(n%5E2)"> 将任意位置 <img src="https://latex.codecogs.com/png.latex?n"> 个点值还原为多项式系数的算法．</p></li>
<li><p>能否选取 <img src="https://latex.codecogs.com/png.latex?n"> 个特殊的点值使系数 - 点值、点值 - 系数的变换支持快速计算？</p></li>
</ul>
</section>
<section id="discrete-fourier-transform" class="level3">
<h3 class="anchored" data-anchor-id="discrete-fourier-transform">Discrete Fourier Transform</h3>
<p>离散傅里叶变换（Discrete Fourier Transform, DFT）接受一个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式的 <img src="https://latex.codecogs.com/png.latex?n"> 个系数，将复数域上的 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?n"> 次单位根代入系数表达式以得到给定多项式的 <img src="https://latex.codecogs.com/png.latex?n"> 个点值． <img src="https://latex.codecogs.com/png.latex?%0Aa_0,a_1,%5Cdots,a_%7Bn-1%7D%20%5Clongrightarrow%20A(1),A(%5Comega_n),%5Cdots,A(%5Comega_n%5E%7Bn-1%7D)%0A"></p>
<p>得益于单位根的特殊运算性质，二者均有被称为快速傅里叶变换（Fast Fourier Transform, FFT）的快速算法．</p>
</section>
<section id="复数域单位根" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="复数域单位根">复数域单位根</h3>
<p>复数域上的 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?n"> 次单位根<sup>2</sup> <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_n%5Ek%20:=%20e%5E%7B%5Cfrac%20%7B2%20%5Cpi%20k%7D%7Bn%7D%20i%7D%20=%20%5Ccos%20%5Cfrac%7B2%20%5Cpi%20k%7D%7Bn%7D%20+%20i%20%5Csin%20%5Cfrac%7B2%20%5Cpi%20k%7D%7Bn%7D,%5Cquad%20k%20%5Cin%20%5Bn%5D%0A"> 是复平面单位圆上的 <img src="https://latex.codecogs.com/png.latex?n"> 等分点，易验证它们是复数域中唯一满足方程 <img src="https://latex.codecogs.com/png.latex?z%5En%20=%201"> 的解．</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;有的文献定义 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20:=%20e%5E%7B-%5Cfrac%20%7B2%20%5Cpi%7D%7Bn%7D%20i%7D">，或是因为信号处理领域常用 IDFT 将信号时域采样数据变为频域信息．事实上，DFT/IDFT 的说法也常有反转，但这只是形式问题．</p></div></div><p>所有单位根模长均为 <img src="https://latex.codecogs.com/png.latex?1">．第 <img src="https://latex.codecogs.com/png.latex?k"> 个单位根的辐角为 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20%7B2%20%5Cpi%20k%7D%7Bn%7D">．复数乘法”模长相乘，辐角相加”的性质告诉我们 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5Ei%20%5Comega_n%5Ej%20=%20%5Comega_n%5E%7Bi+j%7D">．</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em> (Euler’s formula for nerds). </span>Euler 公式 <img src="https://latex.codecogs.com/png.latex?e%5E%7Bit%7D%20=%20%5Ccos%20t%20+%20i%20%5Csin%20t"> 的一种证明可用指数函数的另一定义 <img src="https://latex.codecogs.com/png.latex?%5Cexp%20z%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20(1+%5Cfrac%20z%20n)%5En"> 分析复数处极坐标的极限 <span class="citation" data-cites="euler-formula">[2]</span>．严格来讲，如果三角函数和指数函数都由级数定义 <span class="citation" data-cites="trigonometry">[3]</span>，Euler 公式几乎是显然的．总之，这里仅将 Euler 公式作为一种紧凑的记号使用，细节不做要求．</p>
</div>
</section>
<section id="复数域单位根---三个重要性质" class="level3">
<h3 class="anchored" data-anchor-id="复数域单位根---三个重要性质">复数域单位根 - 三个重要性质<sup>3</sup></h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-cancel" class="theorem">
<p><span class="theorem-title"><strong>定理 1 (消去引理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_%7Bdn%7D%5E%7Bdk%7D%20=%20%5Comega_n%5Ek,%5Cquad%20%5Cforall%20d%20%5Cin%20%5Cmathbb%20N_+%0A"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-half" class="theorem">
<p><span class="theorem-title"><strong>定理 2 (折半引理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%20%5Comega_%7B2n%7D%5E%7B2k%7D%20:%20k%20%5Cin%20%5B2n%5D%20%5Cright%5C%7D%20=%20%5Cleft%5C%7B%20%5Comega_n%5Ek%20:%20k%20%5Cin%20%5Bn%5D%20%5Cright%5C%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>消去 / 折半引理将在 FFT 的推导中使用．</p>
</section>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;这三个引理是《算法导论》<span class="citation" data-cites="algointro">[4]</span> 引入的．</p></div></div><section id="复数域单位根---三个重要性质-1" class="level3">
<h3 class="anchored" data-anchor-id="复数域单位根---三个重要性质-1">复数域单位根 - 三个重要性质</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-summation" class="theorem">
<p><span class="theorem-title"><strong>定理 3 (求和引理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%201%20n%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20=%20%5Bn%20%5Cmid%20i%5D%0A"></p>
</div>
</div>
</div>
</div>
<p>求和引理的证明使用了等比数列求和公式．将在 IDFT 的推导中用到．</p>
</section>
<section id="fast-fourier-transform" class="level3">
<h3 class="anchored" data-anchor-id="fast-fourier-transform">Fast Fourier Transform</h3>
<p>考虑将至多 <img src="https://latex.codecogs.com/png.latex?2n-1"> 次的待变换多项式 <img src="https://latex.codecogs.com/png.latex?A(x)%20=%20%5Csum_%7Bk=0%7D%5E%7B2n-1%7D%20a_k%20x%5Ek"> 奇偶分项两个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式 <img src="https://latex.codecogs.com/png.latex?A(x)%20=%20A_0%20(x%5E2)%20+%20x%20A_1(x%5E2)">，其中 <img src="https://latex.codecogs.com/png.latex?%0AA_0%20(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k%7D%20x%5Ek,%5Cquad%0AA_1%20(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k+1%7D%20x%5Ek%0A"> 代入 <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Comega_%7B2n%7D%5Ek,%5C,%20k%20%5Cin%20%5B2n%5D">，用单位根消去或折半引理（<img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5E%7B2k%7D%20=%20%5Comega_n%5Ek">）得 <img src="https://latex.codecogs.com/png.latex?%0AA(%5Comega_%7B2n%7D%5Ek)%20=%20A_0%20(%5Comega_%7Bn%7D%5Ek)%20+%20%5Comega_%7B2n%7D%5Ek%20A_1%20(%5Comega_%7Bn%7D%5Ek)%0A"> 再用 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5E%7Bn%7D%20=%20-1"> 得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA(%5Comega_%7B2n%7D%5Ek)%20&amp;=%20A_0%20(%5Comega_n%5Ek)%20+%20%5Comega_%7B2n%7D%5Ek%20A_1%20(%5Comega_n%5Ek)%20%5C%5C%0AA(%5Comega_%7B2n%7D%5E%7Bn+k%7D)%20&amp;=%20A_0%20(%5Comega_n%5Ek)%20-%20%5Comega_%7B2n%7D%5Ek%20A_1(%5Comega_n%5Ek)%0A%5Cend%7Baligned%7D%0A,%5Cquad%20k%20%5Cin%20%5Bn%5D%0A"> 原多项式 <img src="https://latex.codecogs.com/png.latex?A(x)"> 规模为 <img src="https://latex.codecogs.com/png.latex?2n"> 的 DFT 转化为规模为 <img src="https://latex.codecogs.com/png.latex?n"> 的 <img src="https://latex.codecogs.com/png.latex?A_0(x)"> 和 <img src="https://latex.codecogs.com/png.latex?A_1(x)"> 的 DFT．递归计算就可得到 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"> 的算法．</p>
</section>
<section id="dft-的矩阵表示" class="level3">
<h3 class="anchored" data-anchor-id="dft-的矩阵表示">DFT 的矩阵表示</h3>
<p>记 <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bgathered%7D%0A%5Cboldsymbol%20a%20=%20%20%5Cbegin%7Bpmatrix%7Da_0%20%5C%5C%20a_1%20%5C%5C%20%5Cvdots%20%5C%5C%20a_%7Bn-1%7D%5Cend%7Bpmatrix%7D,%5Cquad%0AF%20=%20%5Cleft(%20%5Comega_n%5E%7Bij%7D%20%5Cright)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D%20=%20%5Cbegin%7Bpmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A1%20&amp;%20%5Comega_n%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A1%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B(n-1)(n-1)%7D%0A%5Cend%7Bpmatrix%7D%0A%5Cend%7Bgathered%7D%0A"> 则 DFT 的变换结果（给定系数 <img src="https://latex.codecogs.com/png.latex?a_0,a_1,%5Cdots,a_%7Bn-1%7D"> 的多项式在 <img src="https://latex.codecogs.com/png.latex?n"> 个 <img src="https://latex.codecogs.com/png.latex?n"> 次单位根处的点值）可表示为 <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Cboldsymbol%20a%7D%20=%20%5Cbegin%7Bpmatrix%7DA(1)%20%5C%5C%20A(%5Comega_n)%20%5C%5C%20%5Cvdots%20%5C%5C%20A(%5Comega_n%5E%7Bn-1%7D)%5Cend%7Bpmatrix%7D%20=%20F%20%5Cboldsymbol%20a%0A"></p>
</section>
<section id="idft" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="idft">IDFT</h3>
<p>由单位根的消去引理可证，DFT 矩阵 <img src="https://latex.codecogs.com/png.latex?F"> 的逆矩阵为<sup>4</sup> <img src="https://latex.codecogs.com/png.latex?%0AF%5E%7B-1%7D%20=%20%5Cfrac%201%20n%20%5Cleft(%20%5Comega_n%5E%7B-ij%7D%20%5Cright)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D%20=%20%5Cfrac%201%20n%20%5Cbegin%7Bpmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A1%20&amp;%20%5Comega_n%5E%7B-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B-(n-1)%7D%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A1%20&amp;%20%5Comega_n%5E%7B-(n-1)%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B-(n-1)(n-1)%7D%0A%5Cend%7Bpmatrix%7D%0A"> 于是 IDFT 的过程可表示为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cboldsymbol%20a%20%20=%20F%5E%7B-1%7D%20%5Chat%7B%5Cboldsymbol%20a%7D%0A"></p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;这也表明适当归一化后的 DFT 矩阵是一个酉矩阵．</p></div></div><p>故快速计算 IDFT 的方法与 FFT 几乎一致，只需将计算 DFT 时使用的本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 替换为 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5E%7B-1%7D"> 并对最终结果除以 <img src="https://latex.codecogs.com/png.latex?n"> 即可．</p>
</section>
<section id="梳理" class="level3">
<h3 class="anchored" data-anchor-id="梳理">梳理</h3>
<ul>
<li><p>怎么计算卷积？</p>
<ul>
<li>把至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式 <img src="https://latex.codecogs.com/png.latex?A(x)"> 和至多 <img src="https://latex.codecogs.com/png.latex?m-1"> 次的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)"> 写成至多 <img src="https://latex.codecogs.com/png.latex?n+m-2"> 次的多项式（高位补 <img src="https://latex.codecogs.com/png.latex?0">）．为计算 FFT 方便，还要继续补 <img src="https://latex.codecogs.com/png.latex?0"> 至一个大于其次数的 <img src="https://latex.codecogs.com/png.latex?2"> 的幂．</li>
<li>对 <img src="https://latex.codecogs.com/png.latex?A(x)"> 和 <img src="https://latex.codecogs.com/png.latex?B(x)"> 多点求值．</li>
<li>把两个多项式的点值逐点相乘．</li>
<li>多点插值还原 <img src="https://latex.codecogs.com/png.latex?(A*B)(x)"> 的系数．</li>
</ul></li>
<li><p>怎么快速求值？</p>
<ul>
<li>选点选单位根就是 DFT．</li>
<li>消去引理和折半引理使我们可以用 FFT 算法递归地计算 DFT．</li>
<li>推导已经给出了递归的写法，之后还会介绍常数更优的迭代实现．</li>
</ul></li>
<li><p>怎么快速插值？</p>
<ul>
<li>求和引理给出了 DFT 矩阵的逆矩阵．</li>
<li>计算方法很相似，最后逐项除掉一个规模．</li>
</ul></li>
</ul>
</section>
<section id="fft-递归实现---dft-部分" class="level3">
<h3 class="anchored" data-anchor-id="fft-递归实现---dft-部分">FFT 递归实现 - DFT 部分</h3>
<p>方便起见，我们只处理 <img src="https://latex.codecogs.com/png.latex?n"> 为 <img src="https://latex.codecogs.com/png.latex?2"> 的幂的情形．以下 C 风格的代码实现了递归的 DFT 和 IDFT．</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb1-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;complex&gt;</span></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> std<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> complex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> CP<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ll MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> PI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14159265358979323846</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">l</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-6">CP tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> _DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>CP A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[],</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-8">    n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-11">    _DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> _DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-12">    CP w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cos<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>PI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)),</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>sin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>PI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))),</span> wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb1-14">        tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>  k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+</span>wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-15">        tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]-</span>wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-16">        wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>CP A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[],</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-19">    _DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">l</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-20"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="fft-递归实现---卷积部分" class="level3">
<h3 class="anchored" data-anchor-id="fft-递归实现---卷积部分">FFT 递归实现 - 卷积部分</h3>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// alternatively, use std::__lg() in GCC</span></span>
<span id="cb2-2">ll log2ceil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>ll cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span> </span>
<span id="cb2-3">CP A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> ll outC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MXN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb2-4">ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> conv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll inA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[],</span>ll aN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll inB<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[],</span>ll bN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb2-5">    ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">LL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>log2ceil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>aN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>bN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb2-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>aN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>inA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb2-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>bN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>inB<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb2-8">    DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb2-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb2-10">    DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> outC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>round<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">());</span></span>
<span id="cb2-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> outC<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Drawbacks?</p>
<ul>
<li>递归实现慢</li>
<li>临时数组丑</li>
<li>封装性为零</li>
</ul>
</section>
<section id="fft-迭代" class="level3">
<h3 class="anchored" data-anchor-id="fft-迭代">FFT 迭代</h3>
<p>迭代地实现 FFT 不仅在常数上更加优秀，亦更便于使用 C++ 的容器进行封装．这并不困难，只需自底向上模拟 FFT 递归过程即可．</p>
<p>唯一的问题——最底层的顺序？</p>
<p>来观察一轮 <img src="https://latex.codecogs.com/png.latex?2%5E3">-FFT 自顶向下的置换过程 <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bmatrix%7D%0A2%5E3%20&amp;%200/000%20&amp;%201/001%20&amp;%202/010%20&amp;%203/011%20&amp;%204/100%20&amp;%205/101%20&amp;%206/110%20&amp;%207/111%20%5C%5C%0A2%5E2%20&amp;%200/000%20&amp;%202/010%20&amp;%204/100%20&amp;%206/110%20&amp;%201/001%20&amp;%203/011%20&amp;%205/101%20&amp;%207/111%20%5C%5C%0A2%5E1%20&amp;%200/000%20&amp;%204/100%20&amp;%202/010%20&amp;%206/110%20&amp;%201/001%20&amp;%205/101%20&amp;%203/011%20&amp;%207/111%20%5C%5C%0A2%5E0%20&amp;%200/000%20&amp;%204/100%20&amp;%202/010%20&amp;%206/110%20&amp;%201/001%20&amp;%205/101%20&amp;%203/011%20&amp;%207/111%0A%5Cend%7Bmatrix%7D%0A"></p>
<p>你发现了什么？</p>
</section>
<section id="蝶形运算" class="level3">
<h3 class="anchored" data-anchor-id="蝶形运算">蝶形运算</h3>
<p>在计算点值前，<img src="https://latex.codecogs.com/png.latex?2%5En">-FFT 事实上完成了一次 <img src="https://latex.codecogs.com/png.latex?n">-位逆序置换．分解来看，规模为 <img src="https://latex.codecogs.com/png.latex?2%5Ek"> 的层的置换完成了对 <img src="https://latex.codecogs.com/png.latex?2%5E%7Bn-k%7D"> 对应二进制位的分类．</p>
<p>我们有 <img src="https://latex.codecogs.com/png.latex?O(n)"> 的递推方法获得这一置换．</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> spawnrev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb3-2">    rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span></span>
<span id="cb3-4">        rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+((</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;&lt;(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb3-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="fft-迭代实现" class="level3">
<h3 class="anchored" data-anchor-id="fft-迭代实现">FFT 迭代实现</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb4-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>CP A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[],</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// rev[] should be spawned in advance</span></span>
<span id="cb4-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]]);</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// a one-to-one permutation</span></span>
<span id="cb4-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-4">        CP w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cos<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>PI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)),</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>sin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>PI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))),</span> wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-6">            CP wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-7">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb4-8">                CP x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb4-9">                A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-10">                wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-11">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-12">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-13">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">l</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>请自行实现更易用的容器封装版本．</p>
</section>
</section>
<section id="ntt" class="level2 page-columns page-full" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="ntt"><span class="header-section-number">2.2</span> NTT</h2>
<section id="ntt-速成" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="ntt-速成">NTT 速成<sup>5</sup></h3>
<p>FFT 的缺点？浮点数带来的大常数与精度问题．</p>
<p><img src="https://latex.codecogs.com/png.latex?998244353=2%5E%7B23%7D%20%5Ctimes%207%20%5Ctimes%2017%20+%201">，同时是一个质数．</p>
<p>我们指出，在系数和点值模 <img src="https://latex.codecogs.com/png.latex?p=998244353"> 的意义下，当规模 <img src="https://latex.codecogs.com/png.latex?n%20%5Cleq%20p"> 时<sup>6</sup>，至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式仍可由其 <img src="https://latex.codecogs.com/png.latex?n"> 个点值唯一确定，故仍可使用系数-点值-系数的方法求得多项式卷积．</p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;否则只有 <img src="https://latex.codecogs.com/png.latex?p"> 个不同元素的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 中根本取不到 <img src="https://latex.codecogs.com/png.latex?n"> 个不同位置的点值．后面会深入讨论．</p></div></div><p>我们指出，对于满足 <img src="https://latex.codecogs.com/png.latex?n%20%5Cmid%20p-1"> 的 <img src="https://latex.codecogs.com/png.latex?n">，依 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20:=%203%5E%7B%5Cfrac%7Bp-1%7D%7Bn%7D%7D"> 定义的 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 在模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下与复数域中定义的 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 发挥相同的作用，仍可进行规模至多为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B23%7D"> 的 FFT 作为模 <img src="https://latex.codecogs.com/png.latex?p=998244353"> 意义下 NTT 的快速算法．</p>
<p>只需修改单位根定义，把复数运算改为整数取模，就得到了能算 NTT 的 FFT 的实现．</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb5-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> PR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">998244353</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-2">ll w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>PR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,(</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)/(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span></code></pre></div>
</section>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;NTT 原理需较多笔墨，稍后介绍．</p></div></div><section id="fftntt-in-a-nutshell---小结概念区分" class="level3">
<h3 class="anchored" data-anchor-id="fftntt-in-a-nutshell---小结概念区分">FFT/NTT in a nutshell - 小结：概念区分</h3>
<ul>
<li><p>关于 DFT</p>
<ul>
<li>Discrete Fourier Transform, DFT, 离散傅里叶变换</li>
<li>Fast Fourier Transform, FFT, 快速傅里叶变换</li>
<li>FFT 是计算 DFT 的快速算法</li>
</ul></li>
<li><p>关于 NTT</p>
<ul>
<li>Number Theoretic Transform, NTT, 数论变换</li>
<li>FFT 在复数域上的多项式环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BC%7D%5Bx%5D"> 中进行，而 NTT 在模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D_p%5Bx%5D"> 上进行</li>
<li>快速计算 DFT / IDFT, NTT 都用 FFT，故一般不使用”FNTT”的说法</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="applications" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Applications</h1>
<section id="基本应用" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="基本应用"><span class="header-section-number">3.1</span> 基本应用</h2>
<section id="基本应用-1" class="level3">
<h3 class="anchored" data-anchor-id="基本应用-1">基本应用</h3>
<dl>
<dt>大整数乘法</dt>
<dd>
<p>十进制数可拆解为多项式表示，计算卷积后处理进位即可．由于数字最大只是 <img src="https://latex.codecogs.com/png.latex?9">，合理数据范围下卷起来不会爆模数，直接用 NTT 实现即可．</p>
</dd>
<dt>背包计数</dt>
<dd>
<p>两个背包的合并就是多项式卷积．</p>
</dd>
<dt>滤波器</dt>
<dd>
<p>反转多项式的系数数组再做卷积，可以快速得到两个多项式滑动窗口式的内积．</p>
</dd>
<dt>位运算</dt>
<dd>
<p>有些位运算可以写成卷积的形式．模 <img src="https://latex.codecogs.com/png.latex?2"> 意义下”异或”是加法，“与”是乘法，“或”可以通过取反转化为”与”．</p>
</dd>
<dt>字符串</dt>
<dd>
<p>通过巧妙设定字符串距离函数，FFT 可解决更广泛的字符串匹配问题．</p>
</dd>
<dt>值域次数化</dt>
<dd>
<p>当值域较小时，将待计算的值放在多项式次数上统计贡献次数，可以绕开某些极难求解的数值问题．例如 Vandermonde 行列式的快速计算．</p>
</dd>
</dl>
</section>
<section id="基本应用---分治-fft" class="level3">
<h3 class="anchored" data-anchor-id="基本应用---分治-fft">基本应用 - 分治 FFT</h3>
<p>对多个长度相同的多项式的卷积，分治地卷起来可降低时间复杂度．长度不一时，挑小的先卷也可减小常数（用堆维护）．</p>
<p>另有一种 CDQ 风格的分治 FFT．CDQ 长于处理带偏序的二元点对贡献，在处理形如 <img src="https://latex.codecogs.com/png.latex?c_k%20=%20%5Csum_%7Bi%3Ej%7D%20%5Bi+j=k%5D%20a_i%20b_j"> 的带偏序卷积时可以应用．</p>
<p>当卷积的前后项存在依赖关系时，也可使用此法保证处理顺序恰当．然而此类依赖问题往往也可通过解生成函数方程的方法求得封闭形式．</p>
<p>时间复杂度均为 <img src="https://latex.codecogs.com/png.latex?%0AT(n)%20=%202%20T%20%5Cleft(%20%5Cfrac%20n%202%20%5Cright)%20+%20O(n%20%5Clog%20n)%20=%20O(n%20%5Clog%5E2%20n)%0A"></p>
</section>
</section>
<section id="生成函数初步" class="level2 page-columns page-full" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="生成函数初步"><span class="header-section-number">3.2</span> 生成函数初步</h2>
<section id="生成函数初步---导言" class="level3">
<h3 class="anchored" data-anchor-id="生成函数初步---导言">生成函数初步 - 导言</h3>
<p>生成函数是一种对数列的操作技巧．通过将数列表示为多项式或形式幂级数，数列间复杂的和式操作可用简单函数的乘法、复合等运算进行表示，从而大大降低了数列变换技巧的使用门槛．</p>
<p>生成函数在组合数学中应用广泛，且生成函数的部分操作在组合意义下也有较为直观的理解．本节将带大家初窥其中的奥妙．限于篇幅和主讲人能力，我们仅以题带点地讲解，期冀为大家建立构造生成函数的直觉．请感兴趣的同学下来做进一步研究．</p>
<p>熟悉 Taylor 展开的同学或能较快上手此部分内容．</p>
</section>
<section id="ordinary-generating-function" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="ordinary-generating-function">Ordinary Generating Function</h3>
<p>序列 <img src="https://latex.codecogs.com/png.latex?a_n"> 的普通生成函数（Ordinary Generating Function, OGF）定义为其对应的多项式（形式幂级数）<img src="https://latex.codecogs.com/png.latex?A(x)%20=%20%5Csum_%7Bn=0%7D%5E%7B+%5Cinfty%7D%20a_n%20x%5En">．这样书写的目的是为了便于进行数列间的卷积操作．特别的，Taylor 展开（或广义二项式定理）风格的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20%7B1-x%7D%20=%201%20+%20x%20+%20x%5E2%20+%20%5Cdots"> 也是常用技巧之一<sup>7</sup>．</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;多项式求逆等多项式进阶操作，我们后续讲解．</p></div></div><div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-ogf-basic" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 1</strong></span> 写出下列数列的 OGF．下标从 <img src="https://latex.codecogs.com/png.latex?0"> 开始．</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?1,0,0,0%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,1,1,1,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,0,1,0,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,-1,1,-1,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,2,3,4,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,2,4,8,%5Cdots"></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="ogf-组合意义" class="level3">
<h3 class="anchored" data-anchor-id="ogf-组合意义">OGF 组合意义</h3>
<p>OGF 相乘，是背包，是卷积，是两块无标号组合对象的有序拼接．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-ogf-comb" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 2</strong></span> 写出下列计数问题的 OGF，均以 <img src="https://latex.codecogs.com/png.latex?n"> 作为数列的下标．</p>
<ul>
<li>在 <img src="https://latex.codecogs.com/png.latex?m"> 个物品中选出 <img src="https://latex.codecogs.com/png.latex?n"> 个的方案数．</li>
<li>容量为 <img src="https://latex.codecogs.com/png.latex?n"> 的背包装下体积分别为 <img src="https://latex.codecogs.com/png.latex?a_i"> 的 <img src="https://latex.codecogs.com/png.latex?m"> 个物品的方案数．</li>
<li>同上，但每个物品有无限个．</li>
<li><img src="https://latex.codecogs.com/png.latex?n"> 个无标号球放入 <img src="https://latex.codecogs.com/png.latex?r"> 个有标号盒的方案数，要求盒非空．</li>
<li>同上，但盒可空．</li>
<li>将整数 <img src="https://latex.codecogs.com/png.latex?n"> 分拆为若干正整数之和的方案数．</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="exponential-generating-function" class="level3">
<h3 class="anchored" data-anchor-id="exponential-generating-function">Exponential Generating Function</h3>
<p>序列 <img src="https://latex.codecogs.com/png.latex?a_n"> 的指数生成函数（Exponential Generating Function, EGF）定义为 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20=%20%5Csum_%7Bn=0%7D%5E%7B+%5Cinfty%7D%20a_n%20%5Cfrac%20%7Bx%5En%7D%7Bn!%7D%0A"></p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-egf-basic" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 3</strong></span> 写出下列序列的 EGF，下标从 <img src="https://latex.codecogs.com/png.latex?0"> 开始．</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?1,0,0,0,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,1,1,1,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,2,4,8,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?0,1,0,-1,0,1,0,-1,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?1,0,-1,0,1,0,-1,0,%5Cdots"></li>
<li><img src="https://latex.codecogs.com/png.latex?0,1,-1,2!,-3!,4!,%5Cdots"></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="egf-组合意义" class="level3">
<h3 class="anchored" data-anchor-id="egf-组合意义">EGF 组合意义</h3>
<p>观察两个 EGF 的乘积 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA(x)%20B(x)%20&amp;=%20%5Csum_%7Bi=0%7D%5E%7B+%5Cinfty%7D%20a_i%20%5Cfrac%7Bx%5Ei%7D%7Bi!%7D%20%5Csum_%7Bj=0%7D%5E%7B+%5Cinfty%7D%20b_j%20%5Cfrac%7Bx%5Ej%7D%7Bj!%7D%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=0%7D%5E%7B+%5Cinfty%7D%20%5Csum_%7Bj=0%7D%5E%7B+%5Cinfty%7D%20a_i%20b_j%20%5Cfrac%7Bx%5E%7Bi+j%7D%7D%7Bi!%20j!%7D%20%5C%5C%0A&amp;=%20%5Csum_%7Bn=0%7D%5E%7B+%5Cinfty%7D%20%5Csum_%7Bi=0%7D%5En%20a_i%20b_%7Bn-i%7D%20%5Cfrac%7Bx%5En%7D%7Bi!%20(n-i)!%7D%20%5C%5C%0A&amp;=%20%5Csum_%7Bn=0%7D%5E%7B+%5Cinfty%7D%20%5Csum_%7Bi=0%7D%5En%20a_i%20b_%7Bn-i%7D%20%5Cbinom%20n%20i%20%5Cfrac%7Bx%5En%7D%7Bn!%7D%0A%5Cend%7Baligned%7D%0A"> EGF 的乘积，相当于两块有标号组合对象的有序拼接．</p>
</section>
<section id="egf-组合意义-1" class="level3">
<h3 class="anchored" data-anchor-id="egf-组合意义-1">EGF 组合意义</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0AA(x)%20B(x)%20=%20%5Csum_%7Bi=0%7D%5E%7B+%5Cinfty%7D%20a_i%20%5Cfrac%7Bx%5Ei%7D%7Bi!%7D%20%5Csum_%7Bj=0%7D%5E%7B+%5Cinfty%7D%20b_j%20%5Cfrac%7Bx%5Ej%7D%7Bj!%7D%0A=%20%5Csum_%7Bn=0%7D%5E%7B+%5Cinfty%7D%20%5Csum_%7Bi=0%7D%5En%20a_i%20b_%7Bn-i%7D%20%5Cbinom%20n%20i%20%5Cfrac%7Bx%5En%7D%7Bn!%7D"></p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-egf-comb" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 4</strong></span> 写出下列计数问题的 EGF，均以 <img src="https://latex.codecogs.com/png.latex?n"> 作为数列的下标．</p>
<ul>
<li>长度为 <img src="https://latex.codecogs.com/png.latex?n"> 的排列的构型数．</li>
<li>长度为 <img src="https://latex.codecogs.com/png.latex?n"> 的圆排列的构型数．</li>
<li>将 <img src="https://latex.codecogs.com/png.latex?n"> 个有标号球放入 <img src="https://latex.codecogs.com/png.latex?r"> 个有标号盒的方案数，要求盒非空．</li>
<li>将 <img src="https://latex.codecogs.com/png.latex?n"> 个有标号球放入 <img src="https://latex.codecogs.com/png.latex?r"> 个无标号盒的方案数，要求盒非空．</li>
<li>将 <img src="https://latex.codecogs.com/png.latex?n"> 元集合划分为 <img src="https://latex.codecogs.com/png.latex?r"> 个等价类的方案数．</li>
<li>划分 <img src="https://latex.codecogs.com/png.latex?n"> 元集合的方案数．</li>
</ul>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="mathematics-behind" class="level1 page-columns page-full" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Mathematics behind</h1>
<section id="ntt-原理" class="level2 page-columns page-full" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="ntt-原理"><span class="header-section-number">4.1</span> NTT 原理</h2>
<section id="ntt-原理---导言" class="level3">
<h3 class="anchored" data-anchor-id="ntt-原理---导言">NTT 原理 - 导言</h3>
<p>本节介绍 NTT 的原理．</p>
<p>FFT 加速卷积算法的核心，一是多项式的求值插值原理，二是单位根带来的分治快速算法．我们将在本节中证明，模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 中，只要 <img src="https://latex.codecogs.com/png.latex?n%20%5Cleq%20p">，仍可通过 <img src="https://latex.codecogs.com/png.latex?n"> 个点值唯一确定至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的多项式，这保证了系数-点值-系数方法的正确性；此外，基于原根构造出的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的本原单位根，使得使用与 FFT 相同的分治算法加速 NTT 的计算成为可能．</p>
<p>NTT 原理涉及原根等数论内容．本讲的目标是建立 DFT 变换和 FFT 算法的通用数学框架，而非具体研究其某一特例．故我们只讲解 NTT 所需的基础数论知识，无关的细节则略过处理．对数论感兴趣的同学可前往 OI Wiki 学习．</p>
</section>
<section id="模-p-剩余类域-mathbb-z_p" class="level3">
<h3 class="anchored" data-anchor-id="模-p-剩余类域-mathbb-z_p">模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"></h3>
<p><em>模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域</em> <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 是刻画取模运算下整数加法、乘法运算规律的代数结构，其良定义性由 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20a_1%20%5Cequiv%20a_2%20%5Cpmod%7Bp%7D%20%5C%5C%0A%20%20%20%20b_1%20%5Cequiv%20b_2%20%5Cpmod%7Bp%7D%0A%5Cend%7Bcases%7D%0A%20%20%5Cimplies%0A%5Cbegin%7Bcases%7D%0A%20%20%20%20a_1%20+%20b_1%20%5Cequiv%20a_2%20+%20b_2%20%5Cpmod%7Bp%7D%20%5C%5C%0A%20%20%20%20a_1%20b_1%20%5Cequiv%20a_2%20b_2%20%5Cpmod%7Bp%7D%0A%5Cend%7Bcases%7D%0A"> 保证．</p>
<p>模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域的最大特点是其中每个元素都存在（唯一）逆元．这一点是数论中 Bézout 定理的直接应用．</p>
<p>模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域的另一优良性质是其满足消去律，即 <img src="https://latex.codecogs.com/png.latex?%0Aab%20%5Cequiv%200%20%5Cpmod%20p%20%5Cimplies%20a%20%5Cequiv%200%20%5Clor%20b%20%5Cequiv%200%20%5Cpmod%20p%0A"> 而模一般的数 <img src="https://latex.codecogs.com/png.latex?m"> 形成的代数结构则不满足此性质．</p>
</section>
<section id="mathbb-z_px-上的多点插值" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-z_px-上的多点插值"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 上的多点插值</h3>
<p>之后记系数均在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的多项式组成的集合为 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D">．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="lem-zp-remainder" class="theorem lemma">
<p><span class="theorem-title"><strong>引理 1 (<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%20%5Clbrack%20x%20%5Crbrack"> 上的多项式余式定理)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cin%20%5Cmathbb%20Z_p%5Bx%5D">，用 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 中的一次多项式 <img src="https://latex.codecogs.com/png.latex?(x-a)"> 对 <img src="https://latex.codecogs.com/png.latex?A(x)"> 进行带余除法，得到的余式为至多零次的多项式 <img src="https://latex.codecogs.com/png.latex?A(a)">．</p>
</div>
</div>
</div>
</div>
</section>
<section id="mathbb-z_px-上的多点插值-1" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-z_px-上的多点插值-1"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 上的多点插值</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-lagrange" class="theorem">
<p><span class="theorem-title"><strong>定理 4 (Lagrange 定理)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?p"> 是一个质数，设 <img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cin%20%5Cmathbb%20Z_p%5Bx%5D">．同余方程 <img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cequiv%200%20%5Cpmod%7Bp%7D"> 只有至多 <img src="https://latex.codecogs.com/png.latex?%5Cdeg%20A(x)"> 个模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下不同的整数解，除非这多项式的系数全为零．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-lagrange-equal" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 1</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?A(x),B(x)%20%5Cin%20%5Cmathbb%20Z_p%5Bx%5D"> 是至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的两个多项式．若同余方程 <img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cequiv%20B(x)%20%5Cpmod%7Bp%7D"> 有 <img src="https://latex.codecogs.com/png.latex?n"> 个不同的模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下的整数解，则两多项式一定相等．</p>
</div>
</div>
</div>
</div>
<p>推论告诉我们，欲确定 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的一个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式，只需找到其 <img src="https://latex.codecogs.com/png.latex?n"> 个模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下的点值即可．因此，使用系数 - 点值 - 系数方法加速 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 上的卷积是可行的．</p>
</section>
<section id="本原单位根" class="level3">
<h3 class="anchored" data-anchor-id="本原单位根">本<strong>原</strong>单位<strong>根</strong></h3>
<p>回顾 DFT 中复数域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上单位根的定义 <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_n%5Ek%20:=%20e%5E%7B%5Cfrac%20%7B2%20%5Cpi%20k%7D%7Bn%7D%20i%7D%20=%20%5Ccos%20%5Cfrac%7B2%20%5Cpi%20k%7D%7Bn%7D%20+%20i%20%5Csin%20%5Cfrac%7B2%20%5Cpi%20k%7D%7Bn%7D,%5Cquad%20k%20%5Cin%20%5Bn%5D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 是最重要的单位根，因为它生成了所有其它的单位根．</p>
<p>事实上所有的 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5E%7Bk%7D%20:%20%5Cgcd(n,k)=1"> 也都是重要的，它们的 <img src="https://latex.codecogs.com/png.latex?0"> 至 <img src="https://latex.codecogs.com/png.latex?n-1"> 次方也能生成所有的单位根．这也是数论中 Bézout 定理的直接应用．</p>
<p>我们把这一类重要的单位根称为<em>本原单位根</em>．抽象的来说，<img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 可定义如下 <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_n%5En%20=%201;%5Cquad%20%5Comega_n%5Ek%20%5Cneq%201,%5Cquad%20k=1,2,%5Cdots,n-1%0A"></p>
</section>
<section id="mathbb-z_m-上的阶" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="mathbb-z_m-上的阶"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的阶</h3>
<p>如何定义 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的“本原单位根”呢？</p>
<p>称在模 <img src="https://latex.codecogs.com/png.latex?m"> 意义下使得 <img src="https://latex.codecogs.com/png.latex?a%5En=1"> 的最小正整数 <img src="https://latex.codecogs.com/png.latex?n"> 为 <img src="https://latex.codecogs.com/png.latex?a"> 的<em>阶</em>，记为 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bord%7D_m(a)">．在不至混淆的情况下，也简记为 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bord%7D(a)">．</p>
<ul>
<li>阶最高有多高？</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-fermat" class="theorem">
<p><span class="theorem-title"><strong>定理 5 (Fermat 小定理)</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?p"> 是质数，<img src="https://latex.codecogs.com/png.latex?a"> 是非零数，则 <img src="https://latex.codecogs.com/png.latex?a%5E%7Bp-1%7D%20%5Cequiv%201%20%5Cpmod%7Bp%7D">．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-euler" class="theorem">
<p><span class="theorem-title"><strong>定理 6 (Euler 定理)</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,m)=1">，则 <img src="https://latex.codecogs.com/png.latex?a%5E%7B%5Cvarphi(m)%7D%20%5Cequiv%201%20%5Cpmod%7Bm%7D">，其中 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 是数论中的 Euler 函数<sup>8</sup>．</p>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;对质数 <img src="https://latex.codecogs.com/png.latex?p">，<img src="https://latex.codecogs.com/png.latex?%5Cvarphi(p)=p-1">．故 Euler 定理是 Fermat 小定理的一个推广．</p></div></div></section>
<section id="euler-定理的证明---简化剩余系" class="level3">
<h3 class="anchored" data-anchor-id="euler-定理的证明---简化剩余系">Euler 定理的证明 - 简化剩余系</h3>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m%5ER%20:=%20%5C%7Ba%20%5Cin%20%5Cmathbb%20Z_m:%20%5Cgcd(a,m)=1%20%5C%7D"> 被称为 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 的<em>简化剩余系</em>．简化剩余系对模 <img src="https://latex.codecogs.com/png.latex?m"> 乘法封闭．简化剩余系中的每个元素都具有模 <img src="https://latex.codecogs.com/png.latex?m"> 意义下的唯一逆元，且其也在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m%5ER"> 中．此二性质易由 <img src="https://latex.codecogs.com/png.latex?%5Cgcd"> 的线性组合意义证明．</p>
<p>简化剩余系的大小即 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)">．这是 Euler 函数的其中一种定义．</p>
<p>设 <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5Cmathbb%20Z_m%5ER">，其在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中存在逆元，故我们有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cforall%20x,y%20%5Cin%20%5Cmathbb%20Z_m,%5Cquad%20x%20%5Cequiv%20y%20%5Cpmod%7Bm%7D%20%5Ciff%20ax%20%5Cequiv%20ay%20%5Cpmod%7Bm%7D%0A"> 当限定 <img src="https://latex.codecogs.com/png.latex?x,y%20%5Cin%20%5Cmathbb%20Z_m%5ER"> 时，结合 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m%5ER"> 上述两个性质，就有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20Z_m%5ER%20=%20a%20%5Cmathbb%20Z_m%5ER%20=%20%5C%7B%20ax%20%5Cbmod%20m%20:%20x%20%5Cin%20%5Cmathbb%20Z_m%5ER%20%5C%7D%0A"> 故 <img src="https://latex.codecogs.com/png.latex?%0Aa%5E%7B%5Cvarphi(m)%7D%20%5Cprod_%7Bx%20%5Cin%20%5Cmathbb%20Z_m%5ER%7D%20x%20%5Cequiv%20%5Cprod_%7Bx%20%5Cin%20%5Cmathbb%20Z_m%5ER%7D%20ax%20%5Cequiv%20%5Cprod_%7Bx%20%5Cin%20a%20%5Cmathbb%20Z_m%5ER%7D%20x%20%5Cequiv%20%5Cprod_%7Bx%20%5Cin%20%5Cmathbb%20Z_m%5ER%7D%20x%20%5Cimplies%20a%5E%7B%5Cvarphi(m)%7D%20%5Cequiv%201%20%5Cpmod%7Bm%7D%0A"></p>
</section>
<section id="an-的取值---a-m-互质时" class="level3">
<h3 class="anchored" data-anchor-id="an-的取值---a-m-互质时"><img src="https://latex.codecogs.com/png.latex?a%5En"> 的取值 - <img src="https://latex.codecogs.com/png.latex?a">, <img src="https://latex.codecogs.com/png.latex?m"> 互质时</h3>
<p>补充讨论 <img src="https://latex.codecogs.com/png.latex?a%5En%20%5Cbmod%20m,%5C,%20n%20%5Cin%20%5Cmathbb%20Z_%7B+%7D"> 可取得哪些 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中的元素．</p>
<p>当 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,m)=1"> 时，用 <img src="https://latex.codecogs.com/png.latex?%5Cgcd"> 的线性组合含义，有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cgcd(a,m)=1%20&amp;%5Cimplies%20%5Cexists%20x_0,%5Cquad%20a%20x_0%20=%201%20%5Cpmod%7Bm%7D%20%5C%5C%0A&amp;%5Cimplies%20%5Cexists%20x_0,%5Cquad%20a%5En%20x_0%5En%20=%201%20%5Cpmod%7Bm%7D%20%5C%5C%0A&amp;%5Cimplies%20%5Cgcd(a%5En,m)=1%0A%5Cend%7Baligned%7D%0A"> 故此时 <img src="https://latex.codecogs.com/png.latex?a%5En%20%5Cbmod%20m"> 只可能取得 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 的简化剩余系 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m%5ER"> 中的元素．</p>
</section>
<section id="an-的取值---一般情况" class="level3">
<h3 class="anchored" data-anchor-id="an-的取值---一般情况"><img src="https://latex.codecogs.com/png.latex?a%5En"> 的取值 - 一般情况<sup>9</sup></h3>
<p>当 <img src="https://latex.codecogs.com/png.latex?d_1%20=%20%5Cgcd(a,m)%20%5Cneq%201"> 时，设 <img src="https://latex.codecogs.com/png.latex?a%20=%20d_1%20a_1,%5C,%20m%20=%20d_1%20m_1">，当 <img src="https://latex.codecogs.com/png.latex?n%20%5Cgeq%201"> 时， <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Aa%5En%20%5Cbmod%20m%20&amp;=%20d_1%20a_1%20a%5E%7Bn-1%7D%20%5Cbmod%20d_1%20m_1%20=%20d_1%20%5Cleft(%20a_1%20a%5E%7Bn-1%7D%20%5Cbmod%20m_1%20%5Cright)%0A%5Cend%7Baligned%7D"> 此时 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a_1,m_1)=1">，根据线性同余方程理论，括号内表达式的取值集合仅与 <img src="https://latex.codecogs.com/png.latex?a%5E%7Bn-1%7D%20%5Cbmod%20m_1"> 有关．此时若 <img src="https://latex.codecogs.com/png.latex?d_2%20=%20%5Cgcd(a,m_1)"> 仍不等于 <img src="https://latex.codecogs.com/png.latex?1">，则令 <img src="https://latex.codecogs.com/png.latex?a_1%20=%20d_2%20a_2,%5C,%20m_1%20=%20d_2%20m_2">．类似地继续化归，最终有 <img src="https://latex.codecogs.com/png.latex?d_%7Bk+1%7D%20=%20%5Cgcd(a,m_k)%20=%201">， <img src="https://latex.codecogs.com/png.latex?%0Aa%5En%20%5Cbmod%20m%20=%20d_1%20%5Cleft(%20a_1%20d_2%20%5Cleft(%20%5Cdots%20a_%7Bk-1%7D%20d_k%20(a_k%20a%5E%7Bn-k%7D%20%5Cbmod%20m_k)%20%5Cdots%20%5Cright)%20%5Cbmod%20m_1%20%5Cright)%0A"> 故当 <img src="https://latex.codecogs.com/png.latex?n%20%5Cgeq%20k"> 时，<img src="https://latex.codecogs.com/png.latex?a%5En%20%5Cbmod%20m"> 的取值集合为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%20d_1%20d_2%20%5Cdots%20d_k%20(a%5Et%20%5Cbmod%20m_k)%20:%20t%20%5Cin%20%5Cmathbb%20Z_+%20%5Cright%5C%7D%20%5Csubset%20d_1%20d_2%20%5Cdots%20d_k%20%5Cmathbb%20Z_%7Bm_k%7D%5ER%0A"> 事实上，<img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bi=1%7D%5Ek%20d_i"> 恰为 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,m)"> 的各素因子在 <img src="https://latex.codecogs.com/png.latex?m"> 中全部成分的乘积．</p>
</section>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>&nbsp;ExBSGS 求解离散对数 <span class="citation" data-cites="oiwiki-discretelog">[5]</span> 的推导与此相似．</p></div><div id="fn10"><p><sup>10</sup>&nbsp;部分证明稍复杂，我们略过处理．感兴趣的同学请参考 OI Wiki <span class="citation" data-cites="oiwiki-pr">[6]</span>．</p></div></div><section id="原根" class="level3">
<h3 class="anchored" data-anchor-id="原根">原根<sup>10</sup></h3>
<p>需要注意的是，Euler 定理只给出了 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上元素阶的一个上界．换言之，其说明 <img src="https://latex.codecogs.com/png.latex?%0A%5Cforall%20a%20%5Cin%20%5Cmathbb%20Z_m%5ER%20%5Cimplies%20%5Coperatorname%7Bord%7D_m(a)%20%5Cmid%20%5Cvarphi(m)%0A"> 而对于那些使得 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,m)%20%5Cneq%201"> 的元素 <img src="https://latex.codecogs.com/png.latex?a">，用 <img src="https://latex.codecogs.com/png.latex?%5Cgcd"> 的线性组合性质容易证明其永远不可能通过自乘变为 <img src="https://latex.codecogs.com/png.latex?1">．我们设定这类元素的阶为 <img src="https://latex.codecogs.com/png.latex?0">．</p>
<p>称 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上那些确能达到阶数上界 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 的元素是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的<em>原根</em>，用符号 <img src="https://latex.codecogs.com/png.latex?g"> 表示．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-exist" class="theorem">
<p><span class="theorem-title"><strong>定理 7 (原根存在定理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上存在原根，当且仅当 <img src="https://latex.codecogs.com/png.latex?m=2,4,p%5E%7B%5Calpha%7D,2p%5E%7B%5Calpha%7D"> ，其中 <img src="https://latex.codecogs.com/png.latex?p"> 是一奇质数．</p>
</div>
</div>
</div>
</div>
</section>
<section id="求阶和原根" class="level3">
<h3 class="anchored" data-anchor-id="求阶和原根">求阶和原根</h3>
<ul>
<li>求阶，用定理 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bord%7D_m(a)%20%5Cmid%20%5Cvarphi(m)">，求因子 + 快速幂即可 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20m%20%5Clog%20m)">．</li>
<li>找原根，从小到大用上述求阶方法暴力即可．最小原根一般不会太大．</li>
<li>更快的方法请参考洛谷求原根模板题题解．</li>
</ul>
<p>下面再介绍原根的两个定理．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-check" class="theorem">
<p><span class="theorem-title"><strong>定理 8 (原根判定定理)</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(g,m)=1">，则 <img src="https://latex.codecogs.com/png.latex?g"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上原根的充要条件是，对 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 的每个素因数 <img src="https://latex.codecogs.com/png.latex?p">，都有 <img src="https://latex.codecogs.com/png.latex?g%5E%7B%5Cfrac%7B%5Cvarphi(m)%7D%7Bp%7D%7D%5Cnot%5Cequiv%201%5Cpmod%20m">.</p>
</div>
</div>
</div>
</div>
<p>必要性显然．充分性，反证出所有 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 的非平凡因子均不是 <img src="https://latex.codecogs.com/png.latex?g"> 的阶即可．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-pr-num" class="theorem">
<p><span class="theorem-title"><strong>定理 9 (原根个数定理)</strong></span> 若 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上存在原根，则它原根的个数为 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(%5Cvarphi(m))">.</p>
</div>
</div>
</div>
</div>
</section>
<section id="mathbb-z_m-上的本原单位根构造" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="mathbb-z_m-上的本原单位根构造"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的本原单位根构造</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?a"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上一元素，当 <img src="https://latex.codecogs.com/png.latex?n%20%5Cmid%20%5Coperatorname%7Bord%7D_m(a)">，令 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20=%20a%5E%7B%5Cfrac%7B%5Coperatorname%7Bord%7D_m(a)%7D%7Bn%7D%7D">，容易发现 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 就是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根．</p>
<p>使用数论中 Bézout 定理，<strong><img src="https://latex.codecogs.com/png.latex?%5Comega_n%5Ek"> 是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20n%20%7B%5Cgcd(n,k)%7D"> 次本原单位根</strong>．这是 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上本原单位根的<strong>消去引理</strong>．</p>
<p>遗憾的是，<strong>一般的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中，本原单位根不一定满足求和引理</strong><sup>11</sup> <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20n%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_%7Bn%7D%5E%7Bik%7D%20=%20%5Bn%20%5Cmid%20i%5D">．这是因为，求和引理的证明中使用了等比数列求和和消去律，但<strong>一般的 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中消去律并不成立</strong>．</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;这是后文所述定理“整环上的本原单位根也是主要单位根”在一般环上的一个反例．</p></div></div></section>
<section id="mathbb-z_m-上的-ntt---m-是质数" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-z_m-上的-ntt---m-是质数"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 NTT - <img src="https://latex.codecogs.com/png.latex?m"> 是质数</h3>
<p>求和引理是保障 NTT 逆变换对应矩阵确为 <img src="https://latex.codecogs.com/png.latex?n%5E%7B-1%7D%20%5Cbegin%7Bpmatrix%7D%20%5Comega_n%5E%7B-ij%7D%20%5Cend%7Bpmatrix%7D_%7B(i,j)%5Cin%20n%20%5Ctimes%20n%7D"> 的关键性质．如果我们还想保留这一点，就必须要求 <img src="https://latex.codecogs.com/png.latex?m"> 是质数．</p>
<p>为保证 <img src="https://latex.codecogs.com/png.latex?n"> 在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中存在逆元，必须要求 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(n,m)=1">．已经要求 <img src="https://latex.codecogs.com/png.latex?m"> 是质数，故无需做出额外要求．</p>
<p>综上，<strong>逆变换矩阵确为 <img src="https://latex.codecogs.com/png.latex?n%5E%7B-1%7D%20%5Cbegin%7Bpmatrix%7D%20%5Comega_n%5E%7B-ij%7D%20%5Cend%7Bpmatrix%7D_%7B(i,j)%5Cin%20n%20%5Ctimes%20n%7D"> 的 <img src="https://latex.codecogs.com/png.latex?n"> 点 NTT 要求 <img src="https://latex.codecogs.com/png.latex?m"> 是质数，且 <img src="https://latex.codecogs.com/png.latex?n%20%5Cmid%20%5Coperatorname%7Bord%7D_m(a)"></strong>．已经要求 <img src="https://latex.codecogs.com/png.latex?m"> 是质数，故 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 中必存在原根，不妨直接取 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 的一个原根 <img src="https://latex.codecogs.com/png.latex?g"> 构造 <img src="https://latex.codecogs.com/png.latex?n"> 次本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20=%20g%5E%7B%5Cfrac%7B%5Cvarphi(m)%7D%7Bn%7D%7D%20=%20g%5E%7B%5Cfrac%7Bm-1%7D%7Bn%7D%7D">，这样的构造支持至多 <img src="https://latex.codecogs.com/png.latex?m-1"> 次单位根的存在，显然是最优的选择．</p>
</section>
<section id="mathbb-z_m-上的-fft-与卷积加速---998244353" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="mathbb-z_m-上的-fft-与卷积加速---998244353"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 FFT 与卷积加速 - 998244353</h3>
<p>为满足 FFT 对 <img src="https://latex.codecogs.com/png.latex?2%5Em"> 次本原单位根的需求，只需选择 <img src="https://latex.codecogs.com/png.latex?p%20=%20k%202%5Em%20+%201"> 型的奇质数 <img src="https://latex.codecogs.com/png.latex?p">，就可以在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上支持规模至多为 <img src="https://latex.codecogs.com/png.latex?2%5Em"> 的 NTT/FFT 及其逆变换运行．</p>
<p><img src="https://latex.codecogs.com/png.latex?998244353=2%5E%7B23%7D%20%5Ctimes%207%20%5Ctimes%2017%20+%201">，同时是一个质数，在 <code>int</code> 型中的单次加减操作不会溢出，是 OI/XCPC 计数题中不可多得的优秀模数<sup>12</sup>．</p>
<div class="no-row-height column-margin column-container"><div id="fn12"><p><sup>12</sup>&nbsp;网传此模数由 UOJ 站长 vfleaking 提出并推广．在所有需要取模的题目中使用该模数，可使选手无法通过模数判断题目的做法．</p></div></div><p>结合前述关于 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 上多点插值的讨论，通过 NTT/FFT 加速卷积运算的正确性得到完整证明．</p>
</section>
<section id="mathbb-z_m-上的-ntt---对一般的-m" class="level3">
<h3 class="anchored" data-anchor-id="mathbb-z_m-上的-ntt---对一般的-m"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 NTT - 对一般的 <img src="https://latex.codecogs.com/png.latex?m"></h3>
<p>当 <img src="https://latex.codecogs.com/png.latex?m"> 不一定是质数时，NTT 逆变换不能表示为 <img src="https://latex.codecogs.com/png.latex?n%5E%7B-1%7D%20%5Cbegin%7Bpmatrix%7D%20%5Comega_n%5E%7B-ij%7D%20%5Cend%7Bpmatrix%7D_%7B(i,j)%5Cin%20n%20%5Ctimes%20n%7D"> 的形式．但这并不代表 NTT 不可逆．因此，尽管不再实用，一般 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的 NTT 变换仍有讨论价值，即研究 <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bpmatrix%7D%20%5Comega_n%5E%7Bij%7D%20%5Cend%7Bpmatrix%7D_%7B(i,j)%5Cin%20n%20%5Ctimes%20n%7D"> 的可逆性．</p>
<p>我们找到一篇有关该问题的参考文献<span class="citation" data-cites="agarwal1974fast">[7, section 3 and appendix B]</span>，但尚不确定其证明的正确性．友情提示读者：<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 不是域，甚至不是整环，故线性空间中矩阵的性质不能直接应用于 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的矩阵，讨论可逆性时还需小心谨慎．</p>
</section>
<section id="从分析到代数" class="level3">
<h3 class="anchored" data-anchor-id="从分析到代数">从分析到代数</h3>
<p>后续数学内容导读 NTT 原理虽已非常”数学”，但也只是 DFT 在有限域上的一个实例．本节往后，我们要尝试为多项式系数位于复数域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上的 DFT、位于模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的 NTT 及它们的快速算法 FFT 建立一个统一的数学框架．这需要我们剖析求值插值的基本原理，提炼出 FFT 算法成立的根本要求．</p>
<p>后续数学内容不再要求掌握．望同学们在纷繁的定理定义中抓住要旨，窥见抽象数学背后蕴藏的规律．熟悉高等代数和抽象代数的同学或会对某些内容感到熟悉．抽象地讨论 FFT 的资料并不多见，后续内容多为主讲人的新进探索，或有谬误，望不吝指正．</p>
</section>
</section>
<section id="求值与插值" class="level2 page-columns page-full" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="求值与插值"><span class="header-section-number">4.2</span> 求值与插值</h2>
<section id="求值与插值---导言" class="level3">
<h3 class="anchored" data-anchor-id="求值与插值---导言">求值与插值 - 导言</h3>
<p>本节将重新审视已经熟知的多项式，把抽象的、代数的多项式和具体的、分析的多项式函数区分开来．我们指出，多项式和多项式函数不同但关联紧密，形式幂级数与幂级数亦有此类联系．这些抽象的讨论将帮助我们剖析多项式求值插值的基本原理．</p>
<p>除常见代数书目（如<span class="citation" data-cites="qiu-algebra">[8]</span>），也推荐参考 OI Wiki 的多项式基础<span class="citation" data-cites="oiwiki-polynomial">[9]</span>和 Wikipedia 的形式幂级数<span class="citation" data-cites="wikipedia-formalpowerseries">[10]</span>．</p>
</section>
<section id="多项式" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="多项式">多项式</h3>
<p>设（无穷）序列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_n%20%5C%7D"> 是一个只有有限个非零项的序列，其元素均在环 <img src="https://latex.codecogs.com/png.latex?R"> 上．环 <img src="https://latex.codecogs.com/png.latex?R"> 上的<em>多项式环</em><sup>13</sup> <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 是所有满足上述条件的序列构成的集合以及在它们之间定义的两种运算 <img src="https://latex.codecogs.com/png.latex?+,%20%5Ctimes"> 的合称．此语境下，我们也将构成 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 的序列称为 <img src="https://latex.codecogs.com/png.latex?R"> 上的<em>多项式</em>．序列中的元素被称为多项式的系数．<strong>序列间定义的加法和乘法是普通序列升级为多项式的关键．</strong></p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>&nbsp;一般语境下讨论的多项式环是在域上的 <img src="https://latex.codecogs.com/png.latex?K%5Bx%5D">，而非环上的 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D">．</p></div></div><p>多项式环上的加法、乘法的定义已经为大家所熟知．系数所处的环保证了多项式加法和乘法的良定义，而在这两种运算下，<img src="https://latex.codecogs.com/png.latex?R"> 上多项式的集合也构成一个环的结构．</p>
<div class="proof remark page-columns page-full">
<p><span class="proof-title"><em>注记</em> (群、环、域). </span>群、环、域都是常见的代数结构，其中的元素在给定运算下封闭，并满足特定的运算性质．简单来说，环<sup>14</sup>上定义了加法和可能不可逆的、不一定交换的乘法，域上定义了加减乘除所有四则运算．交换环中的乘法满足交换律．除环中的所有元素有乘法逆元．域是交换除环．</p>
<div class="no-row-height column-margin column-container"><div id="fn14"><p><sup>14</sup>&nbsp;本篇中环的定义包含乘法单位元，即幺环．</p></div></div></div>
</section>
<section id="多项式-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="多项式-1">多项式</h3>
<p>习惯上也会将多项式 <img src="https://latex.codecogs.com/png.latex?A"> 写为 <img src="https://latex.codecogs.com/png.latex?A(x)%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_k%20x%5Ek"> 的形式．其中未定元 <img src="https://latex.codecogs.com/png.latex?x"> 只是一个符号，仅为方便加、乘法的理解而使用，并无任何含义．</p>
<p>多项式 <img src="https://latex.codecogs.com/png.latex?A"> 的<em>次数</em> <img src="https://latex.codecogs.com/png.latex?%5Cdeg%20A"> 定义为其最高非零项所处的位置下标．特别的，定义零多项式的次数为 <img src="https://latex.codecogs.com/png.latex?-%5Cinfty">．对任意多项式 <img src="https://latex.codecogs.com/png.latex?A,B%20%5Cin%20R%5Bx%5D">，<img src="https://latex.codecogs.com/png.latex?%5Cdeg(A+B)%20%5Cleq%20%5Cmax%5C%7B%20%5Cdeg%20A,%20%5Cdeg%20B%20%5C%7D">．当 <img src="https://latex.codecogs.com/png.latex?R"> 是整环<sup>15</sup>时，<img src="https://latex.codecogs.com/png.latex?A,B"> 的首项乘积非零，故 <img src="https://latex.codecogs.com/png.latex?%5Cdeg(A*B)%20=%20%5Cdeg%20A%20+%20%5Cdeg%20B">．</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>&nbsp;无零因子的交换幺环，稍后介绍．</p></div></div><p>下面额外为多项式定义一种新的运算．多项式 <img src="https://latex.codecogs.com/png.latex?A"> 和多项式 <img src="https://latex.codecogs.com/png.latex?B"> 的<em>复合</em> <img src="https://latex.codecogs.com/png.latex?A%20%5Ccirc%20B"> 定义为 <img src="https://latex.codecogs.com/png.latex?%0AA%20%5Ccirc%20B%20:=%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20a_k%20B%5Ek%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?B%5Ek"> 代表 <img src="https://latex.codecogs.com/png.latex?k"> 个多项式 <img src="https://latex.codecogs.com/png.latex?B"> 的乘积．习惯上也会将多项式 <img src="https://latex.codecogs.com/png.latex?A"> 和多项式 <img src="https://latex.codecogs.com/png.latex?B"> 的复合写为 <img src="https://latex.codecogs.com/png.latex?A(B(x))%20=%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20a_k%20B%5Ek(x)"> 的形式．由于多项式的次数有限，复合运算中仅包含了有限次多项式加法和乘法．</p>
</section>
<section id="形式幂级数" class="level3">
<h3 class="anchored" data-anchor-id="形式幂级数">形式幂级数</h3>
<p><em>形式幂级数</em>定义与多项式的唯一区别是其不要求 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_n%20%5C%7D"> 只有有限项非零．类似的，<img src="https://latex.codecogs.com/png.latex?R"> 上的形式幂级数环记为 <img src="https://latex.codecogs.com/png.latex?R%5B%5Bx%5D%5D">．</p>
<p>由于涉及无限次运算，形式幂级数的复合运算需考虑环 <img src="https://latex.codecogs.com/png.latex?R"> 上的收敛问题．为回避此问题，一般规定复合右侧函数的常数项须为零．</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>DFT, NTT 与多项式环 DFT/FFT 加速的多项式卷积在复数域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 上的多项式环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5Bx%5D"> 中进行，NTT/FFT 加速的多项式卷积在模 <img src="https://latex.codecogs.com/png.latex?p"> 剩余类域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p"> 上的多项式环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 中进行．</p>
</div>
</section>
<section id="带余除法" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="带余除法">带余除法</h3>
<p><em>整环</em>是无零因子的交换幺环．所谓无零因子，即环中任意元素 <img src="https://latex.codecogs.com/png.latex?a,b"> 满足 <img src="https://latex.codecogs.com/png.latex?ab%20=%200%20%5Cimplies%20a=0%20%5Clor%20b=0">．所有域都是整环．当 <img src="https://latex.codecogs.com/png.latex?R"> 是整环时，<img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 也是整环<sup>16</sup>．整环上可以定义整除相关理论．</p>
<div class="no-row-height column-margin column-container"><div id="fn16"><p><sup>16</sup>&nbsp;可用前述多项式乘积次数公式证明．</p></div><div id="fn17"><p><sup>17</sup>&nbsp;试试在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z%5Bx%5D"> 上用 <img src="https://latex.codecogs.com/png.latex?2x+1"> 去除 <img src="https://latex.codecogs.com/png.latex?x+1">．</p></div></div><p>定义有带余除法的环被称为 <em>Euclid 整环</em>．域上的多项式环都是 Euclid 整环<span class="citation" data-cites="qiu-algebra">[8, 第 7 章第 2 节定理 3, p.&nbsp;11]</span>．值得注意的是，<img src="https://latex.codecogs.com/png.latex?R"> 的 Euclid 性不可传递至 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"><sup>17</sup>．</p>
<p>如在带余除法中保证除式是首一多项式<sup>18</sup>，则带余除法的良定义和进行过程也均可在整环上实现．</p>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>&nbsp;首项为 <img src="https://latex.codecogs.com/png.latex?1"> 的多项式．</p></div></div></section>
<section id="多项式函数-幂级数" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="多项式函数-幂级数">多项式函数 / 幂级数</h3>
<p>刚刚强调，多项式 / 形式幂级数只是定义了加法和乘法的序列．现在介绍多项式函数和幂级数．它们不是序列，而是映射<sup>19</sup>．</p>
<div class="no-row-height column-margin column-container"><div id="fn19"><p><sup>19</sup>&nbsp;函数和映射几乎是等价名词．有时函数特指值域包含于复数域 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C"> 的映射．</p></div><div id="fn20"><p><sup>20</sup>&nbsp;为良定义 <img src="https://latex.codecogs.com/png.latex?x%5E0">，环 <img src="https://latex.codecogs.com/png.latex?R"> 必须有单位元．</p></div><div id="fn21"><p><sup>21</sup>&nbsp;这里再次涉及环 <img src="https://latex.codecogs.com/png.latex?R"> 上的收敛问题．由于实践中只关心形式幂级数的前有限项，后续讨论系数-点值-系数法转换卷积时不需要用到幂级数理论，可以回避．</p></div></div><p>多项式 <img src="https://latex.codecogs.com/png.latex?A"> 对应的环 <img src="https://latex.codecogs.com/png.latex?R"> 上的<em>多项式函数</em> <img src="https://latex.codecogs.com/png.latex?A(x)"> 定义为映射<sup>20</sup> <img src="https://latex.codecogs.com/png.latex?%0AA:%20R%20%5Cto%20R,%5Cquad%20x%20%5Cmapsto%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20a_k%20x%5Ek%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_n%20%5C%7D"> 只有有限项非零．环 <img src="https://latex.codecogs.com/png.latex?R"> 上的幂级数则无此限制<sup>21</sup>．</p>
<p>与多项式 / 形式幂级数不同，这里的 <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20R"> 代表函数的自变量，是会按环 <img src="https://latex.codecogs.com/png.latex?R"> 上运算法则参与运算的有意义的变量．</p>
<p>多项式函数的加法和乘法定义为函数的加法和乘法，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA+B:%20x%20&amp;%5Cmapsto%20A(x)+B(x)%20%5C%5C%0AA%20%5Cotimes%20B:%20x%20&amp;%5Cmapsto%20A(x)B(x)%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="求值" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="求值">求值</h3>
<p>多项式和多项式函数似乎在许多情况下有着平行的关系．下面介绍一个较直观的结论．</p>
<p><strong>若环 <img src="https://latex.codecogs.com/png.latex?R"> 是交换环，则环 <img src="https://latex.codecogs.com/png.latex?R"> 上每个多项式都唯一确定一个 <img src="https://latex.codecogs.com/png.latex?R"> 上的多项式函数，且该映射保持加法和乘法运算</strong><sup>22</sup>．形式化地可以记为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20(A+B)(x)%20&amp;=%20A(x)+B(x)%20%5C%5C%0A%20%20%20%20(A*B)(x)%20&amp;=%20A(x)B(x)%0A%20%20%20%20%5Cend%7Baligned%7D%0A"> 可用于证明上述结论的定理证明见<span class="citation" data-cites="qiu-algebra">[8, 第 7 章第 1 节定理 4, p.&nbsp;7]</span><sup>23</sup>．由于多项式的复合由多项式加法和乘法组成，而多项式函数的复合（定义为函数的复合）亦可在环上平行地展开，故上述映射也保持了复合运算．</p>
<div class="no-row-height column-margin column-container"><div id="fn22"><p><sup>22</sup>&nbsp;这种保持结构不变的映射被称为同态（homomorphism）．</p></div><div id="fn23"><p><sup>23</sup>&nbsp;其证明了域上一元多项式环的通用性质．仿照该证明应可证明环上的版本，从而证明这一同态关系．</p></div></div><p>多项式和多项式函数的这一关系为多项式在任意点的求值操作提供了理论基础．在多项式函数的 <img src="https://latex.codecogs.com/png.latex?t"> 处求值也被称为用 <img src="https://latex.codecogs.com/png.latex?t"> 代入多项式 <img src="https://latex.codecogs.com/png.latex?A">，记为 <img src="https://latex.codecogs.com/png.latex?A(t)">．</p>
</section>
<section id="插值" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="插值">插值</h3>
<p>需要注意的是，前述结论的逆命题不一定成立，即<strong>环 <img src="https://latex.codecogs.com/png.latex?R"> 上的一个多项式函数不一定与 <img src="https://latex.codecogs.com/png.latex?R"> 上多项式一一对应</strong>．一个经典反例是有限域上多项式环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_p%5Bx%5D"> 上的 <img src="https://latex.codecogs.com/png.latex?(x+1)%5Ep%20%5Cequiv%20x%5Ep%20+%201%20%5Cpmod%7Bp%7D">．我们指出其成立的一个充分条件是 <strong><img src="https://latex.codecogs.com/png.latex?R"> 是无限整环</strong><sup>24</sup>．</p>
<div class="no-row-height column-margin column-container"><div id="fn24"><p><sup>24</sup>&nbsp;该定理是下方高亮定理的一个自然的推论．</p></div></div><p>该逆命题的本质是通过多项式函数的所有函数值反过来确定多项式（系数）的过程．而如果在确定时只使用一部分函数值，就是所谓的多点插值过程．很多时候待求多项式的次数是已知的，这在相当程度上缩小了待定多项式的范围．我们指出，<strong>只要 <img src="https://latex.codecogs.com/png.latex?R"> 是整环，就可以通过多项式任意 <img src="https://latex.codecogs.com/png.latex?n"> 个不同位置的点值确定一个至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式．</strong></p>
<p>证明的关键是用带余除法<sup>25</sup>讨论多项式根与其一次因式的关系，即多项式余式定理或小 Bézout 定理<span class="citation" data-cites="qiu-algebra">[8, 第 7 章第 6 节定理 6, p.&nbsp;35]</span>．</p>
<div class="no-row-height column-margin column-container"><div id="fn25"><p><sup>25</sup>&nbsp;由于一次因式均为首一多项式，可以在整环上对其使用带余除法．</p></div></div><p>需要强调，上述结论只能说明，只有那些确实可通过多项式 <img src="https://latex.codecogs.com/png.latex?n"> 点求值得到的点值组，才能与多项式建立保持加法和乘法运算的双射．对于任取的 <img src="https://latex.codecogs.com/png.latex?R"> 中的一个 <img src="https://latex.codecogs.com/png.latex?n"> 元组，则无法确定是否存在与之对应的多项式．</p>
</section>
<section id="求值与插值的线性表示" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="求值与插值的线性表示">求值与插值的线性表示</h3>
<p>到这里，多项式的求值与插值的线性表示已经呼之欲出了．若将交换环 <img src="https://latex.codecogs.com/png.latex?R"> 上的至多 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的多项式看做模<sup>26</sup> <img src="https://latex.codecogs.com/png.latex?R%5En"> 中的一个向量，则多项式多点求值的过程就是 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的一个线性变换（记为 <img src="https://latex.codecogs.com/png.latex?V">），其矩阵表示正是 Vandermonde 矩阵．由先前对求值的讨论，我们还知道其保持模 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的加法运算，并将结果不超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 次的卷积运算转化为 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的逐项乘法．</p>
<div class="no-row-height column-margin column-container"><div id="fn26"><p><sup>26</sup>&nbsp;模是定义在环上的“线性空间”．</p></div><div id="fn27"><p><sup>27</sup>&nbsp;Lagrange 插值的构造用到了除法，且行列式非零推出矩阵可逆仅在域上的线性空间中适用，因此必须要求 <img src="https://latex.codecogs.com/png.latex?R"> 是域．</p></div></div><p>若将对 <img src="https://latex.codecogs.com/png.latex?R"> 的要求<strong>加强到域</strong>，注意到 Vandermonde 行列式在参数互不相同时非零，故此时 <img src="https://latex.codecogs.com/png.latex?V"> 可逆．事实上，<strong>Vandermonde 矩阵求逆的过程就是 Lagrange 插值</strong>，从而给出了将任意 <img src="https://latex.codecogs.com/png.latex?R%5En"> 中向量还原为其对应多项式的构造方法<sup>27</sup>．这与数论中中国剩余定理的构造有异曲同工之妙<span class="citation" data-cites="wikipedia-lagrange">[11, section: A perspective from linear algebra]</span>．</p>
</section>
<section id="求值与插值---小结" class="level3">
<h3 class="anchored" data-anchor-id="求值与插值---小结">求值与插值 - 小结</h3>
<p>本节的核心是多项式和多项式函数的区别与联系，两个方向的”确定”分别给出了多项式多点求值和多点插值的理论基础．</p>
<p>由于多项式和多项式函数这种若即若离的关系，往往在记号上也有意无意地混淆了它们，某些情况下加大了区分的难度．本篇使用的记号体系将尽量用单个字母 <img src="https://latex.codecogs.com/png.latex?A"> 表示多项式，用 <img src="https://latex.codecogs.com/png.latex?A(x)"> 表示多项式 <img src="https://latex.codecogs.com/png.latex?A"> 对应的多项式函数，用 <img src="https://latex.codecogs.com/png.latex?A(t)"> 表示用 <img src="https://latex.codecogs.com/png.latex?t"> 代入多项式 <img src="https://latex.codecogs.com/png.latex?A">，同时在需要区分的符号前加上适当的名词．</p>
</section>
</section>
<section id="环上的-dft" class="level2 page-columns page-full" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="环上的-dft"><span class="header-section-number">4.3</span> 环上的 DFT</h2>
<section id="环上的-dft---导言" class="level3">
<h3 class="anchored" data-anchor-id="环上的-dft---导言">环上的 DFT - 导言</h3>
<p>前面讨论了在多项式任意点处求值插值的基本原理，但 DFT/FFT 的运行只需在单位根处求值和插值．本节将进一步放宽对多项式环的限制，介绍定义在有主要单位根的环上的一般的 DFT 及其快速算法 FFT．</p>
<p>本节内容主要参考了 <span class="citation" data-cites="furer2009faster">[12, section 2, pp.&nbsp;983–984]</span> 和 <span class="citation" data-cites="wikipedia-dft-over-ring">[13]</span>．</p>
</section>
<section id="环上的单位根---两个定义" class="level3">
<h3 class="anchored" data-anchor-id="环上的单位根---两个定义">环上的单位根 - 两个定义</h3>
<p>定义环 <img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 次<em>主要单位根</em>（principal n-th root of unity）<img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 是满足如下条件的环 <img src="https://latex.codecogs.com/png.latex?R"> 中的一个元素： <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_n%5En%20=%201;%5Cquad%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20=%200,%5Cquad%20i=1,2,%5Cdots,n-1%0A"> 由定义立得 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20=%20%5Bn%20%5Cmid%20i%5D%20n">，可见主要单位根的定义即求和引理本身．</p>
<p>定义环 <img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 次<em>本原单位根</em>（primitive n-th root of unity）<img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 是满足如下条件的环 <img src="https://latex.codecogs.com/png.latex?R"> 中的一个元素： <img src="https://latex.codecogs.com/png.latex?%0A%5Comega_n%5En%20=%201;%5Cquad%20%5Comega_n%5Ek%20%5Cneq%201,%5Cquad%20k=1,2,%5Cdots,n-1%0A"></p>
<p>本原单位根在许多情况下与主要单位根等价，但亦非完全相同．</p>
</section>
<section id="环上的单位根---区别与联系" class="level3">
<h3 class="anchored" data-anchor-id="环上的单位根---区别与联系">环上的单位根 - 区别与联系</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-root-relation-1" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 1</strong></span> 若环 <img src="https://latex.codecogs.com/png.latex?R"> 是整环，则环上的本原单位根也是一个主要单位根．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>对任意正整数 <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Bn%5D">，令 <img src="https://latex.codecogs.com/png.latex?S%20=%20%5Csum_%7Bk=0%7D%5En%20%5Comega_n%5E%7Bik%7D">，则 <img src="https://latex.codecogs.com/png.latex?(1-%5Comega_n%5Ei)%20S%20=%20S%20-%20%5Comega_n%5Ei%20S%20=%201%20-%20%5Comega_n%5En%20=%200">，由 <img src="https://latex.codecogs.com/png.latex?R"> 是整环及 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5Ei=0"> 得 <img src="https://latex.codecogs.com/png.latex?S=0">．</p>
</div>
</section>
<section id="环上的单位根---区别与联系-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="环上的单位根---区别与联系-1">环上的单位根 - 区别与联系</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-root-relation-2" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 2</strong></span> 若环 <img src="https://latex.codecogs.com/png.latex?R"> 的特征<sup>28</sup> <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bchar%7DR"> 满足 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bchar%7DR%20%5Cnmid%20n">，则环上的主要单位根也是一个本原单位根．</p>
</div>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn28"><p><sup>28</sup>&nbsp;使得 <img src="https://latex.codecogs.com/png.latex?m%201%20=%20%5Csum_%7Bk=0%7D%5E%7Bm-1%7D1%20=%200"> 的最小正整数 <img src="https://latex.codecogs.com/png.latex?m">．不存在则记为 <img src="https://latex.codecogs.com/png.latex?0">．<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bchar%7D%5Cmathbb%20C%20=%200">，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bchar%7D%5Cmathbb%20Z_p%20=%20p">．可以证明域的特征一定是 <img src="https://latex.codecogs.com/png.latex?0"> 或一质数<span class="citation" data-cites="qiu-algebra">[8, 第 7 章第 11 节定理 3，p.&nbsp;70]</span>．</p></div></div><div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>反证．若存在一正整数 <img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20%5Bn%5D"> 使得 <img src="https://latex.codecogs.com/png.latex?n"> 次主要单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 的某一幂次 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5Ei=1">，则 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bik%7D%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%201%5Ek%20=%20n%201%20%5Cneq%200">，与主要单位根定义矛盾．</p>
</div>
</section>
<section id="环上的单位根---其它性质" class="level3">
<h3 class="anchored" data-anchor-id="环上的单位根---其它性质">环上的单位根 - 其它性质</h3>
<p>分别根据定义和数论中的 Bézout 定理，容易证明主要单位根和本原单位根的消去引理：设 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7Bn%7D"> 是环上的 <img src="https://latex.codecogs.com/png.latex?n"> 次主要（本原）单位根，则 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7Bn%7D%5E%7Bk%7D"> 是环上的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20n%20%7B%5Cgcd(n,k)%7D"> 次主要（本原）单位根．</p>
<p>注意到 <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Comega_%7B2n%7D%5En%20%5Cright)%5E2=1%20%5Cimplies%20(%5Comega_%7B2n%7D%5En%20+%201)(%5Comega_%7B2n%7D%5En%20-%201)=0">，故整环上的 <img src="https://latex.codecogs.com/png.latex?2n"> 次主要单位根或本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D"> 均满足 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5En%20=%20-1">．</p>
<p>环上的 <img src="https://latex.codecogs.com/png.latex?n"> 次主要单位根或本原单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 都存在逆元 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%5E%7B-1%7D%20=%20%5Comega_n%5E%7Bn-1%7D">．</p>
</section>
<section id="环上的-dft-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="环上的-dft-1">环上的 DFT</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 是环 <img src="https://latex.codecogs.com/png.latex?R"> 上的一个 <img src="https://latex.codecogs.com/png.latex?n"> 次主要单位根，其对应的 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的 <em><img src="https://latex.codecogs.com/png.latex?n"> 点 DFT</em> 定义为线性映射（或矩阵） <img src="https://latex.codecogs.com/png.latex?%0AF%20=%20%5Cleft(%20%5Comega_n%5E%7Bij%7D%20%5Cright)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D%20=%20%5Cbegin%7Bpmatrix%7D%0A%20%20%20%201%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A%20%20%20%201%20&amp;%20%5Comega_n%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A%20%20%20%201%20&amp;%20%5Comega_n%5E%7Bn-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B(n-1)(n-1)%7D%0A%20%20%20%20%5Cend%7Bpmatrix%7D%0A"> 若 <img src="https://latex.codecogs.com/png.latex?n%201"> 在环 <img src="https://latex.codecogs.com/png.latex?R"> 中存在乘法逆元，则 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的 DFT 可逆，其逆映射为<sup>29</sup> <img src="https://latex.codecogs.com/png.latex?%0AF%5E%7B-1%7D%20=%20(n%201)%5E%7B-1%7D%20%5Cleft(%20%5Comega_n%5E%7B-ij%7D%20%5Cright)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D%20=%20(n%201)%5E%7B-1%7D%20%5Cbegin%7Bpmatrix%7D%0A%20%20%20%201%20&amp;%201%20&amp;%20%5Cdots%20&amp;%201%20%5C%5C%0A%20%20%20%201%20&amp;%20%5Comega_n%5E%7B-1%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B-(n-1)%7D%20%5C%5C%0A%20%20%20%20%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cddots%20&amp;%20%5Cvdots%20%5C%5C%0A%20%20%20%201%20&amp;%20%5Comega_n%5E%7B-(n-1)%7D%20&amp;%20%5Cdots%20&amp;%20%5Comega_n%5E%7B-(n-1)(n-1)%7D%0A%20%20%20%20%5Cend%7Bpmatrix%7D%0A"></p>
<div class="no-row-height column-margin column-container"><div id="fn29"><p><sup>29</sup>&nbsp;证明使用主要单位根的定义（求和引理）即可．</p></div></div></section>
<section id="环上的-fft" class="level3">
<h3 class="anchored" data-anchor-id="环上的-fft">环上的 FFT</h3>
<p>除无法在任意环上使用 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5En%20=%20-1">，现有的抽象已足够让我们写出与之前类似的推导 FFT 的过程．</p>
<p>设 <img src="https://latex.codecogs.com/png.latex?R"> 是任意环，<img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D"> 是环 <img src="https://latex.codecogs.com/png.latex?R"> 上的一个 <img src="https://latex.codecogs.com/png.latex?2n"> 次主要单位根．由主要单位根的消去引理，<img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5E2"> 是环 <img src="https://latex.codecogs.com/png.latex?R"> 上的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20%7B2n%7D%7B%5Cgcd(2n,2)%7D%20=%20n"> 次主要单位根．方便起见，记 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20=%20%5Comega_%7B2n%7D%5E2">．</p>
<p>考虑对模 <img src="https://latex.codecogs.com/png.latex?R%5E%7B2n%7D"> 中向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a%20=%20%5Cleft(%20a_0,a_1,%5Cdots,a_%7B2n-1%7D%20%5Cright)%5ET"> 做 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D"> 对应的 <img src="https://latex.codecogs.com/png.latex?2n"> 点 DFT 变换，得到向量 <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cboldsymbol%20a%7D%20=%20%5Cleft(%20%5Chat%20a_0,%20%5Chat%20a_1,%20%5Cdots,%20%5Chat%20a_%7B2n-1%7D%20%5Cright)%5ET">，其中 <img src="https://latex.codecogs.com/png.latex?%5Chat%20a_i%20=%20%5Csum_%7Bk=0%7D%5E%7B2n-1%7D%20a_k%20%5Comega_%7B2n%7D%5E%7Bik%7D">．将其奇偶分项为 <img src="https://latex.codecogs.com/png.latex?%5Chat%20a_i=A_0(i)+A_1(i)%20%5Comega_%7B2n%7D%5Ei">，其中 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20A_0(i)%20&amp;:=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k%7D%20%5Comega_%7Bn%7D%5E%7Bik%7D%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k%7D%20%5Comega_%7B2n%7D%5E%7B2ik%7D%20%5C%5C%0A%20%20%20%20A_1(i)%20&amp;:=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k+1%7D%20%5Comega_%7Bn%7D%5E%7Bik%7D%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k+1%7D%20%5Comega_%7B2n%7D%5E%7B2ik%7D%0A%20%20%20%20%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="环上的-fft-1" class="level3">
<h3 class="anchored" data-anchor-id="环上的-fft-1">环上的 FFT</h3>
<p>注意到 <img src="https://latex.codecogs.com/png.latex?A_0(i)=A_0(n+i)">，<img src="https://latex.codecogs.com/png.latex?A_1(i)=A_1(n+i)">，故 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20%20%20%5Chat%20a_i%20%20%20%20%20&amp;=%20A_0(i)%20+%20A_1(i)%20%5Comega_%7B2n%7D%5Ei%20%5C%5C%0A%20%20%20%20%5Chat%20a_%7Bn+i%7D%20&amp;=%20A_0(i)%20+%20A_1(i)%20%5Comega_%7B2n%7D%5E%7Bn+i%7D%0A%20%20%20%20%5Cend%7Baligned%7D,%5Cquad%20i%20%5Cin%20%5Bn%5D%0A"> 而 <img src="https://latex.codecogs.com/png.latex?A_0(i),%5C,%20i%20%5Cin%20%5Bn%5D"> 的计算即计算向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7Ba_0%7D%20=%20%5Cleft(%20a_0,%20a_2,%20%5Cdots,%20a_%7B2n-2%7D%20%5Cright)"> 对应于 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT 的过程；<img src="https://latex.codecogs.com/png.latex?A_1(i),%5C,%20i%20%5Cin%20%5Bn%5D"> 的计算即计算向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%7Ba_1%7D%20=%20%5Cleft(%20a_1,%20a_3,%20%5Cdots,%20a_%7B2n-1%7D%20%5Cright)"> 对应于 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT 的过程．</p>
<p>因此，令 <img src="https://latex.codecogs.com/png.latex?n%20=%202%5Em">，则只要环 <img src="https://latex.codecogs.com/png.latex?R"> 上存在 <img src="https://latex.codecogs.com/png.latex?2%5Em"> 次主要单位根，如上形式的 FFT 递归算法就可在 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"> 的时间复杂度内快速计算 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 点 DFT．而若 <img src="https://latex.codecogs.com/png.latex?2%5Ek%201,%5C,%200%20%5Cleq%20k%20%5Cleq%20m"> 在 <img src="https://latex.codecogs.com/png.latex?R"> 内均存在逆元，<img src="https://latex.codecogs.com/png.latex?R%5En"> 上的 <img src="https://latex.codecogs.com/png.latex?n"> 点 IDFT 也可类似地快速计算．</p>
</section>
</section>
<section id="循环卷积与卷积定理" class="level2 page-columns page-full" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="循环卷积与卷积定理"><span class="header-section-number">4.4</span> 循环卷积与卷积定理</h2>
<section id="循环卷积与卷积定理---导言" class="level3">
<h3 class="anchored" data-anchor-id="循环卷积与卷积定理---导言">循环卷积与卷积定理 - 导言</h3>
<p>上一节中，我们建立了在有主要单位根的环上的 DFT 及其快速算法 FFT 的相关理论，但由于放宽了对多项式环 <img src="https://latex.codecogs.com/png.latex?R%5Bx%5D"> 的限制，多项式的求值插值理论无法在此直接得到应用，环上 DFT 加速多项式卷积的理论尚需重新构建．</p>
<p>在求值与插值部分已经介绍求值变换 <img src="https://latex.codecogs.com/png.latex?V"> 在 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的线性表示，其保持 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的加法运算，并将规模不超过 <img src="https://latex.codecogs.com/png.latex?n"> 的两向量的卷积转化为 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的逐项乘法．本节中，我们来证明 DFT 变换 <img src="https://latex.codecogs.com/png.latex?F"> 也满足同样的性质，且将这一结果推广到卷积规模超过 <img src="https://latex.codecogs.com/png.latex?n"> 时的情况．</p>
</section>
<section id="循环卷积" class="level3">
<h3 class="anchored" data-anchor-id="循环卷积">循环卷积</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?R"> 是<strong>交换环</strong>，我们记 <img src="https://latex.codecogs.com/png.latex?A%20%5Cotimes%20B"> 代表模 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上两个向量的逐项乘法．</p>
<p>设 <img src="https://latex.codecogs.com/png.latex?F"> 是 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上主要单位根 <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> 对应的 <img src="https://latex.codecogs.com/png.latex?n"> 点可逆 DFT 变换，<img src="https://latex.codecogs.com/png.latex?A,B"> 是 <img src="https://latex.codecogs.com/png.latex?R%5En"> 中两个任意取定的向量．显然 <img src="https://latex.codecogs.com/png.latex?F(A+B)=FA+FB">，故 DFT 变换保持 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上的加法运算．现在的主要问题是，求值与插值部分计算卷积的方法 <img src="https://latex.codecogs.com/png.latex?F%5E%7B-1%7D(FA%20%5Cotimes%20FB)"> 在放宽环限制的 <img src="https://latex.codecogs.com/png.latex?R%5En"> 上进行时，将会得到什么结果？</p>
<p>令 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0A%20%20%20%20%5Chat%7B%5Cboldsymbol%20a%7D%20=%20F%20%5Cboldsymbol%20a,%5Cquad%20%5Chat%7B%5Cboldsymbol%20b%7D%20=%20F%20%5Cboldsymbol%20b%20%5C%5C%0A%20%20%20%20%5Chat%20%7B%5Cboldsymbol%20c%7D=%20%5Chat%7B%5Cboldsymbol%20a%7D%20%5Cotimes%20%5Chat%7B%5Cboldsymbol%20b%7D,%5Cquad%20%5Cboldsymbol%20c%20=%20F%5E%7B-1%7D%20%5Chat%7B%5Cboldsymbol%20c%7D%0A%20%20%20%20%5Cend%7Bgathered%7D%0A"> 则 <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%20a_i%20=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_j%20%5Comega_n%5E%7Bij%7D,%5Cquad%20%5Chat%20b_i%20=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20b_k%20%5Comega_n%5E%7Bik%7D%0A"></p>
</section>
<section id="循环卷积-1" class="level3">
<h3 class="anchored" data-anchor-id="循环卷积-1">循环卷积</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%20c_i%20=%20%5Chat%20a_i%20%5Chat%20b_i%20=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_j%20%5Comega_n%5E%7Bij%7D%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20b_k%20%5Comega_n%5E%7Bik%7D%20=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_j%20b_k%20%5Comega_n%5E%7Bi(j+k)%7D%0A"> <img src="https://latex.codecogs.com/png.latex?%0Ac_i%20=%20%5Csum_%7Bt=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7B-it%7D%20%5Chat%20c_t%20=%20%20%5Csum_%7Bt=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7B-it%7D%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_j%20b_k%20%5Comega_n%5E%7Bt(j+k)%7D%0A%20%20%20%20=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_j%20b_k%20%5Csum_%7Bt=0%7D%5E%7Bn-1%7D%20%5Comega_n%5E%7Bt(j+k-i)%7D%0A"> 对最里侧的求和使用主要单位根的定义（求和引理），就有 <img src="https://latex.codecogs.com/png.latex?%0Ac_i%20=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_j%20b_k%20%5Bn%20%5Cmid%20j+k-i%5D%20=%20%5Csum_%7Bj+k%20%5Cequiv%20i%20%5Cbmod%7Bn%7D%7D%20a_j%20b_k%0A"> 这便是所谓的循环卷积．以后将 <img src="https://latex.codecogs.com/png.latex?R%5En"> 中向量 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a"> 和 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20b"> 的循环卷积记为 <img src="https://latex.codecogs.com/png.latex?%5Cboldsymbol%20a%20*%20%5Cboldsymbol%20b">．形象地来看，循环卷积中，次数超过 <img src="https://latex.codecogs.com/png.latex?n-1"> 的卷积项被模意义地地叠加到了以次数为 <img src="https://latex.codecogs.com/png.latex?0"> 为始的项上．</p>
</section>
<section id="卷积定理" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="卷积定理">卷积定理</h3>
<p>前述讨论已经证明<sup>30</sup> <img src="https://latex.codecogs.com/png.latex?%0AF(A%20*%20B)%20=%20FA%20%5Cotimes%20FB%0A"> 这便是一般交换环上 DFT 变换的（循环）卷积定理．</p>
<div class="no-row-height column-margin column-container"><div id="fn30"><p><sup>30</sup>&nbsp;虽然前面用到了 <img src="https://latex.codecogs.com/png.latex?F"> 可逆的要求，但该定理在 <img src="https://latex.codecogs.com/png.latex?F"> 不可逆时也成立．只需类似地验证两边相等即可．</p></div><div id="fn31"><p><sup>31</sup>&nbsp;具体来说，该变换只能是 DFT 矩阵的某个行置换．在 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20C%5En"> 上的证明可参见<span class="citation" data-cites="baraquin2023uniqueness">[14]</span>，主讲人目前正在研究整环上的版本，欢迎讨论．</p></div></div><p>我们指出，当要求所作变换可逆时，卷积定理反过来也要求所作变换是一类似 DFT 映射的变换<sup>31</sup>．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-2timesdft" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 5</strong></span> 尝试将任意序列 DFT 两次，观察结果．证明你的结论．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-detdft" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 6</strong></span> 求 DFT 矩阵的行列式．尽可能缩小可行解范围．</p>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="advanced-operations" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Advanced Operations</h1>
<section id="多项式全家桶---序言" class="level3">
<h3 class="anchored" data-anchor-id="多项式全家桶---序言">多项式全家桶 - 序言</h3>
<ul>
<li><p>有哪些？</p>
<ul>
<li>求逆、开根、对数、指数、快速幂、复合等</li>
</ul></li>
<li><p>咋推的？</p>
<ul>
<li>求解思路几乎都是倍增，时间复杂度几乎都是大常数 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"></li>
<li>Newton 迭代法是推导全家桶迭代公式的通法</li>
<li>严格化需要进一步的形式幂级数理论，主讲人不会</li>
</ul></li>
<li><p>有啥用？</p>
<ul>
<li>当你一波操作化出生成函数发现不会求系数</li>
</ul></li>
<li><p>怎么讲？</p>
<ul>
<li>受限于篇幅和主讲人能力，我们讲不完</li>
<li>只讲求逆和对数，其余请左转 OI Wiki</li>
</ul></li>
</ul>
</section>
<section id="多项式求逆" class="level3">
<h3 class="anchored" data-anchor-id="多项式求逆">多项式求逆</h3>
<p>给定一多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">，求解满足 <img src="https://latex.codecogs.com/png.latex?A(x)%20B(x)%20=%201%20%5Cpmod%7Bx%5E%7Bn%7D%7D"> 的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)">．</p>
<p>多项式逆元存在的充分必要条件是其常数项非零（这是因为边界条件 <img src="https://latex.codecogs.com/png.latex?b_0%20=%20%5Cfrac%201%20%7Ba_0%7D">），若存在则在模意义下一定唯一．这结论可直接由下述求解方法得到．不失一般性，只研究 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的次数至多为奇数 <img src="https://latex.codecogs.com/png.latex?2n-1"> 的情况．设 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA(x)%20&amp;=%20A_0(x)%20+%20x%5En%20A_1(x)%20%5C%5C%0AB(x)%20&amp;=%20B_0(x)%20+%20x%5En%20B_1(x)%0A%5Cend%7Baligned%7D%0A"> 考虑递归地在已知 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20B_0(x)%20=%20A_0(x)%20B_0(x)%20=%201%20%5Cpmod%7Bx%5En%7D%0A"> 的基础上求解 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的逆元．先指出该方法的时间复杂度为 <img src="https://latex.codecogs.com/png.latex?%0AT(n)%20=%20T(%5Cfrac%20n%202)%20+%20O(n%20%5Clog%20n)%20=%20O(n%20%5Clog%20n)%0A"></p>
</section>
<section id="多项式求逆-1" class="level3">
<h3 class="anchored" data-anchor-id="多项式求逆-1">多项式求逆</h3>
<p>以下简记 <img src="https://latex.codecogs.com/png.latex?A(x)"> 为 <img src="https://latex.codecogs.com/png.latex?A">，其它多项式同理．注意到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bcases%7D%0AA%20B_0%20=%201%20%5Cpmod%7Bx%5En%7D%20%5C%5C%0AA%20B%20=%201%20%5Cpmod%7Bx%5En%7D%0A%5Cend%7Bcases%7D%20%5Cimplies%20A%20(B-B_0)%20=%200%20%5Cpmod%7Bx%5En%7D%0A"> 由于 <img src="https://latex.codecogs.com/png.latex?A%20%5Cbmod%7Bx%5En%7D"> 非零，故 <img src="https://latex.codecogs.com/png.latex?%0AB-B_0%20=%200%20%5Cpmod%7Bx%5En%7D%0A"> 这也说明，多项式逆元在模不同 <img src="https://latex.codecogs.com/png.latex?x%5En"> 下的前缀保持一致．</p>
<p>两边平方得 <img src="https://latex.codecogs.com/png.latex?B%5E2%20-%202%20B%20B_0%20+%20B_0%5E2%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D"> 两侧同乘 <img src="https://latex.codecogs.com/png.latex?A"> 并移项得 <img src="https://latex.codecogs.com/png.latex?%0AB%20=%202%20B_0%20-%20A%20B_0%5E2%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"></p>
</section>
<section id="多项式求逆---实现" class="level3">
<h3 class="anchored" data-anchor-id="多项式求逆---实现">多项式求逆 - 实现</h3>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb6-1">Poly inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-2">    ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb6-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-4">        B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<ul>
<li>常数巨大的写法，仅作演示，请勿学习．</li>
<li>正确的写法是在 DFT 后的点值上操作多项式，请小心实现封装．</li>
</ul>
</section>
<section id="多项式-ln" class="level3">
<h3 class="anchored" data-anchor-id="多项式-ln">多项式 <img src="https://latex.codecogs.com/png.latex?%5Cln"></h3>
<p>给定一多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">，求解满足 <img src="https://latex.codecogs.com/png.latex?B(x)%20=%20%5Cln%20A(x)%20%5Cpmod%7Bx%5E%7Bn%7D%7D"> 的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)">．</p>
<p>次数为 <img src="https://latex.codecogs.com/png.latex?+%5Cinfty"> 的形式幂级数的 <img src="https://latex.codecogs.com/png.latex?%5Cln"> 存在的充分必要条件为其常数项非零（这是因为边界条件 <img src="https://latex.codecogs.com/png.latex?b_0%20=%20%5Cln%20a_0">），同样一旦存在则唯一．注意到仅整数 <img src="https://latex.codecogs.com/png.latex?a_0=1"> 时，<img src="https://latex.codecogs.com/png.latex?%5Cln%20a_0"> 可取得整数，故合理的 <img src="https://latex.codecogs.com/png.latex?a_0"> 只能是 <img src="https://latex.codecogs.com/png.latex?1">．</p>
<p>推导是容易的．方程两侧同时求导得 <img src="https://latex.codecogs.com/png.latex?%0AB'(x)%20=%20%5Cfrac%7BA'(x)%7D%7BA(x)%7D%20%5Cpmod%7Bx%5E%7Bn-1%7D%7D%0A"> 两侧再积分得 <img src="https://latex.codecogs.com/png.latex?%0AB(x)%20=%20%5Cint%20%5Cfrac%7BA'(x)%7D%7BA(x)%7D%20%5Coperatorname%7Bd%7D%5C!x%20+%20C%20%5Cpmod%7Bx%5E%7Bn%7D%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?C=%20%5Cln%20a_0">．多项式求逆、求导、积分即可．时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)">．</p>
</section>
<section id="多项式-ln---实现" class="level3">
<h3 class="anchored" data-anchor-id="多项式-ln---实现">多项式 <img src="https://latex.codecogs.com/png.latex?%5Cln"> - 实现</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb7-1">Poly drv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// derivative</span></span>
<span id="cb7-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span>_<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-3">    A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>pop_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-5">Poly itg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// integral</span></span>
<span id="cb7-6">    A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>_<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-7">    A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-9">Poly ln<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> itg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">((</span>drv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)).</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/*log(A[0])*/</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="acknowledgements" class="level3">
<h3 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h3>
<ul>
<li><p>感谢 <code>keke_046</code> 学长教授 FFT、集合幂级数与生成函数．微言大义，博大精深，至今仍在消化．</p></li>
<li><p>感谢队友 <code>ItzDesert</code> 提供位运算典题一道并提供内容编排建议．</p></li>
</ul>
</section>
<section id="题单" class="level3 allowframebreaks">
<h3 class="allowframebreaks anchored" data-anchor-id="题单">题单</h3>
<p>主讲人练题少，仅供参考．</p>
<dl>
<dt>模板</dt>
<dd>
<ul>
<li><p><a href="https://www.luogu.com.cn/problem/P3803">洛谷 P3803</a> 【模板】多项式乘法（FFT）</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P6091">洛谷 P6091</a> 【模板】原根</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4238">洛谷 P4238</a> 【模板】多项式乘法逆</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P5205">洛谷 P5205</a> 【模板】多项式开根</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4725">洛谷 P4725</a> 【模板】多项式对数函数（多项式 ln）</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4726">洛谷 P4726</a> 【模板】多项式指数函数（多项式 exp）</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P5245">洛谷 P5245</a> 【模板】多项式快速幂</p></li>
</ul>
</dd>
<dt>大整数乘法</dt>
<dd>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P1919">洛谷 P1919</a> 【模板】A*B Problem 升级版（FFT 快速傅里叶变换）</li>
</ul>
</dd>
<dt>基础计数</dt>
<dd>
<ul>
<li><p><a href="https://www.spoj.com/problems/TSUM/">SPOJ-TSUM</a> Triple Sums</p></li>
<li><p>BZOJ3513-MUTC2013 Idiots</p>
<p>上面两道题都是 OGF 消序，较 EGF 消序困难．一般的方法是使用 Polya 计数原理．</p></li>
</ul>
</dd>
<dt>位运算</dt>
<dd>
<ul>
<li><p><a href="https://atcoder.jp/contests/abc291/tasks/abc291_g">ABC291G</a> OR Sum</p>
<p>也是滤波器的应用．</p></li>
</ul>
</dd>
<dt>分治 FFT</dt>
<dd>
<ul>
<li><p>百度之星 2023 初赛第二场 T8</p>
<p>容斥后需要计算若干一次多项式乘积，分治 NTT 即可．</p></li>
<li><p><a href="https://www.bilibili.com/video/BV1p14y1z7sF">百度之星 2023 初赛第一场 T6</a></p>
<p>求 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi%3Ej%7D%20%5Cfrac%7Ba_i%7D%7Ba_i%20+%20a_j%7D">．值域次数化后 CDQ 处理偏序．</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4721">洛谷 P4721</a> 【模板】分治 FFT</p>
<p>CDQ 偏序化处理前后项依赖．也可解生成函数方程再多项式求逆．</p></li>
</ul>
</dd>
<dt>字符串</dt>
<dd>
<ul>
<li><p><a href="https://atcoder.jp/contests/abc196/tasks/abc196_f">ABC196F</a> Substring 2</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4173">洛谷 P4173</a> 残缺的字符串</p>
<p>带单字符通配符的字符串匹配．体会设定字符串距离函数的方法．</p></li>
</ul>
</dd>
<dt>全家桶</dt>
<dd>
<ul>
<li><p><a href="https://www.luogu.com.cn/problem/P4721">洛谷 P4721</a> 【模板】分治 FFT</p>
<p>体验生成函数简化复杂数列递推的威力．</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4389">洛谷 P4389</a> 付公主的背包</p>
<p>解决此问题的方法也可用于分拆数计算．</p></li>
<li><p><a href="https://www.luogu.com.cn/problem/P4841">洛谷 P4841</a> 【集训队作业2013】城市规划</p>
<p>EGF 消序划分典题．体验生成函数风格的计数方法．</p></li>
<li><p><a href="https://loj.ac/p/6538">LOJ6538</a> 烷基计数 - 加强版 - 加强版</p>
<p>对生成函数使用的 Polya 计数．</p>
<p>Polya ex. 苯环碳接 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7B-C_4H_9%7D"> 同分异构体计数</p></li>
</ul>
</dd>
<dt>其它</dt>
<dd>
<ul>
<li><p><a href="https://qoj.ac/problem/5748">QOJ5748</a>-UCUP2023-Stage7-K Determinant, or...?</p>
<p>看似人畜无害的 <img src="https://latex.codecogs.com/png.latex?%5Cleft(%20a_%7Bi%20%5Coperatorname%7Bor%7D%20j%7D%20%5Cright)_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D"> 行列式求值，解法的背后却潜藏 FMT 的思想．此类行列式与各类反演、卷积有密切联系，我们给出一篇研究了其与偏序集上反演的关系的参考文献<span class="citation" data-cites="wilf1968hadamard">[15]</span>，欢迎讨论．</p></li>
</ul>
</dd>
</dl>



</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-oiwiki-lagrange" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">OI-Wiki, <span>《拉格朗日插值》</span>. <a href="https://oi-wiki.org/math/numerical/lagrange/" class="uri">https://oi-wiki.org/math/numerical/lagrange/</a>.</div>
</div>
<div id="ref-euler-formula" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">张筑生, <span>《数学分析新讲（重排本）（第二册）》</span>, 2 本北京: 北京大学出版社, 2021, 页 256–262.</div>
</div>
<div id="ref-trigonometry" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">杨树森, <span>《三角函数的严格定义》</span>. <a href="https://zhuanlan.zhihu.com/p/58814328/" class="uri">https://zhuanlan.zhihu.com/p/58814328/</a>, 2023年.</div>
</div>
<div id="ref-algointro" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">T. H. Cormen, C. E. Leiserson, R. L. Rivest, 和 C. Stein, <span>《算法导论（原书第三版）》</span>, 北京: 机械工业出版社, 2013.</div>
</div>
<div id="ref-oiwiki-discretelog" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">OI-Wiki, <span>《离散对数》</span>. <a href="https://oi-wiki.org/math/number-theory/discrete-logarithm/" class="uri">https://oi-wiki.org/math/number-theory/discrete-logarithm/</a>.</div>
</div>
<div id="ref-oiwiki-pr" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">OI-Wiki, <span>《原根》</span>. <a href="https://oi-wiki.org/math/number-theory/primitive-root/" class="uri">https://oi-wiki.org/math/number-theory/primitive-root/</a>.</div>
</div>
<div id="ref-agarwal1974fast" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">R. Agarwal 和 C. Burrus, <span>《Fast Convolution using fermat number transforms with applications to digital filtering》</span>, <em>IEEE Transactions on Acoustics, Speech, and Signal Processing</em>, 卷 22, 期 2, 页 87–97, 1974, doi: <a href="https://doi.org/10.1109/TASSP.1974.1162555">10.1109/TASSP.1974.1162555</a>.</div>
</div>
<div id="ref-qiu-algebra" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">丘维声, <span>《高等代数&nbsp;下册》</span>, 3 本北京: 高等教育出版社, 2015.</div>
</div>
<div id="ref-oiwiki-polynomial" class="csl-entry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">OI-Wiki, <span>《多项式与生成函数简介》</span>. <a href="https://oi-wiki.org/math/poly/intro/" class="uri">https://oi-wiki.org/math/poly/intro/</a>.</div>
</div>
<div id="ref-wikipedia-formalpowerseries" class="csl-entry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">Wikipedia, <span>《Formal power series》</span>. <a href="https://en.wikipedia.org/wiki/Formal_power_series" class="uri">https://en.wikipedia.org/wiki/Formal_power_series</a>.</div>
</div>
<div id="ref-wikipedia-lagrange" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">Wikipedia, <span>《Lagrange polynomial》</span>. <a href="https://en.wikipedia.org/wiki/Lagrange_polynomial" class="uri">https://en.wikipedia.org/wiki/Lagrange_polynomial</a>.</div>
</div>
<div id="ref-furer2009faster" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">M. Fürer, <span>《Faster Integer Multiplication》</span>, <em>SIAM Journal on Computing</em>, 卷 39, 期 3, 页 979–1005, 2009, doi: <a href="https://doi.org/10.1137/070711761">10.1137/070711761</a>.</div>
</div>
<div id="ref-wikipedia-dft-over-ring" class="csl-entry">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">Wikipedia, <span>《Discrete Fourier transform over a ring》</span>. <a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform_over_a_ring" class="uri">https://en.wikipedia.org/wiki/Discrete_Fourier_transform_over_a_ring</a>.</div>
</div>
<div id="ref-baraquin2023uniqueness" class="csl-entry">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">I. Baraquin 和 N. Ratier, <span>《Uniqueness of the discrete Fourier transform》</span>, <em>Signal Processing</em>, 卷 209, 页 109041, 2023.</div>
</div>
<div id="ref-wilf1968hadamard" class="csl-entry">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">H. S. Wilf, <span>《Hadamard determinants M<span>ö</span>bius functions, and the chromatic number of a graph》</span>, 1968.</div>
</div>
</div></section></div> ]]></description>
  <category>OI</category>
  <category>数学</category>
  <category>讲稿</category>
  <category>slide</category>
  <guid>https://blog.sun123zxy.top/posts/20230928-dft/</guid>
  <pubDate>Mon, 31 Jul 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>算法 &amp; 数学碎碎念</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230621-cpmodel/</link>
  <description><![CDATA[ 




<p>前半部分主要为公式、推导、证明等速成提纲，大部分实现、模板、表格放在文末．</p>
<section id="数论" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="数论"><span class="header-section-number">1</span> 数论</h2>
<section id="exgcd" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="exgcd"><span class="header-section-number">1.1</span> ExGCD</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-exgcd" class="theorem">
<p><span class="theorem-title"><strong>定理 1 (ExGCD)</strong></span> 给定线性方程组 <img src="https://latex.codecogs.com/png.latex?ax+by=%5Cgcd(a,b)">，其解可递归地由下式求得 <img src="https://latex.codecogs.com/png.latex?%0Aa%20y_1%20+%20b%20%5Cleft(%20x_1%20-%20%5Cleft%5Clfloor%20%5Cfrac%20a%20b%20%5Cright%5Crfloor%20y_1%20%5Cright)%20=%20%5Cgcd(b,%20a%20%5Cbmod%20b)%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?x_1,%20y_1"> 是 <img src="https://latex.codecogs.com/png.latex?b%20x%20+%20(a%20%5Cbmod%20b)%20y%20=%20%5Cgcd(b,%20a%20%5Cbmod%20b)"> 的一组解．</p>
</div>
</div>
</div>
</div>
</section>
<section id="crt" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="crt"><span class="header-section-number">1.2</span> CRT</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-crt" class="theorem">
<p><span class="theorem-title"><strong>定理 2 (CRT)</strong></span> 给定 <img src="https://latex.codecogs.com/png.latex?n"> 个同余方程 <img src="https://latex.codecogs.com/png.latex?%0Ax%20%5Cequiv%20a_i%20%5Cpmod%7Bm_i%7D%20%5Cpod%7Bi%20=%201,%20%5Cdots,%20n%7D%0A"></p>
<p>其中各 <img src="https://latex.codecogs.com/png.latex?m_i"> 两两互质，则上式等价于 <img src="https://latex.codecogs.com/png.latex?%0Ax%20%5Cequiv%20%5Csum_%7Bi=1%7D%5En%20a_i%20M_i%20%5Coperatorname%7Binv%7D_%7Bm_i%7D(M_i)%20%5Cpmod%20M%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?M%20=%20%5Cprod_%7Bi=1%7D%5En%20m_i">，<img src="https://latex.codecogs.com/png.latex?M_i%20=%20%5Cfrac%7BM%7D%7Bm_i%7D">．</p>
</div>
</div>
</div>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span><img src="https://latex.codecogs.com/png.latex?%0AM_i%20%5Coperatorname%7Binv%7D_%7Bm_i%7D(M_i)%20%5Cmod%20m_j%20=%20%5Bi%20=%20j%5D%0A"></p>
</div>
<section id="excrt" class="level4">
<h4 class="anchored" data-anchor-id="excrt">ExCRT</h4>
<p>对一般的情况，考虑合并两个同余方程．给定 <img src="https://latex.codecogs.com/png.latex?2"> 个同余方程 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%0A%5Cbegin%7Baligned%7D%0A%20%20x%20&amp;%5Cequiv%20a_1%20%5Cpmod%7Bm_1%7D%20%5C%5C%0A%20%20x%20&amp;%5Cequiv%20a_2%20%5Cpmod%7Bm_2%7D%0A%5Cend%7Baligned%7D%0A%5Cright.%0A"> 考虑化为不定方程形式 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%20%20x%20=%20k_1%20m_1%20+%20a_1%20%5C%5C%0A%20%20x%20=%20k_2%20m_2%20+%20a_2%0A%5Cend%7Baligned%7D%0A"> 合并得到 <img src="https://latex.codecogs.com/png.latex?%0Ak_1%20m_1%20+%20a_1%20=%20k_2%20m_2%20+%20a_2%0A"> 即 <img src="https://latex.codecogs.com/png.latex?%0Ak_1%20m_1%20-%20k_2%20m_2%20=%20a_2%20-%20a_1%0A"> 此即关于 <img src="https://latex.codecogs.com/png.latex?k_1,%20k_2"> 的不定方程．若 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(m_1,%20m_2)%20%5Cmid%20a_2%20-%20a_1">，则可应用 ExGCD 求得方程的一组解，带回即得 <img src="https://latex.codecogs.com/png.latex?%0Ax%20%5Cequiv%20k_1%20m_1%20+%20a_1%20%5Cpmod%7B%5Coperatorname%7Blcm%7D(m_1,%20m_2)%7D%0A"> 否则同余方程组无解．</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>若一组同余方程两两可合并，则全部均可合并．当判断大规模同余方程组是否有解时可能用到．</p>
</div>
</section>
</section>
<section id="bsgs" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="bsgs"><span class="header-section-number">1.3</span> BSGS</h3>
<p>求 <img src="https://latex.codecogs.com/png.latex?a%5Ex%20%5Cequiv%20b%20%5Cpmod%7Bm%7D"> 的一个特解，其中 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(a,m)%20=%201">．</p>
<p>实质是非常暴力的根号分治．根据 Euler 定理，只需检测连续 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)"> 个 <img src="https://latex.codecogs.com/png.latex?x"> 就可判定是否有解．令 <img src="https://latex.codecogs.com/png.latex?x%20=%20q%20%5Cleft%5Clceil%20%5Csqrt%20m%20%5Cright%5Crceil%20-r">，其中 <img src="https://latex.codecogs.com/png.latex?q,r%20%5Cin%20%5B1,%5Cleft%5Clceil%20%5Csqrt%20m%20%5Cright%5Crceil%5D">，于是 <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5B0,%5Cleft%5Clceil%20%5Csqrt%20m%20%5Cright%5Crceil%5E2)">．代入原方程移项即得 <img src="https://latex.codecogs.com/png.latex?a%5E%7Bq%20%5Cleft%5Clceil%20%5Csqrt%20m%20%5Cright%5Crceil%7D%20%5Cequiv%20b%20a%5Er%20%5Cpmod%7Bm%7D">，右边使用 <code>map</code> 提前存下即可．时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20m)">．</p>
</section>
<section id="miller-rabintodo" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="miller-rabintodo"><span class="header-section-number">1.4</span> Miller-Rabin【TODO】</h3>
</section>
<section id="pollard-rhotodo" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="pollard-rhotodo"><span class="header-section-number">1.5</span> Pollard-Rho【TODO】</h3>
</section>
<section id="原根euler-定理等" class="level3" data-number="1.6">
<h3 data-number="1.6" class="anchored" data-anchor-id="原根euler-定理等"><span class="header-section-number">1.6</span> 原根、Euler 定理等</h3>
<p>见 <a href="../..\posts/20230928-dft/">FFT/NTT 讲稿</a>．</p>
</section>
<section id="lucas-定理" class="level3" data-number="1.7">
<h3 data-number="1.7" class="anchored" data-anchor-id="lucas-定理"><span class="header-section-number">1.7</span> Lucas 定理</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nt-lucas" class="theorem">
<p><span class="theorem-title"><strong>定理 3 (Lucas 定理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbinom%7Bn%7D%7Bm%7D%20%5Cequiv%20%5Cprod_%7Bi%7D%20%5Cbinom%7Bn_i%7D%7Bm_i%7D%20%5Cequiv%20%5Cbinom%7B%5Cleft%5Clfloor%20n/p%20%5Cright%5Crfloor%7D%7B%5Cleft%5Clfloor%20m/p%20%5Cright%5Crfloor%7D%20%5Cbinom%7Bn%20%5Cbmod%20p%7D%7Bn%20%5Cbmod%20p%7D%20%5Cpmod%20p%0A"></p>
<p>其中 <img src="https://latex.codecogs.com/png.latex?p"> 是质数，<img src="https://latex.codecogs.com/png.latex?n_i"> 和 <img src="https://latex.codecogs.com/png.latex?m_i"> 是 <img src="https://latex.codecogs.com/png.latex?n"> 和 <img src="https://latex.codecogs.com/png.latex?m"> 的 <img src="https://latex.codecogs.com/png.latex?p"> 进制表示下的各数位．</p>
</div>
</div>
</div>
</div>
<p>证明的要点有二：一是 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%20%7Bp%5Ei%7D%20m%20%5Cbmod%20%7Bp%7D%20=%20%5Bm%20=%200%20%5Cland%20m%20=%20p%5Ei%5D">，即 <img src="https://latex.codecogs.com/png.latex?(1+x)%5E%7Bp%5Ei%7D%20%5Cequiv%201%20+%20x%5E%7Bp%5Ei%7D%20%5Cpmod%20p">；二是 Vandermonde 卷积按 <img src="https://latex.codecogs.com/png.latex?p"> 进制拆分．生成函数食用风味更佳．</p>
<p>参考：</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Lucas%27s_theorem">Lucas’s theorem - Wikipedia</a></li>
<li><a href="https://oi-wiki.org/math/number-theory/lucas/">卢卡斯定理 - OI Wiki</a></li>
</ul>
</section>
<section id="legendre-公式和-kummer-定理" class="level3" data-number="1.8">
<h3 data-number="1.8" class="anchored" data-anchor-id="legendre-公式和-kummer-定理"><span class="header-section-number">1.8</span> Legendre 公式和 Kummer 定理</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nt-legendre" class="theorem">
<p><span class="theorem-title"><strong>定理 4 (Legendre 公式)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p%20(n!)%20=%20%5Csum_%7Bi=1%7D%5E%7B+%5Cinfty%7D%20%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bp%5Ei%7D%20%5Cright%5Crfloor%20=%20%5Cfrac%7Bn-S_p(n)%7D%7Bp-1%7D%0A"></p>
<p>其中 <img src="https://latex.codecogs.com/png.latex?p"> 是质数，<img src="https://latex.codecogs.com/png.latex?S_p(n)"> 是 <img src="https://latex.codecogs.com/png.latex?n"> 在 <img src="https://latex.codecogs.com/png.latex?p"> 进制下各数位数字之和．<img src="https://latex.codecogs.com/png.latex?%5Cnu_p%20(n!)"> 为 <img src="https://latex.codecogs.com/png.latex?n!"> 中质因子 <img src="https://latex.codecogs.com/png.latex?p"> 的含量，即所谓的 <img src="https://latex.codecogs.com/png.latex?p">-adic valuation of <img src="https://latex.codecogs.com/png.latex?n!">．</p>
</div>
</div>
</div>
</div>
<p>左侧显然，按和式统计贡献即证．对于右侧， <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5E%7B+%5Cinfty%7D%20%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bp%5Ei%7D%20%5Cright%5Crfloor%20&amp;=%20%5Csum_%7Bi=1%7D%5E%7B+%5Cinfty%7D%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20n_%7Bk+i%7D%20p%5Ek%20%5C%5C%0A&amp;=%20%5Csum_%7Bj=1%7D%5E%7B+%5Cinfty%7D%20n_j%20%5Csum_%7Bk=0%7D%5E%7Bj-1%7D%20p%5Ek%20%5C%5C%0A&amp;=%20%5Csum_%7Bj=1%7D%5E%7B+%5Cinfty%7D%20n_j%20%5Cfrac%7Bp%5Ej-1%7D%7Bp-1%7D%20%5C%5C%0A&amp;=%20%5Cfrac%201%20%7Bp-1%7D%20%5Cleft(%5Csum_%7Bj=1%7D%5E%7B+%5Cinfty%7D%20n_j%20p%5Ej%20-%20%5Csum_%7Bj=1%7D%5E%7B+%5Cinfty%7D%20n_j%5Cright)%20%5C%5C%0A&amp;=%20%5Cfrac%201%20%7Bp-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7B+%5Cinfty%7D%20n_j%20p%5Ej%20-%20%5Csum_%7Bj=0%7D%5E%7B+%5Cinfty%7D%20n_j%5Cright)%20%5C%5C%0A&amp;=%20%5Cfrac%20%7Bn%20-%20S_p(n)%7D%7Bp-1%7D%0A%5Cend%7Baligned%7D%0A"></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nt-kummer" class="theorem">
<p><span class="theorem-title"><strong>定理 5 (Kummer 定理)</strong></span> <img src="https://latex.codecogs.com/png.latex?%5Cbinom%20%7Ba+b%7D%20a"> 中质因子 <img src="https://latex.codecogs.com/png.latex?p"> 的含量等于 <img src="https://latex.codecogs.com/png.latex?p"> 进制下加法 <img src="https://latex.codecogs.com/png.latex?a+b"> 发生的进位次数，也可表示为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p%20%5Cleft(%20%5Cbinom%20%7Ba+b%7D%7Ba%7D%20%5Cright)%20=%20%5Cfrac%7BS_p(a)+S_p(b)-S_p(a+b)%7D%7Bp-1%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>大力使用 定理&nbsp;4 考察 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%20%7Ba+b%7D%7Ba%7D"> 的含 <img src="https://latex.codecogs.com/png.latex?p"> 量： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cnu_p%20%5Cleft(%20%5Cbinom%20%7Ba+b%7D%7Ba%7D%20%5Cright)%20&amp;=%20%5Cnu_p((a+b)!)%20-%20%5Cnu_p(a!)%20-%20%5Cnu_p(b!)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=1%7D%5E%5Cinfty%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%20%7Ba+b%7D%7Bp%5Ek%7D%20%5Cright%5Crfloor%20-%20%5Cleft%5Clfloor%20%5Cfrac%20%7Ba%7D%7Bp%5Ek%7D%20%5Cright%5Crfloor%20-%20%5Cleft%5Clfloor%20%5Cfrac%20%7Bb%7D%7Bp%5Ek%7D%20%5Cright%5Crfloor%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 该公式恰好对 <img src="https://latex.codecogs.com/png.latex?a+b"> 在 <img src="https://latex.codecogs.com/png.latex?p"> 进制计算过程中每一位发生的进位进行了求和．定理的 <img src="https://latex.codecogs.com/png.latex?S_p"> 形式容易通过 定理&nbsp;4 的另一形式得到．</p>
<p>研究该定理 <img src="https://latex.codecogs.com/png.latex?a+b%20=%20p%5Em"> 的特例．用下降阶乘幂形式考虑二项式系数中 <img src="https://latex.codecogs.com/png.latex?k"> 递增的过程，注意到 <img src="https://latex.codecogs.com/png.latex?%5Cnu_p%20(p%5Em-k)%20=%20%5Cnu_p(k)">，可以发现分子新增的 <img src="https://latex.codecogs.com/png.latex?n-k+1"> 和分母新增的 <img src="https://latex.codecogs.com/png.latex?k"> 恰好错一位，于是 <img src="https://latex.codecogs.com/png.latex?%0A%5Cnu_p%20%5Cleft(%20%5Cbinom%20%7Bp%5Em%7D%20k%20%5Cright)%20=%20m%20-%20%5Cnu_p%20(k),%5Cquad%20k%20=%201,2,%5Cdots,p%5Em%0A"></p>
<p>作为 Kummer 定理和上述特殊情况的推论，我们有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cgcd_%7Bk=1%7D%5E%7Bn-1%7D%20%5Cbinom%7Bn%7D%7Bk%7D%20=%20%5Cbegin%7Bcases%7D%0Ap%20&amp;%20n%20=%20p%5Em%20%5C%5C%0A1%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?p"> 是某一质数．这符合 Kummer 定理的直观描述．得到 <img src="https://latex.codecogs.com/png.latex?p%5Em"> 的加法必然会出现进位，在加法 <img src="https://latex.codecogs.com/png.latex?p%5E%7Bm-1%7D%20+%20(p-1)%20p%5E%7Bm-1%7D"> 时达到最小进位次数 <img src="https://latex.codecogs.com/png.latex?1">；否则在任一质数进制 <img src="https://latex.codecogs.com/png.latex?p"> 下，都可以取加法 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blowbit%7D_p%20(n)%20+%20(n%20-%20%5Coperatorname%7Blowbit%7D_p%20(n))"> 使得不发生进位．</p>
<p>参考：</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Legendre%27s_formula">Legendre’s formula - Wikipedia</a></li>
<li><a href="https://en.wiokipedia.org/wiki/Kummer%27s_theorem">Kummer’s theorem - Wikipedia</a></li>
</ul>
</section>
<section id="扩展-euler-定理" class="level3" data-number="1.9">
<h3 data-number="1.9" class="anchored" data-anchor-id="扩展-euler-定理"><span class="header-section-number">1.9</span> 扩展 Euler 定理</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa%5Eb%20%5Cequiv%20a%5E%7Bb%20%5Cbmod%20%5Cvarphi(m)%20+%20%5Cvarphi(m)%7D%20%5Cpmod%7Bm%7D%0A"></p>
<p>进入循环所需步骤其实很少，一定小于 <img src="https://latex.codecogs.com/png.latex?%5Cvarphi(m)">．（疑似量级在 <img src="https://latex.codecogs.com/png.latex?%5Clog%20m"> 以下，存疑，见 FFT 讲稿）</p>
</section>
<section id="lagrange-定理" class="level3" data-number="1.10">
<h3 data-number="1.10" class="anchored" data-anchor-id="lagrange-定理"><span class="header-section-number">1.10</span> Lagrange 定理</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nt-lagrange" class="theorem">
<p><span class="theorem-title"><strong>定理 6 (Lagrange 定理)</strong></span> 设 <img src="https://latex.codecogs.com/png.latex?p"> 是质数，<img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cin%20%5Cmathbb%20Z_p%5Bx%5D">．同余方程 <img src="https://latex.codecogs.com/png.latex?A(x)%20%5Cequiv%200%20%5Cpmod%20p"> 只有至多 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bdeg%7D%20A(x)"> 个模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下不同的整数解，除非这多项式的系数在模 <img src="https://latex.codecogs.com/png.latex?p"> 意义下全为零．</p>
</div>
</div>
</div>
</div>
<p>这是域上的多项式理论在模 <img src="https://latex.codecogs.com/png.latex?p"> 整数域上的应用．</p>
</section>
<section id="wilson-定理" class="level3" data-number="1.11">
<h3 data-number="1.11" class="anchored" data-anchor-id="wilson-定理"><span class="header-section-number">1.11</span> Wilson 定理</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-nt-wilson" class="theorem">
<p><span class="theorem-title"><strong>定理 7 (Wilson 定理)</strong></span> 对质数 <img src="https://latex.codecogs.com/png.latex?p">， <img src="https://latex.codecogs.com/png.latex?%0A(p-1)!%20%5Cequiv%20-1%20%5Cpmod%20p%0A"></p>
</div>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?p=2"> 容易特判证明．现在只考虑 <img src="https://latex.codecogs.com/png.latex?p"> 是奇质数的情况．</p>
<p><img src="https://latex.codecogs.com/png.latex?(p-1)!"> 中，互为逆元的数相互抵消，仅剩下逆元为自身的数 <img src="https://latex.codecogs.com/png.latex?%5Cpm%201">，立得上述定理．</p>
<p>另一种证法注意到 <img src="https://latex.codecogs.com/png.latex?x%5E%7Bp-1%7D%20-%201%20=%20%5Cprod_%7Bk=1%7D%5E%7Bp-1%7D%20(x-k)">．这是因为 Fermat 小定理指出 <img src="https://latex.codecogs.com/png.latex?1"> 至 <img src="https://latex.codecogs.com/png.latex?p-1"> 的所有数的 <img src="https://latex.codecogs.com/png.latex?p-1"> 次幂均为 <img src="https://latex.codecogs.com/png.latex?1">，而 Lagrange 定理又保证了多项式点值到系数映射的唯一性．随后代入 <img src="https://latex.codecogs.com/png.latex?x=0"> 立得结论．</p>
<p>参见 <a href="https://en.wikipedia.org/wiki/Wilson%27s_theorem">Wilson’s theorem - Wikipedia</a>．</p>
</section>
<section id="线性预处理" class="level3" data-number="1.12">
<h3 data-number="1.12" class="anchored" data-anchor-id="线性预处理"><span class="header-section-number">1.12</span> 线性预处理</h3>
<section id="线性求逆元" class="level4">
<h4 class="anchored" data-anchor-id="线性求逆元">线性求逆元</h4>
<p>现欲求出 <img src="https://latex.codecogs.com/png.latex?a"> 模质数 <img src="https://latex.codecogs.com/png.latex?p"> 意义下的逆元 <img src="https://latex.codecogs.com/png.latex?a%5E%7B-1%7D">．用 <img src="https://latex.codecogs.com/png.latex?a"> 对 <img src="https://latex.codecogs.com/png.latex?p"> 做带余除法，<img src="https://latex.codecogs.com/png.latex?p=qa+r">，于是 <img src="https://latex.codecogs.com/png.latex?-qa%20%5Cequiv%20r%20%5Cpmod%20p">．两侧同时乘 <img src="https://latex.codecogs.com/png.latex?r"> 的逆元 <img src="https://latex.codecogs.com/png.latex?r%5E%7B-1%7D"> 得 <img src="https://latex.codecogs.com/png.latex?-q%20r%5E%7B-1%7D%20a%20%5Cequiv%201%20%5Cpmod%20p">，故 <img src="https://latex.codecogs.com/png.latex?%0Aa%5E%7B-1%7D%20=%20-%20q%20r%5E%7B-1%7D%20=%20-%20%5Cleft%5Clfloor%20%5Cfrac%20p%20a%20%5Cright%5Crfloor%20%5Ccdot%20(p%20%5Cbmod%20a)%5E%7B-1%7D%0A"></p>
</section>
<section id="线性阶乘逆" class="level4">
<h4 class="anchored" data-anchor-id="线性阶乘逆">线性阶乘逆</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%201%20%7Bn!%7D%20=%20(n+1)%20%5Ccdot%20%5Cfrac%201%20%7B(n+1)!%7D%0A"></p>
</section>
</section>
</section>
<section id="积性函数" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="积性函数"><span class="header-section-number">2</span> 积性函数</h2>
<section id="整除分块" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="整除分块"><span class="header-section-number">2.1</span> 整除分块</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1">ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-3">    d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4">    ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=(</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))*</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>此 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20n)"> 较满，极大劣于因子个数的 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20n)">．</p>
<p>另有变种枚举 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bd%5E2%7D%20%5Cright%5Crfloor"> 的整除分块如下，复杂度为 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B1/3%7D)">．</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1">ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb2-3">    d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sqrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb2-4">    ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=(</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))*</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<section id="上取整整除分块" class="level4">
<h4 class="anchored" data-anchor-id="上取整整除分块">上取整整除分块</h4>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1">ll cdiv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ceil(a/b)</span></span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)?</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-4">ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb3-6">    d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cdiv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span> l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cdiv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-7">    ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=(</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))*</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
</section>
<section id="杜教筛" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="杜教筛"><span class="header-section-number">2.2</span> 杜教筛</h3>
<p>设 <img src="https://latex.codecogs.com/png.latex?f"> 为一数论函数，我们希望快速求得其前缀和 <img src="https://latex.codecogs.com/png.latex?%5Chat%20f%20(n)%20=%20%5Csum_%7Bi=1%7D%5En%20f(i)">. 考虑数论函数 <img src="https://latex.codecogs.com/png.latex?g"> 和 <img src="https://latex.codecogs.com/png.latex?h%20=%20g%20*%20f">， <img src="https://latex.codecogs.com/png.latex?%0Ah(n)%20=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20g(d)%20f(%5Cfrac%20n%20d)%0A"> 两端做前缀和得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%20h%20(n)%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20h(i)%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%20g(d)%20f(%5Cfrac%20i%20d)%20%5C%5C%0A&amp;=%20%5Csum_%7Bd=1%7D%5En%20g(d)%20%5Csum_%7Bi=1%7D%5E%7B%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%7D%20f(i)%20%5C%5C%0A&amp;=%20%5Csum_%7Bd=1%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%20%5C%5C%0A&amp;=%20g(1)%20%5Chat%20f%20(n)%20+%20%5Csum_%7Bd=2%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%0A%5Cend%7Baligned%7D%0A"> 因此 <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%20f%20(n)%20=%20%5Cfrac%201%20%7Bg(1)%7D%20%5Cleft(%20%5Chat%20h%20(n)%20-%20%5Csum_%7Bd=2%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%20%5Cright)%0A"></p>
<p>故若 <img src="https://latex.codecogs.com/png.latex?g">、<img src="https://latex.codecogs.com/png.latex?h"> 的前缀和可 <img src="https://latex.codecogs.com/png.latex?O(1)"> 算得，根据上式整除分块即可递归地计算出 <img src="https://latex.codecogs.com/png.latex?f"> 的前缀和．预处理前 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B2/3%7D)"> 项并记忆化得到的时间复杂度为 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B2/3%7D)">．外层整除分块不会增加时间复杂度．</p>
<p>关于时间复杂度证明可参考 <a href="../..\posts/20230418-complexity/#杜教筛">sun123zxy’s blog - OI 数论中的上界估计与时间复杂度证明 # 杜教筛</a>．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0Af%20=%20%5Cmu,%20g%20=%20I,%20h%20=%20%5Cvarepsilon%20%5C%5C%0Af%20=%20%5Cvarphi,%20g%20=%20I,%20h%20=%20%5Coperatorname%7Bid%7D%5C%5C%0Af%20=%20%5Coperatorname%7Bid%7D%5Ek%20%5Cmu,%20g%20=%20%5Coperatorname%7Bid%7D%5Ek,%20h%20=%20%5Cvarepsilon%20%5C%5C%0Af%20=%20%5Coperatorname%7Bid%7D%5Ek%20%5Cvarphi,%20g%20=%20%5Coperatorname%7Bid%7D%5Ek,%20h%20=%20%5Coperatorname%7Bid%7D%5E%7Bk+1%7D%0A%5Cend%7Bgathered%7D%0A"></p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>杜教筛的这种化法事实上也是 Eratosthenes 筛法的应用．一般的我们有 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd=1%7D%5En%20f(d)%20%5Chat%20g(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%20f(d)%20g(%5Cfrac%20i%20d)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%20f(%5Cfrac%20i%20d)%20g(d)%20%20%20=%20%5Csum_%7Bd=1%7D%5En%20g(d)%20%5Chat%20f(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20)%0A"></p>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb4-1">unordered_map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s_mu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-2">ll S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>MXG<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// already accumulated</span></span>
<span id="cb4-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s_mu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>count<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)){</span></span>
<span id="cb4-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s_mu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb4-7">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-8">    ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-10">        d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-11">        ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb4-12">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s_mu</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-14"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="杂式" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="杂式"><span class="header-section-number">2.3</span> 杂式</h3>
<p>无平方因子数计数： <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20%5Cmu%5E2(i)%20=%20%5Csum_%7Bi=1%7D%5E%7B%5Cleft%5Clfloor%20%5Csqrt%20n%20%5Cright%5Crfloor%7D%20%5Cmu(i)%20%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor%0A"></p>
<p><a href="../..\posts/20200220-factor/">约数个数函数的一个性质</a>：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad(ab)%20=%20%5Csum_%7Bx%7Ca%7D%20%5Csum_%7By%7Cb%7D%20%5B%5Cgcd%20(x,y)%20=%201%5D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ad(abc)%20=%20%5Csum_%7Bx%7Ca%7D%20%5Csum_%7By%7Cb%7D%20%5Csum_%7Bz%7Cc%7D%20%5B%5Cgcd%20(x,y)%20=%201%5D%20%5B%5Cgcd%20(y,z)%20=%201%5D%20%5B%5Cgcd%20(x,z)%20=1%5D%0A"></p>
<p>广义约数个数函数性质扩展：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma_k%20(ab)%20=%20%5Csum_%7Bx%7Ca%7D%20%5Csum_%7By%7Cb%7D%20%5B%5Cgcd(x,y)=1%5D%20(x%20%5Cfrac%7Bb%7D%7By%7D)%5Ek%20=%20%5Csum_%7Bx%7Ca%7D%20%5Csum_%7By%7Cb%7D%20%5B%5Cgcd(x,%5Cfrac%7Bb%7D%7By%7D)=1%5D%20(x%20y)%5Ek%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma_k%20(abc)%20=%20%5Csum_%7Bx%7Ca%7D%20%5Csum_%7By%7Cb%7D%20%5Csum_%7Bz%7Cc%7D%20%5B%5Cgcd(x,%5Cfrac%7Bb%7D%7By%7D)=1%5D%20%5B%5Cgcd(y,%5Cfrac%7Bc%7D%7Bz%7D)=1%5D%20%5B%5Cgcd(x,%20%5Cfrac%7Bc%7D%7Bz%7D=1)%5D%20(x%20y%20z)%5Ek%0A"></p>
</section>
</section>
<section id="组合" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="组合"><span class="header-section-number">3</span> 组合</h2>
<section id="容斥-二项式反演" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="容斥-二项式反演"><span class="header-section-number">3.1</span> 容斥 / 二项式反演</h3>
<section id="形式一" class="level4">
<h4 class="anchored" data-anchor-id="形式一">形式一</h4>
<p>容斥原理的第一种形式给出了“子集和变换”的逆变换．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-inex-first-set" class="theorem">
<p><span class="theorem-title"><strong>定理 8 (容斥原理，形式一，集合)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0Ag(S)%20=%20%5Csum_%7BT%20%5Csubset%20S%7D%20f(T)%20%5Ciff%20f(S)%20=%20%5Csum_%7BT%20%5Csubset%20S%7D%20(-1)%5E%7B%7CS%7C%20-%20%7CT%7C%7D%20g(T)%0A"></p>
</div>
</div>
</div>
</div>
<p>证明的关键是 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5En%20%5Cbinom%20n%20k%20(-1)%5Ek%20=%20(1-1)%5En%20=%20%5Bn=0%5D">．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-inex-first-binomial" class="theorem">
<p><span class="theorem-title"><strong>定理 9 (容斥原理，形式一，二项式反演)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0Ag(n)%20=%20%5Csum_%7Bk=0%7D%5En%20%5Cbinom%20n%20k%20f(k)%20%5Ciff%20f(n)%20=%20%5Csum_%7Bk=0%7D%5En%20(-1)%5E%7Bn-k%7D%20%5Cbinom%20n%20k%20g(k)%0A"></p>
<p>若设 <img src="https://latex.codecogs.com/png.latex?F(x)"> 和 <img src="https://latex.codecogs.com/png.latex?G(x)"> 分别为 <img src="https://latex.codecogs.com/png.latex?f(n)"> 和 <img src="https://latex.codecogs.com/png.latex?g(n)"> 的指数生成函数（EGF），则结论可等价地表示为</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AG(x)%20=%20e%5Ex%20F(x)%20%5Ciff%20F(x)%20=%20e%5E%7B-x%7D%20G(x)%0A"></p>
</div>
</div>
</div>
</div>
<p>生成函数的形式使我们可在 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"> 的优秀时间复杂度之内在 <img src="https://latex.codecogs.com/png.latex?f(n)"> 和 <img src="https://latex.codecogs.com/png.latex?g(n)"> 间做出变换．</p>
</section>
<section id="形式二" class="level4">
<h4 class="anchored" data-anchor-id="形式二">形式二</h4>
<p>形式一的补集形式，给出了全集 <img src="https://latex.codecogs.com/png.latex?U"> 下“超集和变换”的逆变换．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-inex-second-set" class="theorem">
<p><span class="theorem-title"><strong>定理 10 (容斥原理，形式二，集合)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0Ag(S)%20=%20%5Csum_%7BS%20%5Csubset%20T%20%5Csubset%20U%7D%20f(T)%20%5Ciff%20f(S)%20=%20%5Csum_%7BS%20%5Csubset%20T%20%5Csubset%20U%7D%20(-1)%5E%7B%7CT%7C%20-%20%7CS%7C%7D%20g(T)%0A"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-inex-second-binomal" class="theorem">
<p><span class="theorem-title"><strong>定理 11 (容斥原理，形式二，二项式反演)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0Ag(n)%20=%20%5Csum_%7Bk=0%7D%5E%7BN-n%7D%20%5Cbinom%20%7BN-n%7D%20k%20f(n+k)%20%5Ciff%20f(n)%20=%20%5Csum_%7Bk=0%7D%5E%7BN-n%7D%20(-1)%5Ek%20%5Cbinom%20%7BN-n%7D%20k%20g(n+k)%0A"></p>
</div>
</div>
</div>
</div>
</section>
<section id="应用" class="level4">
<h4 class="anchored" data-anchor-id="应用">应用</h4>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-inex-extraordinary" class="theorem example">
<p><span class="theorem-title"><strong>例 1 (不太常见的“容斥原理”)</strong></span> 满足全部性质的元素数量可容斥地通过下式计算 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcap_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7B%7CS%7C=k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U-S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7B%7CS%7C=k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcup_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7Bi_1%20%3C%20%5Cdots%20%3C%20i_k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A_%7Bi_1%7D%20%5Ccup%20%5Cdots%20%5Ccup%20A_%7Bi_k%7D%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?A"> 代表全集，<img src="https://latex.codecogs.com/png.latex?A_i"> 代表满足第 <img src="https://latex.codecogs.com/png.latex?i"> 个性质的元素构成的集合，<img src="https://latex.codecogs.com/png.latex?U"> 是非空有限的性质指标集．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>令 <img src="https://latex.codecogs.com/png.latex?f(S)"> 为恰好只满足 <img src="https://latex.codecogs.com/png.latex?S"> 中各性质的元素数量，<img src="https://latex.codecogs.com/png.latex?g(S)"> 为至多只满足 <img src="https://latex.codecogs.com/png.latex?S"> 中各性质的元素数量，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0Af(S)%20:=%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cleft(%20A%20%5Ccap%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20-%20%5Cbigcup_%7Bi%20%5Cin%20U-S%7D%20A_i%20%5Cright)%20%5C%5C%0Ag(S)%20:=%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U-S%7D%20A_i%20%5Cright)%0A=%20%5Coperatorname%7Bcard%7D%5Cleft(A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20+%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcup_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%0A%5Cend%7Bgathered%7D%0A"> 取 <img src="https://latex.codecogs.com/png.latex?S=U"> 代入 定理&nbsp;8 右侧就得到结论第一行的等式．继续化简 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcap_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7B%7CS%7C=k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U-S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7B%7CS%7C=k%7D%20%5Cleft(%20%5Coperatorname%7Bcard%7D%5Cleft(A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20+%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcup_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5Cright)%20%5C%5C%0A&amp;=%20%5Coperatorname%7Bcard%7D%5Cleft(A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Cbinom%7B%7CU%7C%7D%7Bk%7D%20+%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Csum_%7B%7CS%7C=k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcup_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 注意到 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7B%7CU%7C-k%7D%20%5Cbinom%7B%7CU%7C%7D%7Bk%7D%20=%20%5B%7CU%7C%20=%200%5D%0A"> 而 <img src="https://latex.codecogs.com/png.latex?U%20%5Cneq%20%5Cvarnothing">，故上式左项为 <img src="https://latex.codecogs.com/png.latex?0">，即得结论式第二行．</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-inex-ordinary-out" class="theorem example">
<p><span class="theorem-title"><strong>例 2 (有点常见的“容斥原理”)</strong></span> 不满足任何性质的元素数量可容斥地通过下式计算 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Coperatorname%7Bcard%7D%5Cleft(%20A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Csum_%7B%7CS%7C%20=%20k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20%5Ccap%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Coperatorname%7Bcard%7DA%20+%20%5Csum_%7Bk=1%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Csum_%7B%7CS%7C%20=%20k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Coperatorname%7Bcard%7DA%20+%20%5Csum_%7Bk=1%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Csum_%7Bi_1%20%3C%20%5Cdots%20%3C%20i_k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A_%7Bi_1%7D%20%5Ccap%20%5Cdots%20%5Ccap%20A_%7Bi_k%7D%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?A"> 代表全集，<img src="https://latex.codecogs.com/png.latex?A_i"> 代表满足第 <img src="https://latex.codecogs.com/png.latex?i"> 个性质的元素构成的集合，<img src="https://latex.codecogs.com/png.latex?U"> 是非空有限的性质指标集．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>令 <img src="https://latex.codecogs.com/png.latex?f(S)"> 为恰好只满足 <img src="https://latex.codecogs.com/png.latex?S"> 中各性质的元素数量，<img src="https://latex.codecogs.com/png.latex?g(S)"> 为至少满足 <img src="https://latex.codecogs.com/png.latex?S"> 中各性质的元素数量，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0Af(S)%20:=%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cleft(%20A%20%5Ccap%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20-%20%5Cbigcup_%7Bi%20%5Cin%20U-S%7D%20A_i%20%5Cright)%20%5C%5C%0Ag(S)%20:=%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20%5Ccap%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%0A=%20%5Cbegin%7Bcases%7D%0A%5Coperatorname%7Bcard%7DA%20&amp;%20S%20=%20%5Cvarnothing%20%5C%5C%0A%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A%5Cend%7Bgathered%7D%0A"> 取 <img src="https://latex.codecogs.com/png.latex?S=%5Cvarnothing"> 代入 定理&nbsp;10 右侧就得到结论．</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-inex-shuffle" class="theorem exercise">
<p><span class="theorem-title"><strong>习题 1 (错排)</strong></span> 计算 <img src="https://latex.codecogs.com/png.latex?n"> 元错排的数量．</p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>解</em>. </span>设 <img src="https://latex.codecogs.com/png.latex?A_i"> 表示第 <img src="https://latex.codecogs.com/png.latex?i"> 个位置配对正确的置换构成的集合．直接应用 例&nbsp;2 立得</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Coperatorname%7Bcard%7D%5Cleft(%20A%20-%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Csum_%7B%7CS%7C%20=%20k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A%20%5Ccap%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Cbinom%20n%20k%20(n-k)!%20%5C%5C%0A&amp;=%20n!%20%5Csum_%7Bk=0%7D%5E%7B%7CU%7C%7D%20(-1)%5Ek%20%5Cfrac%201%20%7Bk!%7D%20%5Csim%20%5Cfrac%7Bn!%7D%7Be%7D%0A%5Cend%7Baligned%7D%0A"></p>
</div>
<p>这说明随机取一排列，其错排的概率趋近于 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20e">．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-inex-ordinary-in" class="theorem example">
<p><span class="theorem-title"><strong>例 3 (常见的“容斥原理”)</strong></span> 满足至少 <img src="https://latex.codecogs.com/png.latex?1"> 个性质的元素数量可容斥地通过下式计算 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcup_%7Bi%20%5Cin%20U%7D%20A_i%20%5Cright)%0A&amp;=%20%5Csum_%7Bk=1%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7Bk-1%7D%20%5Csum_%7B%7CS%7C%20=%20k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20%5Cbigcap_%7Bi%20%5Cin%20S%7D%20A_i%20%5Cright)%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=1%7D%5E%7B%7CU%7C%7D%20(-1)%5E%7Bk-1%7D%20%5Csum_%7Bi_1%20%3C%20%5Cdots%20%3C%20i_k%7D%20%5Coperatorname%7Bcard%7D%5Cleft(%20A_%7Bi_1%7D%20%5Ccap%20%5Cdots%20%5Ccap%20A_%7Bi_k%7D%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?A_i"> 代表满足第 <img src="https://latex.codecogs.com/png.latex?i"> 个性质的元素构成的集合，<img src="https://latex.codecogs.com/png.latex?i%20%5Cin%20U">．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>对 例&nbsp;2 做简单移项即得．</p>
</div>
</section>
</section>
<section id="球盒问题" class="level3 page-columns page-full" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="球盒问题"><span class="header-section-number">3.2</span> 球盒问题</h3>
<p>组合数学的万恶之源．</p>
<div class="column-screen-inset">
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?n"> balls</th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> boxes</th>
<th style="text-align: center;">allow empty?</th>
<th style="text-align: center;">recurrence / closed-form</th>
<th style="text-align: center;">generating functions</th>
<th style="text-align: center;">notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,1,0%7D"></td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">MAY empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r%5En"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%5Cmathrm%7BEGF%7D_r(x)%20&amp;=%20(e%5E%7Bx%7D)%5Er%20=%20e%5E%7Brx%7D%20%5C%5C%20%5Cmathrm%7BOGF%7D_r(x)%20&amp;=%20%5Cfrac%7B1%7D%7B1-rx%7D%5Cend%7Baligned%7D"></td>
<td style="text-align: center;">number of <img src="https://latex.codecogs.com/png.latex?%5Bn%5D%20%5Cto%20%5Br%5D"> mappings</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,1,1%7D"></td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r!%20%7Bn%20%5Cbrace%20r%7D%20=%20%5Csum_%7Bk=0%7D%5Er%20(-1)%5E%7Br-k%7D%20%5Cbinom%20r%20k%20k%5En"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20%5Cmathrm%7BEGF%7D_r(x)&amp;=(e%5Ex%20-%201)%5Er%20%5C%5C%20%5Cmathrm%7BEGF%7D_n(x)%20&amp;=%20e%5E%7B-x%7D%20%5Csum_%7Br=0%7D%5E%7B+%5Cinfty%7D%20r%5En%20%5Cfrac%7Bx%5Er%7D%7Br!%7D%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;">number of <img src="https://latex.codecogs.com/png.latex?%5Bn%5D%20%5Cto%20%5Br%5D"> surjections</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,1/%5CSigma,1%7D"></td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">Labeled; <img src="https://latex.codecogs.com/png.latex?r">-disabled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5En%20k!%20%7Bn%20%5Cbrace%20k%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_r(x)=%5Cfrac%7B1%7D%7B2-e%5Ex%7D%20=%20%5Cfrac%7B1%7D%7B1-(e%5Ex-1)%7D"></td>
<td style="text-align: center;">ordered Bell number; number of weak orderings / ordered set partitions on <img src="https://latex.codecogs.com/png.latex?%5Bn%5D"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,0,0%7D"></td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5Er%20%7Bn%20%5Cbrace%20k%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_r(x)%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cfrac%20%7B(e%5Ex%20-%201)%5Ek%7D%7Bk!%7D"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,0,1%7D"></td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20%7Bn%20%5Cbrace%20r%7D%20&amp;=%20%5Csum_%7Bk=0%7D%5Er%20%5Cfrac%7Bk%5En%7D%7Bk!%7D%20%5Ccdot%20%5Cfrac%7B(-1)%5E%7Br-k%7D%7D%7B(r-k)!%7D%20%5C%5C%20%7Bn+1%20%5Cbrace%20r%7D%20&amp;=%20r%20%7Bn%20%5Cbrace%20r%7D%20+%20%7Bn%20%5Cbrace%20r-1%7D%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20%5Cmathrm%7BEGF%7D_r(x)%20&amp;=%20%5Cfrac%7B(e%5Ex%20-%201)%5Er%7D%7Br!%7D%20%5C%5C%20%5Cmathrm%7BOGF%7D_n(x)%20&amp;=%20e%5E%7B-x%7D%20%5Csum_%7Br=0%7D%5E%7B+%5Cinfty%7D%20r%5En%20%5Cfrac%7Bx%5Er%7D%7Br!%7D%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;">Stirling number of the second kind</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B1,0/%5CSigma,1%7D"></td>
<td style="text-align: center;">labeled</td>
<td style="text-align: center;">UNLabeled; <img src="https://latex.codecogs.com/png.latex?r">-disabled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20B(n)%20&amp;=%20%5Csum_%7Bk=0%7D%5En%20%7Bn%20%5Cbrace%20k%7D%20%5C%5C%20B(n+1)%20&amp;=%20%5Csum_%7Bk=0%7D%5En%20%5Cbinom%20n%20k%20B(k)%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D(x)=e%5E%7Be%5Ex%20-%201%7D"></td>
<td style="text-align: center;">Bell number; number of equivialent relations / set partitions on <img src="https://latex.codecogs.com/png.latex?%5Bn%5D"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,1,0%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">MAY empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bn+r-1%7D%7Br-1%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BOGF_r%7D(x)%20=%20%5Cleft(%5Cfrac%201%20%7B1-x%7D%5Cright)%5Er"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> 元不定方程非负整数解个数</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,1,1%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">Labeled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbinom%7Bn-1%7D%7Br-1%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20%5Cmathrm%7BOGF_r%7D(x)%20&amp;=%20%5Cleft(%5Cfrac%20x%20%7B1-x%7D%5Cright)%5Er%20%5C%5C%20&amp;=%20x%5Er%20%5Cleft(%5Cfrac%201%20%7B1-x%7D%5Cright)%5Er%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> 元 <img src="https://latex.codecogs.com/png.latex?n"> 次单项式构型数</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,1/%5CSigma,1%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">Labeled; <img src="https://latex.codecogs.com/png.latex?r">-disabled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?a(n)=%5Cbegin%7Bcases%7D1%20&amp;%20n=1%20%5C%5C%202%5E%7Bn-1%7D%20&amp;%20n%5Cgeq%202%20%5Cend%7Bcases%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BOGF%7D(x)%20=%201+%5Cfrac%7Bx%7D%7B1-2x%7D%20=%20%5Cfrac%7B1%7D%7B1-%5Cfrac%7Bx%7D%7B1-x%7D%7D"></td>
<td style="text-align: center;">考虑“是否向前拼接”的 <img src="https://latex.codecogs.com/png.latex?n-1"> 个选择</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,0,0%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">MAY empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5Er%20p(n,k)"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> 元 <img src="https://latex.codecogs.com/png.latex?n"> 次单项对称多项式（monomial symmetric polynomial）构型数</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,0,1%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?p(n,r)=p(n-1,r-1)+p(n-r,r)"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> 部分拆数</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7B0,0/%5CSigma,1%7D"></td>
<td style="text-align: center;">UNLabeled</td>
<td style="text-align: center;">UNLabeled; <img src="https://latex.codecogs.com/png.latex?r">-disabled</td>
<td style="text-align: center;">NON empty</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20p(n)%20&amp;=%20%5Csum_%7B%5Csubstack%7Bk%20%5Cin%20%5Cmathbb%20Z%7D%7D%20(-1)%5Ek%20p_%7Bn-k(3k-1)/2%7D%20%5C%5C%20&amp;=%20p_%7Bn-1%7D%20+%20p_%7Bn-2%7D%20-%20p_%7Bn-5%7D%20-%20p_%7Bn-7%7D%20+%20%5Cdots%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%20%5Cmathrm%7BOGF%7D(x)&amp;=%5Cprod_%7Bk=1%7D%5E%7B+%5Cinfty%7D%20%5Cfrac%201%20%7B1-x%5Ek%7D%20%5C%5C%20&amp;=%20%5Cleft(%20%5Csum_%7Bk%20%5Cin%20%5Cmathbb%20Z%7D%20(-1)%5Ek%20x%5E%7Bk(3k-1)/2%7D%20%5Cright)%5E%7B-1%7D%20%5Cend%7Baligned%7D"></td>
<td style="text-align: center;">partition function（分拆数）; number of partitions of <img src="https://latex.codecogs.com/png.latex?n">; <img src="https://latex.codecogs.com/png.latex?n"> 元（含）以上 <img src="https://latex.codecogs.com/png.latex?n"> 次单项对称多项式构型数</td>
</tr>
</tbody>
</table>
</div>
<p>以后我们约定：</p>
<ul>
<li>形如 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BBB_%7B1,1,0%7D%7D"> 的记号表示代号 <img src="https://latex.codecogs.com/png.latex?1,1,0"> 对应球盒问题的方案数；</li>
<li>形如 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_n%5E%7B1,1,0%7D(x)"> 代表代号 <img src="https://latex.codecogs.com/png.latex?1,1,0"> 对应 <img src="https://latex.codecogs.com/png.latex?n"> 球球盒问题的指数生成函数；</li>
<li>形如 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_r%5E%7B1,1,0%7D(x)"> 代表代号 <img src="https://latex.codecogs.com/png.latex?1,1,0"> 对应 <img src="https://latex.codecogs.com/png.latex?r"> 球球盒问题的指数生成函数；</li>
<li>普通生成函数 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BOGF%7D_r%5E%7B1,1,0%7D(x)"> 同理．</li>
</ul>
<p>在不至混淆的情况下，也可省略下标或上标上的代号．</p>
<section id="通用性质" class="level4">
<h4 class="anchored" data-anchor-id="通用性质">通用性质</h4>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-bb-sigma" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 1 (非空盒数量不限制)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0A%5Cmathrm%7BBB%7D_%7B*,*/%5CSigma,1%7D(n)%20=%20%5Csum_%7Bk=0%7D%5En%20%5Cmathrm%7BBB%7D_%7B*,*,1%7D(n,k)%20%5C%5C%0A%5Cmathrm%7BEGF%7D%5E%7B*,*/%5CSigma,1%7D(x)%20=%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20%5Cmathrm%7BEGF%7D_%7Br=k%7D%5E%7B*,*,1%7D(x)%0A%5Cend%7Bgathered%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-bb-x10-x11" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 2 (有标号盒空置)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0A%5Cmathrm%7BBB%7D_%7B*,1,0%7D(n,r)%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cbinom%20r%20k%20%5Cmathrm%7BBB%7D_%7B*,1,1%7D(n,k)%20%5C%5C%0A%5Cmathrm%7BEGF%7D_n%5E%7B*,1,0%7D(x)%20=%20e%5Ex%20%5Cmathrm%7BEGF%7D_n%5E%7B*,1,1%7D(x)%0A%5Cend%7Bgathered%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>对有标号盒的二项式反演．在 <img src="https://latex.codecogs.com/png.latex?1,1,0">-球盒问题中，上式体现为第二类 Stirling 数的通项公式；在 <img src="https://latex.codecogs.com/png.latex?0,1,0">-球盒问题中，上式体现为 Vandermonde 卷积．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-bb-x00-x01" class="theorem proposition">
<p><span class="theorem-title"><strong>命题 3 (无标号盒空置)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bgathered%7D%0A%5Cmathrm%7BBB%7D_%7B*,0,0%7D(n,r)%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cmathrm%7BBB%7D_%7B*,0,1%7D(n,k)%20%5C%5C%0A%5Cmathrm%7BOGF%7D_n%5E%7B*,0,0%7D(x)%20=%20%5Cfrac%201%20%7B1-x%7D%20%5Cmathrm%7BOGF%7D_n%5E%7B*,0,1%7D(x)%0A%5Cend%7Bgathered%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>对无标号盒，直接求和即可．</p>
</section>
</section>
<section id="第二类-stirling-数" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="第二类-stirling-数"><span class="header-section-number">3.3</span> 第二类 Stirling 数</h3>
<p>第二类 Stirling 数的组合定义即 <img src="https://latex.codecogs.com/png.latex?1,0,1">-球盒问题的方案数 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BBB%7D_%7B1,0,1%7D(n,r)%20=%20%7Bn%20%5Cbrace%20r%7D">，亦作将 <img src="https://latex.codecogs.com/png.latex?n"> 个元素划分入 <img src="https://latex.codecogs.com/png.latex?r"> 个集合的方案数．</p>
<section id="递推" class="level4">
<h4 class="anchored" data-anchor-id="递推">递推</h4>
<p>由组合意义，考虑在已有 <img src="https://latex.codecogs.com/png.latex?n"> 个球时加入新球，此时面临将其放入原有的 <img src="https://latex.codecogs.com/png.latex?r"> 个集合或新开辟一个集合的两种选择，由此得递推式 <img src="https://latex.codecogs.com/png.latex?%0A%7Bn+1%20%5Cbrace%20r%7D%20=%20r%20%7Bn%20%5Cbrace%20r%7D%20+%20%7Bn%20%5Cbrace%20r-1%7D%0A"> 边界在 <img src="https://latex.codecogs.com/png.latex?%0A%7Bn%20%5Cbrace%200%7D%20=%20%5Bn%20=%200%5D,%5Cquad%20%7Bn%20%5Cbrace%20n%7D%20=%201%0A"></p>
</section>
<section id="第二类-striling-数同行计算mathrmogf_n101x-或-mathrmegf_n111x" class="level4">
<h4 class="anchored" data-anchor-id="第二类-striling-数同行计算mathrmogf_n101x-或-mathrmegf_n111x">第二类 Striling 数同行计算：<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BOGF%7D_n%5E%7B1,0,1%7D(x)"> 或 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_n%5E%7B1,1,1%7D(x)"></h4>
<p>来考虑用两种方法得到 <img src="https://latex.codecogs.com/png.latex?1,1,1">-球盒问题的方案数．</p>
<p>我们的第一种方法注意到，上述问题的方案数恰好是 <img src="https://latex.codecogs.com/png.latex?1,0,1">-球盒问题方案数 <img src="https://latex.codecogs.com/png.latex?r!"> 倍——这是对后者的盒进行标号的结果．我们得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BBB%7D_%7B1,1,1%7D(n,r)%20=%20r!%20%5Cmathrm%7BBB%7D_%7B1,0,1%7D(n,r)%20=%20r!%20%7Bn%20%5Cbrace%20r%7D%0A"></p>
<p>第二种方法考虑用容斥非空盒的方法与 <img src="https://latex.codecogs.com/png.latex?1,1,0">-球盒问题 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BBB%7D_%7B1,1,0%7D(n,r)%20=%20r%5En"> 建立联系．我们有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BBB%7D_%7B1,1,0%7D(n,r)%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cbinom%20r%20k%20%5Cmathrm%7BBB%7D_%7B1,1,1%7D(n,k)%0A"> 即 <img src="https://latex.codecogs.com/png.latex?%0Ar%5En%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cbinom%20r%20k%20k!%20%7Bn%20%5Cbrace%20k%7D%0A"> 二项式反演即得 <img src="https://latex.codecogs.com/png.latex?%0Ar!%20%7Bn%20%5Cbrace%20r%7D%20=%20%5Csum_%7Bk=0%7D%5Er%20(-1)%5E%7Br-k%7D%20%5Cbinom%20r%20k%20k%5En%0A"> 即 <img src="https://latex.codecogs.com/png.latex?%0A%7Bn%20%5Cbrace%20r%7D%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cfrac%7B(-1)%5E%7Br-k%7D%20k%5En%7D%7Bk!%20(r-k)!%7D%20=%20%5Csum_%7Bk=0%7D%5Er%20%5Cfrac%7Bk%5En%7D%7Bk!%7D%20%5Ccdot%20%5Cfrac%7B(-1)%5E%7Br-k%7D%7D%7B(r-k)!%7D%0A"> 这正是第二类 Stirling 数的通项公式．注意到其具有卷积的形式，由此可快速计算出同一行的第二类 Stirling 数．事实上，二项式反演的生成函数形式已向我们道尽一切 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BOGF%7D_n%5E%7B1,0,1%7D(x)%20=%20%5Cmathrm%7BEGF%7D_n%5E%7B1,1,1%7D(x)%20=%20e%5E%7B-x%7D%20%5Cmathrm%7BEGF%7D_n%5E%7B1,1,0%7D(x)%20=%20e%5E%7B-x%7D%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20k%5En%20%5Cfrac%7Bx%5Ek%7D%7Bk!%7D%0A"></p>
</section>
<section id="第二类-striling-数同列计算mathrmegf_r101xmathrmegf_r110x-与-mathrmegf10sigma1x" class="level4">
<h4 class="anchored" data-anchor-id="第二类-striling-数同列计算mathrmegf_r101xmathrmegf_r110x-与-mathrmegf10sigma1x">第二类 Striling 数同列计算：<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_r%5E%7B1,0,1%7D(x)">，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D_r%5E%7B1,1,0%7D(x)"> 与 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D%5E%7B1,0/%5CSigma,1%7D(x)"></h4>
<p>为快速计算同一列的第二类 Stirling 数，考虑用生成函数的思路构造 <img src="https://latex.codecogs.com/png.latex?1,1,0">-球盒问题和 <img src="https://latex.codecogs.com/png.latex?1,0,1">-球盒问题的方案数．前者将大小为 <img src="https://latex.codecogs.com/png.latex?n"> 的有标号集合划分为 <img src="https://latex.codecogs.com/png.latex?r"> 个有标号等价类，这相当于有序拼接 <img src="https://latex.codecogs.com/png.latex?r"> 个非空有标号集合；后者则是前者除掉 <img src="https://latex.codecogs.com/png.latex?r!"> 消序的版本．写成生成函数即 <span id="eq-egf-110-101"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cmathrm%7BEGF%7D_r%5E%7B1,1,0%7D(x)%20&amp;=%20(e%5Ex%20-%201)%5Er%20%5C%5C%0A%5Cmathrm%7BEGF%7D_r%5E%7B1,0,1%7D(x)%20&amp;=%20%5Cfrac%7B(e%5Ex%20-%201)%5Er%7D%7Br!%7D%0A%5Cend%7Baligned%7D%0A%5Ctag%7B1%7D"></span></p>
</section>
<section id="bell-数" class="level4">
<h4 class="anchored" data-anchor-id="bell-数">Bell 数</h4>
<p>Bell 数 <img src="https://latex.codecogs.com/png.latex?B(n)"> 的组合定义即 <img src="https://latex.codecogs.com/png.latex?1,0/%5CSigma,1">-球盒问题的方案数 <img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BBB%7D_%7B1,0/%5CSigma,1%7D">，亦可描述为 <img src="https://latex.codecogs.com/png.latex?n"> 元集合上等价关系（划分）的数量．</p>
<p>注意到 <img src="https://latex.codecogs.com/png.latex?1,0,1">-球盒问题和 <img src="https://latex.codecogs.com/png.latex?1,0/%5CSigma,1">-球盒问题的关系 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BBB%7D_%7B1,0/%5CSigma,1%7D(n)%20=%20%5Csum_%7Br=0%7D%5E%7Bn%7D%20%5Cmathrm%7BBB%7D_%7B1,0,1%7D(n,r)%20=%20%5Csum_%7Br=0%7D%5E%7B+%5Cinfty%7D%20%5Cmathrm%7BBB%7D_%7B1,0,1%7D(n,r)%0A"> 我们首先有 <img src="https://latex.codecogs.com/png.latex?%0AB(n)%20=%20%5Csum_%7Br=0%7D%5En%20%7Bn%20%5Cbrace%20r%7D%0A"> 其次，根据 式&nbsp;1 写出此关系的 EGF 形式就有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathrm%7BEGF%7D%5E%7B1,0/%5CSigma,1%7D(x)%20=%20%5Csum_%7Br=0%7D%5E%7B+%5Cinfty%7D%20%5Cmathrm%7BEGF%7D_r%5E%7B1,0,1%7D(x)%20=%20%5Csum_%7Br=0%7D%5E%7B+%5Cinfty%7D%20%5Cfrac%7B(e%5Ex%20-%201)%5Er%7D%7Br!%7D%20=%20e%5E%7Be%5Ex%20-%201%7D%0A"> 我们得到 Bell 数的可用于快速计算的 EGF．</p>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>有标号集合的无序划分是指数型生成函数的一类重要应用．例如，有标号连通图计数可视为对有标号一般图的无序划分，故有标号连通图的 EGF <img src="https://latex.codecogs.com/png.latex?G(x)"> 和有标号一般图的 EGF <img src="https://latex.codecogs.com/png.latex?F(x)"> 间有着 <img src="https://latex.codecogs.com/png.latex?e%5E%7BG(x)%7D%20=%20F(x)"> 的关系．</p>
</div>
<p>Bell 数还有递推形式 <img src="https://latex.codecogs.com/png.latex?%0AB(n+1)%20=%20%5Csum_%7Bk=0%7D%5En%20%5Cbinom%20n%20k%20B(k)%0A"> 边界 <img src="https://latex.codecogs.com/png.latex?B(0)=1">．组合的解释是，枚举第 <img src="https://latex.codecogs.com/png.latex?n+1"> 个元素被放入的集合的大小，再对除该集合之外的元素进行划分．从指数生成函数的角度来看，设 <img src="https://latex.codecogs.com/png.latex?B(n)"> 的 EGF 为 <img src="https://latex.codecogs.com/png.latex?F(x)">，由 EGF 的移位性质和二项式反演的 EGF 形式，上式等价于 <img src="https://latex.codecogs.com/png.latex?F'(x)%20=%20e%5Ex%20F(x)">，解此微分方程也能得到 Bell 数的生成函数．</p>
</section>
<section id="第一类-stirling-数stirling-数与阶乘幂todo" class="level4">
<h4 class="anchored" data-anchor-id="第一类-stirling-数stirling-数与阶乘幂todo">第一类 Stirling 数、Stirling 数与阶乘幂【TODO】</h4>
<p>更多参考：</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Stirling_number">Stirling number - Wikipedia</a></li>
<li><a href="https://oi-wiki.org/math/combinatorics/stirling/">斯特林数 - OI Wiki</a></li>
</ul>
</section>
</section>
<section id="分拆数todo" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="分拆数todo"><span class="header-section-number">3.4</span> 分拆数【TODO】</h3>
<p>关于 <img src="https://latex.codecogs.com/png.latex?k"> 部分拆数，</p>
<blockquote class="blockquote">
<p>By taking conjugates, the number <img src="https://latex.codecogs.com/png.latex?p_k(n)"> of partitions of <img src="https://latex.codecogs.com/png.latex?n"> into exactly <img src="https://latex.codecogs.com/png.latex?k"> parts is equal to the number of partitions of <img src="https://latex.codecogs.com/png.latex?n"> in which the largest part has size <img src="https://latex.codecogs.com/png.latex?k">.</p>
</blockquote>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Partition_(number_theory)">Partition (number theory) - Wikipedia</a></li>
<li><a href="https://oi-wiki.org/math/combinatorics/partition/">分拆数 - OI Wiki</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/530925142">组合数学（2）分拆数 - 知乎</a></li>
</ul>
</section>
<section id="背包计数" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="背包计数"><span class="header-section-number">3.5</span> 背包计数</h3>
<p>通式： <img src="https://latex.codecogs.com/png.latex?%0A%5Cprod_%7Bi=1%7D%5En%20(1+%20s_i%20x%5E%7Bv_i%7D)%5E%7Bm_i%7D%20=%20%5Cexp%20%5Csum_%7Bi=1%7D%5En%20m_i%20%5Cln%20(1%20+%20s_i%20x%5E%7Bv_i%7D)%20=%20%5Cexp%20%5Csum_%7Bi=1%7D%5En%20m_i%20%5Csum_%7Bk=1%7D%5E%7B+%5Cinfty%7D%20(-1)%5E%7Bk-1%7D%20%5Cfrac%20%7Bs_i%5Ek%7D%7Bk%7D%20x%5E%7Bk%20v_i%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?v_i"> 互不相同（相同者体现在 <img src="https://latex.codecogs.com/png.latex?m_i"> 上）．后者可以埃筛调和级数计算贡献 + 多项式 <img src="https://latex.codecogs.com/png.latex?%5Cexp"> 地在 <img src="https://latex.codecogs.com/png.latex?O(t%20%5Clog%20t)">（这里的 <img src="https://latex.codecogs.com/png.latex?t"> 指我们所关心的体积上限）内快速计算．</p>
<p>下面问题的 OGF 都可化归至通式，从而 <img src="https://latex.codecogs.com/png.latex?O(t%20%5Clog%20t)"> 地得到计算．</p>
<p>设有 <img src="https://latex.codecogs.com/png.latex?n"> 种可区分的物品，体积分别为 <img src="https://latex.codecogs.com/png.latex?v_i">．当每种物品只有一件时，方案数 OGF 为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cprod_%7Bi=1%7D%5En%20(1+%20x%5E%7Bv_i%7D)%0A"> 当每种物品有无限件时，方案数 OGF 为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cprod_%7Bi=1%7D%5En%20(1+%20x%5E%7Bv_i%7D%20+%20x%5E%7B2%20v_i%7D%20+%20%5Cdots)%20=%20%5Cprod_%7Bi=1%7D%5En%20(1%20-%20x%5E%7Bv_i%7D)%5E%7B-1%7D%0A"> 当每种物品分别有 <img src="https://latex.codecogs.com/png.latex?c_i"> 件时，方案数 OGF 为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cprod_%7Bi=1%7D%5En%20(1+%20x%5E%7Bv_i%7D%20+%20x%5E%7B2%20v_i%7D%20+%20%5Cdots%20+%20x%5E%7Bc_i%20v_i%7D)%20=%20%5Cprod_%7Bi=1%7D%5En%20%5Cfrac%7B1%20-%20x%5E%7B(c_i+1)%20v_i%7D%7D%7B1%20-%20x%5E%7Bv_i%7D%7D%20=%20%5Cprod_%7Bi=1%7D%5En%20(1%20-%20x%5E%7B(c_i+1)%20v_i%7D)%20%5Cprod_%7Bi=1%7D%5En%20(1%20-%20x%5E%7Bv_i%7D)%5E%7B-1%7D%0A"></p>
<p>ex：普通的最优化背包也有卷积视角的理解，见 <a href="https://codeforces.com/blog/entry/98663">Knapsack, Subset Sum and the (max,+) Convolution - Codeforces</a>．</p>
</section>
<section id="各种图计数" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="各种图计数"><span class="header-section-number">3.6</span> 各种图计数</h3>
<section id="有无标号有无根树计数todo" class="level4">
<h4 class="anchored" data-anchor-id="有无标号有无根树计数todo">有（无）标号有（无）根树计数【TODO】</h4>
</section>
<section id="有标号-dag-计数" class="level4">
<h4 class="anchored" data-anchor-id="有标号-dag-计数">有标号 DAG 计数</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0Af_n=%5Csum_%7Bi=1%7D%5En(-1)%5E%7Bi+1%7D%5Cbinom%7Bn%7D%7Bi%7D2%5E%7Bi(n-i)%7Df_%7Bn-i%7D%0A"> 思路是对 DAG 的入度为零的点做容斥．进一步推导可拆出卷积形式，再用类似分治 FFT 的生成函数方法可得封闭形式．</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph#Combinatorial_enumeration">Wikipedia</a></li>
<li><a href="https://oeis.org/A003024">OEIS</a></li>
<li><a href="https://oi-wiki.org/math/combinatorics/inclusion-exclusion-principle/#dag-%E8%AE%A1%E6%95%B0">OI-Wiki</a></li>
<li><a href="https://www.cnblogs.com/cjyyb/p/10134575.html">cjyyb 题解</a></li>
</ul>
</section>
<section id="有标号偏序图计数" class="level4">
<h4 class="anchored" data-anchor-id="有标号偏序图计数">有标号偏序图计数</h4>
<p>问得好，但这是个著名的 open problem．各种类型的偏序图计数参考 <a href="https://en.wikipedia.org/wiki/Partially_ordered_set#Number_of_partial_orders">Partially ordered set - Wikipedia # Number of partial orders</a>．</p>
<ul>
<li><a href="https://math.stackexchange.com/questions/2677986/how-many-partial-orders-can-be-defined-on-varnothing-and-a-finite-set">Stack Exchange</a></li>
<li><a href="https://oeis.org/A001035">OEIS</a></li>
<li><a href="https://doi.org/10.1007/BF00383446">Erné, M., Stege, K. Counting finite posets and topologies. Order 8, 247–265 (1991)</a>（内有研究历史综述）</li>
</ul>
</section>
<section id="有标号连通图计数" class="level4">
<h4 class="anchored" data-anchor-id="有标号连通图计数">有标号连通图计数</h4>
<p>标准的有标号无序划分．EGF 是有标号一般图计数 EGF 的 <img src="https://latex.codecogs.com/png.latex?%5Cln">．</p>
</section>
<section id="竞赛图" class="level4">
<h4 class="anchored" data-anchor-id="竞赛图">竞赛图</h4>
<p>强连通的竞赛图一定存在 Hamilton 回路（归纳证明）；无环的竞赛图是全序图．两者结合可推出竞赛图一定存在 Hamilton 路径．同时，强连通竞赛图中存在所有大小的环路．</p>
</section>
<section id="有标号划分为-k-个全序图" class="level4">
<h4 class="anchored" data-anchor-id="有标号划分为-k-个全序图">有标号划分为 <img src="https://latex.codecogs.com/png.latex?k"> 个全序图</h4>
<p>Lah 数 <img src="https://latex.codecogs.com/png.latex?%0AL(n,k)%20=%20%5Cfrac%7Bn!%7D%7Bk!%7D%20%5Cbinom%7Bn-1%7D%7Bk-1%7D%0A"> 思路是先 <img src="https://latex.codecogs.com/png.latex?n!"> 排个大序，再无标号球入非空有标号桶，再除 <img src="https://latex.codecogs.com/png.latex?k!"> 给桶消序．</p>
<p>生成函数的思路是，考虑非空全序计数的 EGF 为 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20%7B1-x%7D%20-%201%20=%20%5Cfrac%20x%20%7B1-x%7D">，<img src="https://latex.codecogs.com/png.latex?k"> 次有序拼接再消序即得 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum%20_%7Bn%5Cgeq%20k%7DL(n,k)%7B%5Cfrac%20%7Bx%5E%7Bn%7D%7D%7Bn!%7D%7D=%7B%5Cfrac%20%7B1%7D%7Bk!%7D%7D%5Cleft(%7B%5Cfrac%20%7Bx%7D%7B1-x%7D%7D%5Cright)%5E%7Bk%7D%0A"></p>
<p>更多信息参考 Wikipedia．</p>
</section>
<section id="有根树拓扑序计数" class="level4">
<h4 class="anchored" data-anchor-id="有根树拓扑序计数">有根树拓扑序计数</h4>
<p>对于外向树，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bn!%7D%7B%5Cprod_%7Bu%20%5Cin%20V%7D%20%5Coperatorname%7Bsize%7D(u)%7D">，其中 <img src="https://latex.codecogs.com/png.latex?V"> 是所有节点的集合，<img src="https://latex.codecogs.com/png.latex?n"> 是树大小，<img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bsize%7D(u)"> 是以 <img src="https://latex.codecogs.com/png.latex?u"> 为根的子树大小．</p>
<p>树形 DP 风格的归纳证明是可以的．下面的链接中提供了一个有趣的组合理解，其思路是从全序出发，逐步按照拓扑序的要求对每个节点下的子树消序．</p>
<p>题目常见要求对每个节点作为根节点求出方案数，换根 DP 即可．</p>
<p>注意到每个合法的外向树拓扑序 reverse 后立刻与内向树拓扑序形成一一对应，故内向树拓扑序计数与外向树相同．</p>
<ul>
<li><a href="https://codeforces.com/blog/entry/75627">[Insight] Number of Topological Orderings of a Directed Tree - Codeforces</a></li>
</ul>
</section>
<section id="dag-拓扑序计数" class="level4">
<h4 class="anchored" data-anchor-id="dag-拓扑序计数">DAG 拓扑序计数</h4>
<p>对一般的 DAG 上的拓扑序计数，其本质上是偏序上线性扩张的计数问题，这被证明是 #P-complete 的问题（总之就是很困难）．</p>
<ul>
<li><a href="https://math.stackexchange.com/questions/814177/how-many-topological-orderings-exist-for-a-graph">How many topological orderings exist for a graph? - Mathematics Stack Exchange</a></li>
<li><a href="https://en.wikipedia.org/wiki/Topological_sorting#Relation_to_partial_orders">Topological sorting - Wikipedia # Relation to partial orders</a></li>
<li><a href="https://en.wikipedia.org/wiki/Linear_extension">Linear extension - Wikipedia</a></li>
</ul>
</section>
<section id="无向图的色多项式chromatic-polynomial和无环定向acyclic-orientations" class="level4">
<h4 class="anchored" data-anchor-id="无向图的色多项式chromatic-polynomial和无环定向acyclic-orientations">无向图的色多项式（chromatic polynomial）和无环定向（acyclic orientations）</h4>
<p>色多项式是对图的 <img src="https://latex.codecogs.com/png.latex?k">-colorings 的数量在 <img src="https://latex.codecogs.com/png.latex?k=0,1,%5Cdots,n"> 进行 Lagrange 插值后得到的多项式．<img src="https://latex.codecogs.com/png.latex?k%3En"> 的 <img src="https://latex.codecogs.com/png.latex?k">-colorings 的数量也可通过在色多项式的 <img src="https://latex.codecogs.com/png.latex?x=k"> 处求值得到．这一证明主要依赖所谓的 deletion–contraction 递推关系式．</p>
<p>对一般的图而言，色多项式的大部分系数和求值问题都是 “NP” 相关的，但在一些特殊的图上有好的形式：</p>
<ul>
<li>完全图 <img src="https://latex.codecogs.com/png.latex?K_n">：<img src="https://latex.codecogs.com/png.latex?x%5E%7B%5Cunderline%7Bn%7D%7D">（下降阶乘幂）</li>
<li>无边图 <img src="https://latex.codecogs.com/png.latex?%5Coverline%20K_n">：<img src="https://latex.codecogs.com/png.latex?x%5En"></li>
<li>链 / 树：<img src="https://latex.codecogs.com/png.latex?P_n">：<img src="https://latex.codecogs.com/png.latex?x(x-1)%5E%7Bn-1%7D"></li>
<li>环：<img src="https://latex.codecogs.com/png.latex?(x-1)%5En%20+%20(-1)%5En%20(x-1)"></li>
</ul>
<p>多个连通分量拼接时，色多项式满足乘法性．</p>
<p>关于图的无环定向的方案数，Richard Stanley 在一篇 1973 年的论文中证明其恰为图的色多项式在 <img src="https://latex.codecogs.com/png.latex?-1"> 处的取值．</p>
<ul>
<li><a href="https://mathworld.wolfram.com/ChromaticPolynomial.html">Chromatic Polynomial - from Wolfram MathWorld</a></li>
<li><a href="https://en.wikipedia.org/wiki/Chromatic_polynomial">Chromatic polynomial - Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Orientation_(graph_theory)">Orientation (graph theory) - Wikipedia</a></li>
<li>Stanley, R. P. “Acyclic Orientations of Graphs.” Disc. Math. 5, 171-178, 1973.</li>
</ul>
</section>
</section>
<section id="矩阵树定理" class="level3" data-number="3.7">
<h3 data-number="3.7" class="anchored" data-anchor-id="矩阵树定理"><span class="header-section-number">3.7</span> 矩阵树定理</h3>
<section id="无向图的情形" class="level4">
<h4 class="anchored" data-anchor-id="无向图的情形">无向图的情形</h4>
<p>对无向图，度数矩阵 <img src="https://latex.codecogs.com/png.latex?D%20=%20%5Coperatorname%7Bdiag%7D%20%5C%7B%20%5Coperatorname%7Bdeg%7D(i)%20%5C%7D">，邻接矩阵 <img src="https://latex.codecogs.com/png.latex?A"> 定义为 <img src="https://latex.codecogs.com/png.latex?%0AA_%7Bi,j%7D%20=%20%5Cbegin%7Bcases%7D%0A0%20&amp;%20i=j%20%5C%5C%0Ae(i,j)%20&amp;%20i%20%5Cneq%20j%0A%5Cend%7Bcases%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?e(i,j)"> 表示点 <img src="https://latex.codecogs.com/png.latex?i"> 到点 <img src="https://latex.codecogs.com/png.latex?j"> 的边的数量（对无向图，<img src="https://latex.codecogs.com/png.latex?e(i,j)%20=%20e(j,i)">）．</p>
<p>定义 Laplace 矩阵（Kirchhoff 矩阵）<img src="https://latex.codecogs.com/png.latex?L=D-A">．</p>
<p>Laplace 矩阵有性质 <img src="https://latex.codecogs.com/png.latex?L=%20B%20B%5ET">，其中关联矩阵 <img src="https://latex.codecogs.com/png.latex?B"> 按如下方式定义 <img src="https://latex.codecogs.com/png.latex?%0AB_%7Bi,j%7D%20=%20%5Cbegin%7Bcases%7D%0A1%20&amp;%20%5Ctext%7Bnode%20$i$%20is%20the%20ID-smaller%20endpoint%20of%20edge%20$j$%7D%20%5C%5C%0A-1%20&amp;%20%5Ctext%7Bnode%20$i$%20is%20the%20ID-larger%20endpoint%20of%20edge%20$j$%7D%20%5C%5C%0A0%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A"></p>
<p>这里 <img src="https://latex.codecogs.com/png.latex?1"> 与 <img src="https://latex.codecogs.com/png.latex?-1"> 的引入完成了一种对边的“手动定向”，其用途将在后文介绍．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-mattree-nondirected" class="theorem">
<p><span class="theorem-title"><strong>定理 12 (矩阵树定理，无向图)</strong></span> <img src="https://latex.codecogs.com/png.latex?n"> 点无向图的生成树的个数与该图的 Laplace 矩阵 <img src="https://latex.codecogs.com/png.latex?L"> 的任意主子式的值相等．其也与 <img src="https://latex.codecogs.com/png.latex?L"> 所有 <img src="https://latex.codecogs.com/png.latex?n-1"> 个非零特征值乘积的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20n"> 倍相等．</p>
</div>
</div>
</div>
</div>
<p>Laplace 矩阵同行的代数余子式均相等（这性质由行和为 <img src="https://latex.codecogs.com/png.latex?0"> 得到），因此去掉任意一行一列均可得到正确的无向图生成树计数．此外，由于 <img src="https://latex.codecogs.com/png.latex?L%20=%20B%20B%5ET"> 至少半正定，<img src="https://latex.codecogs.com/png.latex?L"> 的所有特征值非负．</p>
<p>证明的要点在于对 <img src="https://latex.codecogs.com/png.latex?L%20=%20B%20B%5ET"> 的某个主子式（一般选择去掉第一行第一列）应用 Cauchy-Binet 公式，随后说明行列式的组合意义中，环的情况一定相互抵消．关于特征值的结论可从特征多项式、各 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶主子式与韦达定理的关系中得到（依此方法能进一步得到有关 <img src="https://latex.codecogs.com/png.latex?k"> - 生成森林的一些结论）．</p>
<p>事实上，去掉第 <img src="https://latex.codecogs.com/png.latex?i"> 行第 <img src="https://latex.codecogs.com/png.latex?i"> 列，即是统计以 <img src="https://latex.codecogs.com/png.latex?i"> 为根的根向生成树的数量．先前定义关联矩阵 <img src="https://latex.codecogs.com/png.latex?B"> 时“手动定向”，是为了使换向过程中环的情况相互抵消，只留下树的唯一一种情况．当然，因为是无向图，这里树的朝向和根的具体位置并不重要．</p>
</section>
<section id="有向图的情形" class="level4">
<h4 class="anchored" data-anchor-id="有向图的情形">有向图的情形</h4>
<p>对有向图，我们明确统计的对象为根向（或叶向）生成树的数量．根向树形图与出度 Laplace 矩阵相关，<img src="https://latex.codecogs.com/png.latex?L%5E%7Bout%7D%20=%20D%5E%7Bout%7D%20-%20A">，其中 <img src="https://latex.codecogs.com/png.latex?D%5E%7Bout%7D"> 是出度矩阵．</p>
<p>为体现有向图的要求，出度 Laplace 矩阵对应的关联矩阵需要一些修改．令矩阵 <img src="https://latex.codecogs.com/png.latex?B"> 满足 <img src="https://latex.codecogs.com/png.latex?%0AB_%7Bi,j%7D%20=%20%5Cbegin%7Bcases%7D%0A1%20&amp;%20%5Ctext%7Bnode%20$i$%20is%20the%20head%20of%20edge%20$j$%7D%20%5C%5C%0A0%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A"> 矩阵 <img src="https://latex.codecogs.com/png.latex?C"> 满足 <img src="https://latex.codecogs.com/png.latex?%0AC_%7Bi,j%7D%20=%20%5Cbegin%7Bcases%7D%0A1%20&amp;%20%5Ctext%7Bnode%20$i$%20is%20the%20head%20of%20edge%20$j$%7D%20%5C%5C%0A-1%20&amp;%20%5Ctext%7Bnode%20$i$%20is%20the%20tail%20of%20edge%20$j$%7D%20%5C%5C%0A0%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A"> 则出度 Laplace 矩阵满足性质 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bout%7D%20=%20B%20C%5ET">．我们构造的矩阵 <img src="https://latex.codecogs.com/png.latex?B"> 体现了对出边方向的要求，在此基础上矩阵 <img src="https://latex.codecogs.com/png.latex?C"> 进一步完成了“手动定向”的工作．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-mattree-rootwise" class="theorem">
<p><span class="theorem-title"><strong>定理 13 (矩阵树定理，根向树形图)</strong></span> <img src="https://latex.codecogs.com/png.latex?n"> 点有向图以 <img src="https://latex.codecogs.com/png.latex?i"> 为根的生成根向树形图的数量与该图出度 Laplace 矩阵 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bout%7D"> 去掉第 <img src="https://latex.codecogs.com/png.latex?i"> 行第 <img src="https://latex.codecogs.com/png.latex?i"> 列的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶主子式的值相等．该有向图的所有生成根向树形图的数量也与 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bout%7D"> 的所有 <img src="https://latex.codecogs.com/png.latex?n-1"> 个非零特征值的乘积相等．</p>
</div>
</div>
</div>
</div>
<p>由于 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bout%7D"> 的行和仍为 <img src="https://latex.codecogs.com/png.latex?0">，其同行代数余子式仍然相等．</p>
<p>关于叶向树形图，我们有类似的结论：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-mattree-leafwise" class="theorem">
<p><span class="theorem-title"><strong>定理 14 (矩阵树定理，叶向树形图)</strong></span> <img src="https://latex.codecogs.com/png.latex?n"> 点有向图以 <img src="https://latex.codecogs.com/png.latex?i"> 为根的生成叶向树形图的数量与该图入度 Laplace 矩阵 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bin%7D"> 去掉第 <img src="https://latex.codecogs.com/png.latex?i"> 行第 <img src="https://latex.codecogs.com/png.latex?i"> 列的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶主子式的值相等．该有向图的所有生成根向树形图的数量也与 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bin%7D"> 的所有 <img src="https://latex.codecogs.com/png.latex?n-1"> 个非零特征值的乘积相等．</p>
</div>
</div>
</div>
</div>
<p>由于 <img src="https://latex.codecogs.com/png.latex?L%5E%7Bin%7D"> 的列和（而非行和）为 <img src="https://latex.codecogs.com/png.latex?0">，其同列（而非同行）代数余子式均相等．</p>
<p>更多内容，参考</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Laplacian_matrix">Laplacian matrix - Wikipedia</a></li>
<li><a href="https://oi-wiki.org/graph/matrix-tree/">矩阵树定理 - OI Wiki</a></li>
<li><a href="https://en.wikipedia.org/wiki/Kirchhoff's_theorem">Kirchhoff’s theorem - Wikipedia</a></li>
</ul>
</section>
</section>
<section id="polya-计数" class="level3" data-number="3.8">
<h3 data-number="3.8" class="anchored" data-anchor-id="polya-计数"><span class="header-section-number">3.8</span> Polya 计数</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-burnside" class="theorem">
<p><span class="theorem-title"><strong>定理 15 (Burnside)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%E7%AD%89%E4%BB%B7%E7%B1%BB%E8%AE%A1%E6%95%B0%20&amp;=%20%5Cfrac%7B1%7D%7B%7CG%7C%7D%5Csum_%7Bf%20%5Cin%20G%7D%20%7CC(f)%7C%0A%5Cend%7Baligned%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?G"> 是等价操作群，<img src="https://latex.codecogs.com/png.latex?C(f)"> 是操作 <img src="https://latex.codecogs.com/png.latex?f"> 下的不动点集合．</p>
</div>
</div>
</div>
</div>
</section>
<section id="杂数选提" class="level3" data-number="3.9">
<h3 data-number="3.9" class="anchored" data-anchor-id="杂数选提"><span class="header-section-number">3.9</span> 杂数选提</h3>
<section id="catalan-数" class="level4">
<h4 class="anchored" data-anchor-id="catalan-数">Catalan 数</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_n%20=%20%5Cbinom%7B2n%7D%7Bn%7D%20-%20%5Cbinom%7B2n%7D%7Bn+1%7D%20=%20%5Cfrac%201%20%7Bn+1%7D%20%5Cbinom%7B2n%7D%7Bn%7D%20=%20%5Cprod_%7Bk=2%7D%5En%20%5Cfrac%7Bn+k%7D%7Bk%7D%0A"></p>
<p>Segner’s recurrence relation: <img src="https://latex.codecogs.com/png.latex?%0AC_0%20=%201;%5Cquad%20C_%7Bn+1%7D%20=%20%5Csum_%7Bi=0%7D%5En%20C_i%20C_%7Bn-i%7D%0A"></p>
<p>OGF: <img src="https://latex.codecogs.com/png.latex?%0AA(z)%20=%201%20+%20z%20A%5E2(z)%20%5Cimplies%20A(z)%20=%20%5Cfrac%7B1-%5Csqrt%7B1-4z%7D%7D%7B2z%7D%0A"></p>
<p>注意下面组合意义间的前后逻辑顺序．</p>
<ul>
<li><p>number of full binary tree with <img src="https://latex.codecogs.com/png.latex?n"> interior nodes / <img src="https://latex.codecogs.com/png.latex?n+1"> leaves / <img src="https://latex.codecogs.com/png.latex?2n+1"> nodes</p>
<p>在数内点意义下可以导出 Catalan 数的生成函数．</p></li>
<li><p>number of ways of associating <img src="https://latex.codecogs.com/png.latex?n"> binary operators / parenthesizing <img src="https://latex.codecogs.com/png.latex?n+1"> factors completely</p></li>
<li><p>number of proper parenthesis sequences with <img src="https://latex.codecogs.com/png.latex?n"> pairs of parentheses</p>
<p>【TODO】暂时不知道怎么从上面推过来的．另一种理解是长度为 <img src="https://latex.codecogs.com/png.latex?n"> 的出栈序列的数量．</p></li>
<li><p>number of ordered trees with <img src="https://latex.codecogs.com/png.latex?n+1"> vertices</p>
<p>最外层要补一对括号．</p></li>
<li><p>number of binary trees with <img src="https://latex.codecogs.com/png.latex?n"> vertices</p>
<p>by left-child right-sibling encoding of ordered trees. 最后删去只有左儿子的根．</p>
<p>该组合意义可以导出 Catalan 数的生成函数．</p></li>
</ul>
<p>Catalan 数的组合意义并不止如此几种．cf.&nbsp;<a href="https://en.wikipedia.org/wiki/Catalan_number">Wikipedia</a></p>
</section>
</section>
<section id="代数组合todo" class="level3" data-number="3.10">
<h3 data-number="3.10" class="anchored" data-anchor-id="代数组合todo"><span class="header-section-number">3.10</span> 代数组合【TODO】</h3>
<section id="q-analog" class="level4">
<h4 class="anchored" data-anchor-id="q-analog"><img src="https://latex.codecogs.com/png.latex?q">-analog</h4>
</section>
<section id="有限域上的线性空间" class="level4">
<h4 class="anchored" data-anchor-id="有限域上的线性空间">有限域上的线性空间</h4>
</section>
<section id="有限群构型计数" class="level4">
<h4 class="anchored" data-anchor-id="有限群构型计数">有限群构型计数</h4>
</section>
</section>
</section>
<section id="多项式" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="多项式"><span class="header-section-number">4</span> 多项式</h2>
<p>此部分详细介绍请移步 <a href="../..\posts/20230928-dft/">FFT/NTT 讲稿</a>．</p>
<section id="通用" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="通用"><span class="header-section-number">4.1</span> 通用</h3>
</section>
<section id="fft-fntt-卷积" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="fft-fntt-卷积"><span class="header-section-number">4.2</span> FFT / FNTT / 卷积</h3>
<ul>
<li><p>DFT：（本原）单位根构造 <img src="https://latex.codecogs.com/png.latex?%5Comega_n%20=%20e%5E%7B%5Cfrac%20%7B2%20%5Cpi%7D%7Bn%7Di%7D">．</p></li>
<li><p>NTT：<img src="https://latex.codecogs.com/png.latex?P=998244353%20=%207%20%5Ctimes%2017%20%5Ctimes%202%5E%7B23%7D%20+%201">，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BPR%7D%20=%203"> 是它的一个原根．（本原）单位根构造 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7Bn%7D%20=%20%5Cmathrm%7BPR%7D%5E%7B%5Cfrac%7BP-1%7D%7Bn%7D%7D%20%5Cbmod%20P">．</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?P=1004535809%20=%20479%20%5Ctimes%202%5E%7B21%7D%20+%201">，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BPR%7D%20=%203"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?P=469762049%20=%207%20%5Ctimes%202%5E%7B26%7D+1">，<img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BPR%7D%20=%203"></p></li>
</ul>
<p>考虑将待变换多项式 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20=%20%5Csum_%7Bk=0%7D%5E%7B2n-1%7D%20a_k%20x%5Ek%0A"> 奇偶分项为两个多项式 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20=%20A_0%20(x%5E2)%20+%20x%20A_1(x%5E2)%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA_0%20(x)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k%7D%20x%5Ek%20%5C%5C%0AA_1%20(x)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20a_%7B2k+1%7D%20x%5Ek%0A%5Cend%7Baligned%7D%0A"> 代入 <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Comega_%7B2n%7D%5Ek%20%5Cpod%7Bk%20=%200,%5Cdots,%202n-1%7D">，用单位根消去 / 折半性质（<img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5E%7B2k%7D%20=%20%5Comega_n%5Ek">） <img src="https://latex.codecogs.com/png.latex?%0AA(%5Comega_%7B2n%7D%5Ek)%20=%20A_0%20(%5Comega_%7Bn%7D%5Ek)%20+%20%5Comega_%7B2n%7D%5Ek%20A_1%20(%5Comega_%7Bn%7D%5Ek)%0A"> 用 <img src="https://latex.codecogs.com/png.latex?%5Comega_%7B2n%7D%5E%7Bn+k%7D%20=%20-%20%5Comega_%7B2n%7D%5Ek"> <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA(%5Comega_%7B2n%7D%5Ek)%20&amp;=%20A_0%20(%5Comega_n%5Ek)%20+%20%5Comega_%7B2n%7D%5Ek%20A_1%20(%5Comega_n%5Ek)%20%5C%5C%0AA(%5Comega_%7B2n%7D%5E%7Bn+k%7D)%20&amp;=%20A_0%20(%5Comega_n%5Ek)%20-%20%5Comega_%7B2n%7D%5Ek%20A_1(%5Comega_n%5Ek)%0A%5Cend%7Baligned%7D%0A%5Cpod%7Bk%20=%200,%20%5Cdots,%20n-1%7D%0A"> 即得 FFT/FNTT 递归算法．用单位根求和性质 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%201%20n%20%5Csum_%7Bk=0%7D%5E%7Bn-1%7D%20%5Comega%5E%7Bik%7D%20=%20%5Bi%20%5Cmid%20n%5D%0A"> 可知 DFT/NTT 变换矩阵 <img src="https://latex.codecogs.com/png.latex?F%20=%20%5Cbegin%7Bpmatrix%7D%5Comega_%7Bn%7D%5E%7Bij%7D%5Cend%7Bpmatrix%7D_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D"> 满足 <img src="https://latex.codecogs.com/png.latex?F%20F%5EH%20=%20F%5EH%20F%20=%20n%20I_n">，故 <img src="https://latex.codecogs.com/png.latex?F%5E%7B-1%7D%20=%20%5Cfrac%201%20n%20F%5EH%20=%20%5Cbegin%7Bpmatrix%7D%20%5Cfrac%201%20n%20%5Comega_%7Bn%7D%5E%7B-ij%7D%5Cend%7Bpmatrix%7D_%7B(i,j)%20%5Cin%20n%20%5Ctimes%20n%7D">，此即 DFT/NTT 逆变换矩阵．</p>
<section id="蝶形运算与迭代算法" class="level4">
<h4 class="anchored" data-anchor-id="蝶形运算与迭代算法">蝶形运算与迭代算法</h4>
<p>为使用迭代算法，需要快速得到递归算法向下深入过程中 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_n%20%5C%7D"> 置换后的最终结果．观察知该置换是位逆序置换，可按如下方法线性求出．</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb5-1">rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+((</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;&lt;(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span></code></pre></div>
</section>
</section>
<section id="多项式方程求解newton-迭代法todo" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="多项式方程求解newton-迭代法todo"><span class="header-section-number">4.3</span> 多项式方程求解（Newton 迭代法）【TODO】</h3>
<p>给定一多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">，求解满足 <img src="https://latex.codecogs.com/png.latex?A(B(x))%20=%200%20%5Cpmod%7Bx%5En%7D"> 的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)">．</p>
<p>显然 <img src="https://latex.codecogs.com/png.latex?B(x)"> 只有前 <img src="https://latex.codecogs.com/png.latex?n"> 项有效．目前我们尚不清楚解的存在性、唯一性等性质，但注意到 <img src="https://latex.codecogs.com/png.latex?%0AA(B(x))%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D%20%5Cimplies%20A(B(x))%20=%200%20%5Cpmod%7Bx%5En%7D%0A"> 故考虑递推求解．首先，边界条件 <img src="https://latex.codecogs.com/png.latex?A(b_0)%20=%200"> 需要单独求解．在确定某一 <img src="https://latex.codecogs.com/png.latex?b_0"> 的基础上，我们开始递推．考虑已经获得 <img src="https://latex.codecogs.com/png.latex?A(B(x))%20=%200%20%5Cpmod%7Bx%5En%7D"> 的一个解 <img src="https://latex.codecogs.com/png.latex?B(x)%20=%20B_0(x)">，下面尝试得到方程 <img src="https://latex.codecogs.com/png.latex?A(B(x))%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D"> 的解．</p>
<p>将待求解方程 <img src="https://latex.codecogs.com/png.latex?A(B(x))%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D"> 左式多项式 <img src="https://latex.codecogs.com/png.latex?A"> 在 <img src="https://latex.codecogs.com/png.latex?B_0"> 处 Taylor 展开 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0AA(B(x))%20=%20A(B_0(x))%20&amp;+%20A'(B_0(x))%20(B(x)-B_0(x))%20%5C%5C%20&amp;+%20%5Cfrac%7BA''(B_0(x))%7D%7B2!%7D%20(B(x)-B_0(x))%5E2%20+%20%5Cdots%0A=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A%5Cend%7Bsplit%7D%0A"> <strong>假若</strong> <img src="https://latex.codecogs.com/png.latex?B(x)-B_0(x)%20=%200%20%5Cpmod%7Bx%5En%7D">，那么模 <img src="https://latex.codecogs.com/png.latex?x%5E%7B2n%7D"> 意义下二次方以上的项可以舍去，上式等价于 <img src="https://latex.codecogs.com/png.latex?%0AA(B_0(x))%20+%20A'(B_0(x))%20(B(x)-B_0(x))%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"> 移项即可解出待求 <img src="https://latex.codecogs.com/png.latex?B(x)"> <img src="https://latex.codecogs.com/png.latex?%0AB(x)%20=%20%20B_0(x)%20-%20%5Cfrac%7BA(B_0(x))%7D%7BA'(B_0(x))%7D%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"> 这里要求 <img src="https://latex.codecogs.com/png.latex?A'(B_0(x))"> 需在 <img src="https://latex.codecogs.com/png.latex?x%5E%7B2n%7D"> 意义下可逆，即 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bsplit%7D%0A%5Bx%5E0%5D%20A'(B_0(x))%20=%20%5Bx%5E0%5D%20A'(b_0)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cleft(%20%5Bx%5Ek%5D%20A'%20%5Cright)%20b_0%5Ek%20%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20(k+1)%20a_%7Bk+1%7D%20b_0%5Ek%20%5Cneq%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A%5Cend%7Bsplit%7D%0A"> 注意到 <img src="https://latex.codecogs.com/png.latex?B(x)%20-%20B_0(x)%20=%20-%5Cfrac%7BA(B_0(x))%7D%7BA'(B_0(x))%7D%20=%200%20%5Cpmod%7Bx%5E%7Bn%7D%7D">，故满足上述“假若”的解存在且唯一．然而，若不要求这一“假若”成立，则每步迭代解的唯一性无法得到保证．考虑到边界条件 <img src="https://latex.codecogs.com/png.latex?b_0"> 的解亦不一定唯一，故一般的 Newton 迭代法解唯一性的讨论较为复杂．当然，上述推导至少为我们提供了一种寻找特解的方法．</p>
<p>Newton 迭代法作为通用求解框架，可涵盖几乎所有多项式初等运算．【TODO】</p>
</section>
<section id="多项式求逆" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="多项式求逆"><span class="header-section-number">4.4</span> 多项式求逆</h3>
<p>给定一多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">，求解满足 <img src="https://latex.codecogs.com/png.latex?A(x)%20B(x)%20=%201%20%5Cpmod%7Bx%5E%7Bn%7D%7D"> 的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)">．</p>
<p>多项式逆元存在的充分必要条件是其常数项非零（这是因为边界条件 <img src="https://latex.codecogs.com/png.latex?b_0%20=%20%5Cfrac%201%20%7Ba_0%7D">），若存在则在模意义下一定唯一．这结论可直接由下述求解方法得到．不失一般性，我们只研究 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的次数为奇数 <img src="https://latex.codecogs.com/png.latex?2n-1"> 的情况．设 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AA(x)%20&amp;=%20A_0(x)%20+%20x%5En%20A_1(x)%20%5C%5C%0AB(x)%20&amp;=%20B_0(x)%20+%20x%5En%20B_1(x)%0A%5Cend%7Baligned%7D%0A"> 下述两种方法均递归地在已知 <img src="https://latex.codecogs.com/png.latex?%0AA(x)%20B_0(x)%20=%20A_0(x)%20B_0(x)%20=%201%20%5Cpmod%7Bx%5En%7D%0A"> 的基础上求解 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的逆元．时间复杂度均为 <img src="https://latex.codecogs.com/png.latex?%0AT(n)%20=%20T(%5Cfrac%20n%202)%20+%20O(n%20%5Clog%20n)%20=%20O(n%20%5Clog%20n)%0A"></p>
<p>以下简记 <img src="https://latex.codecogs.com/png.latex?A(x)"> 为 <img src="https://latex.codecogs.com/png.latex?A">，其它多项式同理．</p>
<section id="倍增法一原创" class="level4">
<h4 class="anchored" data-anchor-id="倍增法一原创">倍增法一（原创）</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A&amp;%20A%20B%20=%201%20%5Cpmod%7Bx%5E%7B2n%7D%7D%20%5C%5C%0A%5Ciff&amp;%20(A_0%20+%20x%5En%20A_1)(B_0%20+%20x%5En%20B_1)%20=%201%20%5Cpmod%7Bx%5E%7B2n%7D%7D%20%5C%5C%0A%5Ciff&amp;%20x%5En(A_1%20B_0%20+%20A_0%20B_1)%20+%20A_0%20B_0%20=%201%20%5Cpmod%7Bx%5E%7B2n%7D%7D%20%5C%5C%0A%5Ciff&amp;%20A_1%20B_0%20+%20A_0%20B_1%20+%20%5Cleft%5Clfloor%20%5Cfrac%7BA_0%20B_0%7D%7Bx%5En%7D%20%5Cright%5Crfloor%20=%200%20%5Cpmod%7Bx%5E%7Bn%7D%7D%20%5C%5C%0A%5Ciff&amp;%20%20A_0%20B_1%20=%20-%5Cleft%5Clfloor%20%5Cfrac%7BA_0%20B_0%7D%7Bx%5En%7D%20%5Cright%5Crfloor%20-%20A_1%20B_0%20%5Cpmod%7Bx%5E%7Bn%7D%7D%20%5C%5C%0A%5Ciff&amp;%20%20B_1%20=%20-%20B_0%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%7BA_0%20B_0%7D%7Bx%5En%7D%20%5Cright%5Crfloor%20+%20A_1%20B_0%20%5Cright)%20%5Cpmod%7Bx%5E%7Bn%7D%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>常数偏大，这里就不放代码了．</p>
</section>
<section id="倍增法二" class="level4">
<h4 class="anchored" data-anchor-id="倍增法二">倍增法二</h4>
<p>注意到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bcases%7D%0AA%20B_0%20=%201%20%5Cpmod%7Bx%5En%7D%20%5C%5C%0AA%20B%20=%201%20%5Cpmod%7Bx%5En%7D%0A%5Cend%7Bcases%7D%20%5Cimplies%20A%20(B-B_0)%20=%200%20%5Cpmod%7Bx%5En%7D%0A"> 由于 <img src="https://latex.codecogs.com/png.latex?A"> 的常数项非零，故 <img src="https://latex.codecogs.com/png.latex?%0AB-B_0%20=%200%20%5Cpmod%7Bx%5En%7D%0A"> （这证明了逆元在不同模数下的前缀保持一致）</p>
<p>两边平方得 <img src="https://latex.codecogs.com/png.latex?%0AB%5E2%20-%202%20B%20B_0%20+%20B_0%5E2%20=%200%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"> 两侧同乘 <img src="https://latex.codecogs.com/png.latex?A"> 并移项得 <img src="https://latex.codecogs.com/png.latex?%0AB%20=%202%20B_0%20-%20A%20B_0%5E2%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"></p>
</section>
</section>
<section id="多项式开方todo" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="多项式开方todo"><span class="header-section-number">4.5</span> 多项式开方【TODO】</h3>
<p>和多项式求逆类似的推导可得递推方程 <img src="https://latex.codecogs.com/png.latex?%0AB%20=%20%5Cfrac%201%202%20%5Cleft(%5Cfrac%20A%20%7BB_0%7D%20+%20B_0%20%5Cright)%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"> 有一些和 Newton 法一样麻烦的边界条件讨论，也会出现复杂的多解情况．<img src="https://latex.codecogs.com/png.latex?a_0%20=%201"> 时 <img src="https://latex.codecogs.com/png.latex?b_0%20=%20%5Cpm%201">，按 <img src="https://latex.codecogs.com/png.latex?b_0%20=%201"> 的实现如下．</p>
<p>亦可 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%20A%20=%20%5Cexp%20%5Cleft(%20%5Cfrac%201%202%20%5Cln%20A%20%5Cright)">，此法可处理多项式任意幂指数运算．</p>
</section>
<section id="多项式-ln" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="多项式-ln"><span class="header-section-number">4.6</span> 多项式 <img src="https://latex.codecogs.com/png.latex?%5Cln"></h3>
<p>给定一多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">，求解满足 <img src="https://latex.codecogs.com/png.latex?B(x)%20=%20%5Cln%20A(x)%20%5Cpmod%7Bx%5E%7Bn%7D%7D"> 的多项式 <img src="https://latex.codecogs.com/png.latex?B(x)">．</p>
<p>次数为 <img src="https://latex.codecogs.com/png.latex?+%5Cinfty"> 的多项式 <img src="https://latex.codecogs.com/png.latex?%5Cln"> 存在的充分必要条件为其常数项非零（这是因为边界条件 <img src="https://latex.codecogs.com/png.latex?b_0%20=%20%5Cln%20a_0">），同样一旦存在则唯一．注意到仅整数 <img src="https://latex.codecogs.com/png.latex?a_0=1"> 时，<img src="https://latex.codecogs.com/png.latex?%5Cln%20a_0"> 可取得整数，故合理的 <img src="https://latex.codecogs.com/png.latex?a_0"> 只能是 <img src="https://latex.codecogs.com/png.latex?1">．另一种解释参见<a href="https://oi-wiki.org/math/poly/elementary-func/#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%AF%B9%E6%95%B0%E5%87%BD%E6%95%B0--%E6%8C%87%E6%95%B0%E5%87%BD%E6%95%B0">多项式初等函数 - OI Wiki # 多项式对数函数 &amp; 指数函数</a>．</p>
<p>推导是容易的．方程两侧同时求导得 <img src="https://latex.codecogs.com/png.latex?%0AB'(x)%20=%20%5Cfrac%7BA'(x)%7D%7BA(x)%7D%20%5Cpmod%7Bx%5E%7Bn-1%7D%7D%0A"> 两侧再积分得 <img src="https://latex.codecogs.com/png.latex?%0AB(x)%20=%20%5Cint%20%5Cfrac%7BA'(x)%7D%7BA(x)%7D%20%5Coperatorname%7Bd%7D%5C!x%20+%20C%20%5Cpmod%7Bx%5E%7Bn%7D%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?C=%20%5Cln%20a_0">．多项式求逆、求导、积分即可．时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)">．</p>
</section>
<section id="多项式-exptodo" class="level3" data-number="4.7">
<h3 data-number="4.7" class="anchored" data-anchor-id="多项式-exptodo"><span class="header-section-number">4.7</span> 多项式 <img src="https://latex.codecogs.com/png.latex?%5Cexp">【TODO】</h3>
<p>Newton 迭代法可推出 <img src="https://latex.codecogs.com/png.latex?%0AB%20=%20B(1%20-%20%5Cln%20B_0%20+%20A)%20%5Cpmod%7Bx%5E%7B2n%7D%7D%0A"> 时间复杂度 <img src="https://latex.codecogs.com/png.latex?%0AT(n)%20=%20T(%5Cfrac%20n%202)%20+%20O(n%20%5Clog%20n)%20=%20O(n%20%5Clog%20n)%0A"></p>
<p>存在的充要条件是 <img src="https://latex.codecogs.com/png.latex?a_0=0">．唯一性证明暂不明确．</p>
</section>
<section id="多项式快速幂" class="level3" data-number="4.8">
<h3 data-number="4.8" class="anchored" data-anchor-id="多项式快速幂"><span class="header-section-number">4.8</span> 多项式快速幂</h3>
<p>普通的多项式快速幂实现当然是 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n%20%5Clog%20k)"> 的．下面介绍基于指对数性质的 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"> 求法．</p>
<p>对常数项 <img src="https://latex.codecogs.com/png.latex?a_0=1"> 的 <img src="https://latex.codecogs.com/png.latex?n-1"> 次多项式 <img src="https://latex.codecogs.com/png.latex?A(x)">， <img src="https://latex.codecogs.com/png.latex?%0AA%5Ek(x)%20=%20e%5E%7Bk%20%5Cln%20A(x)%7D%0A"></p>
<p>我们指出，在系数对质数 <img src="https://latex.codecogs.com/png.latex?p"> 取模的意义下，当我们关心的多项式长度 <img src="https://latex.codecogs.com/png.latex?n%20%5Cleq%20p"> 时，有 <img src="https://latex.codecogs.com/png.latex?%0AA%5Ep(x)%20%5Cequiv%20a_0%20%5Cequiv%201%20%5Cpmod%20p%0A"> 这是因为 <img src="https://latex.codecogs.com/png.latex?%0A(a+b)%5Ep%20%5Cequiv%20a%5Ep%20+%20b%5Ep%20%5Cpmod%20p%0A"> 故 <img src="https://latex.codecogs.com/png.latex?%0AA%5Ep(x)%20=%20(a_0%20+%20x%20A_1%20(x))%5Ep%20%5Cequiv%20a_0%5Ep%20+%20x%5Ep%20A_1%5Ep(x)%20%5Cpmod%20p%0A"> 由费马小定理，<img src="https://latex.codecogs.com/png.latex?a_0%5Ep%20=%20a_0">，而 <img src="https://latex.codecogs.com/png.latex?n%20%5Cleq%20p"> 表明 <img src="https://latex.codecogs.com/png.latex?x%5Ep%20A_1%5Ep(x)"> 一项可被忽略，故上述结论得到证明．这些讨论可用于处理幂指数 <img src="https://latex.codecogs.com/png.latex?k%20%5Cgeq%20p"> 的情况．</p>
<p>一般的，当常数项非 <img src="https://latex.codecogs.com/png.latex?1"> 时，为满足多项式 <img src="https://latex.codecogs.com/png.latex?%5Cln"> 的要求，设多项式 <img src="https://latex.codecogs.com/png.latex?A(x)"> 的最低次项为 <img src="https://latex.codecogs.com/png.latex?a_t%20x%5Et">，则 <img src="https://latex.codecogs.com/png.latex?%0AA%5Ek(x)%20=%20(a_t%20x%5Et)%5Ek%20%5Cleft(%20%5Cfrac%7BA(x)%7D%7Ba_t%20x%5Et%7D%20%5Cright)%5Ek%0A"> 右侧的多项式常数项归一，故可再应用上述方法计算．</p>
<p>关于多项式，更代数的内容参考 <a href="https://en.wikipedia.org/wiki/Formal_power_series">Formal power series - Wikipedia</a></p>
</section>
</section>
<section id="集合幂级数todo" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="集合幂级数todo"><span class="header-section-number">5</span> 集合幂级数【TODO】</h2>
</section>
<section id="矩阵" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="矩阵"><span class="header-section-number">6</span> 矩阵</h2>
<section id="矩阵乘法" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="矩阵乘法"><span class="header-section-number">6.1</span> 矩阵乘法</h3>
<p>普通的 <img src="https://latex.codecogs.com/png.latex?O(n%5E3)"> 实现．</p>
</section>
<section id="矩阵快速幂" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="矩阵快速幂"><span class="header-section-number">6.2</span> 矩阵快速幂</h3>
<p>普通的 <img src="https://latex.codecogs.com/png.latex?O(n%5E3%20%5Clog%20k)"> 实现．</p>
</section>
<section id="行列式" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="行列式"><span class="header-section-number">6.3</span> 行列式</h3>
<p>普通的实现是使用逆元进行高斯消元，可用于域上的线性空间．若求解逆元的时间复杂度为 <img src="https://latex.codecogs.com/png.latex?O(%5Clog%20p)">，则时间复杂度为 <img src="https://latex.codecogs.com/png.latex?O(n%5E3+%20n%5E2%20%5Clog%20p)">．</p>
<p>这里给出另一种做法．该做法在消去时使用辗转相除法，可用于任意 Euclid 整环（Euclidean domain，有带余除法的无零因子的交换幺环）上的模（环上的线性空间），且时间复杂度不会增加．一个常见的应用是模 <img src="https://latex.codecogs.com/png.latex?m"> 整数环 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20Z_m"> 上的行列式求值，其中 <img src="https://latex.codecogs.com/png.latex?m"> 不是质数．</p>
<p>消去各目标行第 <img src="https://latex.codecogs.com/png.latex?c"> 列元素时，以第 <img src="https://latex.codecogs.com/png.latex?c"> 行的 <img src="https://latex.codecogs.com/png.latex?a_%7Bc,c%7D"> 为除数与目标行的第 <img src="https://latex.codecogs.com/png.latex?c"> 列元素辗转相除，最终使 <img src="https://latex.codecogs.com/png.latex?a_%7Bc,c%7D"> 变为 <img src="https://latex.codecogs.com/png.latex?0">，再做一次行交换将其换至目标行，就完成了一次行消去过程．注意到当 <img src="https://latex.codecogs.com/png.latex?a_%7Bc,c%7D"> 非零时，一次行消去操作结束后 <img src="https://latex.codecogs.com/png.latex?a_%7Bc,c%7D"> 单调不增，且过程中 <img src="https://latex.codecogs.com/png.latex?a_%7Bc,c%7D"> 不会从非零变为零，故辗转相除带来的 <img src="https://latex.codecogs.com/png.latex?%5Clog%20p"> 次额外操作开销被分摊到整轮对第 <img src="https://latex.codecogs.com/png.latex?c"> 列的消去过程中，因此时间复杂度仍为 <img src="https://latex.codecogs.com/png.latex?O(n%5E3+%20n%5E2%20%5Clog%20p)">．</p>
</section>
</section>
<section id="字符串-自动机" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="字符串-自动机"><span class="header-section-number">7</span> 字符串 / 自动机</h2>
<p>基于 DFA 理论，<a href="https://oi-wiki.org/string/automaton/">OI-Wiki</a> 上有对 KMP / AC 自动机，SAM / GSAM 和 PAM 简明扼要的概括．<a href="https://oi-wiki.org/string/sam/">OI-Wiki</a> 的后缀自动机讲解亦值得参考．</p>
</section>
<section id="图论todo" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="图论todo"><span class="header-section-number">8</span> 图论【TODO】</h2>
<section id="最短路" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="最短路"><span class="header-section-number">8.1</span> 最短路</h3>
</section>
<section id="强连通分量" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="强连通分量"><span class="header-section-number">8.2</span> 强连通分量</h3>
</section>
<section id="网络流" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="网络流"><span class="header-section-number">8.3</span> 网络流</h3>
</section>
</section>
<section id="杂项" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="杂项"><span class="header-section-number">9</span> 杂项</h2>
<section id="模板" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="模板"><span class="header-section-number">9.1</span> 模板</h3>
<p>见 <a href="code/model.cpp">model.cpp</a>, <a href="code/model_temp.cpp">model_temp.cpp</a>．</p>
<section id="model.cpp" class="level4">
<h4 class="anchored" data-anchor-id="model.cpp">MODEL.CPP</h4>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb6-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> std<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">unsigned</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">unsigned</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ull<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> db<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> ldb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- read ---</span></span>
<span id="cb6-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-11">T rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// for bigint read</span></span>
<span id="cb6-12">    T ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> sgn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>getchar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'9'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> sgn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>getchar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();}</span></span>
<span id="cb6-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'9'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>getchar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();}</span></span>
<span id="cb6-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>sgn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-17"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- variable mod ---</span></span>
<span id="cb6-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">998244353</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>PR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-21"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define pmod_m</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">((</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;(</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)?(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-(</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb6-22"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define nmod_m</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">((</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+(</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb6-23"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define hmod_m</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span>nmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">((</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)%(</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),(</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// slow!</span></span>
<span id="cb6-24"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define pmod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span>pmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-25"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define nmod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span>nmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-26"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#define hmod</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;"> </span>hmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-28">T qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>U x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>T mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-29">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> T ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb6-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-32"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-33"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-34">ll inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>T mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// assume mod prime</span></span>
<span id="cb6-35"></span>
<span id="cb6-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- Number Theory ---</span></span>
<span id="cb6-37">ll gcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-38">ll lcm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>gcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-39">tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// capable of +/- integers</span></span>
<span id="cb6-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-41">    ll x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-43"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-44">ll inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-45">    ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?</span>hmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-47"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-48">tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> solve_equ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// return solution with min non-negative x</span></span>
<span id="cb6-49">    ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-50">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// !!!</span></span>
<span id="cb6-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">false</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-52">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ll dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// ensure dx positive</span></span>
<span id="cb6-54">    ll t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>hmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)/</span>dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-56"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">CAUTION</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> __int128</span></span>
<span id="cb6-58">pair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> excrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>pair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>pair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> p2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// merge (a1,m1) (a2,m2)</span></span>
<span id="cb6-59">    ll a1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>p2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-60">    ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>solve_equ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-61">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-62">    ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lcm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>m2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>hmod_m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>a1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-63"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-64">ll bsgs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// solve a^x=b mod m, gcd(a,m)=1</span></span>
<span id="cb6-65">    unordered_map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> mp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ll sqrtM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ceil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>sqrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb6-66">    ll cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-67">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>sqrtM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-68">        cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-69">        mp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-70">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-71">    ll nw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-72">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>sqrtM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-73">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>mp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>nw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>sqrtM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>mp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>nw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-74">        nw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>nw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-75">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-76">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-77"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">CAUTION</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> uncensored / __int128 / rand() ---</span></span>
<span id="cb6-79"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> is_prime<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// miller rabin</span></span>
<span id="cb6-80">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-81">    ll u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++;</span></span>
<span id="cb6-82">    ll test_time<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>test_time<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--){</span></span>
<span id="cb6-83">        ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rand<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()%(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">__int128</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-84">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-85">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-86">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-87">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-88">            v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">__int128</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-89">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">false</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-90">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-91"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-92"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">CAUTION</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> uncensored __int128 rand() ---</span></span>
<span id="cb6-93">ll pollard_rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-94">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">auto</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=[&amp;](</span>ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-&gt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">__int128</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)%</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;};</span></span>
<span id="cb6-95">    ll c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rand<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()%(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-96">    ll t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-97">    ll r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-98">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-99">        ll d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>gcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>abs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-100">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-101">        t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-102">        r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-103">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-104"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> ll get_factor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-105">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>is_prime<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-106">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-107">    ll d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pollard_rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-108">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-109"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-110"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> _prime_test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-111">    srand<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>time<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb6-112">    ll N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-113">    cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;(</span>is_prime<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)?</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YES"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NO"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;&lt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>get_factor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-114"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-115"></span>
<span id="cb6-116"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- constant mod, can be modified to be variable ---</span></span>
<span id="cb6-117"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-118"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">static</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">inline</span> ModInt uroot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>PR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),(</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)/</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-120"></span>
<span id="cb6-121">    T dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">():</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}{}</span></span>
<span id="cb6-122">    ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>initializer_list<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> lst<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{*</span>lst<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>begin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()}{}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// for mod-free number, use this</span></span>
<span id="cb6-123">    ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>U dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hmod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))}{}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// implicit conversion, slow!</span></span>
<span id="cb6-124">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">explicit</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> T <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-125">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ostream<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ostream <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> mi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>mi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-126">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// negative number version</span></span>
<span id="cb6-127">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// friend ostream&amp; operator &lt;&lt; (ostream &amp;out,const ModInt&amp; mi){out&lt;&lt;(mi.dat+mi.dat&lt;MOD?mi.dat:mi.dat-MOD)&lt;&lt;" "; return out;}</span></span>
<span id="cb6-128">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>pmod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};}</span></span>
<span id="cb6-129">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nmod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(-</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};}</span></span>
<span id="cb6-130">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nmod<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};}</span></span>
<span id="cb6-131">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};}</span></span>
<span id="cb6-132">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Euclidean division</span></span>
<span id="cb6-133">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Euclidean division</span></span>
<span id="cb6-134">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ModInt qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ModInt x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-135">        ModInt ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-136">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">inline</span> ModInt inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// assume MOD is prime</span></span>
<span id="cb6-137">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-138">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-139">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-140">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-141">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-142">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-143">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ModInt b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-144"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-145"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> ModInt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-146"></span>
<span id="cb6-147"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- linear init ---</span></span>
<span id="cb6-148">vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>facinv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>inv_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-149"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> linear_init<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-150">    fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> facinv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> inv_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-151">    inv_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> inv_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=-(</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv_s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>MOD<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-152">    fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-153">    facinv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>fac<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]));</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--)</span> facinv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>facinv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-154"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-155"></span>
<span id="cb6-156"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- polynomial ---</span></span>
<span id="cb6-157"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> log2ceil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-158">vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-159"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> spawn_rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// n=log2ceil(N)</span></span>
<span id="cb6-160">    rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-161">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+((</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;&lt;(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb6-162"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-163"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span> vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;{</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-164">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-165">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">inline</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// to avoid strange glitches caused by size_t</span></span>
<span id="cb6-166">    Poly subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// [l,r), zero padded (support negative number)</span></span>
<span id="cb6-167">        Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()?</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">):</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-168">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-169">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ostream<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ostream <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&lt;&lt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-170">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-171">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(),</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">());</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-172">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+=</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()?</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-173">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-174">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=-</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-175">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+(-</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-176">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-177">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// to be called by opt() only (with proper length and rev array)</span></span>
<span id="cb6-178">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-179">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]));</span></span>
<span id="cb6-180">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-181">            MI w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>uroot<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-182">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-183">                MI wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-184">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-185">                    MI x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-186">                    at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-187">                    wk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-188">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-189">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-190">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-191">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>typ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>MI inv_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">});</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-192">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-193">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly opt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>MI a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&gt;</span> func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-194">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>log2ceil<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> spawn_rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-195">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-196">        Poly C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb6-197">        C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>DFT<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-198">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-199">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-200">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> opt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()+</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,[](</span>MI a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;});</span></span>
<span id="cb6-201">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-202">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-203">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">={</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])};</span></span>
<span id="cb6-204">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-205">            B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>opt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,[](</span>MI a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;});</span></span>
<span id="cb6-206">            B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-207">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-208">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-209">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly sqrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-210">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// assume a_0 = 1 and b_0 positive</span></span>
<span id="cb6-211">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-212">            B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))+</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">});</span></span>
<span id="cb6-213">            B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-214">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-215">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-216">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly drv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// derivative</span></span>
<span id="cb6-217">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-218">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>pop_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-219">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-220">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly itg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// integral</span></span>
<span id="cb6-221">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">});</span></span>
<span id="cb6-222">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-223">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-224">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">inline</span> Poly ln<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-225">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> itg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">((</span>drv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>inv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)).</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/*log(A[0])*/</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-226">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-227">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Poly exp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-228">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> Poly B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/*exp(A[0])*/</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-229">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-230">            B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*(</span>Poly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}-</span>ln<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))+</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hf<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-231">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-232">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-233">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-234">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">inline</span> Poly qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Poly <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>MI up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> exp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ln<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// assume a_0 = 1</span></span>
<span id="cb6-235">    </span>
<span id="cb6-236">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">static</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> _test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-237">        ll N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-238">        Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-239">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-240">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-241">        Poly C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-242">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/*ll N=rd(); Poly A(N);</span></span>
<span id="cb6-243"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        for(ll i=0;i&lt;N;i++) A[i]=rd();</span></span>
<span id="cb6-244"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        A=inv(A); cout&lt;&lt;A;*/</span></span>
<span id="cb6-245">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-246"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-247"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> divntt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-248">    Poly A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-249">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> divntt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// capable of non-negative [l,r), "i&lt;j" order</span></span>
<span id="cb6-250">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-251">        ll mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-252">        Poly T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>subpoly<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-253">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()&amp;&amp;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">CAUTION</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: time complexity</span></span>
<span id="cb6-254">            C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+=</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-255">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-256">        divntt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> divntt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>mid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-257">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-258"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-259"></span>
<span id="cb6-260"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- matrix ---</span></span>
<span id="cb6-261"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span> vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;{</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-262">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">static</span> Matrix I<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-263">        Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-264">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-265">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-266">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-267">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-268">    Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...){}</span></span>
<span id="cb6-269">    Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>initializer_list<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> lst<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>lst<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){}</span></span>
<span id="cb6-270">    MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;::</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-271">    MI cat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*(</span>cbegin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()+</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-272">    MI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}</span></span>
<span id="cb6-273">    Matrix submat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> sc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> tc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-274">        Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>tc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,{});</span></span>
<span id="cb6-275">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>tc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-276">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-277">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-278">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> ostream<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ostream <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-279">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>cat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&lt;&lt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-280">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-281"></span>
<span id="cb6-282">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Matrix <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Matrix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-283">        Matrix C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-284">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span></span>
<span id="cb6-285">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span></span>
<span id="cb6-286">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span></span>
<span id="cb6-287">                    C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>cat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>B<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>cat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-288">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-289">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-290">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> Matrix qpow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Matrix X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-291">        Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>I<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Matrix<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-292">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>up<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-293">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-294">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> stair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// row reduce to upper stair matrix, return swap time % 2. capable of any ring</span></span>
<span id="cb6-295">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> swp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-296">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-297">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">auto</span> swpl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=[&amp;](</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-298">                swp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb6-299">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-300">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span></span>
<span id="cb6-301">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-302">                    MI factor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)/</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-303">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-=</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>factor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-304">                    swpl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-305">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> swpl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-306">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>at<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++;</span></span>
<span id="cb6-307">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> swp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-308">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-309">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> MI det<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-310">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-311">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> opt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>stair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-312">        MI ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-313">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> opt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?-</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-314">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-315">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> rk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// rank (confuse with std::rank)</span></span>
<span id="cb6-316">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>stair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-317">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--)</span></span>
<span id="cb6-318">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>col<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span></span>
<span id="cb6-319">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-320">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb6-321">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-322"></span>
<span id="cb6-323">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">static</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> _test<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-324">        ll N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(),</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> Matrix A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,{});</span></span>
<span id="cb6-325">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>M<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">());</span></span>
<span id="cb6-326">        A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>stair<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>A<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-327">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-328"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-329"></span>
<span id="cb6-330"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- automata ---</span></span>
<span id="cb6-331"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> STRN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> CHAR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> OFFSET<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-332"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> ACAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// id: 0 is null, 1 is start</span></span>
<span id="cb6-333">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-334">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-335">        array<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>CHAR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-336">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-337">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>STRN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-338">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-339">    ACAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-340">        sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-341">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>CHAR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-342">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-343">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> insert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-344">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-345">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span>OFFSET<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-346">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=++</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-347">            p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-348">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-349">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-350">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> buildFail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-351">        queue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-352">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>empty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()){</span></span>
<span id="cb6-353">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>front<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(),</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>pop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-354">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>CHAR<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++){</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-355">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>que<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-356">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-357">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-358">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-359">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-360">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// below: subject to problem Lugou P5357</span></span>
<span id="cb6-361">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-362">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> match<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-363">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-364">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-365">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span>OFFSET<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-366">            p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-367">            cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]++;</span></span>
<span id="cb6-368">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-369">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-370">    vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-371">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> buildTree<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// fail tree</span></span>
<span id="cb6-372">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>clear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-373">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-374">        function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&gt;</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=[&amp;](</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-375">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+=</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-376">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-377">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-378">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-379">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]]&lt;&lt;</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-380">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-381"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-382"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> ACAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ACAM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-383"></span>
<span id="cb6-384"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// 2 * length of string suffices</span></span>
<span id="cb6-385"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SuffixAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// id: 0 is null, 1 is start</span></span>
<span id="cb6-386">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-387">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-388">        map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// feel free to modify to array&lt;int,26&gt;</span></span>
<span id="cb6-389">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-390">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-391">    SuffixAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb6-392">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> insert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-393">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=++</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-394">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;!</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-395">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-396">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-397">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-398">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// vtx[q].len&gt;vtx[p].len+1, partition needed</span></span>
<span id="cb6-399">            vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">false</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-400">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]==</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-401">            vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-402">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-403">        last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-404">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-405">    ll LCSWith<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// as an example of matching</span></span>
<span id="cb6-406">        ll p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-407">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-408">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++;</span></span>
<span id="cb6-409">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-410">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;!</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-411">                cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-412">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-413">            p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">?</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-414">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-415">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-416">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// below: subject to problem Luogu P3804</span></span>
<span id="cb6-417">    vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-418">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> buildTree<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-419">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>clear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-420">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-421">        function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&gt;</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=[&amp;](</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-422">            sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-423">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+=</span>sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-424">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> dfs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-425">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-426">    ll answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-427">        ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-428">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">LL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>sz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]*</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-429">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb6-430">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-431"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-432"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> SuffixAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&gt;</span> SAM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-433"></span>
<span id="cb6-434"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb6-435"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> PalindromicAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// id: 1 is odd root, 0 is even root (as fallback)</span></span>
<span id="cb6-436">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb6-437">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-438">        map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// feel free to modify to array&lt;int,26&gt;</span></span>
<span id="cb6-439">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-440">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-441">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// subject to problem Luogu P5496</span></span>
<span id="cb6-442">    PalindromicAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-443">        vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// fail[even]=odd, fail[odd]=even</span></span>
<span id="cb6-444">        last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-445">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-446">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> getValid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// even is never valid, odd is always valid</span></span>
<span id="cb6-447">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(;</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]!=</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb6-448">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-449">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-450">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> insert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb6-451">        s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>sn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>getValid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> </span>
<span id="cb6-452">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]){</span></span>
<span id="cb6-453">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>getValid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// when p=odd, fail[p]=even, then f is still odd</span></span>
<span id="cb6-454">            vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]={</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>len<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// len[odd]=-1 useful here</span></span>
<span id="cb6-455">                                                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// vtx[f].ch[c]=0 only happens when p=odd</span></span>
<span id="cb6-456">                                                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// for s[sn-vtx[p].len-1..sn] is already a palindrome</span></span>
<span id="cb6-457">            vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-458">            cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>vn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>fail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// subject...</span></span>
<span id="cb6-459">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vtx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>ch<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb6-460">        cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&lt;&lt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// subject...</span></span>
<span id="cb6-461">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-462"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb6-463"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> PalindromicAutomation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&gt;</span> PAM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-464"></span>
<span id="cb6-465"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> entry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-466">    </span>
<span id="cb6-467"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb6-468"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb6-469">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//freopen("t1.in","r",stdin);</span></span>
<span id="cb6-470">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//freopen("t1.out","w",stdout);</span></span>
<span id="cb6-471">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ll T=rd(); while(T--){</span></span>
<span id="cb6-472">        entry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb6-473">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//}</span></span>
<span id="cb6-474">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-475"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="model_temp.cpp" class="level4">
<h4 class="anchored" data-anchor-id="model_temp.cpp">MODEL_TEMP.CPP</h4>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb7-1"></span>
<span id="cb7-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;bits/stdc++.h&gt;</span></span>
<span id="cb7-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> std<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// --- </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">CAUTION</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> uncensored ---</span></span>
<span id="cb7-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> MaxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999999999</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20005</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400005</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-10">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-11">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-12">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-13">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> GraphInit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb7-14">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-15">        edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]};</span></span>
<span id="cb7-16">        last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-18">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> AddNetEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-19">        AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-21">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> Un<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb7-22"></span>
<span id="cb7-23">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>gap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-24">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> bomb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-25">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> Send<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> ret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-26">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-27">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> gone<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-29">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-30">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-31">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Send<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb7-32">            edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-33">            edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>Un<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-34">            ret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>gone<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-35">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ret<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span>bomb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> gone<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-36">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-37">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(--</span>gap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]]==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> bomb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-38">        gap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]]++;</span></span>
<span id="cb7-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> gone<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-40">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-41">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> ISAP<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> st<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> ed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-42">        ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>st<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-43">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>gap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-44">        gap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-45">        bomb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>bomb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-47">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> cur<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-48">            mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>Send<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-49">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-50">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-51">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-52"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-53"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> CostFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">999999999</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10005</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200005</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-56">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-57">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-58">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-59">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-60">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> GraphInit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb7-61">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-62">        edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]};</span></span>
<span id="cb7-63">        last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-64">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-65">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> AddNetEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-66">        AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,-</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-67">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-68">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> Un<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb7-69"></span>
<span id="cb7-70">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>miCost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-71">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-72">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> Q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>hd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>tl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-73">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> SPFA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb7-74">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>graN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-75">        hd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>tl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-76">        dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>Q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>tl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-77">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>hd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>tl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-78">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>hd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++];</span>isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-79">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-80">                <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-81">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-82">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-83">                    dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]+</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-84">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]){</span></span>
<span id="cb7-85">                        isQ<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-86">                        Q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>tl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-87">                    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-88">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-89">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-90">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-91">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]&gt;=</span>INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-92">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-93">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-94">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> Adjust<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb7-95">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>INF<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-96">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]].</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-97">            dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-98">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]].</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-99">            edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span>dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-100">            edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>Un<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>pre<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])].</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-101">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-102">        mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>miCost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>dlt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>dis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-103">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-104">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> EK<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> st<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> ed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-105">        ST<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>st<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ED<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-106">        mxFlow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>miCost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-107">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>SPFA<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">())</span> Adjust<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb7-108">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-109"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-110"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">namespace</span> Tarjan<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> ll PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2E6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-112">    ll N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-113">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ll u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>ll nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;};</span></span>
<span id="cb7-114">    Edge edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>EDN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-115">    ll graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-116">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> GraphInit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++)</span> last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb7-117">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> AddBscEdge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-118">        edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=(</span>Edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]};</span></span>
<span id="cb7-119">        last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>graM<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-120">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-121">    ll bel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>cN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>rps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//belong, number of components, representative vertax of the component</span></span>
<span id="cb7-122">    ll dfn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>dN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-123">    ll stk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>tp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> isI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>PTN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb7-124">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> Tarjan<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-125">        dfn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=++</span>dN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-126">        stk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>tp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>isI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-127">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>last<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>nxt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb7-128">            ll v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>edge<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">].</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-129">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>isI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]){</span></span>
<span id="cb7-130">                low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>dfn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb7-131">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>dfn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]){</span></span>
<span id="cb7-132">                Tarjan<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-133">                low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">],</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb7-134">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-135">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-136">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>dfn<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]==</span>low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]){</span></span>
<span id="cb7-137">            rps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[++</span>cN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>ll t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-138">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-139">                t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>stk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>tp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--];</span></span>
<span id="cb7-140">                isI<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>bel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span>cN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-141">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span>u<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-142">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-143">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-144"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-145"></span></code></pre></div>
</section>
</section>
<section id="对拍" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="对拍"><span class="header-section-number">9.2</span> 对拍</h3>
<section id="windows-batch" class="level4">
<h4 class="anchored" data-anchor-id="windows-batch">Windows Batch</h4>
<pre class="batch"><code>:loop
    gen.exe&gt;dat.in
    my.exe&lt;dat.in&gt;my.out
    std.exe&lt;dat.in&gt;std.out
    fc my.out std.out
    if not errorlevel 1 goto loop
pause</code></pre>
</section>
<section id="linux-shell" class="level4">
<h4 class="anchored" data-anchor-id="linux-shell">Linux Shell</h4>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb9-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./gen</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>dat.in</span>
<span id="cb9-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./std</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>dat.in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>std.out</span>
<span id="cb9-4">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./my</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>dat.in<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>my.out</span>
<span id="cb9-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">diff</span> std.out my.out<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> OK</span>
<span id="cb9-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> DIFF</span>
<span id="cb9-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 0</span>
<span id="cb9-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb9-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
</section>
<section id="表" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="表"><span class="header-section-number">9.3</span> 表</h3>
<section id="质数表" class="level4">
<h4 class="anchored" data-anchor-id="质数表">质数表</h4>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb10-1">1e2     1e3     1e4       1e5       1e6</span>
<span id="cb10-2">101         1009        10007       100003      1000003</span>
<span id="cb10-3"></span>
<span id="cb10-4">1e7       1e8         1e9         1e10        1e11          </span>
<span id="cb10-5">10000019    100000007   1000000007  10000000019 100000000003</span>
<span id="cb10-6"></span>
<span id="cb10-7">1e12          1e13            1e14            1e15</span>
<span id="cb10-8">1000000000039   10000000000037  100000000000031 1000000000000037</span>
<span id="cb10-9"></span>
<span id="cb10-10">1e16              1e17                1e18</span>
<span id="cb10-11">10000000000000061   100000000000000003  1000000000000000003</span></code></pre></div>
</section>
<section id="典列" class="level4">
<h4 class="anchored" data-anchor-id="典列">典列</h4>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb11-1">index         0   1   2   3   4   5   6   7   8     9     10</span>
<span id="cb11-2">Catalan       1   1   2   5   14  42  132 429 1430  4862  16796</span>
<span id="cb11-3">Bell          1   1   2   5   15  52  203 877 4140  21147 115975</span>
<span id="cb11-4">partition     1   1   2   3   5   7   11  15  22    30    42</span>
<span id="cb11-5">group         0   1   1   1   2   1   2   1   5     2     2</span></code></pre></div>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb12-1">binomial</span>
<span id="cb12-2">x   0   1   2   3   4   5</span>
<span id="cb12-3">0 | 1</span>
<span id="cb12-4">1 | 1   1</span>
<span id="cb12-5">2 | 1   2   1</span>
<span id="cb12-6">3 | 1   3   3   1</span>
<span id="cb12-7">4 | 1   4   6   4   1</span>
<span id="cb12-8">5 | 1   5   10  10  5  1</span>
<span id="cb12-9"></span>
<span id="cb12-10">Stirling I</span>
<span id="cb12-11">x   0   1   2   3   4   5</span>
<span id="cb12-12">0 | 1</span>
<span id="cb12-13">1 |     1</span>
<span id="cb12-14">2 |     1   1</span>
<span id="cb12-15">3 |     2   3   1</span>
<span id="cb12-16">4 |     6   11  6   1</span>
<span id="cb12-17">5 |     24  50  355 10  1</span>
<span id="cb12-18"></span>
<span id="cb12-19">Stirling II</span>
<span id="cb12-20">x   0   1   2   3   4   5</span>
<span id="cb12-21">0 | 1</span>
<span id="cb12-22">1 |     1</span>
<span id="cb12-23">2 |     1   1</span>
<span id="cb12-24">3 |     1   3   1</span>
<span id="cb12-25">4 |     1   7   6   1</span>
<span id="cb12-26">5 |     1   15  25  10  1</span>
<span id="cb12-27"></span>
<span id="cb12-28">Lah</span>
<span id="cb12-29">x   0   1   2   3   4   5</span>
<span id="cb12-30">0 | 1</span>
<span id="cb12-31">1 |     1</span>
<span id="cb12-32">2 |     2   1</span>
<span id="cb12-33">3 |     6   6   1</span>
<span id="cb12-34">4 |     24  36  12  1</span>
<span id="cb12-35">5 |     120 240 120 20  1</span>
<span id="cb12-36"></span>
<span id="cb12-37">k-partition</span>
<span id="cb12-38">    0   1   2   3   4   5</span>
<span id="cb12-39">0 | 1</span>
<span id="cb12-40">1 |     1</span>
<span id="cb12-41">2 |     1   1</span>
<span id="cb12-42">3 |     1   1   1</span>
<span id="cb12-43">4 |     1   2   1   1</span>
<span id="cb12-44">5 |     1   2   2   1   1</span></code></pre></div>


</section>
</section>
</section>

 ]]></description>
  <category>OI</category>
  <category>数学</category>
  <guid>https://blog.sun123zxy.top/posts/20230621-cpmodel/</guid>
  <pubDate>Tue, 20 Jun 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>CCPC 2023 湘潭邀请赛游记</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230530-xiangtan/</link>
  <description><![CDATA[ 




<section id="序" class="level2">
<h2 class="anchored" data-anchor-id="序">序</h2>
<p>04:36，长沙返程的硬卧列车上。</p>
<p>禁不起隔壁大叔富有特色的鼾声，对着窗外发愣。</p>
<p>写写游记吧。</p>
</section>
<section id="day--inf-0" class="level2">
<h2 class="anchored" data-anchor-id="day--inf-0">Day (-inf, 0)</h2>
<p>由于 UCUP Taiwan 场神奇的发挥，意外获得湘潭邀请赛名额 x1。公费旅游万岁！</p>
<p>然而，飞机不给报，高铁不给报，软卧不给报，打车也不给报，路途时间高达 30h，还被迫翘掉周五周一头尾三节大课，体验并不良好。祸不单行，赛前十余日惊悉普物 27 日下午期末考试，若申请缓考，本学期的奖学金怕是无了。思量再三，还是想去，决定与队友兵分两路，考完直接空降长沙，再想办法到湘潭。晚上城铁已经收班，要是想当天到，恐怕只能高价打车了。这么算下来……</p>
<p>自费金额 +1000 : (</p>
<p>火车票意外地非常抢手，稍不留神，返程火车就只剩晚上 11 点半的了——赶上明天的早课是没必要再想了。不过，岳麓山橘子洲恰在长沙站西不远处，看看夜景也是不错的。</p>
<p>其它队伍似乎并不太着急……</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/whynot.jpg" class="img-fluid figure-img"></p>
<figcaption>你先别急</figcaption>
</figure>
</div>
<p>最后竟因抢票太积极，被迫与大部队分道扬镳 : (</p>
</section>
<section id="day-0" class="level2">
<h2 class="anchored" data-anchor-id="day-0">Day 0</h2>
<p>去湘潭的路途并无太多亮点，感受是 <img src="https://latex.codecogs.com/png.latex?%0A1000%20%5Ctext%7BCNY%7D%20=%20%5Ctext%7B%E9%A3%9E%E6%9C%BA%7D%20+%20%5Ctext%7B%E6%89%93%E8%BD%A6%7D%20+%20%5Ctext%7B%E4%B9%9F%E4%B8%8D%E7%9F%A5%E9%81%93%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B%E5%8F%8D%E6%AD%A3%E8%8E%AB%E5%90%8D%E5%85%B6%E5%A6%99%E5%B0%B1%E5%88%B0%E4%BA%86%E7%9A%84%E4%BD%93%E9%AA%8C%7D%0A"></p>
<p>从半径来看，大兴机场并没有想象中的大。但其空间设计非常有意思。雪花状的航站楼中间高两头低，下站点、值机、安检全部集中在中心区域，而航站楼、廊桥、登机口通过几只触角向远端延伸，空间利用率极高，极大地节省了转场行走花费的时间。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/daxing.jpg" class="img-fluid figure-img"></p>
<figcaption>颇有商圈风范</figcaption>
</figure>
</div>
<p>与队友联系，惊悉热身赛诸多不尽人意之处。这小破赛居然不用 DOMJudge？Pending 一发 20 min？评测机 32 位没 <code>__int128</code>？PE 是什么鬼东西？Dev C++ 只提供魔改版？VSCode 给了但机子带不动？……感觉不如校赛。希望不是所有 CCPC 都这样（</p>
<p>队友给看了道热身赛题说是签到数论，飞机上吭哧吭哧半天无果，结果发现被诈骗了，赛时场内一人未过（</p>
<p>到达 XX 电竞酒店，半夜。发现机子上竟有 Age of Empires 2——更神奇的是，队友竟突然指出 AoE2 是其机房的传统艺能！？小众中的小众，从未发现同好的 RTS/AoE 玩家落泪了。遗憾的是到得太晚，没来得及切磋一把。01:00 左右睡下。</p>
</section>
<section id="day-1" class="level2">
<h2 class="anchored" data-anchor-id="day-1">Day 1</h2>
<p>湖南的清晨从一碗米粉开始——味道不错，但口感并不太中意。</p>
<p>一出门才感受到湖南的湿热：湿度高达 90% 的头顶烈日，走上两分钟就汗水淋漓，可不比某火炉城市好到那里。已经可以想象无法洗澡就要登上返程火车的我们会有多臭了 : ( 。更别说湘潭大学惊人的大小，坚持到开幕式现场的根本就没几个队（</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/xiangtan-1.jpg" class="img-fluid figure-img"></p>
<figcaption>湘大某入口</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/xiangtan-2.jpg" class="img-fluid figure-img"></p>
<figcaption>校徽版（据说存在缺漏）</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>有气球（没有 CCPC 图标），有打印（比评测快），有汉堡套餐（没怎么认真吃），志愿者人手似乎不太够，每个考室甚至分不到一个监考。</p>
<p>随便开题。两位队友秒了 I 然后 J（牛！）。随机游走开题，L 感觉是什么大力数据结构嵌套，E 数学题玩了玩感觉并没有什么思路，但发现并秒了 H，然后第一梯队的签到题好像就做完了。继续随机游走，看了 G 以为队友做过，确认后发现并没有，那应该就不太容易了。看榜开 F，干碎臭长题面发现就是个基础<del>随机运筹学</del>期望 dp，队友灵魂提醒需要特判 <img src="https://latex.codecogs.com/png.latex?B=1">，成功 1A。这期间两位队友也开了 A 但一发 WA 一发 TLE——怎么会 T 呢？在此之间卡壳卡爆。三人干瞪眼贡献四发罚时浪费 1h，结果竟是 <img src="https://latex.codecogs.com/png.latex?10%5E5"> 次 <code>printf</code> 在老爷评测上跑的太慢！写题的队友表示以后彻底切割 C 风格读写（</p>
<p>然后三人回头看之前和一位队友讨论一半的 K（J 是 K 的 checker 海星）。想到了 <code>aa</code>, <code>bb</code>, <code>cc</code>, …, <code>ab</code>, <code>ac</code>, <code>ad</code>, … 的构造方式，但在考虑后续延伸时莫名认为要继续移位构造超大置换环 <code>abcde...</code>, <code>acegi...</code>，于是开始大力计算 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=0%7D%5E%7B25%7D%20%5Cgcd(26,i)">。队友打断吟唱，指出只需 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20%7B25%20%5Ctimes%2024%7D%7B2%7D"> 两位循环并在后面填充 <code>z</code> 即可，遂暴毙，决定先拿下汉堡套餐，然后继续游走摆烂。然而队友小脑转的比大脑快，光速敲完遗憾 WA，似乎他的特判有亿点多。调试无果，打印，换我重写。写得差不多了，两位队友合力调试突然成功，于是历经坎坷终于进入 6 题区。</p>
<p>距比赛结束还有一个半小时左右。看 B 看 D，深感星穹铁道题面之博大精深，决定搏一搏 L。上了个厕所发现会二维了，三维似乎也只是颗二维线段树，维护 max/min 判断当前操作方块是否平整 + 区间覆盖的修改操作即可。然而队友思路是神奇的二维扫描线，顿感自己非常不熟悉这种非标线段树。激烈讨论后，还是让擅长数据结构的队友按他熟悉的方法实现。然而队友实现一半算法竟然假了，又紧急更换写法，此前表现正常的电脑突然开始变卡，三个人对着电脑大吼大叫，最后 2 min 写完了代码！F11！输出“No”！摆！</p>
<p>第一次外出比赛就这样结束了。比较遗憾的，无疑是 A <code>printf</code> 吃的四发罚时了。给你校老爷评测机跪了（</p>
<p>滚榜环节的操作非常迷惑，不从奖牌区滚起，又跳过了 Cu Ag 区，滚了个寂寞。因为老爷评测机的原因，封榜前后的排名也几乎没有发生变化。6 题金银铜，这是我能见着的区分度吗（</p>
<p>最后冠军颁奖倒意外地有节目效果。主持人抑扬顿挫念出“梦想天生”，BGM 和掌声突然响起，恍惚有 Dream Battle 前奏噔噔咚，灵梦按在地上揍的感觉（</p>
</section>
<section id="day-1-赛后" class="level2">
<h2 class="anchored" data-anchor-id="day-1-赛后">Day 1 赛后</h2>
<p>返程继续暴汗。从湘潭乘城铁至长沙。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/city-railway.jpg" class="img-fluid figure-img"></p>
<figcaption>高铁风格，地铁运营</figcaption>
</figure>
</div>
<p>队友来时已经踩好点了，拉着啥也不知道的我就往五一广场走……</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[75,25]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/plaza.jpg" class="img-fluid figure-img"></p>
<figcaption>五一广场</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/tea.jpg" class="img-fluid figure-img"></p>
<figcaption>到处都是的某神奇奶茶店</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>队友在前面慢悠悠地寻找吃饭的地方，看上去是准备边吃边坐挨到火车到点了。还想出去逛逛，于是暂时各奔东西。街边随便点了份牛杂面（超辣！）和臭豆腐（完全不臭），乘地铁二号线至橘子洲西岸，向岳麓山前进。然而功课未做充足，到达山门才发现索道已停，大巴收班。天色已晚，爬上去显然赶不上 11 点半的火车，只好悻悻而去。</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/mount-2.jpg" class="img-fluid figure-img"></p>
<figcaption>岳麓山门</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/mount-1.jpg" class="img-fluid figure-img"></p>
<figcaption>岳麓山麓</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>然而……</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/young.jpg" height="600" class="figure-img"></p>
<figcaption>年轻真好</figcaption>
</figure>
</div>
<p>于是从麓山路返回，上至橘子洲大桥。由此可直接步行至江心的橘子洲。</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/orange-1.jpg" class="img-fluid figure-img"></p>
<figcaption>橘子洲西望</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/orange-2.jpg" class="img-fluid figure-img"></p>
<figcaption>橘子洲东望</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>时间来到 10 点整。准备返程。地铁至五一广场，与队友汇合，前往长沙站。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230530-xiangtan/img/station.jpg" class="img-fluid figure-img"></p>
<figcaption>旅途的终点</figcaption>
</figure>
</div>
<p>疲惫，忘记买早饭就过安检了。候车大厅已无空位，站着闲聊了小会儿，时间到了。之前车上刷夜的豪言壮语早已抛之脑后，上车一躺——Day 1, end.</p>
<p>upd x1: 酒店登录过 Steam 的群友都被盗号了 <img src="https://latex.codecogs.com/png.latex?%5CSigma%20(%20%5Csupset%20%5Cmathrm%7BO%7D%20_%5Cfrown%20%5Cmathrm%7BO%7D%20)%20%5Csupset"></p>
<p>upd x2: 报销疑似仍然有戏，感谢学校感谢党 <img src="https://latex.codecogs.com/png.latex?%5CSigma%20(%20%5Csupset%20%5Cmathrm%7BO%7D%20_%5Csmile%20%5Cmathrm%7BO%7D%20)%20%5Csupset"></p>
</section>
<section id="补题" class="level2">
<h2 class="anchored" data-anchor-id="补题">补题</h2>
<p><a href="https://codeforces.com/gym/104396">GYM104396</a></p>
<section id="l" class="level3">
<h3 class="anchored" data-anchor-id="l">L</h3>
<p>需要注意的是，四分树 / K-D 树不存在时间复杂度优秀的区间修改。对于任意区间修改，树套树的实现是必要的。</p>
<p>L 其实有基于差分的非常容易的解法，见解法二。随机分划长度的类似 hash 的解法三也非常震撼。</p>


</section>
</section>

 ]]></description>
  <category>游记</category>
  <category>OI</category>
  <category>回忆</category>
  <guid>https://blog.sun123zxy.top/posts/20230530-xiangtan/</guid>
  <pubDate>Mon, 29 May 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Hilbert 曲线与集合势理论</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230519-hilbert/</link>
  <description><![CDATA[ 




<section id="空间填充曲线" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="空间填充曲线"><span class="header-section-number">1</span> 空间填充曲线</h2>
<section id="曲线" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="曲线"><span class="header-section-number">1.1</span> 曲线</h3>
<p>（我们所讨论的）曲线：定义域为 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> 的连续映射．</p>
</section>
<section id="空间填充曲线-1" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="空间填充曲线-1"><span class="header-section-number">1.2</span> 空间填充曲线</h3>
<p>（我们所讨论的）空间填充曲线的定义：连续满射 <img src="https://latex.codecogs.com/png.latex?f:%20%5B0,1%5D%20%5Cto%20%5B0,1%5D%5E2">．</p>
</section>
</section>
<section id="hilbert-曲线" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="hilbert-曲线"><span class="header-section-number">2</span> Hilbert 曲线</h2>
<section id="n-阶伪-hilbert-曲线-h_nt" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="n-阶伪-hilbert-曲线-h_nt"><span class="header-section-number">2.1</span> <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线 <img src="https://latex.codecogs.com/png.latex?H_n(t)"></h3>
<p>理解一：将 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%5E2"> 等分成 <img src="https://latex.codecogs.com/png.latex?2%5En%20%5Ctimes%202%5En"> 个小方块，按特定顺序将每个小方块的中心点用直线连接起来．这顺序是递归构造的．</p>
<p>理解二：构造 <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线时，将所研究的方块区域四等分．左下角填入左上-右下翻转的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶伪 Hilbert 曲线；左上、右上角填入未翻转的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶伪 Hilbert 曲线；右下角填入左下-右上翻转的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶伪 Hilbert 曲线．最后用三条直线连接各小方块内曲线的起止点．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-fakehil-len" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线的长度 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blen%7DH_n%20=%202%5En%20-%202%5E%7B-n%7D">．</p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em> (递推). </span>由伪 Hilbert 曲线的递归定义得 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7Blen%7DH_n%20=%202%20%5Coperatorname%7Blen%7DH_%7Bn-1%7D%20+%20%5Cfrac%203%20%7B2%5En%7D%0A"> 边界为 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blen%7DH_0%20=%200">．求解该递推式即可．</p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em> (直观). </span>注意到 <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线将区间分为 <img src="https://latex.codecogs.com/png.latex?2%5En%20%5Ctimes%202%5En%20=%204%5En"> 个小方块，除首尾方块，其余小方块内的曲线长度均为小方块边长 <img src="https://latex.codecogs.com/png.latex?2%5En">．因此 <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7Blen%7DH_n%20=%204%5E%7B-n%7D%20%5Ccdot%202%5E%7B-n%7D%20-%202%20%5Ccdot%20%5Cfrac%20%7B2%5E%7B-n%7D%7D%7B2%7D%20=%202%5En%20-%202%5E%7B-n%7D%0A"></p>
</div>
<p>式中 “<img src="https://latex.codecogs.com/png.latex?-%202%5E%7B-n%7D">” 部分并不讨人喜爱．我们考虑水平或垂直地延长首尾方块曲线至任意边界，这样曲线长度 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blen%7DH_n%20=%202%5En"> 就恒成立了．我们在后文的讨论中使用这一改进．</p>
</section>
<section id="hilbert-曲线-ht" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="hilbert-曲线-ht"><span class="header-section-number">2.2</span> Hilbert 曲线 <img src="https://latex.codecogs.com/png.latex?H(t)"></h3>
<p>真正的 Hilbert 曲线是由 <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线取逐点极限得到的．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AH(t)%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20H_n(t)%0A"></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-converge" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (良定义性)</strong></span> 伪 Hilbert 曲线一致收敛（因此也是逐点收敛的）．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>对一给定的 <img src="https://latex.codecogs.com/png.latex?t%20%5Cin%20%5B0,1%5D">，设其落在区间 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5B%20k%204%5E%7B-n_0%7D,%20(k+1)%204%5E%7B-n_0%7D%20%5Cright%5D">，则对任意 <img src="https://latex.codecogs.com/png.latex?n%20%5Cgeq%20n_0">，<img src="https://latex.codecogs.com/png.latex?H_n(t)"> 均落在 <img src="https://latex.codecogs.com/png.latex?H_%7Bn_0%7D(t)"> 所确定的边长为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B-n%7D"> 的小闭方块内，即 <img src="https://latex.codecogs.com/png.latex?%5C%7C%20H_%7Bn%7D(t)%20-%20H_%7Bn_0%7D(t)%20%5C%7C_%5Cinfty%20%5Cleq%202%5E%7B-n%7D">．由 Cauchy 收敛原理即得其一致收敛性．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-surjective" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (满射性)</strong></span> Hilbert 曲线是 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%20%5Cto%20%5B0,1%5D%5E2"> 的满射．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>对一给定的 <img src="https://latex.codecogs.com/png.latex?(x,y)%20%5Cin%20%5B0,1%5D%5E2">，将所研究的闭方块区域四等分，任取一 <img src="https://latex.codecogs.com/png.latex?(x,y)"> 所在小闭方块作为下一个研究的闭方块．如此进行下去，构造出一列框住 <img src="https://latex.codecogs.com/png.latex?(x,y)"> 的收缩的闭方块套．闭方块套里的每一个半径为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B-n%7D"> 的闭方块都对应着 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> 上长 <img src="https://latex.codecogs.com/png.latex?4%5E%7B-n%7D"> 的一个闭区间，这些区间同样构成了 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> 上的一个闭区间套．由闭区间套原理，这列闭区间套确定了一个实数 <img src="https://latex.codecogs.com/png.latex?t%20%5Cin%20%5B0,1%5D">，它就是使得 <img src="https://latex.codecogs.com/png.latex?f(t)%20=%20(x,y)"> 的一个解．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>需要注意的是，当 <img src="https://latex.codecogs.com/png.latex?(x,y)"> 落在某两个闭方块的公共边界上时，证明中我们任取其中一个闭方块继续讨论．因此，选择不同闭方块将可能使我们得到不同的 <img src="https://latex.codecogs.com/png.latex?t"> 值，这是 Hilbert 曲线不是单射的原因之一．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-surjective" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (连续性)</strong></span> Hilbert 曲线在其定义域内连续．</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>对一给定的 <img src="https://latex.codecogs.com/png.latex?t%20%5Cin%20%5B0,1%5D">，考虑 <img src="https://latex.codecogs.com/png.latex?H(t)"> 任意取定的 <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon"> 邻域 <img src="https://latex.codecogs.com/png.latex?U_%7B%5Cvarepsilon%7D(H(t))%20=%20%5C%7B%20(x,y)%20:%20%5C%7C%20H(t)%20-%20(x,y)%20%5C%7C_%7B%5Cinfty%7D%20%3C%20%5Cvarepsilon%20%5C%7D">，取 <img src="https://latex.codecogs.com/png.latex?n_0%20=%20%5Clog_2%20%5Cvarepsilon%20-%202">，即可使第 <img src="https://latex.codecogs.com/png.latex?n_0"> 阶伪 Hillbert 曲线划分出的各闭方块边长为<img src="https://latex.codecogs.com/png.latex?2%5E%7B-n_0%7D%20%3C%20%5Cfrac%20%5Cvarepsilon%202">．设此时 <img src="https://latex.codecogs.com/png.latex?t"> 落在闭区间 <img src="https://latex.codecogs.com/png.latex?I%20=%20%5Cleft%5B%20k%204%5E%7B-n_0%7D,%20(k+1)%204%5E%7B-n_0%7D%20%5Cright%5D">（如在边界，则任取），其对应闭方块 <img src="https://latex.codecogs.com/png.latex?J%20=%20H(I)">．由于 <img src="https://latex.codecogs.com/png.latex?I"> 已经是 <img src="https://latex.codecogs.com/png.latex?t"> 的一个（单侧）邻域，为证明 <img src="https://latex.codecogs.com/png.latex?H(t)"> 在点 <img src="https://latex.codecogs.com/png.latex?t"> 的连续性，下面只需证 <img src="https://latex.codecogs.com/png.latex?J%20%5Csubset%20U_%5Cvarepsilon(H(t))">．由于我们构造的 <img src="https://latex.codecogs.com/png.latex?n_0"> 使闭方块 <img src="https://latex.codecogs.com/png.latex?J"> 的边长为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B-n_0%7D%20%3C%20%5Cfrac%20%5Cvarepsilon%202">，<img src="https://latex.codecogs.com/png.latex?H(t)"> 与这闭方块中任意点 <img src="https://latex.codecogs.com/png.latex?(x,y)"> 的距离 <img src="https://latex.codecogs.com/png.latex?%0A%5C%7C%20H(t)%20-%20(x,y)%20%5C%7C_%7B%5Cinfty%7D%20%5Cleq%20%5Cfrac%20%5Cvarepsilon%202%20%3C%20%5Cvarepsilon%0A"> 故 <img src="https://latex.codecogs.com/png.latex?J%20%5Csubset%20U_%5Cvarepsilon(H(t))">．</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-hil-len" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Hilbert 曲线是不可求长的．</p>
</div>
</div>
</div>
</div>
<p>对一般的曲线而言，逐点收敛于曲线 <img src="https://latex.codecogs.com/png.latex?f"> 的曲线族 <img src="https://latex.codecogs.com/png.latex?f_n"> 的长度的极限 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Coperatorname%7Blen%7Df_n"> 与 <img src="https://latex.codecogs.com/png.latex?f"> 的长度 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blen%7Df"> 并不一定相同．这一事实有一简单有力的实例验证：用锯齿状曲线逼近圆．</p>
<p>因此，直接取 Exercise&nbsp;1 的极限并不可行．根据曲线长度的定义，只有构造出一族直接由 <img src="https://latex.codecogs.com/png.latex?H(t)"> 上点构成的近似曲线，我们才能从这族曲线长度的极限中得到 Hilbert 曲线的正确长度．</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>考虑划分 <img src="https://latex.codecogs.com/png.latex?P_%7Bn%7D%20:%20t_k%20=%20k%204%5E%7B-%7Bn%7D%7D%20%5Cpod%7Bk%20=%200,%201,%20%5Cdots,%204%5E%7Bn%7D%7D">，将 <img src="https://latex.codecogs.com/png.latex?H(t_k)"> 依次用折线连接，就得到了《Space-filling curves》2.6 节<span class="citation" data-cites="sagan">[1]</span>讨论的 Hilbert 曲线的 <img src="https://latex.codecogs.com/png.latex?n"> 阶近似多边形曲线 <img src="https://latex.codecogs.com/png.latex?P_n(t)">（Approximating polygon for the Hilbert curve）．我们指出，与 <img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线相同，<img src="https://latex.codecogs.com/png.latex?n"> 阶 Hilbert 近似多边形曲线仍然可以类似的由递归方法得到，遍历 <img src="https://latex.codecogs.com/png.latex?2%5En%20%5Ctimes%202%5En"> 个小方块，且平均每个小方块内的曲线长度为 <img src="https://latex.codecogs.com/png.latex?2%5E%7B-n%7D">．因此，<img src="https://latex.codecogs.com/png.latex?n"> 阶 Hilbert 近似多边形曲线的长度 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Blen%7DP_n(t)%20=%20(2%5En%20%5Ctimes%202%5En)%20%5Ccdot%202%5E%7B-n%7D%20=%202%5En">．由于该数列没有上界，故我们说明了 Hilbert 曲线的不可求长性．</p>
</div>
</section>
<section id="全平面填充" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="全平面填充"><span class="header-section-number">2.3</span> 全平面填充</h3>
<p>环绕填充并连接相邻曲线即可．</p>
</section>
<section id="四进制小数表示" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="四进制小数表示"><span class="header-section-number">2.4</span> 四进制小数表示</h3>
<p><img src="https://latex.codecogs.com/png.latex?n"> 阶伪 Hilbert 曲线对 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> 区间的划分操作可被一一对应地记为 <img src="https://latex.codecogs.com/png.latex?n"> 位四进制小数，从而为 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> 上被划分出的区间和对应的 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%5E2"> 上的方块赋予了一种简洁的表示方法．但由于递归构造时左下、右下角涉及翻转操作，为每个实数 <img src="https://latex.codecogs.com/png.latex?t">（无限位规范四进制小数）写出其平面对应点 <img src="https://latex.codecogs.com/png.latex?H(t)"> 的非递归封闭形式表达稍显复杂．《Space-filling curves》<span class="citation" data-cites="sagan">[1]</span>的 2.3 节给出了基于复数和四进制小数的精确表示．</p>
</section>
<section id="小结" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="小结"><span class="header-section-number">2.5</span> 小结</h3>
<ul>
<li>Hilbert 曲线确实遍历了 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%5E2"> 区域的所有点.</li>
<li>Hilbert 曲线是满射, 但不是单射，所以不是从线段到正方形区域的双射．</li>
<li><img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%5E2%20%5Cto%20%5B0,1%5D"> 的单射（甚至双射）？集合势理论．</li>
<li>（补充）空间填充曲线必自交，即不能是单射．（Pf：否则与 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%5E2"> 同胚，这显然荒谬．）（证明同胚逆映射连续需用拓扑定理：any continuous bijection from a compact space onto a Hausdorff space is a homeomorphism）</li>
<li>（补充）不自交但有面积的曲线：Osgood 曲线．但它不是空间填充曲线．</li>
</ul>
</section>
</section>
<section id="集合势理论" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="集合势理论"><span class="header-section-number">3</span> 集合势理论</h2>
<section id="集合的势" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="集合的势"><span class="header-section-number">3.1</span> 集合的势</h3>
<ul>
<li><p>等势，劣势于，优势于．</p></li>
<li><p>“劣势于”是集合上的序关系：自反性、反对称性（Bernstein 定理）、传递性．</p>
<p>事实上更是全序关系，证明需用到选择公理．</p></li>
</ul>
</section>
<section id="有限集可列集与无限集" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="有限集可列集与无限集"><span class="header-section-number">3.2</span> 有限集、可列集与无限集</h3>
<ul>
<li><p>有限集，可列集，无限集．</p></li>
<li><p>无限集的充要条件：与某一真子集等势（Dedekind 定义）．</p>
<p>充分性：归纳取出可列集，该部分映射到后继形成双射．</p>
<p>必要性：即有限集不与任何其真子集等势．冗长，证明略．</p></li>
<li><p>无限集并有限或可列集仍与原无限集等势．</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20N%5E2%20%5Capprox%20%5Cmathbb%20N%0A"></p>
<p>本质：可列个可列集的并还是可列集；可列集的有限次笛卡尔积仍是可列集．</p>
</section>
<section id="从可列到不可列" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="从可列到不可列"><span class="header-section-number">3.3</span> 从可列到不可列</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20R%20%5Cnot%20%5Capprox%20%5Cmathbb%20N%0A"></p>
<p>写成小数，对角线法．</p>
<p>规范小数（规定其均为无限小数），规范二进制小数．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A2%5E%7B%5Cmathbb%20N%7D%20%5Capprox%20%5Cmathbb%20R%0A"></p>
<p>核心在于不规范小数是可列集．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Cmathbb%20R%7D%5E2%20%5Capprox%20%5Cmathbb%20R%0A"></p>
<p>小数穿插构造法．需要注意的是，构造的 <img src="https://latex.codecogs.com/png.latex?(0,1)%5E2%20%5Cto%20(0,1)"> 的单射不是满射 <img src="https://latex.codecogs.com/png.latex?%0Ac%20=%200.303030%5Cdots%20%5Cimplies%20a%20=%200.333%5Cdots,%20b=%200.000%5Cdots%0A"> 此外，它也不是连续映射 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Aa=0.3333%5Cdots,%20b=0.4999%5Cdots%20&amp;%5Cimplies%20c=0.343939%5Cdots%20%5C%5C%0Aa=0.3333%5Cdots,%20b=0.5000%5Cdots%20&amp;%5Cimplies%20c=0.353030%5Cdots%0A%5Cend%7Baligned%7D%0A"> 其对应的 <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D%20%5Cto%20%5B0,1%5D%5E2"> 的非单的满射（如构造出的小数不规范，则将其规范化）亦不连续． <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ac%20=%200.4999%5Cdots%20&amp;%5Cimplies%20a%20=%200.4999%5Cdots,%20b=0.9999%0A%5Cdots%20%5C%5C%0Ac%20=%200.5000%5Cdots%20&amp;%5Cimplies%20a%20=%200.5000%5Cdots,%20b=0.0000%5Cdots%0A%5Cend%7Baligned%7D%0A"></p>
<p>Fun fact: <img src="https://latex.codecogs.com/png.latex?%7B%5Cmathbb%20R%7D%5E2%20%5Capprox%20%5Cleft(2%5E%7B%5Cmathbb%20N%7D%5Cright)%5E%7B2%7D%20%5Capprox%202%5E%7B%5Cleft(%7B%5Cmathbb%20N%20%5Ctimes%202%7D%20%5Cright)%7D%20%5Capprox%202%5E%7B%5Cmathbb%20N%7D%20%5Capprox%20%5Cmathbb%20R">（基数理论）</p>
</section>
<section id="小结-1" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="小结-1"><span class="header-section-number">3.4</span> 小结</h3>
<ul>
<li>Hilbert 曲线：<img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R%20%5Cto%20%7B%5Cmathbb%20R%7D%5E2"> 的连续满射．</li>
<li>集合势理论：<img src="https://latex.codecogs.com/png.latex?%7B%5Cmathbb%20R%7D%5E2%20%5Cto%20%7B%5Cmathbb%20R%7D"> 的不连续单（双）射．</li>
</ul>
</section>
</section>



<div id="quarto-appendix" class="default"><section id="comments" class="level2 appendix unnumbered"><h2 class="anchored quarto-appendix-heading">Comments</h2><div class="quarto-appendix-contents">

<ul>
<li><p>希尔伯特曲线及性质的形式化理解 - zzdyyy<span class="citation" data-cites="zzdyyy">[2]</span></p>
<p>本文脉络的主要参考．</p></li>
<li><p>Why does the Hilbert curve fill the whole square? - Math StackExchange<span class="citation" data-cites="mathex_fill">[3]</span></p>
<p>提供了收敛性的较严谨证明．</p></li>
<li><p>希尔伯特曲线：无限数学怎样应用于有限世界 - 3Blue1Brown<span class="citation" data-cites="3b1b">[4]</span></p>
<p>优秀的可视化．</p></li>
<li><p>Space-filling curve - Wikipedia<span class="citation" data-cites="wikipedia_spacefilling">[5]</span></p></li>
<li><p>《集合论基础教程》张峰、陶然<span class="citation" data-cites="zhangfeng">[6]</span></p></li>
</ul>
<p>扩展阅读：</p>
<ul>
<li><p>《Space-filling curves》Hans Sagan<span class="citation" data-cites="sagan">[1]</span></p>
<p>回顾了空间填充曲线发展历史；用形式化的语言刻画了 Hilbert 曲线，见文内引用．</p></li>
</ul>
</div></section><section id="acknowledgements" class="level2 appendix unnumbered"><h2 class="anchored quarto-appendix-heading">Acknowledgements</h2><div class="quarto-appendix-contents">

<p>感谢吕老师组织研讨课．本次研讨课与宁同学一同准备并主要由后者主讲，在讨论和展示过程中收获颇丰．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-sagan" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">H. Sagan, <em>Space-filling curves</em>. Springer Science &amp; Business Media, 1994.</div>
</div>
<div id="ref-zzdyyy" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">zzdyyy, <span>“希尔伯特曲线及性质的形式化理解.”</span> <a href="https://www.cnblogs.com/zzdyyy/p/7636474.html" class="uri">https://www.cnblogs.com/zzdyyy/p/7636474.html</a>, 2017.</div>
</div>
<div id="ref-mathex_fill" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">M. A. (https://math.stackexchange.com/users/22857/martin-argerami), <span>“Why does the hilbert curve fill the whole square?”</span> Mathematics Stack Exchange. Available: <a href="https://math.stackexchange.com/q/142029">https://math.stackexchange.com/q/142029</a></div>
</div>
<div id="ref-3b1b" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">3Blue1Brown, <span>“希尔伯特曲线：无限数学怎样应用于有限世界.”</span> <a href="https://www.bilibili.com/video/av4201747" class="uri">https://www.bilibili.com/video/av4201747</a>, 2016.</div>
</div>
<div id="ref-wikipedia_spacefilling" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">Wikipedia, <span>“Space-filling curve - wikipedia.”</span> <a href="https://en.wikipedia.org/wiki/Space-filling_curve" class="uri">https://en.wikipedia.org/wiki/Space-filling_curve</a>.</div>
</div>
<div id="ref-zhangfeng" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">张峰 and 陶然, <em>集合论基础教程</em>. 北京: 清华大学出版社, 2021.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <category>讲稿</category>
  <guid>https://blog.sun123zxy.top/posts/20230519-hilbert/</guid>
  <pubDate>Wed, 17 May 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Wallis 公式、Stirling 公式与正态分布</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230423-stirling/</link>
  <description><![CDATA[ 




<p>参考：</p>
<ul>
<li>张筑生《数学分析新讲》第二册<span class="citation" data-cites="analysis">[1]</span></li>
<li>张颢《概率论》<span class="citation" data-cites="prob">[2]</span></li>
<li>Wikipedia, Math StackExchange, etc.</li>
</ul>
<section id="warm-up" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="warm-up"><span class="header-section-number">1</span> Warm up</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-double-factorial" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(2n-1)!!%7D%7B(2n)!!%7D%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B1%20%5Ctimes%203%20%5Ctimes%205%20%5Ctimes%20%5Cdots%20%5Ctimes%20(2n-1)%7D%7B2%20%5Ctimes%204%20%5Ctimes%206%20%5Ctimes%20%5Cdots%20%5Ctimes%202n%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>用放缩 <img src="https://latex.codecogs.com/png.latex?%0A2k%20%3E%20%5Csqrt%7B(2k-1)(2k+1)%7D%0A"> 拆分母即得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B(2n-1)!!%7D%7B(2n)!!%7D%20%3C%20%5Cfrac%201%20%7B%5Csqrt%7B2n+1%7D%7D%20%5Csim%200%0A"></p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-binomial" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (中心二项式系数)</strong></span> 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B%5Cbinom%7B2n%7D%7Bn%7D%7D%7B2%5E%7B2n%7D%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cbinom%7B2n%7D%7Bn%7D%7D%7B2%5E%7B2n%7D%7D%20=%20%5Cfrac%7B(2n)!%7D%7B2%5E%7B2n%7D%20(n!)%5E2%7D%20=%20%5Cfrac%7B(2n)!%7D%7B(2%5En%20n!)%5E2%7D%20=%20%5Cfrac%7B(2n)!%7D%7B((2n)!!)%5E2%7D%20=%20%5Cfrac%7B(2n-1)!!%7D%7B(2n)!!%7D%20%3C%20%5Cfrac%201%20%7B%5Csqrt%7B2n+1%7D%7D%20%5Csim%200%0A"></p>
</div>
<p>上两例有没有更精确的渐进估计？这便是我们马上要研究的问题．</p>
</section>
<section id="wallis-公式" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="wallis-公式"><span class="header-section-number">2</span> Wallis 公式</h2>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="lem-wallis-integral" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1 (Wallis 积分公式)</strong></span> 定积分系列 <img src="https://latex.codecogs.com/png.latex?%0AJ_n%20=%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%5En%20x%20%5Coperatorname%7Bd%7D%5C!x%0A"> 满足 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AJ_%7B2n%7D%20&amp;=%20%5Cfrac%7B(2n-1)!!%7D%7B(2n)!!%7D%20%5Ccdot%20%5Cfrac%20%5Cpi%202%20%5C%5C%0AJ_%7B2n+1%7D%20&amp;=%20%5Cfrac%7B(2n)!!%7D%7B(2n+1)!!%7D%20%5Ccdot%201%0A%5Cend%7Baligned%7D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>我们的思路是：先把一个 <img src="https://latex.codecogs.com/png.latex?%5Csin%20x"> 放进微分中，然后分部积分得到递推式．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AJ_n%20&amp;=%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%5En%20x%20%5Coperatorname%7Bd%7D%5C!x%20%5C%5C%0A&amp;=%20-%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%5E%7Bn-1%7D%20x%20%5Coperatorname%7Bd%7D%5C!%5Ccos%20x%20%5C%5C%0A&amp;=%20%5Cleft%5B%20-%20%5Csin%5E%7Bn-1%7D%20x%20%5Ccos%20x%20%5Cright%5D_%7B0%7D%5E%7B%5Cfrac%20%5Cpi%202%7D%20+%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Ccos%20x%20%5Coperatorname%7Bd%7D%5C!%5Csin%5E%7Bn-1%7D%20x%20%5C%5C%0A&amp;=%20(n-1)%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Ccos%5E2%20x%20%5Csin%5E%7Bn-2%7D%20x%20%5Coperatorname%7Bd%7D%5C!x%20%5C%5C%0A&amp;=%20(n-1)%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20(1%20-%20%5Csin%5E2%20x)%20%5Csin%5E%7Bn-2%7D%20x%20%5Coperatorname%7Bd%7D%5C!x%20%5C%5C%0A&amp;=%20(n-1)%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%5E%7Bn-2%7D%20x%20%5Coperatorname%7Bd%7D%5C!x%20-%20(n-1)%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%5En%20x%20%5Coperatorname%7Bd%7D%5C!x%20%5C%5C%0A&amp;=%20(n-1)%20J_%7Bn-2%7D%20-%20(n-1)%20J_n%0A%5Cend%7Baligned%7D%0A"></p>
<p>故 <img src="https://latex.codecogs.com/png.latex?%0AJ_n%20=%20%5Cfrac%7Bn-1%7D%7Bn%7D%20J_%7Bn-2%7D%0A"> 边界条件 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AJ_0%20&amp;=%20%5Cfrac%20%5Cpi%202%20%5C%5C%0AJ_1%20&amp;=%20%5Cint_0%5E%7B%5Cfrac%20%5Cpi%202%7D%20%5Csin%20x%20%5Coperatorname%7Bd%7D%5C!x%20=%201%0A%5Cend%7Baligned%7D%0A"> 代入递推式求解就得到了要证的结论．</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-wallis" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Wallis 公式)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%20%5Cpi%202%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%201%20%7B2n+1%7D%20%5Cleft(%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>注意到在积分区间上，<img src="https://latex.codecogs.com/png.latex?%5Csin%5En%20x%20%5Cgeq%20%5Csin%5E%7Bn+1%7D%20x">，由积分的单调性，<img src="https://latex.codecogs.com/png.latex?J_n"> 随 <img src="https://latex.codecogs.com/png.latex?n"> 单调递减，故 <img src="https://latex.codecogs.com/png.latex?J_%7B2n+1%7D%20%5Cleq%20J_%7B2n%7D%20%5Cleq%20J_%7B2n-1%7D"> 成立．代入 Lemma&nbsp;1 中得到的结果 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B(2n)!!%7D%7B(2n+1)!!%7D%20%5Cleq%20%5Cfrac%7B(2n-1)!!%7D%7B(2n)!!%7D%20%5Ccdot%20%5Cfrac%20%5Cpi%202%20%5Cleq%20%5Cfrac%7B(2n-2)!!%7D%7B(2n-1)!!%7D%0A"> 移项得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%20%5Cfrac%7B1%7D%7B2n+1%7D%20%5Cleq%20%5Cfrac%20%5Cpi%202%20%5Cleq%20%5Cleft(%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%20%5Cfrac%201%20%7B2n%7D%0A"></p>
<p>现在只需说明 RHS 与 LHS 的差是一个无穷小． <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cleft(%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%20%5Cleft(%20%5Cfrac%201%20%7B2n%7D%20-%20%5Cfrac%201%20%7B2n+1%7D%20%20%5Cright)%0A&amp;=%20%5Cleft(%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%20%5Cleft(%20%5Cfrac%201%20%7B2n(2n+1)%7D%20%5Cright)%20%5C%5C%0A&amp;=%20%5Cleft(%20%5Cfrac%7B(2n-2)!!%7D%7B(2n-1)!!%7D%20%5Cright)%5E2%20%5Cfrac%20%7B2n%7D%7B(2n+1)%7D%0A%5Cend%7Baligned%7D%0A"> 由 Example&nbsp;1 ，<img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(2n-2)!!%7D%7B(2n-1)!!%7D%20=%200">，故上式确为一个无穷小，定理得证．</p>
</div>
<p>Wallis 公式还有其它表现形式： <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B2%5E%7B2n%7D%7D%7B%5Cbinom%7B2n%7D%7Bn%7D%7D%20=%20%5Cfrac%7B(2n)!!%7D%7B(2n-1)!!%7D%20%5Csim%20%5Csqrt%7B%5Cpi%20n%7D%20%5Cpod%7Bn%20%5Cto%20%5Cinfty%7D%0A"> 这里 Wallis 公式反映为对 Example&nbsp;1 和 Example&nbsp;2 的渐进估计．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-catalan" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> 对 Catalan 数 <img src="https://latex.codecogs.com/png.latex?%0AC_n%20=%20%5Cbinom%7B2n%7D%7Bn%7D%20-%20%5Cbinom%7B2n%7D%7Bn+1%7D%0A"> 做出渐进估计．</p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>注意到 <img src="https://latex.codecogs.com/png.latex?%0AC_n%20=%20%5Cbinom%7B2n%7D%7Bn%7D%20-%20%5Cbinom%7B2n%7D%7Bn+1%7D%20=%20%5Cbinom%7B2n%7D%7Bn%7D%20-%20%5Cfrac%20n%20%7Bn+1%7D%20%5Cbinom%7B2n%7D%7Bn%7D%20=%20%5Cfrac%201%20%7Bn+1%7D%20%5Cbinom%7B2n%7D%7Bn%7D%0A"> 用 Wallis 公式计算即得 <img src="https://latex.codecogs.com/png.latex?%0AC_n%20%5Csim%20%5Cfrac%20%7B2%5E%7B2n%7D%7D%7B%5Csqrt%7B%5Cpi%7D%20n%5E%7B%5Cfrac%203%202%7D%7D%0A"></p>
</div>
<p>Wallis 公式的另一种表现形式是 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%20%5Cpi%202%20=%20%5Cprod_%7Bn=1%7D%5E%5Cinfty%20%5Cfrac%7B4%20n%5E2%7D%7B4%20n%5E2-1%7D%20=%20%5Cprod_%7Bn=1%7D%5E%5Cinfty%20%5Cleft(%20%5Cfrac%7B2n%7D%7B2n-1%7D%20%5Ccdot%20%5Cfrac%7B2n%7D%7B2n+1%7D%20%5Cright)%0A"> 这表达式也被称为 Wallis product，用于近似计算 <img src="https://latex.codecogs.com/png.latex?%5Cpi">．</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>这和我们在 Example&nbsp;1 中使用的放缩技巧……</p>
</div>
</section>
<section id="stirling-公式" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="stirling-公式"><span class="header-section-number">3</span> Stirling 公式</h2>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="lem-e" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 2</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%201+%5Cfrac%201%20n%20%5Cright)%5En%20%3C%20e%20%3C%20%5Cleft(%201%20+%20%5Cfrac%201%20n%20%5Cright)%5E%7Bn+1%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>这是《数学分析 I》中大家所熟知的．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-stirling-weak" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%5Cfrac%20n%20e%20%5Cright)%5En%20%3C%20%5Cfrac%20%7Bn!%7D%20e%0A%3C%20n%20%5Cleft(%20%5Cfrac%20n%20e%20%5Cright)%5En%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>将 Lemma&nbsp;2 写成 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B(n+1)%5En%7D%7Bn%5En%7D%20%3C%20e%20%3C%20%5Cfrac%7B(n+1)%5E%7Bn+1%7D%7D%7Bn%5E%7Bn+1%7D%7D%0A"> 对 <img src="https://latex.codecogs.com/png.latex?k%20=%201,2,%20%5Cdots,%20n-1"> 做连乘 <img src="https://latex.codecogs.com/png.latex?%0A%5Cprod_%7Bk=1%7D%5E%7Bn-1%7D%20%5Cfrac%7B(k+1)%5Ek%7D%7Bk%5Ek%7D%20%3C%20e%5E%7Bn-1%7D%20%3C%20%5Cprod_%7Bk=1%7D%5E%7Bn-1%7D%20%5Cfrac%7B(k+1)%5E%7Bk+1%7D%7D%7Bk%5E%7Bk+1%7D%7D%0A"> 注意到乘积的相邻两项中，前一项的分子与后一项的分母可以约分，中间每项只余下 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20k">，故上式可化为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bn%5E%7Bn-1%7D%7D%7B(n-1)!%7D%20%3C%20e%5E%7Bn-1%7D%20%3C%20%5Cfrac%7Bn%5En%7D%7B(n-1)!%7D%0A"> 两端再同乘 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bn!%7D%7Be%5E%7Bn%7D%7D"> 就得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%5Cfrac%20n%20e%20%5Cright)%5En%20%3C%20%5Cfrac%20%7Bn!%7D%20e%0A%3C%20n%20%5Cleft(%20%5Cfrac%20n%20e%20%5Cright)%5En%0A"></p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-stirling" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Stirling 公式)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0An!%20%5Csim%20%5Csqrt%7B2%20%5Cpi%20n%7D%20%5Cleft(%20%5Cfrac%20n%20e%20%5Cright)%5En%20%5Cpod%7Bn%20%5Cto%20%5Cinfty%7D%0A"></p>
</div>
</div>
</div>
</div>
<p>完整证明较复杂，这里介绍证明最后一步：已知 <img src="https://latex.codecogs.com/png.latex?n!%20%5Csim%20a%20%5Csqrt%20n%20%5Cleft(%20%5Cfrac%20n%20e%20%5Cright)%5En">，用 Wallis 公式对 <img src="https://latex.codecogs.com/png.latex?2%5E%7B2n%7D%20/%20%5Cbinom%7B2n%7D%7Bn%7D"> 的渐进估计确定系数 <img src="https://latex.codecogs.com/png.latex?a">．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csqrt%7B%5Cpi%20n%7D%20%5Csim%20%5Cfrac%20%7B2%5E%7B2n%7D%7D%7B%5Cbinom%7B2n%7D%7Bn%7D%7D%20=%20%5Cfrac%7B2%5E%7B2n%7D%20(n!)%5E2%7D%7B(2n)!%7D%20%5Csim%20%5Cfrac%7B2%5E%7B2n%7D%20(a%20%5Csqrt%20n%20n%5En%20e%5E%7B-n%7D)%5E2%7D%7Ba%20%5Csqrt%7B2n%7D%202%5E%7B2n%7D%20n%5E%7B2n%7D%20e%5E%7B-2n%7D%7D%20=%20%5Csqrt%7B%5Cfrac%20n%202%7D%20a%0A"></p>
<p>因此 <img src="https://latex.codecogs.com/png.latex?a=%5Csqrt%7B2%20%5Cpi%7D">．</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-stirling-binomial" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> 当 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty">，<img src="https://latex.codecogs.com/png.latex?k%20%5Cto%20%5Cinfty"> 时，用 Stirling 公式渐进估计 <img src="https://latex.codecogs.com/png.latex?%5Cbinom%20n%20k">．</p>
</div>
</div>
</div>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span><img src="https://latex.codecogs.com/png.latex?%0A%5Cbinom%20n%20k%20%5Csim%20%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D%20%5Cfrac%7Bn%5En%7D%7Bk%5Ek%20(n-k)%5E%7Bn-k%7D%7D%0A"></p>
</div>
</section>
<section id="poisson-分布" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="poisson-分布"><span class="header-section-number">4</span> Poisson 分布</h2>
<p>描述单位时间平均发生次数恒定的随机事件的概率分布．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-poission" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Poisson 分布)</strong></span> 若离散随机变量 <img src="https://latex.codecogs.com/png.latex?X"> 满足 <img src="https://latex.codecogs.com/png.latex?%0AP(X%20=%20k)%20=%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bk!%7De%5E%7B-%5Clambda%7D%0A"> 其中 <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%3E%200"> 是确定的常数，则随机变量 <img src="https://latex.codecogs.com/png.latex?X"> 服从 Poisson 分布．</p>
</div>
</div>
</div>
</div>
<section id="从二项分布的推导" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="从二项分布的推导"><span class="header-section-number">4.1</span> 从二项分布的推导</h3>
<p>在 <img src="https://latex.codecogs.com/png.latex?np%20=%20%5Clambda"> 的条件下，取 <img src="https://latex.codecogs.com/png.latex?P(X_n%20=%20k)%20=%20%5Cbinom%20n%20k%20p%5Ek%20(1-p)%5E%7Bn-k%7D"> 在 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty"> 在 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty"> 上的逐点极限．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AP(X_n%20=%20k)%0A&amp;=%20%5Cbinom%7Bn%7D%7Bk%7D%20p%5Ek%20(1-p)%5E%7Bn-k%7D%20%5C%5C%0A&amp;=%20%5Cbinom%7Bn%7D%7Bk%7D%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bn%5Ek%7D%20%5Cleft(%201-%5Cfrac%20%5Clambda%20n%20%5Cright)%5E%7Bn-k%7D%20%5C%5C%0A&amp;=%20%5Clambda%5Ek%20%5Cleft(%201-%5Cfrac%20%5Clambda%20n%20%5Cright)%5En%20%5Cleft(%201-%5Cfrac%20%5Clambda%20n%20%5Cright)%5E%7B-k%7D%20%5Cbinom%7Bn%7D%7Bk%7D%20%5Cfrac%7B1%7D%7Bn%5Ek%7D%20%5C%5C%0A&amp;%5Csim%20%5Clambda%5Ek%20e%5E%7B-%5Clambda%7D%5Cbinom%7Bn%7D%7Bk%7D%20%5Cfrac%201%20%7Bn%5Ek%7D%20%5C%5C%0A&amp;=%20%5Clambda%5Ek%20e%5E%7B-%5Clambda%7D%20%5Cfrac%20%7Bn%20(n-1)%20%5Cdots%20(n-k+1)%7D%7Bk!%20n%5Ek%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bk!%7D%20e%5E%7B-%5Clambda%7D%20%5Ccdot%201%20%5Ccdot%20(1-%5Cfrac%201%20n)%20%5Cdots%20(1%20-%20%5Cfrac%7Bk-1%7D%7Bn%7D)%20%5C%5C%0A&amp;%5Csim%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bk!%7D%20e%5E%7B-%5Clambda%7D%0A%5Cend%7Baligned%7D%0A"></p>
</section>
<section id="归一性验证" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="归一性验证"><span class="header-section-number">4.2</span> 归一性验证</h3>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20P(X%20=%20k)%20=%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bk!%7De%5E%7B-%5Clambda%7D%20=%20%20e%5E%7B-%5Clambda%7D%20%5Csum_%7Bk=0%7D%5E%7B+%5Cinfty%7D%20%5Cfrac%7B%5Clambda%5Ek%7D%7Bk!%7D%20=%20e%5E%7B-%5Clambda%7D%20e%5E%7B%5Clambda%7D%20=%201%0A"></p>
</section>
</section>
<section id="正态分布" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="正态分布"><span class="header-section-number">5</span> 正态分布</h2>
<p>与 Poisson 分布不同，（标准）正态分布是在 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty"> 的过程中假定 <img src="https://latex.codecogs.com/png.latex?p"> 不变的情况下，对归一化（即假定期望和方差不变）后的 <img src="https://latex.codecogs.com/png.latex?X_n"> 取逐点极限得到的．</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-poission" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (正态分布)</strong></span> 若连续随机变量 <img src="https://latex.codecogs.com/png.latex?X"> 的期望 <img src="https://latex.codecogs.com/png.latex?E(X)%20=%20%5Cmu">，方差 <img src="https://latex.codecogs.com/png.latex?D(X)%20=%20%5Csigma">，且其概率分布函数为 <img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%7D%20%5Csigma%7D%20%5Cexp%20%5Cleft(-%5Cfrac%7B(x-%5Cmu)%5E2%7D%7B2%20%5Csigma%5E2%7D%5Cright)%0A"> 则变量 <img src="https://latex.codecogs.com/png.latex?X"> 服从正态分布，记为 <img src="https://latex.codecogs.com/png.latex?X%20%5Csim%20N(%5Cmu,%20%5Csigma%5E2)">．</p>
<p>特别的，当 <img src="https://latex.codecogs.com/png.latex?%5Cmu%20=%200">，<img src="https://latex.codecogs.com/png.latex?%5Csigma%20=%201"> 时，变量 <img src="https://latex.codecogs.com/png.latex?X"> 服从标准正态分布 <img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%7D%7D%20%5Cexp%20%5Cleft(-%5Cfrac%7B1%7D%7B2%7D%20x%5E2%5Cright)%0A"></p>
</div>
</div>
</div>
</div>
<section id="从二项分布的推导de-moivre-laplace-定理" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="从二项分布的推导de-moivre-laplace-定理"><span class="header-section-number">5.1</span> 从二项分布的推导（de Moivre-Laplace 定理）</h3>
<p>设随机变量 <img src="https://latex.codecogs.com/png.latex?X_n%20%5Csim%20B(n,p)">．方便起见，令 <img src="https://latex.codecogs.com/png.latex?q%20=%201-p">．众所周知，二项分布的期望与方差满足 <img src="https://latex.codecogs.com/png.latex?E(X_n)%20=%20np">，<img src="https://latex.codecogs.com/png.latex?D(X_n)%20=%20npq">．</p>
<p>对随机变量 <img src="https://latex.codecogs.com/png.latex?X_n"> 做归一化： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbar%20X_n%20=%20%5Cfrac%7BX_n%20-%20E(X_n)%7D%7B%5Csqrt%7BD(X_n)%7D%7D%20=%20%5Cfrac%7BX_n%20-%20np%7D%7B%5Csqrt%7Bnpq%7D%7D%0A"> 考虑到 <img src="https://latex.codecogs.com/png.latex?%0AP(%5Cbar%20X_n%20=%20x)%20=%20P(X_n%20=%20np%20+%20x%20%5Csqrt%7Bnpq%7D)%0A"> 令 <img src="https://latex.codecogs.com/png.latex?k%20=%20np%20+%20x%20%5Csqrt%7Bnpq%7D">，则 <img src="https://latex.codecogs.com/png.latex?%0AP(%5Cbar%20X_n%20=%20x)%20=%20P(X_n%20=%20k)%20=%20%5Cbinom%7Bn%7D%7Bk%7D%20p%5Ek%20q%5E%7Bn-k%7D%0A"> 此时 <img src="https://latex.codecogs.com/png.latex?n,k"> 均趋于无穷大，故可应用 Example&nbsp;3 对二项式系数做出估计 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cbinom%7Bn%7D%7Bk%7D%20p%5Ek%20q%5E%7Bn-k%7D%0A&amp;%5Csim%20%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D%20%5Cfrac%7Bn%5En%7D%7Bk%5Ek%20(n-k)%5E%7Bn-k%7D%7D%20p%5Ek%20q%5E%7Bn-k%7D%20%5C%5C%0A&amp;=%20%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D%20%5Cleft(%20%5Cfrac%7Bnp%7D%7Bk%7D%20%5Cright)%5E%7Bk%7D%20%5Cleft(%20%5Cfrac%7Bnq%7D%7Bn-k%7D%20%5Cright)%5E%7Bn-k%7D%20%5C%5C%0A&amp;=%20%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D%20%5Cexp%7B%5Cleft(%20k%20%5Cln%7B%5Cfrac%7Bnp%7D%7Bk%7D%7D%20+%20(n-k)%20%5Cln%7B%5Cfrac%7Bnq%7D%7Bn-k%7D%7D%20%5Cright)%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>下面分别处理 <img src="https://latex.codecogs.com/png.latex?k%20%5Cln%7B%5Cfrac%7Bnp%7D%7Bk%7D%7D"> 和 <img src="https://latex.codecogs.com/png.latex?(n-k)%20%5Cln%7B%5Cfrac%7Bnq%7D%7Bn-k%7D%7D">．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ak%20%5Cln%7B%5Cfrac%7Bnp%7D%7Bk%7D%7D%0A&amp;=%20-(np%20+%20x%20%5Csqrt%7Bnpq%7D)%20%5Cln%7B%5Cfrac%7Bnp%20+%20x%20%5Csqrt%7Bnpq%7D%7D%7Bnp%7D%7D%20%5C%5C%0A&amp;=%20-(np%20+%20x%20%5Csqrt%7Bnpq%7D)%20%5Cln%7B%5Cleft(%201%20+%20x%20%5Csqrt%7B%5Cfrac%20q%20%7Bnp%7D%7D%20%5Cright)%7D%20%5C%5C%0A&amp;=%20-(np%20+%20x%20%5Csqrt%7Bnpq%7D)%20%5Cleft(%20x%20%5Csqrt%7B%5Cfrac%20q%20%7Bnp%7D%7D%20-%20%5Cfrac%7Bx%5E2%20q%7D%7B2np%7D%20+%20o%5Cleft(%20%5Cfrac%201%20n%20%5Cright)%20%5Cright)%20%5C%5C%0A&amp;=%20-x%20%5Csqrt%7Bnpq%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20x%5E2%20q%20-%20x%5E2%20q%20+%20o(1)%0A%5Cend%7Baligned%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A(n-k)%20%5Cln%7B%5Cfrac%7Bnq%7D%7Bn-k%7D%7D%0A&amp;=%20-(nq%20-%20x%20%5Csqrt%7Bnpq%7D)%20%5Cln%7B%5Cfrac%7Bnq%20-%20x%20%5Csqrt%7Bnpq%7D%7D%7Bnq%7D%7D%20%5C%5C%0A&amp;=%20-(nq%20-%20x%20%5Csqrt%7Bnpq%7D)%20%5Cln%7B%5Cleft(%201%20-%20x%20%5Csqrt%7B%5Cfrac%20p%20%7Bnq%7D%7D%20%5Cright)%7D%20%5C%5C%0A&amp;=%20(nq%20-%20x%20%5Csqrt%7Bnpq%7D)%20%5Cleft(%20x%20%5Csqrt%7B%5Cfrac%20p%20%7Bnq%7D%7D%20+%20%5Cfrac%7Bx%5E2%20p%7D%7B2nq%7D%20+%20o%5Cleft(%20%5Cfrac%201%20n%20%5Cright)%20%5Cright)%20%5C%5C%0A&amp;=%20x%20%5Csqrt%7Bnpq%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20x%5E2%20p%20-%20x%5E2%20p%20+%20o(1)%0A%5Cend%7Baligned%7D%0A"></p>
<p>因此 <img src="https://latex.codecogs.com/png.latex?%0Ak%20%5Cln%7B%5Cfrac%7Bnp%7D%7Bk%7D%7D%20+%20(n-k)%20%5Cln%7B%5Cfrac%7Bnq%7D%7Bn-k%7D%7D%20=%20-%20%5Cfrac%7B1%7D%7B2%7D%20x%5E2%20(p+q)%20+%20o(1)%20=%20-%20%5Cfrac%201%202%20x%5E2%20+%20o(1)%0A"></p>
<p>下面处理 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D">．</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20k%20(n-k)%7D%7D%0A&amp;=%20%5Csqrt%7B%5Cfrac%7Bn%7D%7B2%20%5Cpi%20(np%20+%20x%20%5Csqrt%7Bnpq%7D)%20(nq%20-%20x%20%5Csqrt%7Bnpq%7D)%7D%7D%20%5C%5C%0A&amp;=%20%5Csqrt%7B%5Cfrac%7B1%7D%7B2%20%5Cpi%20(p%20+%20x%20%5Csqrt%7B%5Cfrac%7Bpq%7D%7Bn%7D%7D)%20(q%20-%20x%20%5Csqrt%7B%5Cfrac%7Bpq%7D%7Bn%7D%7D)%7D%7D%20%5C%5C%0A&amp;=%20%5Csqrt%7B%5Cfrac%7B1%7D%7B2%20%5Cpi%20n%20p%20q%20+%20o(1)%7D%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>将上述结果代回，我们就得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cbinom%7Bn%7D%7Bk%7D%20p%5Ek%20q%5E%7Bn-k%7D%0A&amp;%5Csim%20%5Csqrt%7B%5Cfrac%7B1%7D%7B2%20%5Cpi%20n%20p%20q%20+%20o(1)%7D%7D%20%5Cexp%7B%5Cleft(%20-%20%5Cfrac%201%202%20x%5E2%20+%20o(1)%20%5Cright)%7D%20%5C%5C%0A&amp;%5Csim%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%20%5Cpi%20n%20p%20q%7D%7D%20%5Cexp%7B%5Cleft(%20-%20%5Cfrac%201%202%20x%5E2%20%5Cright)%7D%0A%5Cend%7Baligned%7D%0A"> 即 <img src="https://latex.codecogs.com/png.latex?%0AP(%5Cbar%20X_n%20=%20x)%20=%20P(X_n%20=%20k)%20%5Csim%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%20npq%7D%7D%20%5Cexp%20%5Cleft(%20-%7B%5Cfrac%201%202%20x%5E2%7D%20%5Cright)%20=%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%20npq%7D%7D%20%5Cexp%20%5Cleft(%20-%5Cfrac%7B(k-np)%5E2%7D%7B2npq%7D%20%5Cright)%0A"> 这正是我们想要的．</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>细心的同学可能会对式子前边的系数仍是 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty"> 时的无穷小产生疑问．事实上，在将 <img src="https://latex.codecogs.com/png.latex?X_n"> 归一化为 <img src="https://latex.codecogs.com/png.latex?%5Cbar%20X_n"> 的过程中，我们将整个变量“压缩”至原来的 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B%5Csqrt%7Bnpq%7D%7D">，因此前面的系数可以理解为一种类似 <img src="https://latex.codecogs.com/png.latex?%5Coperatorname%7Bd%7D%5C!x"> 的存在．关于归一化的直观理解，3Blue1Brown 的中心极限定理视频<span class="citation" data-cites="3b1b-clt">[3]</span>提供了很好的讲解．</p>
<p>更形式化的，由于归一化得到的离散型随机变量 <img src="https://latex.codecogs.com/png.latex?%5Cbar%20X_n"> 在 <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty"> 的过程中已经变成连续型随机变量 <img src="https://latex.codecogs.com/png.latex?X">，我们研究的对象也应从单点转向区间．因此，对 <img src="https://latex.codecogs.com/png.latex?X_n"> 与 <img src="https://latex.codecogs.com/png.latex?%5Cbar%20X_n"> 概率分布的叙述做一点变动 <img src="https://latex.codecogs.com/png.latex?%0AP%5Cleft(x%20%5Cleq%20%5Cbar%20X_n%20%3C%20x%20+%20%5Cfrac%201%20%7B%5Csqrt%7Bnpq%7D%7D%5Cright)%0A=%20P%5Cleft(k%20%5Cleq%20X_n%20%3C%20k%20+%201%20%5Cright)%0A=%20P(X_n=k)%20%5Csim%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%20npq%7D%7D%20%5Cexp%20%5Cleft(%20-%7B%5Cfrac%201%202%20x%5E2%7D%20%5Cright)%0A"> 令区间大小趋于 <img src="https://latex.codecogs.com/png.latex?0"> 就得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Af(x)%20&amp;=%20%5Clim_%7Bh%20%5Cto%200%7D%7B%5Cfrac%7BP(x%20%5Cleq%20X%20%3C%20x+h)%7D%7Bh%7D%7D%20%5C%5C%0A&amp;=%20%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Csqrt%7Bnpq%7D%20%5Ccdot%20P%5Cleft(x%20%5Cleq%20%5Cbar%20X_n%20%3C%20x%20+%20%5Cfrac%201%20%7B%5Csqrt%7Bnpq%7D%7D%5Cright)%20%5C%5C%0A&amp;=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Csqrt%7Bnpq%7D%20%5Ccdot%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%20npq%7D%7D%20%5Cexp%20%5Cleft(%20-%7B%5Cfrac%201%202%20x%5E2%7D%20%5Cright)%20&amp;%20%5Cdots%20%5Ctext%7B%E8%BF%99%E9%87%8C%20$%5Csim$%20%E8%A1%A8%E7%8E%B0%E4%B8%BA%E7%AD%89%E4%BB%B7%E6%97%A0%E7%A9%B7%E5%B0%8F%E6%9B%BF%E6%8D%A2%7D%20%5C%5C%0A&amp;=%20%5Cfrac%201%20%7B%5Csqrt%7B2%20%5Cpi%7D%7D%20%5Cexp%20%5Cleft(%20-%7B%5Cfrac%201%202%20x%5E2%7D%20%5Cright)%0A%5Cend%7Baligned%7D%0A"> 这才是我们真正想要的，由二项分布归一化后取极限得到的，标准正态分布的概率密度函数．</p>
</div>
</section>
</section>
<section id="challenge" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="challenge"><span class="header-section-number">6</span> Challenge</h2>
<p>选讲或留作课后讨论．</p>
<section id="中心极限定理要求下正态分布的唯一性" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="中心极限定理要求下正态分布的唯一性"><span class="header-section-number">6.1</span> 中心极限定理要求下正态分布的唯一性</h3>
<p>正态分布概率密度函数 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%5E2%7D"> 的形式是如何被确定的？怎么说明这形式是满足中心极限定理的独一无二的概率密度函数？</p>
<p>3Blue1Brown 关于正态分布的系列视频较完整的解答了上述疑问，下面是推导思路的提纲．</p>
<p>首先需要意识到，随机变量之和的概率分布即原变量概率密度函数的卷积．</p>
<p>形式化的唯一性证明一般分为两步：</p>
<ul>
<li>使用 moment generating function 的方法证明，任一分布的概率密度函数的各次卷积所构成的函数列一定收敛，且收敛至的函数与初始选取的分布无关．</li>
<li>验证正态分布概率密度函数的卷积仍有 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%5E2%7D"> 的形式．</li>
</ul>
<p>这是严谨但并不令人满意的．我们需要更“几何”化的理解来理解 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%5E2%7D"> 的这种唯一性，即为什么只有 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%5E2%7D"> 在卷积下具有形式不变性．（需要指出的是，3Blue1Brown 的系列视频中，下面部分的严谨性不够充分，有待进一步研究）</p>
<p>Herschel-Maxwell derivation 指出，若二维概率分布满足以下两个条件：</p>
<ul>
<li>该分布具有各向同性，即该二维分布概率密度函数在某点处的取值只与该点离原点的距离有关</li>
<li>分布关于 <img src="https://latex.codecogs.com/png.latex?x,y"> 坐标轴独立，即该二维分布的概率密度函数可写为 <img src="https://latex.codecogs.com/png.latex?f(x)f(y)"> 的形式．</li>
</ul>
<p>则一维情形下此分布的概率密度函数被唯一地确定为具有 <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20e%5E%7Bc%20x%5E2%7D"> 的形式．当然需要假设 <img src="https://latex.codecogs.com/png.latex?f(x)"> 连续，并在最后做归一化处理．</p>
<p>两个随机变量 <img src="https://latex.codecogs.com/png.latex?X,Y"> 的和 <img src="https://latex.codecogs.com/png.latex?X+Y"> 的概率密度函数可被视为这两个随机变量的 Descartes 积 <img src="https://latex.codecogs.com/png.latex?(X,Y)"> 的二元概率密度函数“切片”并按面积（除掉 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%202"> 的常数因子后）“投影”至 <img src="https://latex.codecogs.com/png.latex?y=-x"> 上的结果．</p>
<p>考虑中心极限定理．两个独立同分布变量相加，这已经满足了二维分布独立性的要求．若考虑要求卷积后形式不变，也有必要要求二维分布的各项同性（这样一来，沿 <img src="https://latex.codecogs.com/png.latex?y=-x"> 方向的“切片”的形状与坐标轴向的“切片”只有一个常数因子 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%202"> 的差别）．因此，中心极限定理某种意义上正好对应了 Herschel-Maxwell derivation 的要求，从而唯一确定了正态分布概率密度函数 <img src="https://latex.codecogs.com/png.latex?e%5E%7B-x%5E2%7D"> 的形式．</p>
</section>
<section id="正态分布的归一性验证maxwell-速率分布与高维球体表面积" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="正态分布的归一性验证maxwell-速率分布与高维球体表面积"><span class="header-section-number">6.2</span> 正态分布的归一性验证、Maxwell 速率分布与高维球体表面积</h3>
<p>Guass 积分： <img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7B-%5Cinfty%7D%5E%7B+%5Cinfty%7D%20e%5E%7B-x%5E2%7D%20%5Coperatorname%7Bd%7D%5C!x%20=%20%5Csqrt%20%5Cpi%0A"></p>
<p>Maxwell 速率分布： <img src="https://latex.codecogs.com/png.latex?%0Af(v)%20=%204%20%5Cpi%20v%5E2%20%5Cleft(%20%5Cfrac%7Bm%7D%7B2%20%5Cpi%20kT%7D%20%5Cright)%5E%7B%5Cfrac%203%202%7D%20%5Cexp%20%5Cleft(%20-%20%5Cfrac%7Bm%7D%7B2kT%7Dv%5E2%20%5Cright)%0A"></p>
<p>以及它们与高维球体表面积的联系涉及多元积分学的内容．参见 3Blue1Brown 有关 <img src="https://latex.codecogs.com/png.latex?%5Cpi"> 与正态分布的视频<span class="citation" data-cites="3b1b-pi">[4]</span>．</p>
</section>
<section id="n-的其它估计" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="n-的其它估计"><span class="header-section-number">6.3</span> <img src="https://latex.codecogs.com/png.latex?n!"> 的其它估计</h3>
<p>一种更容易想到的做法是 <img src="https://latex.codecogs.com/png.latex?%0An%20%5Cln%20n%20-%20n%20-%201%20=%20%5Cint_1%5En%20%5Cln%20x%20%5Coperatorname%7Bd%7D%5C!x%20%5Cleq%0A%5Cln%20n!%20=%20%5Csum_%7Bk=1%7D%5En%20%5Cln%20k%0A%5Cleq%20%5Cint_1%5E%7Bn+1%7D%20%5Cln%20x%20%5Coperatorname%7Bd%7D%5C!x%20=%20(n+1)%20%5Cln%20(n+1)%20-%20n%20-%202%0A"> 从而 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft(%20%5Cfrac%20n%20e%20%5Cright)%5En%20%5Cleq%20e%20%5Ccdot%20n!%20%5Cleq%20%5Cleft(%5Cfrac%7Bn+1%7D%7Be%7D%5Cright)%5E%7Bn+1%7D%0A"> 当然这比 Theorem&nbsp;2 的估计稍差．</p>
<p>更多估计可参考这篇文章<span class="citation" data-cites="hijjjjq">[5]</span>．</p>
</section>
<section id="wallis-公式的其它证明" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="wallis-公式的其它证明"><span class="header-section-number">6.4</span> Wallis 公式的其它证明</h3>
<p>3Blue1Brown 频道提供了一个几何风格的证明<span class="citation" data-cites="3b1b-wallis">[6]</span>，其与 Bassel 问题的 Euler 解法有着神秘的联系．事实上，Euler 对 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Csin%20x%7D%7Bx%7D"> 的无穷乘积拆解也可用于证明 Wallis product，参见 Wikipedia<span class="citation" data-cites="wp-wallis">[7]</span>．</p>
</section>
<section id="wallis-公式视角下三阶乘与中心三项式系数的渐进估计" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="wallis-公式视角下三阶乘与中心三项式系数的渐进估计"><span class="header-section-number">6.5</span> Wallis 公式视角下三阶乘与中心三项式系数的渐进估计</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-triple-factorial-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(3n-2)!!!%7D%7B(3n)!!!%7D%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B1%20%5Ctimes%204%20%5Ctimes%207%20%5Ctimes%20%5Cdots%20%5Ctimes%20(3n-2)%7D%7B3%20%5Ctimes%206%20%5Ctimes%209%20%5Ctimes%20%5Cdots%20%5Ctimes%203n%7D%0A"> 并对其做出渐进估计．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-triple-factorial-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(3n-1)!!!%7D%7B(3n)!!!%7D%20=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B2%20%5Ctimes%205%20%5Ctimes%208%20%5Ctimes%20%5Cdots%20%5Ctimes%20(3n-1)%7D%7B3%20%5Ctimes%206%20%5Ctimes%209%20%5Ctimes%20%5Cdots%20%5Ctimes%203n%7D%0A"> 并对其做出渐进估计．</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exr-trinomial" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(3n)!%20/%20(n!)%5E3%7D%7B3%5E%7B3n%7D%7D%0A"> 并对其做出渐进估计．</p>
</div>
</div>
</div>
</div>
<p>用 Stirling 公式计算得到的结果是 <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Csqrt%203%7D%7B2%20%5Cpi%20n%7D%0A"> 但在 Wallis 公式的视角下如何获得？</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="acknowledgments" class="level2 appendix" data-number="7"><h2 class="anchored quarto-appendix-heading"><span class="header-section-number">7</span> Acknowledgments</h2><div class="quarto-appendix-contents">

<p>感谢吕老师组织<del>我最喜欢的</del>研讨课环节．此外，Example&nbsp;1 的放缩技巧由“吸取教训”同学提供，Poisson 分布的二项分布推导是与“抱头蹲防”同学讨论的结果，在此表示感谢．</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-analysis" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">张筑生, <em>数学分析新讲（重排本）（第二册）</em>, 2nd ed. 北京: 北京大学出版社, 2021.</div>
</div>
<div id="ref-prob" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">张颢, <em>概率论</em>. 北京: 高等教育出版社, 2018.</div>
</div>
<div id="ref-3b1b-clt" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">3Blue1Brown, <span>“Why is the "central limit" a normal distribution?”</span> <a href="https://www.youtube.com/watch?v=d_qvLDhkg00" class="uri">https://www.youtube.com/watch?v=d_qvLDhkg00</a>, 2023.</div>
</div>
<div id="ref-3b1b-pi" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">3Blue1Brown, <span>“Why π is in the normal distribution (beyond integral tricks).”</span> <a href="https://www.youtube.com/watch?v=cy8r7WSuT1I" class="uri">https://www.youtube.com/watch?v=cy8r7WSuT1I</a>, 2023.</div>
</div>
<div id="ref-hijjjjq" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">hijjjjq, <span>“对n的阶乘（n!）进行估计.”</span> <a href="https://zhuanlan.zhihu.com/p/552658420" class="uri">https://zhuanlan.zhihu.com/p/552658420</a>, 2022.</div>
</div>
<div id="ref-3b1b-wallis" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">3Blue1Brown, <span>“The wallis product for pi, proved geometrically.”</span> <a href="https://www.youtube.com/watch?v=8GPy_UMV-08" class="uri">https://www.youtube.com/watch?v=8GPy_UMV-08</a>, 2018.</div>
</div>
<div id="ref-wp-wallis" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">Wikipedia, <span>“Wallis product.”</span> <a href="https://en.wikipedia.org/wiki/Wallis_product#Proof_using_Euler's_infinite_product_for_the_sine_function" class="uri">https://en.wikipedia.org/wiki/Wallis_product#Proof_using_Euler's_infinite_product_for_the_sine_function</a>.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <category>讲稿</category>
  <guid>https://blog.sun123zxy.top/posts/20230423-stirling/</guid>
  <pubDate>Sat, 22 Apr 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>一些数论算法的时间复杂度分析</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230418-complexity/</link>
  <description><![CDATA[ 




<section id="预备" class="level2" data-number="">
<h2 data-number="" class="anchored" data-anchor-id="预备"><span class="header-section-number"></span> 预备</h2>
<section id="渐进符号" class="level3" data-number="0.1">
<h3 data-number="0.1" class="anchored" data-anchor-id="渐进符号"><span class="header-section-number">0.1</span> 渐进符号</h3>
<p>其实不少高等数学 / 数学分析教材在讲解无穷小的比较时已经相当严谨地介绍过大 O、小 O 记号，然而各种历史习惯记法的符号滥用（abuse of notation）<span class="citation" data-cites="wikipedia_abuse">[1]</span> 直到现在都让笔者头疼. These notations seem to be innocent, but can be catastrophic without careful manipulation. 例如</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-error-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (反例 1)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0An%20=%20O(n%5E2)%20%5Cland%20n%5E2%20=%20O(n%5E2)%20%5Cimplies%20n%20=%20n%5E2%0A"></p>
</div>
</div>
</div>
</div>
<p>Knuth 在《具体数学》里举出的例子 <span class="citation" data-cites="concretemath_onotation">[2]</span>. “<img src="https://latex.codecogs.com/png.latex?=">” 隐含的对称性使其在 <img src="https://latex.codecogs.com/png.latex?g(x)%20=%20O(f(x))"> 中格格不入. 事实上，将 <img src="https://latex.codecogs.com/png.latex?O(f(x))"> 看作“阶不高于 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的所有函数的集合”是比“某个阶不高于 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的函数”更严谨的理解. 因此，本文将使用 <img src="https://latex.codecogs.com/png.latex?f(x)%20%5Cin%20O(g(x))"> （有时也记为 <img src="https://latex.codecogs.com/png.latex?O(f(x))%20%5Csubset%20O(g(x))">）的集合论符号代替传统的 <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20O(g(x))"> 记法.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-error-2" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (反例 2)</strong></span> <img src="https://latex.codecogs.com/png.latex?%0An%5E2%20%5Csin%20n%20%5Cin%20O(n%5E2)%20%5Cimplies%20%5Csum_%7Bi=1%7D%5En%20i%5E2%20%5Csin%20i%20%5Cin%20%5Csum_%7Bi=1%7D%5En%20O(i%5E2)%20%5Csubset%20O%5Cleft(%20%5Csum_%7Bi=1%7D%5En%20i%5E2%20%5Cright)%20%5Csubset%20O(n%5E3)%0A"> 或更一般的， <img src="https://latex.codecogs.com/png.latex?%0Ag(x)%20%5Cin%20O(f(x))%20%5Cimplies%20%5Csum_%7BP(n,i)%7D%20g(i)%20%5Cin%20%5Csum_%7BP(n,i)%7D%20O(f(i))%20%5Csubset%20O%20%5Cleft(%5Csum_%7BP(n,i)%7D%20f(i)%20%5Cright)%0A"></p>
</div>
</div>
</div>
</div>
<p>没看出有啥问题，对吧？笔者在写作此文时犯了同样的错误. 请注意，大 O 记号的作用对象是函数，<img src="https://latex.codecogs.com/png.latex?f(i)"> 是什么？它只是个函数值，是确定的数——这是因为 <img src="https://latex.codecogs.com/png.latex?i"> 也是求和枚举中确定的数，而不是 <img src="https://latex.codecogs.com/png.latex?n"> 这种真正代表变元的记号. 所以 <img src="https://latex.codecogs.com/png.latex?O(f(i))"> 是什么？它什么也不是.</p>
<p>这种错误的出现是在所难免的，我们太习惯用 <img src="https://latex.codecogs.com/png.latex?x">、<img src="https://latex.codecogs.com/png.latex?x%5E3%20+%205%20x%5E2%20+%20x"> 这种变元都不明确的记号来表示函数了<span class="citation" data-cites="wikipedia_abuse">[1]</span>. 写成 <img src="https://latex.codecogs.com/png.latex?f(x)"> 也不严谨，因为只有 <img src="https://latex.codecogs.com/png.latex?f"> 才应代表函数本身，<img src="https://latex.codecogs.com/png.latex?f(x)"> 只能是函数值. 这样我们就可以放心地写下 <img src="https://latex.codecogs.com/png.latex?O(f)">，不用担心把变元与确定值弄混了.</p>
<p>然而大家还是喜欢写 <img src="https://latex.codecogs.com/png.latex?O(n%5E2)"> 和 <img src="https://latex.codecogs.com/png.latex?O(e%5E%7Bn%5E2%7D)">，而不是奇怪的 <img src="https://latex.codecogs.com/png.latex?O(%5Cmathrm%7Bid%7D%5E2)"> 和 <img src="https://latex.codecogs.com/png.latex?O(%5Cmathrm%7Bexp%7D%20%5Ccirc%20%7B%5Cmathrm%7Bid%7D%5E2%7D)">. 所以，我们大概只能沿用这种不太严谨的记号，并时刻提醒自己加倍小心了. （形如 <img src="https://latex.codecogs.com/png.latex?x%20%5Cmapsto%20e%5E%7Bx%5E2%7D"> 的 <img src="https://latex.codecogs.com/png.latex?%5Clambda"> 风格“匿名函数”记号可能更好？）</p>
<p>但上述命题从结论上是正确的. 正确的推导过程应为 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7BP(n,i)%7D%20g(i)%20%5Cleq%20%5Csum_%7BP(n,i)%7D%20C%20f(i)%20%5Cleq%20C%20%5Csum_%7BP(n,i)%7D%20f(i)%20%5Cin%20O%20%5Cleft(%5Csum_%7BP(n,i)%7D%20f(i)%20%5Cright)%5C%0A"> 第一步是直接由大 O 记号的定义得到的结果.</p>
<p>Wikipedia <span class="citation" data-cites="asymptotic_wikipedia">[3]</span> 中有一张详尽的表格介绍了各种渐进符号的定义，OI Wiki <span class="citation" data-cites="asymptotic_oiwiki">[4]</span> 上也有极好的讲解，尚不熟练的读者可以参考. 有兴趣仔细研究的读者可以参考《具体数学》第九章 <span class="citation" data-cites="concretemath_onotation">[2]</span>、Wikipedia 及其 reference（个人推荐 Knuth 关于 <img src="https://latex.codecogs.com/png.latex?O">、<img src="https://latex.codecogs.com/png.latex?%5COmega">、<img src="https://latex.codecogs.com/png.latex?%5CTheta"> 的短文 <span class="citation" data-cites="knuth_omicron">[5]</span>）. 本文除用 “<img src="https://latex.codecogs.com/png.latex?%5Cin">” 和“<img src="https://latex.codecogs.com/png.latex?%5Csubset">”替代 “<img src="https://latex.codecogs.com/png.latex?=">” 外，完全使用 Knuth 提议的记号体系.</p>
</section>
<section id="调和数-hn-调和级数" class="level3" data-number="0.2">
<h3 data-number="0.2" class="anchored" data-anchor-id="调和数-hn-调和级数"><span class="header-section-number">0.2</span> 调和数 <img src="https://latex.codecogs.com/png.latex?H(n)"> / 调和级数</h3>
<p>调和级数的部分和 <img src="https://latex.codecogs.com/png.latex?H(n)"> 定义为 <img src="https://latex.codecogs.com/png.latex?%0AH(n)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Cfrac%201%20i%0A"> 通过一些与 <img src="https://latex.codecogs.com/png.latex?e"> 有关的数列放缩可以证明 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20(%20H(n)%20-%20%5Clog%20n%20)%20=%20c">，其中 <img src="https://latex.codecogs.com/png.latex?c%20%5Capprox%200.577"> 是 Euler 常数. 因此 <img src="https://latex.codecogs.com/png.latex?H(n)%20%5Csim%20%5Clog%20n%20%5Cin%20%5CTheta(%5Clog%20n)">.</p>
</section>
<section id="自然数等幂和-p_pn-p---级数" class="level3" data-number="0.3">
<h3 data-number="0.3" class="anchored" data-anchor-id="自然数等幂和-p_pn-p---级数"><span class="header-section-number">0.3</span> 自然数等幂和 <img src="https://latex.codecogs.com/png.latex?P_p(n)"> / <img src="https://latex.codecogs.com/png.latex?p"> - 级数</h3>
<p><img src="https://latex.codecogs.com/png.latex?p"> - 级数可视为调和级数的推广. 其部分和定义为 <img src="https://latex.codecogs.com/png.latex?P_p(n)%20=%20%5Csum_%7Bi=1%7D%5En%20i%5E%7B-p%7D">．<img src="https://latex.codecogs.com/png.latex?p"> - 级数具有如下性质：</p>
<ul>
<li>当 <img src="https://latex.codecogs.com/png.latex?p%20%3E%201"> 时，<img src="https://latex.codecogs.com/png.latex?p"> - 级数收敛；</li>
<li>当 <img src="https://latex.codecogs.com/png.latex?p%20=%201"> 时，<img src="https://latex.codecogs.com/png.latex?p"> - 级数是调和级数；</li>
<li>当 <img src="https://latex.codecogs.com/png.latex?-%5Cinfty%20%3C%20p%20%3C%201"> 时，我们指出 <img src="https://latex.codecogs.com/png.latex?P_p(n)%20%5Csim%20%5Cfrac%7B1%7D%7B1-p%7D%20n%5E%7B1-p%7D%20%5Cin%20%5CTheta(n%5E%7B1-p%7D)"></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?-%5Cinfty%20%3C%20p%20%3C%201"> 时 <img src="https://latex.codecogs.com/png.latex?p"> - 级数的渐进估计可以从连续幂函数积分的角度理解. 证明这渐进性，离散情况下，可对 <img src="https://latex.codecogs.com/png.latex?n%5Ep"> 差分后前缀和 + 二项式定理得到高次项系数，或可用离散微积分理论得到精确表示（参见《具体数学》<span class="citation" data-cites="concretemath_calculus">[6]</span>）；连续情况下，Lagrange 中值定理应为较简单的估计方法. 这里从略. 总之，我们得到： <img src="https://latex.codecogs.com/png.latex?%0AP_p(n)%20%5Cin%20%5Cbegin%7Bcases%7D%0A%5CTheta(n%5E%7B1-p%7D)%20&amp;%20p%20%3C%201%20%5C%5C%0A%5CTheta(%5Clog%20n)%20&amp;%20p%20=%201%20%5C%5C%0A%5CTheta(1)%20&amp;%20p%20%3E%201%0A%5Cend%7Bcases%7D%0A"></p>
</section>
</section>
<section id="约数函数-sigma_zn" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="约数函数-sigma_zn"><span class="header-section-number">1</span> 约数函数 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z(n)"></h2>
<p>约数函数（Divisor Function，也可称为除数函数、因数函数）是与 <img src="https://latex.codecogs.com/png.latex?n"> 的因子有关的一类函数，定义为 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z(n)%20=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20d%5Ez">．当 <img src="https://latex.codecogs.com/png.latex?z=0"> 时，<img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)"> 被称为约数个数函数（number-of-divisors function），常被记为 <img src="https://latex.codecogs.com/png.latex?d(n)"> 或 <img src="https://latex.codecogs.com/png.latex?%5Ctau(n)">. 当 <img src="https://latex.codecogs.com/png.latex?z=1"> 时，<img src="https://latex.codecogs.com/png.latex?%5Csigma_1(n)"> 被称为约数和函数（sum-of-divisors function），常直接记为 <img src="https://latex.codecogs.com/png.latex?%5Csigma(n)">.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-sigma0ub" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> 估计 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0%20(n)"> 的渐进上界.</p>
</div>
</div>
</div>
</div>
<p>也就是估计 <img src="https://latex.codecogs.com/png.latex?n"> 的因子的数量. 一个广为人知的上界是 <img src="https://latex.codecogs.com/png.latex?2%20%5Csqrt%20n">，因为 <img src="https://latex.codecogs.com/png.latex?n"> 的所有小于 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%20n"> 的因子 <img src="https://latex.codecogs.com/png.latex?d"> 均与另一因子 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%20n%20d"> 一一对应.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>事实上进一步可以证明 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)%20%5Cin%20o(n%5E%5Cepsilon)%20%5Cquad%20%5Cforall%20%5Cepsilon%20%3E%200">，或更精确的，<img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)%20%5Cin%20O(n%5E%7B%5Clog%202%20/%20%5Clog%20%5Clog%20n%7D)"> <span class="citation" data-cites="wikipedia_divisor">[7]</span>．这一点说明，在实现与枚举因子有关的算法时，虽然仍会从 <img src="https://latex.codecogs.com/png.latex?1"> 枚举至 <img src="https://latex.codecogs.com/png.latex?%5Csqrt%20n"> 探测因子，但真正参与计算的因子其实相当少．因此，这些算法的实际表现往往极大程度地优于按 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)%20%5Cin%20O(%5Csqrt%20n)"> 估计的理论时间复杂度．</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-sumsigma0ub" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> 估计 <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Csigma_0%7D(n)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Csigma_0%20(i)"> 的渐进上界.</p>
</div>
</div>
</div>
</div>
<p>即估计 <img src="https://latex.codecogs.com/png.latex?1"> 到 <img src="https://latex.codecogs.com/png.latex?n"> 中所有数因子个数的和. 这是一个形式上鲜为人知但其应用广为人知的例子. 变换求和顺序，容易得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7B%5Csigma_0%7D(n)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Csigma_0%20(i)%0A=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%201%0A=%20%5Csum_%7Bd=1%7D%5En%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%0A%5Cleq%20%5Csum_%7Bd=1%7D%5En%20%5Cfrac%20n%20d%0A=%20n%20H(n)%20%5Cin%20O(n%20%5Clog%20n)%0A"></p>
<p>显然，这比 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Csqrt%20n)"> 的平凡估计好上不少. 本例的思路不仅是埃氏筛（Sieve of Eratosthenes）的理论基础，也在杜教筛、快速 Mobius 变换、<img src="https://latex.codecogs.com/png.latex?%5Cgcd"> 卷积 <span class="citation" data-cites="gcdconv">[8]</span> 等处出现.</p>
<p>进一步利用此技巧和 <img src="https://latex.codecogs.com/png.latex?p"> - 级数的估计，我们甚至能在仔细研究 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z(n)"> 前就得到其前缀和的渐进估计：</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-sumsigmazub" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> 估计 <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Csigma_z%7D(n)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Csigma_z%20(i)"> 的渐进上界.</p>
</div>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%7B%5Csigma_z%7D(n)%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Csigma_z%20(i)%0A=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%20d%5Ez%0A=%20%5Csum_%7Bd=1%7D%5En%20d%5Ez%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20%5C%5C%0A&amp;%5Cleq%20n%20%5Csum_%7Bd=1%7D%5En%20d%5E%7Bz-1%7D%0A=%20n%20P_%7B1-z%7D(n)%0A%5Cin%20%5Cbegin%7Bcases%7D%0AO(n%5E%7Bz+1%7D)%20&amp;%20z%20%3E%200%20%5C%5C%0AO(n%20%5Clog%20n)%20&amp;%20z%20=%200%20%5C%5C%0AO(n)%20&amp;%20z%20%3C%200%0A%5Cend%7Bcases%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>遗憾的是，对此前缀和做差分并不能得到 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z(n)"> 的优秀估计.</p>
<p>现在引入一个重要放缩技巧，其在后续估计中屡试不爽.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-trick1" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%20%5Cmid%20n%7D%20f(d)%20%5Cleq%20%5Csum_%7Bi=1%7D%5En%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"></p>
</div>
</div>
</div>
</div>
<p>右式比左式多算了 <img src="https://latex.codecogs.com/png.latex?i%20%5Cnmid%20n"> 的项，因此命题是正确的. 但我们还可以做得更好：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-trick1ex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 2</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%20%5Cmid%20n%7D%20f(d)%20%5Cleq%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20f(i)%20+%20f(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"></p>
</div>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Csqrt%20n"> 分治. 我们其实已经在 Example&nbsp;3 估计 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)"> 时用过此技巧了.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-sigma1ub" class="theorem example">
<p><span class="theorem-title"><strong>Example 6</strong></span> 估计 <img src="https://latex.codecogs.com/png.latex?%5Csigma_1%20(n)"> 的渐进上界.</p>
</div>
</div>
</div>
</div>
<p>用 Proposition&nbsp;1： <img src="https://latex.codecogs.com/png.latex?%0A%5Csigma_1%20(n)%0A=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20d%20%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cleq%20n%20H(n)%20%5Cin%20O(n%20%5Clog%20n)%0A"></p>
<p>可以证明用 Proposition&nbsp;2 不会得到更优的结果.</p>
<p>我们发现了一个有趣的事实：<img src="https://latex.codecogs.com/png.latex?%5Csigma_1%20(n)"> 和 <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Csigma_0%7D(n)"> 的渐进上界均为 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)">.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-sigmazub" class="theorem example">
<p><span class="theorem-title"><strong>Example 7</strong></span> 估计 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z%20(n)"> 的渐进上界.</p>
</div>
</div>
</div>
</div>
<p>用 Proposition&nbsp;2 和 <img src="https://latex.codecogs.com/png.latex?p"> - 级数的性质： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csigma_z%20(n)%0A&amp;=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20d%5Ez%0A%5Cleq%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20i%5Ez%20+%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%5Ez%20%5C%5C%0A&amp;%5Cleq%20%5Cbegin%7Bcases%7D%0A%5Cdisplaystyle%202%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%5Ez%20%5Cleq%202%20n%5Ez%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20i%5E%7B-z%7D%20&amp;%20=%202%20n%5Ez%20P_z(%5Csqrt%20n)%20&amp;%20z%20%5Cgeq%200%5C%5C%0A%5Cdisplaystyle%202%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20i%5Ez%20&amp;%20=%202%20P_%7B-z%7D(%5Csqrt%20n)%20%20&amp;%20z%20%3C%200%0A%5Cend%7Bcases%7D%20%5C%5C%0A%5Cin%20&amp;%20%5Cbegin%7Bcases%7D%0A2%20n%5Ez%20O(1)%20&amp;%20z%20%3E%201%20%5C%5C%0A2%20n%20O(%5Clog%20%5Csqrt%20n)%20&amp;%20z%20=%201%20%5C%5C%0A2%20n%5Ez%20O(n%5E%7B%5Cfrac%20%7B1-z%7D%202%7D)%20&amp;%200%20%5Cleq%20z%20%3C%201%20%5C%5C%0A2%20O(n%5E%7B%5Cfrac%20%7B1+z%7D%202%7D)%20&amp;%20-1%20%3C%20z%20%3C%200%20%5C%5C%0A2%20O(%5Clog%20%5Csqrt%20n)%20&amp;%20z%20=%20-1%20%5C%5C%0A2%20O(1)%20&amp;%20z%20%3C%20-1%0A%5Cend%7Bcases%7D%0A=%20%5Cbegin%7Bcases%7D%0AO(n%5Ez)%20&amp;%20z%20%3E%201%20%5C%5C%0AO(n%20%5Clog%20n)%20&amp;%20z%20=%201%20%5C%5C%0AO(n%5E%7B%5Cfrac%20%7B1+z%7D%202%7D)%20&amp;%20-1%20%3C%20z%20%3C%201%20%5C%5C%0AO(%5Clog%20n)%20&amp;%20z%20=%20-1%20%5C%5C%0AO(1)%20&amp;%20z%20%3C%20-1%0A%5Cend%7Bcases%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>这是一个相当优秀的渐进上界. 值得关注的是：</p>
<ul>
<li>当 <img src="https://latex.codecogs.com/png.latex?z=0"> 时，<img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)%20%5Cin%20O(n%5E%7B%5Cfrac%201%202%7D)">. 这与 Example&nbsp;3 的结果一致.</li>
<li>当 <img src="https://latex.codecogs.com/png.latex?z=%5Cfrac%201%202"> 时，<img src="https://latex.codecogs.com/png.latex?%5Csigma_%7B%5Cfrac%201%202%7D(n)%20%5Cin%20O(n%5E%7B%5Cfrac%203%204%7D)">，即 <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bd%20%5Cmid%20n%7D%20%5Csqrt%20d%20%5Cin%20O(n%5E%7B%5Cfrac%203%204%7D)">. 洛谷 P4980 Polya 定理模板题 <span class="citation" data-cites="polya_luogu">[9]</span> 的一种比较 trivial 的解法 <span class="citation" data-cites="polya_my">[10]</span> 的时间复杂度证明就来源于此. 我们之后还会在整除分块与杜教筛中见到它.</li>
</ul>
<p>另外，如果只使用 Proposition&nbsp;1 ，<img src="https://latex.codecogs.com/png.latex?-1%3Cz%3C1"> 部分的渐进上界将只能估计至 <img src="https://latex.codecogs.com/png.latex?O(n)">. 因此 Proposition&nbsp;2 是更为优越的.</p>
<p>约数函数更复杂的上限与渐进估计可参考 Wikipedia <span class="citation" data-cites="wikipedia_divisor">[7]</span>.</p>
</section>
<section id="整除分块" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="整除分块"><span class="header-section-number">2</span> 整除分块</h2>
<p>也被称为数论分块. 求 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20f(i)%20g(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"> 我们按 <img src="https://latex.codecogs.com/png.latex?d%20=%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor"> 分块求和： <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%7D%20g(d)%20%5Csum_%7B%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20=%20d%7D%20f(i)%0A"> 可以证明，对一指定的 <img src="https://latex.codecogs.com/png.latex?d">，满足 <img src="https://latex.codecogs.com/png.latex?d%20=%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor"> 的 <img src="https://latex.codecogs.com/png.latex?i"> 取遍一连续区间，故若 <img src="https://latex.codecogs.com/png.latex?f"> 的前缀和能 <img src="https://latex.codecogs.com/png.latex?O(1)"> 求出，块数量 <img src="https://latex.codecogs.com/png.latex?%5C#%20%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cright%5C%7D_%7Bi=1%7D%5En"> 即该算法的时间复杂度. 注意到当 <img src="https://latex.codecogs.com/png.latex?i%20%5Cleq%20%5Csqrt%20n"> 时，<img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor"> 最多只有 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%5Csqrt%20n%20%5Cright%5Crfloor"> 种取值，而 <img src="https://latex.codecogs.com/png.latex?i%20%5Cgeq%20%5Csqrt%20n"> 时，<img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cleq%20%5Csqrt%20n"> 表明其也最多只有 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%5Csqrt%20n%20%5Cright%5Crfloor"> 种取值. 因此整除分块的时间复杂度 <img src="https://latex.codecogs.com/png.latex?%0AT_1(n)%20=%20%5C#%20%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cright%5C%7D_%7Bi=1%7D%5En%20%5Cleq%202%20%5Csqrt%20n%20%5Cin%20O(%5Csqrt%20n)%0A"></p>
<p>方便起见，后文记 <img src="https://latex.codecogs.com/png.latex?D(n)%20=%20%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cright%5C%7D_%7Bi=1%7D%5En">.</p>
<section id="整除分块嵌套" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="整除分块嵌套"><span class="header-section-number">2.1</span> 整除分块嵌套</h3>
<p>将 Proposition&nbsp;2 加强，我们有如下通用放缩：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-trick2ex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%20%5Cmid%20n%7D%20f(d)%20%5Cleq%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20f(d)%20%5Cleq%20%5Csum_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%20f(i)%20+%20f(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"></p>
</div>
</div>
</div>
</div>
<p>LHS 成立的关键在于 <img src="https://latex.codecogs.com/png.latex?%5C%7Bd:%20d%20%5Cmid%20n%5C%7D%20%5Csubset%20D(n)">；而 RHS 的本质就是上述对整除分块块数量上界的估计.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>整除分块的 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20n)"> 相当满，而枚举因子的 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)%20%5Cin%20O(%5Csqrt%20n)"> 却相当不满．这一点在前面介绍 <img src="https://latex.codecogs.com/png.latex?%5Csigma_0(n)"> 时已经提到．</p>
</div>
<p>注意到 Proposition&nbsp;2 是 Example&nbsp;7 证明的核心，而 Proposition&nbsp;3 是 Proposition&nbsp;2 的加强版，故仿造 Example&nbsp;7 的证明，我们有</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-divissigma" class="theorem example">
<p><span class="theorem-title"><strong>Example 8</strong></span> 令 <img src="https://latex.codecogs.com/png.latex?%0AS_z(n)%20=%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20d%5Ez%0A"> 则前述 Example&nbsp;7 中 <img src="https://latex.codecogs.com/png.latex?%5Csigma_z(n)"> 的上界与渐进上界也同样适用于 <img src="https://latex.codecogs.com/png.latex?S_z(n)">.</p>
</div>
</div>
</div>
</div>
<p>现在可以对嵌套整除分块 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20f(i)%20%5Csum_%7Bj=1%7D%5E%7B%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%7D%20g(j)%20h(%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bij%7D%20%5Cright%5Crfloor)%0A"> 的时间复杂度 <img src="https://latex.codecogs.com/png.latex?T_2"> 做出估计了. 对 Example&nbsp;8 取 <img src="https://latex.codecogs.com/png.latex?z=%5Cfrac%201%202">，立刻有 <img src="https://latex.codecogs.com/png.latex?%0AT_2(n)%20=%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20T_1(d)%20%5Cleq%202%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20%5Csqrt%20d%20=%202%20S_%7B%5Cfrac%201%202%7D(n)%20%5Cleq%204%20%5Csqrt%20n%20P_%7B%5Cfrac%201%202%7D(%5Csqrt%20n)%20%5Cin%20O(n%5E%7B%5Cfrac%203%204%7D)%0A"></p>
<p>我们还可以进一步归纳. 假定 <img src="https://latex.codecogs.com/png.latex?%5Cforall%20m%20%5Cgeq%200,%20%5Cquad%20%5Cexists%20z_m%20:%200%20%5Cleq%20z_m%20%3C%201,%20%5Cquad%20T_m(n)%20=%20O(n%5E%7Bz_m%7D)">，我们有 <img src="https://latex.codecogs.com/png.latex?%0AT_%7Bm+1%7D(n)%20=%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20T_m(d)%20%5Cleq%20C%20%5Csum_%7Bd%20%5Cin%20D(n)%7D%20n%5E%7Bz_m%7D%20=%20C%20S_%7Bz_m%7D(n)%20%5Cin%20O(n%5E%7B%5Cfrac%20%7B1+z_m%7D%202%7D)%0A"> 因此 <img src="https://latex.codecogs.com/png.latex?z_%7Bm+1%7D%20=%20%5Cfrac%20%7B1+z_m%7D%202">. 边界条件 <img src="https://latex.codecogs.com/png.latex?z_0%20=%200">，数列递推求得 <img src="https://latex.codecogs.com/png.latex?z_m%20=%201-2%5E%7B-m%7D">，检验满足条件. 因此 <img src="https://latex.codecogs.com/png.latex?m"> 重嵌套整除分块的时间复杂度 <img src="https://latex.codecogs.com/png.latex?%0AT_m(n)%20%5Cin%20O(n%5E%7B1-%202%5E%7B-m%7D%7D)%0A"></p>
</section>
</section>
<section id="杜教筛" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="杜教筛"><span class="header-section-number">3</span> 杜教筛</h2>
<p>杜教筛可以以低于线性的时间复杂度求解某些数论函数的前缀和. 其思路并不复杂. 设 <img src="https://latex.codecogs.com/png.latex?f"> 为一数论函数，我们希望快速求得其前缀和 <img src="https://latex.codecogs.com/png.latex?%5Chat%20f%20(n)%20=%20%5Csum_%7Bi=1%7D%5En%20f(i)">. 考虑数论函数 <img src="https://latex.codecogs.com/png.latex?g"> 和 <img src="https://latex.codecogs.com/png.latex?h%20=%20g%20*%20f">， <img src="https://latex.codecogs.com/png.latex?%0Ah(n)%20=%20%5Csum_%7Bd%20%5Cmid%20n%7D%20g(d)%20f(%5Cfrac%20n%20d)%0A"> 两端做前缀和得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Chat%20h%20(n)%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20h(i)%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bd%20%5Cmid%20i%7D%20g(d)%20f(%5Cfrac%20i%20d)%20%5C%5C%0A&amp;=%20%5Csum_%7Bd=1%7D%5En%20g(d)%20%5Csum_%7Bi=1%7D%5E%7B%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%7D%20f(i)%20%5C%5C%0A&amp;=%20%5Csum_%7Bd=1%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%20%5C%5C%0A&amp;=%20g(1)%20%5Chat%20f%20(n)%20+%20%5Csum_%7Bd=2%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%0A%5Cend%7Baligned%7D%0A"> 因此 <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%20f%20(n)%20=%20%5Cfrac%201%20%7Bg(1)%7D%20%5Cleft(%20%5Chat%20h%20(n)%20-%20%5Csum_%7Bd=2%7D%5En%20g(d)%20%5Chat%20f%20(%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor)%20%5Cright)%0A"> 故若 <img src="https://latex.codecogs.com/png.latex?g">、<img src="https://latex.codecogs.com/png.latex?h"> 的前缀和可 <img src="https://latex.codecogs.com/png.latex?O(1)"> 算得，根据上式整除分块即可递归地计算出 <img src="https://latex.codecogs.com/png.latex?f"> 的前缀和.</p>
<p>下面分析算法的复杂度. 注意到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5Clfloor%20%5Cfrac%7B%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%7D%7Bj%7D%20%5Cright%5Crfloor%20=%20%5Cleft%5Clfloor%20%5Cfrac%7Bn%7D%7Bij%7D%20%5Cright%5Crfloor%0A"> 故单轮递归涉及到的自变量均可表示为 <img src="https://latex.codecogs.com/png.latex?d%20=%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor"> 的形式. 一个 <img src="https://latex.codecogs.com/png.latex?%5Chat%20f%20(d)"> 做整除分块耗时 <img src="https://latex.codecogs.com/png.latex?T_1(d)">，若采用记忆化递归，由上节分析，算法总时间复杂度为 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%20%5Cin%20D(n)%7D%20T_1(d)%20=%20T_2(n)%20%5Cin%20O(n%5E%7B%5Cfrac%203%204%7D)%0A"></p>
<p>但我们还可以做得更好——考虑先用 <img src="https://latex.codecogs.com/png.latex?O(K)"> 的时间复杂度线性筛出前 <img src="https://latex.codecogs.com/png.latex?K"> 个 <img src="https://latex.codecogs.com/png.latex?f(n)"> 并求前缀和，则递归求解时，<img src="https://latex.codecogs.com/png.latex?d%20%5Cleq%20K"> 的 <img src="https://latex.codecogs.com/png.latex?%5Chat%20f(d)"> 就无需再向下递归了. 为分析此类时间复杂度，对 Proposition&nbsp;3 做最后一点扩展：</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-trick3ex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 4</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7B%5Cbegin%7Bgathered%7D%20d%20%5Cmid%20n%20%5C%5C%20d%20%3E%20K%20%5Cend%7Bgathered%7D%7D%20f(d)%20%5Cleq%20%5Csum_%7B%5Cbegin%7Bgathered%7D%20d%20%5Cin%20D(n)%20%5C%5C%20d%20%3E%20K%20%5Cend%7Bgathered%7D%7D%20f(d)%20%5Cleq%20%5Csum_%7BK%20%3C%20i%20%5Cleq%20%5Csqrt%20n%7D%20f(i)%20+%20%5Csum_%7B1%20%5Cleq%20i%20%5Cleq%20%5Cmin%7B%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor,%5Csqrt%20n%20%5C%7D%20%7D%7D%20f(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"> 特别的，当 <img src="https://latex.codecogs.com/png.latex?K%20%3E%20%5Csqrt%20n"> 时，有 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7B%5Cbegin%7Bgathered%7D%20d%20%5Cmid%20n%20%5C%5C%20d%20%3E%20K%20%5Cend%7Bgathered%7D%7D%20f(d)%20%5Cleq%20%5Csum_%7B%5Cbegin%7Bgathered%7D%20d%20%5Cin%20D(n)%20%5C%5C%20d%20%3E%20K%20%5Cend%7Bgathered%7D%7D%20f(d)%20%5Cleq%20%5Csum_%7B1%20%5Cleq%20i%20%5Cleq%20%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor%7D%20f(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%0A"></p>
</div>
</div>
</div>
</div>
<p>利用此估计，当 <img src="https://latex.codecogs.com/png.latex?K%20%3E%20%5Csqrt%20n"> 时，算法在递归部分的时间复杂度估计降低为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cmathrm%7BDu%7D_K(n)%20&amp;=%0A%5Csum_%7B%5Cbegin%7Bgathered%7D%20d%20%5Cin%20D(n)%20%5C%5C%20d%20%3E%20K%20%5Cend%7Bgathered%7D%7D%20T_1(d)%20%5C%5C%0A&amp;=%20%5Csum_%7B1%20%5Cleq%20i%20%5Cleq%20%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor%7D%20T_1(%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor)%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7B1%20%5Cleq%20i%20%5Cleq%20%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor%7D%20C%20%5Csqrt%7B%5Cfrac%20n%20i%7D%20%5C%5C%0A&amp;=%20C%20%5Csqrt%20n%20%5Csum_%7B1%20%5Cleq%20i%20%5Cleq%20%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor%7D%20i%5E%7B-%5Cfrac%201%202%7D%20%5C%5C%0A&amp;=%20%20C%20%5Csqrt%20n%20P_%7B%5Cfrac%201%202%7D%5Cleft(%5Cleft%5Clfloor%20%5Cfrac%20n%20K%20%5Cright%5Crfloor%5Cright)%20%5C%5C%0A&amp;%5Cin%20%5Csqrt%20n%20O%5Cleft(%20%5Cleft(%5Cfrac%20n%20K%5Cright)%5E%7B%5Cfrac%201%202%7D%20%5Cright)%20%5C%5C%0A&amp;%5Csubset%20O(n%20K%5E%7B-%5Cfrac%201%202%7D)%0A%5Cend%7Baligned%7D%0A"> 总时间复杂度 <img src="https://latex.codecogs.com/png.latex?%0AO(K)%20+%20O(n%20K%5E%7B-%5Cfrac%201%202%7D)%0A"> 为最小化时间复杂度，取 <img src="https://latex.codecogs.com/png.latex?K%20=%20n%5E%7B%5Cfrac%202%203%7D">，即得最优时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B%5Cfrac%202%203%7D)">.</p>
<p>这部分的时间复杂度证明主要参考了文章 <span class="citation" data-cites="zhihu_dusieve">[11]</span>.</p>
</section>
<section id="challenge" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="challenge"><span class="header-section-number">4</span> Challenge</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-nonsquare" class="theorem example">
<p><span class="theorem-title"><strong>Example 9</strong></span> 对 <img src="https://latex.codecogs.com/png.latex?1"> 到 <img src="https://latex.codecogs.com/png.latex?n"> 间的无平方因子数计数. <img src="https://latex.codecogs.com/png.latex?n%20%5Cleq%2010%5E%7B18%7D">.</p>
<p>参见蓝桥杯 2023 省赛 A 组 J 题《翻转硬币》<span class="citation" data-cites="nonsquare1_luogu">[12]</span> 或《完全平方数》<span class="citation" data-cites="nonsquare2_luogu">[13]</span>.</p>
</div>
</div>
</div>
</div>
<p>我们指出，无平方因子数有如下计数公式 <img src="https://latex.codecogs.com/png.latex?%0Af(n)%20=%20%5Csum_%7Bi=1%7D%5En%20%5Cmu%5E2%20(i)%20=%20%5Csum_%7Bi=1%7D%5E%7B%5Cleft%5Clfloor%20%5Csqrt%20n%20%5Cright%5Crfloor%7D%20%5Cmu(i)%20%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor%0A"></p>
<p>朴素实现复杂度为 <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%20n)">，考虑对 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor"> 开发一种新的整除分块算法. 现在问题有三. 一是估计 <img src="https://latex.codecogs.com/png.latex?%0A%5C#%20D_2(n)%20=%20%5C#%20%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor%20%5Cright%5C%7D_%7Bi=1%7D%5E%7B%5Csqrt%20n%7D%0A"> 这并不困难，按 <img src="https://latex.codecogs.com/png.latex?i%20%5Cleq%20n%5E%7B%5Cfrac%201%203%7D"> 和 <img src="https://latex.codecogs.com/png.latex?i%20%5Cgeq%20n%5E%7B%5Cfrac%201%203%7D"> 讨论即知其上界为 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B%5Cfrac%201%203%7D)">.</p>
<p>二是实现方案. 这里也直接给出：</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1">ll sqrtN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sqrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-2">ll ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>sqrtN<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-4">    d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">),</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sqrt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-5">    ans<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=(</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)-</span>S_mu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>l<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))*</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>最后是算法时间复杂度分析. 普通的 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%20%5Cfrac%20n%20i%20%5Cright%5Crfloor"> 整除分块不会因杜教筛增加时间复杂度，但 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clfloor%20%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor"> 则需要额外的讨论. 注意到该整除分块枚举中，需做杜教筛的数的集合为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20%20%5Cright%5Crfloor%5Cright%5C%7D_%7Bd%20%5Cin%20D_2%20(n)%7D%0A"> 同样类似 Proposition&nbsp;3 ，我们有</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="prp-trick4ex" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 5</strong></span> <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bd%5E2%20%5Cmid%20n%7D%20f(%5Cfrac%20n%20%7Bd%5E2%7D)%20%5Cleq%20%5Csum_%7Bd%20%5Cin%20D_2(n)%7D%20f(d)%20%5Cleq%20%5Csum_%7Bi=1%7D%5E%7Bn%5E%7B%5Cfrac%201%203%7D%7D%20f(i)%20+%20f(%5Cleft%5Clfloor%20%5Cfrac%20n%20%7Bi%5E2%7D%20%5Cright%5Crfloor)%0A"></p>
</div>
</div>
</div>
</div>
<p>因此算法递归部分时间复杂度可估计为 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bd%20%5Cin%20D_2%20(n)%7D%20%5Cmathrm%7BDu%7D_K%20%5Cleft(%5Cleft%5Clfloor%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20%5Cright%5Crfloor%5Cright)%0A&amp;%5Cleq%20%5Csum_%7Bd%20%5Cin%20D_2%20(n)%7D%20C%20%5Cleft%5Clfloor%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20%5Cright%5Crfloor%20K%5E%7B-%5Cfrac%201%202%7D%20%5C%5C%0A&amp;%5Cleq%20C%20K%5E%7B-%5Cfrac%201%202%7D%20%5Cleft(%20%5Csum_%7Bi=1%7D%5E%7Bn%5E%7B%5Cfrac%201%203%7D%7D%20%5Cleft(%20%5Cfrac%20n%20%7B%5Cfrac%20n%20%7Bi%5E2%7D%7D%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20+%20%5Csum_%7Bi=1%7D%5E%7Bn%5E%7B%5Cfrac%201%203%7D%7D%20%5Cleft(%20%5Cfrac%20n%20i%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20%5Cright)%20%5C%5C%0A&amp;=%20C%20K%5E%7B-%5Cfrac%201%202%7D%20%5Cleft(%20%5Csum_%7Bi=1%7D%5E%7Bn%5E%7B%5Cfrac%201%203%7D%7D%20i%20+%20n%5E%7B%5Cfrac%201%202%7D%20%5Csum_%7Bi=1%7D%5E%7Bn%5E%7B%5Cfrac%201%203%7D%7D%20i%5E%7B-%5Cfrac%201%202%7D%20%5Cright)%20%5C%5C%0A&amp;%5Cin%20K%5E%7B-%5Cfrac%201%202%7D%20%5Cleft(%20O(n%5E%7B%5Cfrac%202%203%7D)%20+%20n%5E%7B%5Cfrac%201%202%7D%20O(n%5E%7B%5Cfrac%201%206%7D)%20%5Cright)%20%5C%5C%0A&amp;%5Csubset%20O(n%5E%7B%5Cfrac%202%203%7D%20K%5E%7B-%5Cfrac%201%202%7D)%0A%5Cend%7Baligned%7D%0A"> 总时间复杂度为 <img src="https://latex.codecogs.com/png.latex?%0AO(K)%20+%20O(n%5E%7B%5Cfrac%202%203%7D%20K%5E%7B-%5Cfrac%201%202%7D)%0A"> 取 <img src="https://latex.codecogs.com/png.latex?K=n%5E%7B%5Cfrac%204%209%7D">，得到最优时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B%5Cfrac%204%209%7D)">. 代入 <img src="https://latex.codecogs.com/png.latex?n%20=%2010%5E%7B18%7D">，量级约为 <img src="https://latex.codecogs.com/png.latex?10%5E8">.</p>
<p>这估计并不算优秀. 传言存在 <img src="https://latex.codecogs.com/png.latex?O(n%5E%7B%5Cfrac%202%205%7D)"> 的估计，猜测大概优化了 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%5Cfrac%20n%20i%20%5Cright%5Crfloor%20%5Cright%5C%7D_%7Bi=1%7D%5En"> 和 <img src="https://latex.codecogs.com/png.latex?%5Cleft%5C%7B%20%5Cleft%5Clfloor%20%20%5Cleft(%20%5Cleft%5Clfloor%20%5Cfrac%20n%20d%20%5Cright%5Crfloor%20%5Cright)%5E%7B%5Cfrac%201%202%7D%20%20%5Cright%5Crfloor%5Cright%5C%7D_%7Bd%20%5Cin%20D_2%20(n)%7D"> 的重叠部分．关于这一估计，我们找到两篇参考文献，请参阅博客 <span class="citation" data-cites="nonsquare_blog">[14]</span> 和论文 <span class="citation" data-cites="nonsquare_paper">[15]</span>．</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-wikipedia_abuse" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span>“Abuse of notation - wikipedia.”</span> <a href="https://en.wikipedia.org/wiki/Abuse_of_notation#Function_notation" class="uri">https://en.wikipedia.org/wiki/Abuse_of_notation#Function_notation</a>.</div>
</div>
<div id="ref-concretemath_onotation" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">R. L. Graham, D. E. Knuth, and O. Patashnik, <span>“Concrete mathematics: A foundation for computer science,”</span> Second.in A @foundation for computer science. Addison-Wesley, 1994, pp. 443–449.</div>
</div>
<div id="ref-asymptotic_wikipedia" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline"><span>“Big o notation - wikipedia # family of bachmann–landau notations.”</span> <a href="https://en.wikipedia.org/wiki/Big_O_notation#Family_of_Bachmann%E2%80%93Landau_notations" class="uri">https://en.wikipedia.org/wiki/Big_O_notation#Family_of_Bachmann%E2%80%93Landau_notations</a>.</div>
</div>
<div id="ref-asymptotic_oiwiki" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline"><span>“复杂度 - OI wiki.”</span> <a href="https://oi-wiki.org/basic/complexity/#%E6%B8%90%E8%BF%9B%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%AE%9A%E4%B9%89" class="uri">https://oi-wiki.org/basic/complexity/#%E6%B8%90%E8%BF%9B%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%AE%9A%E4%B9%89</a>.</div>
</div>
<div id="ref-knuth_omicron" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">D. E. Knuth, <span>“Big omicron and big omega and big theta,”</span> <em>SIGACT News</em>, vol. 8, no. 2, pp. 18–24, Apr. 1976, doi: <a href="https://doi.org/10.1145/1008328.1008329">10.1145/1008328.1008329</a>.</div>
</div>
<div id="ref-concretemath_calculus" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">R. L. Graham, D. E. Knuth, and O. Patashnik, <span>“Concrete mathematics: A foundation for computer science,”</span> Second.in A @foundation for computer science. Addison-Wesley, 1994, pp. 47–56.</div>
</div>
<div id="ref-wikipedia_divisor" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline"><span>“Divisor function - wikipedia # growth_rate.”</span> <a href="https://en.wikipedia.org/wiki/Divisor_function#Growth_rate" class="uri">https://en.wikipedia.org/wiki/Divisor_function#Growth_rate</a>.</div>
</div>
<div id="ref-gcdconv" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">sun123zxy, <span>“sun123zxy’s blog - 原创OI题目 GCD卷积 problem and solution.”</span> <a href="https://blog.sun123zxy.top/posts/20201206-gcdconv/" class="uri">https://blog.sun123zxy.top/posts/20201206-gcdconv/</a>, 2020.</div>
</div>
<div id="ref-polya_luogu" class="csl-entry">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline"><span>“P4980 【模板】pólya 定理 - 洛谷 | 计算机科学教育新生态.”</span> <a href="https://www.luogu.com.cn/problem/P4980" class="uri">https://www.luogu.com.cn/problem/P4980</a>.</div>
</div>
<div id="ref-polya_my" class="csl-entry">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">sun123zxy, <span>“sun123zxy’s blog - 等价类计数：Burnside引理 &amp; Polya定理.”</span> <a href="http://blog.sun123zxy.top/posts/20200321-burnside/#s-4.3" class="uri">http://blog.sun123zxy.top/posts/20200321-burnside/#s-4.3</a>, 2020.</div>
</div>
<div id="ref-zhihu_dusieve" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">Ander, <span>“杜教筛.”</span> <a href="https://zhuanlan.zhihu.com/p/521699400" class="uri">https://zhuanlan.zhihu.com/p/521699400</a>, 2022.</div>
</div>
<div id="ref-nonsquare1_luogu" class="csl-entry">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline"><span>“P9238 [蓝桥杯 2023 省 a] 翻转硬币 - 洛谷 | 计算机科学教育新生态.”</span> <a href="https://www.luogu.com.cn/problem/P9238" class="uri">https://www.luogu.com.cn/problem/P9238</a>.</div>
</div>
<div id="ref-nonsquare2_luogu" class="csl-entry">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline"><span>“P4318 完全平方数 - 洛谷 | 计算机科学教育新生态.”</span> <a href="https://www.luogu.com.cn/problem/P4318" class="uri">https://www.luogu.com.cn/problem/P4318</a>.</div>
</div>
<div id="ref-nonsquare_blog" class="csl-entry">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">smsxgz, <span>“Counting square free numbers.”</span> <a href="https://smsxgz.github.io/post/pe/counting_square_free_numbers/" class="uri">https://smsxgz.github.io/post/pe/counting_square_free_numbers/</a>, 2019.</div>
</div>
<div id="ref-nonsquare_paper" class="csl-entry">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">J. Pawlewicz, <span>“Counting square-free numbers.”</span> 2011. Available: <a href="https://arxiv.org/abs/1107.4890">https://arxiv.org/abs/1107.4890</a></div>
</div>
</div></section></div> ]]></description>
  <category>OI</category>
  <category>数学</category>
  <guid>https://blog.sun123zxy.top/posts/20230418-complexity/</guid>
  <pubDate>Mon, 17 Apr 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>国家博物馆兼东单良乡骑行一日游</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230306-national-museum-tour/</link>
  <description><![CDATA[ 




<p>“来北京，当然要逛逛啊！”嘴上这么说，充实的学习生活却总能带来无数个宅在宿舍的理由。恰逢本学期思政课需亿点社会实践，国家博物馆乃官方推荐之所，而东可游长安街、王府井，南可观东交民巷，完成任务而了却游园之心，岂不美哉？虽开学未几，春景未至，然天气渐暖，今日不去，更待何时？不妨早做打算。遂与室友相约，周日出游。</p>
<p>乘地铁至天安门东，一路罚站。当然毕竟是淡季，车上并不拥挤。惊奇地发现一号线已非昔日模样：站台已加装护栏，而列车的内饰也早已翻新。</p>
<p>例行排队安检，上至天安门广场东侧。国家博物馆就在眼前，隔天安门广场与人民大会堂遥相呼应。馆子很大，上上下下一共六层，尚分南北两区，一整天或许也很难逛完，故我们只选取少量展馆参观。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/col-museum-outside.jpg" class="img-fluid figure-img"></p>
<figcaption>博物馆外侧</figcaption>
</figure>
</div>
<p>展览当然是相当不错的，但具体说来却没啥好写。博物馆这种地方，始终还是得自己去看。常设的《复兴之路》展区是标准的《中国近现代史纲要》，最近也新开了新时代展区，但我们去的时候……空无一人……（逃）</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/museum-exhibits.jpg" class="img-fluid figure-img"></p>
<figcaption>神州十三号返回舱（左）；复兴之路“新时代”展厅（右）</figcaption>
</figure>
</div>
<p>总之，逛逛逛拍拍拍，出来已经一点半了。讨论一下，准备往东单走找地儿吃饭。走在东长安街的人行道上，公安部、生态环境部、<del>长安俱乐部</del>滚滚而来，赫赫有名的北京饭店也映入眼帘。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/beijing-hotel.jpg" class="img-fluid figure-img"></p>
<figcaption>挺敦实一栋楼</figcaption>
</figure>
</div>
<p>王府井的人气似乎已经恢复了八成。我们并无兴致逛街，草草填饱肚子，往南向东交民巷前进。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/wangfujing.jpg" class="img-fluid figure-img"></p>
<figcaption>王府井步行街</figcaption>
</figure>
</div>
<p>比起嘈杂的天安门广场，东交民巷可谓意外的宁静。从东侧进入东交民巷，街上行人三三两两，似乎都是本地居民。往东前进，法国邮政局、西班牙领事馆等欧式建筑在街边排列，但均未开放游览，亦无游客驻足。灰黑色的砖瓦在紧闭的大门后默默不语，枯树残影的映衬下略显凄凉。教堂倒是小有人气，时有新人在此拍摄婚纱。行至天安门广场前最后一个路口，有警卫把守，似乎已不得入内。查看地图，前面已是公安局地界。也许得从天安门广场方向步行进入才可进一步游览吧。（事后调查，不少使馆的入口其实在前门大街一侧，许多建筑也已商业运行，除外观保持原样外，已无太多历史可寻。）</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/church.jpg" class="img-fluid figure-img"></p>
<figcaption>东交民巷的教堂</figcaption>
</figure>
</div>
<p>室友突然提议骑回良乡——英雄所见略同啊（笑）。从学校骑至主城一直是我的计划之一，现在离天黑尚有三四小时光景，晚 7:00 之前骑回学校并无不可。已有一室友因事先行离开，另一位室友苦于舟车劳顿，计划地铁回程。于是和提议的室友开启了近 40km 的骑行之旅。</p>
<p>已在东交民巷南边，我们没有选择卢沟桥路线，而是往京良路方向前进。二环可不小，出了前门公园，在狭窄的胡同间穿行，不一会就有点小累了。室友事后表示他没意识到 40km 的严重性（</p>
<p>渐行至三、四环外。偶然拐离干道，驶入普通道路。路上房屋低矮，矮墙垛垛，货车辆辆，尘土飞扬，加之今日有霾，揉眼一看，好似来到某西部偏远地区的乡间小路上。偌大的北京城也有如此“土里土气”的地方……之前在房山线上看到的壮美秋景，似乎也不在本次路线之上。况且春天尚未到来，即使经过也别无二致吧。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/col-riding.jpg" class="img-fluid figure-img"></p>
<figcaption>胡同、“乡道”与分界处</figcaption>
</figure>
</div>
<p>至京良路。室友体力已下降不少，速度逐渐放缓。然而调高座椅、换用前脚掌蹬车的我似乎还能一战。<del>室友表示你个山区居民怎么这么能蹬，</del>虽然中途因未知原因迷路多绕出几公里的路程，最终还是在 7:00 之前赶回了学校。</p>
<p>买了面包和咖啡匆匆赶去参加组会，坐下的瞬间，突然感觉如断电般困倦……</p>



 ]]></description>
  <category>游记</category>
  <guid>https://blog.sun123zxy.top/posts/20230306-national-museum-tour/</guid>
  <pubDate>Sun, 05 Mar 2023 16:00:00 GMT</pubDate>
  <media:content url="https://blog.sun123zxy.top/posts/20230306-national-museum-tour/img/wangfujing.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>聊聊红石音乐</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230217-rmg/</link>
  <description><![CDATA[ 




<p>咕极必肝，肝极必咕。</p>
<p>本来是打算做完 Ancient Temple 和视频一起发出的，但现在看到这篇文章，说明下文随想里立下的 flag 已经被打脸了（</p>
<p>咕的原因，一方面是因为现实生活太过充实有趣，即使红乐般的激昂也有黯淡之时；但更重要的，还是对第二次迭代的表现效果不满意。模子是 Foxtail Grass Studio 的专辑封面和《妖妖剑戟梦想》的白玉楼阶梯，但始终没能做出想要的效果。更好的想法？暂时也没有。</p>
<p>半途而废很可惜，但糟蹋更可惜。或许暂时搁置、静待花开，会有更好的结果。</p>
<p>写下随想与技术细节，封存于冷清的博客，是纪念，还是重启的依托？</p>
<blockquote class="blockquote">
<p>东方的天空微微露出青白色的天光，幻想乡迎来了又一个清晨。</p>
<p>很快，太阳就会出现，将光芒洒满这片遗忘之地。</p>
<p>尽管，那片原野已然如幻梦般消失不见——</p>
<p>但，在看不见的隐秘角落，无数的原野正在悄然生长——</p>
<p>这里也是，那里也是</p>
<p>——如同小小的光芒。</p>
<p>——<a href="https://www.bilibili.com/read/cv11907285">东方莳梦原～Champaign of Unfinished Dreams</a> by 秋ノ宮飛鳥</p>
</blockquote>
<section id="一点随想" class="level2">
<h2 class="anchored" data-anchor-id="一点随想">一点随想</h2>
<p>2022 年 8 月 17 日夜，Ancient Temple 完成过半，月色入户，欣然开摆。</p>
<p>对，今天又是 8 月 17 日，是妖妖梦、风神录的发售日，<del>也是某个枪毙节</del>，还是某个新博客启用的周年纪念日——我又来写随想了。</p>
<p>18 年华灯宴 1U_s 大佬一曲<a href="https://b23.tv/FwrlLWL">十七岁</a>把我拉入红石音乐的大坑，到现在也有 4 年多了。随便聊聊感想，谈谈技术和非技术的各种话题。</p>
<p>我玩红乐，或许“科技靠考古的自闭造轮手”是个不错的形容。不加红石群、不更新版本，没人带没人陪，Google + Minecraft Wiki 在手，自己瞎倒腾，其他看造化。风格是 18 年的远古遗风——realpiano + 命令方块 + WorldEdit 的前进式、贪吃蛇式、下落式红石音乐大行其道的年头。到后来，特效红石音乐开始流行，但我心中的红乐早已定型。</p>
<p>我喜欢那个年代红石音乐特有的那种风格，那种朴素，但红石音乐完美融入场景的感觉。当年东方各作红石音乐全曲中就可见一斑——跟随红石信号一步步向前，如同听着 BGM 驾驶自机飞翔于道中，看版面缓缓向前伸展——STG 原作与 Minecraft 的奇妙融合让我着迷。我想做这样的红石音乐，我想做这样能化出心中幻想的红石音乐。</p>
<p>想做？音乐你懂吗？建筑你会吗？</p>
<p>不会，但可以学！</p>
<p>那你还会什么？</p>
<p>我是 OIer！我会编程！</p>
<p>这就是后来近三年红乐自动化尝试的开端。倒也开始稍微认真点的学习 MIDI、乐理以及其他各种各样的东西。</p>
<p>时间来到 20 年暑假。当时正好在玩 Python，偶然一搜，找到了 Raspberry Jam Mod 和 <a href="https://github.com/mido/mido">mido</a>——前者把 <a href="https://www.minecraft.net/en-us/edition/pi" class="uri">https://www.minecraft.net/en-us/edition/pi</a> 的 Python API 移植到 Java 版，后者提供在 Python 中处理 MIDI 文件的方法。</p>
<p>诶，这就不可以开工了吗！</p>
<p>肝能量发动，写了第一个能跑起来的脚本，随便丢了个正在做的第三版 Ancient Temple 进去听听——哎哟挺不错啊！</p>
<p>生产力工具上线，整活得以开始。要说最想做的，那一定是妖妖梦五面道中。对，就是 《东方妖妖梦 ~ Ancient Temple》。如 ZUN 所说，那是使古老寺院的空气突然升温的曲子。樱花上飘，楼观斩下……那是原作带来的难以忘怀的幻想。</p>
<p>但当时的我，没打算做，或者说有点不敢做。一方面，当然是 1U_s 大大的<a href="https://www.bilibili.com/video/BV1Gs411i7K9">妖妖梦红乐曲集</a>实在精彩，随手制作的五面道中已足以满足我自娱自乐的需求；二来也是对自己实力不太自信，怕做出自己也不太喜欢的作品。但 1U 的曲集毕竟是手工打造，两条音轨虽然意境极佳，但与原曲相比确也是捉襟见肘，而我手中的自动化可以极大程度地减轻工作量（虽然造轮子的过程没少花时间 (lll￢ω￢)）</p>
<p>所以到头来还是想做——或者下次一定？</p>
<p>那这次造啥呢？</p>
<p>余光瞄到刚退坑不久的 Dancing Line——说是舞线，其实脑子里全是 Through the Fog 的场景。回去重打 TTF 风暴的时候，听着 90% 后疯狂的雷声，突然想到 Minecraft 可以 <code>/weather rain</code> 可以 <code>/summon lightning_bolt</code>，加之场景想要偷懒的话搞个单层水世界就行，倒是试水的不错选择。</p>
<p>于是就开始试着扒谱。暑假结束，MIDI 是写好了，人却咕起来了。一咕就咕到了后一年的四月，忍不住了，爆肝三个周末整出来了。这个明显还是有很多问题的，首先曲子扒得就不太好，而且灯光一直到最后一小段才加上，另外前面下雨那段也太黑了。Sildur’s Vibrant Shader 的黑雷电问题也没解决，加上当时电脑太菜，Replaymod 录制还是挺难受的（不过预览模式倒是意外的贡献了个封面 XD），当然凑合能看。</p>
<p>后来就又到暑假了，打算一口气把 RMG 这个烂摊子写好，于是大刀阔斧的重构了，命名为 <a href="https://github.com/sun123zxy/redstone-music-generator">redstone-music-generator</a>，甚至还写了文档发了 Github，收获人生首 star &amp; issue（</p>
<p>或许是为了尝试 observer 的设计模式，亦或是太重视轮子的易用性，代码比较臃肿，过了几个月发现自己也很难看懂了。</p>
<p>其实写脚本主要还是给自己创作使用啊，没必要考虑太多“别人的需求”。</p>
<p>反思的结果就是新版的 redstone-music-generator 了，现暂存于原版本的 <code>develop</code> 分支下。这个版本再次重构，学习了某些命令行软件的做法，配置参数从之前在各个组件上的零散分布变为了单一配置文件的集中分布，显然提高了效率。</p>
<p>Ancient Temple 的 MIDI 也已经做到第五版了，这次以红乐的标准，大幅参考原曲 MIDI，期望能尽力还原出原作的表现。</p>
<p>鼓起勇气脱离咕海的动力来源，还是喜欢这曲子吧。说到底还是想把它做了再养老。</p>
<p>说起来，红石音乐到底应该怎样定义呢？之前 WorldEdit 的使用就已经引发过争议，那自动化搭建到底是红是黑？而在发声方面，是坚持音符盒的原教旨主义，还是命令方块的改良革新，甚至是更激进的 Midiout？</p>
<blockquote class="blockquote">
<p>up辛苦了，工作量能看出来。</p>
<p>但是原谅我还是很难接受这种从mc映射到外部midi播放器的格式。我觉得这并不能称作红石音乐，因为不是在mc内部完成播放的。</p>
<p>不过，用资源包和用接口，也不过只是内部调用和外部调用的区别罢了，也说不清…这是个哲学层次的问题。</p>
<p>红石音乐最后到底会变成什么样我也不知道，而且这种发展的方向和趋势我也没办法也没有理由去阻止。</p>
<p>我大概是，跟不上时代了吧…</p>
<p>——<a href="https://www.bilibili.com/video/BV1oW411a7eJ">【黑石音乐】aLIEz【接近完美的还原】_哔哩哔哩_bilibili</a> 下 <a href="https://space.bilibili.com/32262433">NJune六月</a> 的评论</p>
</blockquote>
<p>或许每个人心中的红乐标准都有所不同……或许我们只能求同存异，力求百花齐放，不要走火入魔。但最近粒子特效红石音乐的发展又让我感到困惑——一点红石、音符盒甚至命令方块都不出现，真的算红乐吗？那些炫酷的粒子特效，真的属于 Minecraft 吗？</p>
<p>只能交给时间回答了。我想，我能保证的，只是一颗全心投入、宁缺毋滥的创作心态；而我应该做的，是继续完成手头的作品。</p>
</section>
<section id="mc-指令相关" class="level2">
<h2 class="anchored" data-anchor-id="mc-指令相关">MC 指令相关</h2>
<section id="setblock-datavalue-block-state-and-data-tag-nbt" class="level3">
<h3 class="anchored" data-anchor-id="setblock-datavalue-block-state-and-data-tag-nbt">setblock, dataValue, block state and data tag (nbt)</h3>
<section id="扁平化前1.12-及以前" class="level4">
<h4 class="anchored" data-anchor-id="扁平化前1.12-及以前">扁平化前（1.12 及以前）</h4>
<p><code>setblock &lt;x&gt; &lt;y&gt; &lt;z&gt; &lt;block&gt; [dataValue|state] [oldBlockHandling] [dataTag]</code></p>
<p><code>dataValue</code> 和 <code>blockstate</code> 在扁平化之前是方块状态的两种不同描述方式，<code>dataValue</code> 是实际存储时使用的 4 bit 数据。通常，<code>blockstate</code> 或 <code>dataValue</code> 用来描述方块的一些基本性质，比如朝向 <code>facing</code>、羊毛的颜色 <code>color</code>、中继器的延迟刻数 <code>delay</code>。</p>
<p>具体写法例如：<code>/setblock ~ ~ ~1 minecraft:unpowered_repeater delay=4,facing=east</code> 设置一个延迟为 4 rt，面朝“东方”的红石中继器。（这里打上了引号，因为事实上<strong>红石中继器的 facing 代表的方向与信号传导的方向是相反的</strong>）</p>
<p>又，其效果等同于 <code>/setblock ~ ~ ~1 minecraft:unpowered_repeater 15</code>。（<code>dataValue = (delay - 1) * 4 + facing</code>，<code>facing=south|west|north|east</code> 分别对应 <code>0|1|2|3</code> 。默认值是 <code>north</code>）</p>
<p>再例如，<code>/setblock ~ ~ ~1 minecraft:command_block facing=down 0 {Command:"/time set 6000"}</code> 设置一个修改时间为正午的，面朝下方的命令方块。</p>
<p>中间的 <code>0</code> 是用来占位的。</p>
<p>查找某方块的 <code>dataValue</code> 和 <code>blockstate</code> 时可以翻阅 Minecraft Wiki 1.13 以前的历史版本（1.13 于 2018 年 6 月 18 日发布）</p>
</section>
<section id="扁平化后1.13-及以后" class="level4">
<h4 class="anchored" data-anchor-id="扁平化后1.13-及以后">扁平化后（1.13 及以后）</h4>
<p><code>setblock &lt;pos&gt; &lt;block&gt; [destroy|keep|replace]</code></p>
<p>其中 <code>&lt;block&gt;</code> 是 <code>block_state</code>， 具体的写法是 <code>namespaced_ID[block_states=value]{data_tags:value}</code></p>
<p>也就是说，原先的 <code>block</code>、<code>block_state</code> 和 <code>dataTag</code> 现在被统一整合入 <code>block_state</code> 里面，显然这更方便使用了。（然而作为考古学家，这好像也没法用上…）</p>
</section>
</section>
<section id="fallingsand-or-falling_block" class="level3">
<h3 class="anchored" data-anchor-id="fallingsand-or-falling_block">FallingSand or falling_block</h3>
<p>掉落方块实体。1.11 前它叫 <code>FallingSand</code>，1.11 及以后它叫 <code>falling_block</code>。</p>
<p>1.12 及以前可用 <code>/summon falling_block ~ ~ ~ {Block:minecraft:redstone_block,Time: 1}</code> 召唤掉落的红石块。Time 参数设置最长掉落时间，实际上会与 30 秒取最大值，但如果留空则会马上消失。</p>
<p>而 <code>/summon falling_block ~ ~ ~ {Block:"minecraft:wool", Data: 14, Time:1}</code> 可召唤掉落的红色羊毛。<code>Data</code> 标签自然与颜色对应了。</p>
<p>1.13 后由于扁平化更新了 <code>block_state</code> 的概念，指令格式变为 <code>/summon falling_block &lt;x&gt; &lt;y&gt; &lt;z&gt; {BlockState:{Name:&lt;Namespaced block ID&gt;,Properties:{&lt;blockstate_name&gt;:&lt;value&gt;}}}</code>。</p>
<p>参见：</p>
<ul>
<li><p><a href="https://minecraft.fandom.com/wiki/Falling_Block">Falling Block – Minecraft Wiki</a></p></li>
<li><p><a href="https://minecraft.fandom.com/wiki/Tutorials/Falling_blocks">Tutorials/Falling blocks – Minecraft Wiki</a></p></li>
<li><p><a href="https://minecraft.fandom.com/wiki/Tutorials/Command_NBT_tags#Entities">Tutorials/Command NBT tags – Minecraft Wiki</a></p></li>
</ul>
</section>
<section id="解决指令引号嵌套无法识别问题" class="level3">
<h3 class="anchored" data-anchor-id="解决指令引号嵌套无法识别问题">解决指令引号嵌套无法识别问题</h3>
<p>见 <a href="https://gaming.stackexchange.com/questions/246064/why-are-my-quotation-marks-causing-an-unexpected-token-error-with-this-command">minecraft java edition - Why are my quotation marks causing an “unexpected token” error with this command? - Arqade</a>，用 <code>\</code> 转义即可。</p>
</section>
</section>
<section id="mod资源包" class="level2">
<h2 class="anchored" data-anchor-id="mod资源包">mod、资源包</h2>
<p>注意此处提到的 mod 和资源包均只在其 1.12.2 对应版本下测试，不少功能在新版已经不需要 mod 了。</p>
<section id="worldedit" class="level3">
<h3 class="anchored" data-anchor-id="worldedit">WorldEdit</h3>
<p>建筑党老相识了，不细讲了，Google 一下你就知道。</p>
<ul>
<li><a href="https://worldedit.enginehub.org/en/latest/">WorldEdit Documentation</a></li>
</ul>
<p>用的多的命令 <code>copy</code>、<code>flip</code>、<code>rotate</code>、<code>paste</code>、<code>stack</code>、<code>set</code>、<code>replace</code>。当然还有最要命的 <code>undo</code> 啦（</p>
<p><code>schematic</code> 系列指令也很好用（用来偷建筑）（逃）</p>
</section>
<section id="voxelmap" class="level3">
<h3 class="anchored" data-anchor-id="voxelmap">VoxelMap</h3>
<p>常见的小地图，用来传送挺方便的。也不细讲了。</p>
</section>
<section id="tickratechanger" class="level3">
<h3 class="anchored" data-anchor-id="tickratechanger">TickrateChanger</h3>
<p><a href="https://www.curseforge.com/minecraft/mc-mods/tickratechanger">TickrateChanger - Mods - Minecraft - CurseForge</a></p>
<p>tickrate changer，就是字面意思嘛。改 tickrate 可以使游戏变快或变慢，从而实现精确调节 BPM。正常值 20。</p>
<p>但是有个挺烦的问题是调了过后声音的频率也随之改变了，这样音高就发生变化了…有大佬知道怎么办吗？</p>
</section>
<section id="colored-redstone" class="level3">
<h3 class="anchored" data-anchor-id="colored-redstone">Colored Redstone</h3>
<p><a href="https://www.curseforge.com/minecraft/mc-mods/colored-redstone">Colored Redstone - Mods - Minecraft - CurseForge</a></p>
<p>材质包编辑红石颜色失败后的替代品。具体细节有点忘了，只记得生成时 namespace 好像是 <code>coloredredstone:colored_redstone_block</code>，用 datavalue 来调颜色。（也忘了自己是怎么知道的了……好像是拆 jar 看的？）</p>
<p>顺序大概是这样：</p>
<p><img src="https://blog.sun123zxy.top/posts/20230217-rmg/colorful-redstone.jpg" class="img-fluid"></p>
</section>
<section id="invisiblights" class="level3">
<h3 class="anchored" data-anchor-id="invisiblights">InvisibLights</h3>
<p><a href="https://www.curseforge.com/minecraft/mc-mods/invisiblights">InvisibLights - Mods - Minecraft - CurseForge</a></p>
<p>材质包编辑发光材质失败后的替代品。字面义，作为隐形光源使用。</p>
</section>
<section id="realpiano-资源包" class="level3">
<h3 class="anchored" data-anchor-id="realpiano-资源包">realpiano 资源包</h3>
<p><a href="http://lkrb.net/blog/54.html">原出处</a>已挂，有个<a href="https://www.cr173.com/soft/277354.html">下载站</a>还有资源。</p>
<p>发声命令 <code>/execute @p ~ ~ ~ playsound lkrb.piano.p60fff voice @p ~ ~ ~"</code>，<code>C5 = 60</code>，音高 21 至 108，力度可选 <code>ppp,pp,p,mp,mf,f,ff,fff</code>。</p>
</section>
<section id="soma-资源包" class="level3">
<h3 class="anchored" data-anchor-id="soma-资源包">soma 资源包</h3>
<p>这个老强了，按 MIDI 音源标准制作的全套音色，长短音都有。</p>
<p>因为没怎么用就不细讲了。</p>
</section>
<section id="材质包编辑" class="level3">
<h3 class="anchored" data-anchor-id="材质包编辑">材质包编辑</h3>
<p>一开始是因为 SEUS v11.0 太黑看不清红石块，想找个方法让红石块自发光 。找了半天没找到的现成的，只好现学现做。</p>
<p>关于如何获取作为参考的 Default 材质包，参考 <a href="https://www.reddit.com/r/Minecraft/comments/47sycp/where_can_i_find_the_default_texture_pack_to_edit/">Where can I find the default texture pack to edit? : Minecraft</a>，直接把 <code>1.12.2.jar</code> 解压后里面的 <code>assets</code> 文件夹提到资源包里就可以用了，意外的方便啊（</p>
<p>（其实 mod 的 jar 里面也有这个文件夹！）</p>
<p>参考 <a href="https://optifine.readthedocs.io/emissive_textures.html">Emissive Textures - OptiFine documentation</a>，只需在材质包放置 <code>/assets/minecraft/optifine/emissive.properties</code> 和 <code>/assets/minecraft/textures/blocks/redstone_block_e.png</code>，<code>emissive.properties</code> 里写上 <code>suffix.emissive=_e</code> 就可以了。</p>
<p>1.12 差不多也算是古董版本了，参考网上教程时还需注意版本差异。</p>
<p>于是兴高采烈的准备用到掉落式红石钢琴上，发现——欸？光呢？？？</p>
<p>于是发现了 <a href="https://github.com/sp614x/optifine/issues/1342">Emissive textures not working for certain entities and items · Issue #1342 · sp614x/optifine · GitHub</a>——woc，这不是 xwj 大佬吗？？？</p>
<p>所以人家 18 年就把这些东西玩透了……<del>只有红石音乐作者才能发现的 bug</del></p>
<p>这个 Issue 至今 open，一下不知道怎么办了…只能暂时搁置。后来使用上文提到的 Colored Redstone 和 invisiblights 解决问题。</p>
<p>此外，发现同一地点方块贴图始终一致，这说明随机种子由位置决定。但作为 Falling_block 生成时，全都只会用第一个贴图。</p>
</section>
</section>
<section id="mcpi-和-raspberryjammod-相关" class="level2">
<h2 class="anchored" data-anchor-id="mcpi-和-raspberryjammod-相关">MCPI 和 RaspberryJamMod 相关</h2>
<p>RaspberryJamMod：把 <a href="https://www.minecraft.net/en-us/edition/pi">Minecraft: Pi Edition</a> 的 Python API 移植到 Java 版的一款 mod。</p>
<ul>
<li>Github 库：<a href="https://github.com/arpruss/raspberryjammod">GitHub - arpruss/raspberryjammod: Raspberry Jam Mod - a Mod Forge Minecraft mod implementing most of Raspberry Juice/Pi API</a></li>
<li>官方指南：<a href="https://www.instructables.com/Python-coding-for-Minecraft/">Python Coding for Minecraft : 18 Steps (with Pictures) - Instructables</a></li>
<li>Minecraft: Pi Edition 的 API：<a href="https://www.stuffaboutcode.com/p/minecraft-api-reference.html">Minecraft: Pi Edition API</a></li>
</ul>
<section id="mcpi-block-类在-setblock-setblockwithnbt-中的使用" class="level3">
<h3 class="anchored" data-anchor-id="mcpi-block-类在-setblock-setblockwithnbt-中的使用">MCPI Block 类在 setBlock &amp; setBlockWithNBT 中的使用</h3>
<p><code>Block</code> 类被封装成了包含三个元素 <code>id:int</code>, <code>data:int</code>, <code>nbt:str</code> 的“数组”，在 <code>setBlock</code> 和 <code>setBlockWithNBT</code> 中直接使用 <code>Block</code> 类会被 <code>flatten()</code> 或 <code>floorFlatten()</code> 函数“拍扁”成分散的参数。一个 <code>Block</code> 对象只可能被拍扁成 <code>data, id</code> 或 <code>id, data, nbt</code>，取决于该对象是否设置了 <code>nbt</code> （用 <code>None</code> 判断）。</p>
<p>因此，需要自定义 <code>data</code> 时，不能使用 <code>block</code> 模块的预设方块。</p>
<p><code>Vec3</code> 类也可被拍扁。</p>
<p>例如：</p>
<ul>
<li><code>setBlock(Vec3(0,0,0), 137, 2)</code> 等同于 <code>mc.setBlock(Vec3(0,0,0), Block(137, 2))</code></li>
<li><code>setBlockWithNBT(Vec3(0,0,0), 137, 2, '{Command:"your command"}')</code> 等同于 <code>setBlockWithNBT(Vec3(0,0,0), Block(137, 2), '{Command:"your command"}')</code> 等同于 <code>setBlockWithNBT(Vec3(0,0,0), Block(137, 2, '{Command:"your command"}'))</code></li>
</ul>
<p>需要注意的是， <code>setBlock()</code> 不能接受 <code>nbt</code> 参数或带 <code>nbt</code> 的 <code>Block</code> 对象，否则会报错。而 <code>setBlockWithNBT()</code> 则有无 <code>nbt</code> 皆可。</p>
</section>
<section id="关于-mcpi-与游戏内的坐标差" class="level3">
<h3 class="anchored" data-anchor-id="关于-mcpi-与游戏内的坐标差">关于 MCPI 与游戏内的坐标差</h3>
<p>见 <a href="https://stackoverflow.com/questions/70747581/python-minecraft-coordinates-trouble">Python + Minecraft Coordinates Trouble - Stack Overflow</a>：</p>
<blockquote class="blockquote">
<p>getPos, getTilePos, setPos and setTilePos all appear to be relative to the player’s spawn point at least in a single player world. I am going through trying to teleport my character but the coordinates I end up on are not the world’s coordinates but a coordinate relative to where my character would spawn.</p>
</blockquote>
<blockquote class="blockquote">
<p>So, either fix an offset of 66 blocks into the y-axis values, or manually set the world spawn to <code>(0, 0, 0)</code> with <code>/setworldspawn</code>.</p>
</blockquote>
</section>
</section>
<section id="自制轮子" class="level2">
<h2 class="anchored" data-anchor-id="自制轮子">自制轮子</h2>
<section id="redstone-music-generator旧版" class="level3">
<h3 class="anchored" data-anchor-id="redstone-music-generator旧版">redstone-music-generator（旧版）</h3>
<p>（这是重构旧版前再次阅读代码后的小报告）</p>
<p>大概使用了 observer 的设计模式，写了类似 C# 中的 Event，Delegate 暂时还没有封装，稍微有点混乱。</p>
<p>自己写了一些工具类，然后弄了个 <code>MIDIHandler</code> 预处理 MIDI 文件。</p>
<p>整个生成在最上层由 <code>RMG</code> 类管，<code>RMG</code> 读取 <code>MIDIHandler</code> 的信息然后触发绑定在 <code>RMG</code> 上的各种 <code>onNote()</code>、<code>onBeat()</code> 函数（触发过程由封装的 <code>Event</code> 类实现）。通过设置 <code>RMG</code> 的成员变量可以设置例如要生成的音轨、起始终止拍等参数。</p>
<p>然后各种插件都丢在了 <code>observer.py</code> 里。这些插件接受各种需要的信息（当前音符编号、音高等），一些是用于生成 <code>Vec3</code> 或 <code>Block</code> 的 <code>XXXPosGen</code> 和 <code>XXXBlockGen</code>（还没有给他们写基类，主要是现在还没封装 Delegate），另一些是包含 <code>onNote()</code>、<code>onBeat()</code>，用来绑在 <code>RMG</code> 上的插件。（注意绑在 <code>RMG</code> 上的是函数而不是插件本身！）每个插件都有自己的参数，插件之间也可以相互嵌套（例如 <code>GroundedAdvancing</code> 里面就套了个 <code>SingleBlock</code>）。插件存在的目的是为各个输出函数 <code>onNote()</code>、<code>onBeat()</code> 统一设置参数。（这里是否可以再改的函数式编程一点？）</p>
<p>现在有一个问题就是 PosGen 和 BlockGen 分开了，有 Issue 提到想要自定义每个 Note 下放的 partBlock，像这样搞就很麻烦。</p>
<p>应该有一个把 PosGen 和 BlockGen 合起来的方案，最好是能独立表示多个方块及其位置信息的一个整体。</p>
</section>
<section id="redstone-music-generator新版" class="level3">
<h3 class="anchored" data-anchor-id="redstone-music-generator新版">redstone-music-generator（新版）</h3>
<p>TODO（咕咕咕）</p>
<p>temp: <code>/execute @p ~ ~ ~ playsound block.note.guitar voice @p ~ ~ ~</code></p>


</section>
</section>

 ]]></description>
  <category>回忆</category>
  <category>Minecraft</category>
  <category>音乐</category>
  <category>Python</category>
  <guid>https://blog.sun123zxy.top/posts/20230217-rmg/</guid>
  <pubDate>Thu, 16 Feb 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>str 学数学 题解</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230213-strwithmath/</link>
  <description><![CDATA[ 




<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-problem" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (str 学数学)</strong></span> str 同学因为名字里含有一个 str，所以觉得字符串对于他来说太简单了，于是他开始了他的数学之旅。</p>
<p>在旅途中str遇到了刚抽到胡桃的 lyl，而 lyl 同学正沉浸在出货的喜悦之中，为了能收获双倍喜悦，他便询问 str，他选的区间内有多少个幸运数字，str觉得这个问题和字符串一样简单，于是把这个问题交给了你。</p>
<p>共有 <img src="https://latex.codecogs.com/png.latex?T"> 组询问，每次给出两个正整数 <img src="https://latex.codecogs.com/png.latex?L,R">，你需要判断有多少 <img src="https://latex.codecogs.com/png.latex?n">，<img src="https://latex.codecogs.com/png.latex?L%20%5Cleq%20n%20%5Cleq%20R"> 使得方程 <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B4%7D%0A"> 成立。</p>
<p>请输出你得到的答案。</p>
<p>数据范围：<img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20T%20%5Cleq%2010000">，<img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20L%20%5Cleq%20R%20%5Cleq%2010%5E7"></p>
<p>样例输入：</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1">4</span>
<span id="cb1-2">1 4</span>
<span id="cb1-3">2 8</span>
<span id="cb1-4">1 10</span>
<span id="cb1-5">1 100</span></code></pre></div>
<p>样例输出：</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1">3</span>
<span id="cb2-2">3</span>
<span id="cb2-3">5</span>
<span id="cb2-4">26</span></code></pre></div>
<p>来源：2023 年寒假集训 B 组总结赛</p>
</div>
</div>
</div>
</div>
<p>考场上当然是打表找规律了，但非常愚钝地没看出来……</p>
<p>结论是，<img src="https://latex.codecogs.com/png.latex?n"> 是一个幸运数字，当且仅当 <img src="https://latex.codecogs.com/png.latex?n+1"> 是一个质数。下面提供两种证明方法。</p>
<section id="official-solution" class="level2">
<h2 class="anchored" data-anchor-id="official-solution">Official Solution</h2>
<p>出题人提供的非常有技巧性的解法。</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B4%7D%0A"></p>
<p>考虑为 <img src="https://latex.codecogs.com/png.latex?%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Crfloor"> 配对，</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20+%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bi(n-j+1)%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20&amp;=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B2%7D%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20+%20%5Cleft%20%5Clfloor%20i%20-%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20&amp;=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B2%7D%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20i%20-%20%5B%20n+1%20%5Cnmid%20ij%20%5D%20&amp;=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B2%7D%20%5C%5C%0A%5Cfrac%7Bn%5E2%20(n+1)%7D%7B2%7D%20-%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5B%20n+1%20%5Cnmid%20ij%20%5D%20&amp;=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B2%7D%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5B%20n+1%20%5Cnmid%20ij%20%5D%20&amp;=%20n%5E2%0A%5Cend%7Baligned%7D%0A"></p>
<p>即要求 <img src="https://latex.codecogs.com/png.latex?n+1%20%5Cnmid%20ij"> 对任意 <img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20i,j%20%5Cleq%20n"> 成立。因此根据质数定义，<img src="https://latex.codecogs.com/png.latex?n+1"> 就是且只能是质数了。</p>
</section>
<section id="alternative-solution" class="level2">
<h2 class="anchored" data-anchor-id="alternative-solution">Alternative Solution</h2>
<p>考场上推了一半的想法。</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)%7D%7B4%7D%0A"></p>
<p>注意到 <img src="https://latex.codecogs.com/png.latex?a%20%5Cbmod%20b%20=%20a%20-%20b%20%5Clfloor%20%5Cfrac%20a%20b%20%5Crfloor">，考虑构造取模</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20(n+1)%20%5Cleft%20%5Clfloor%20%5Cfrac%20%7Bij%7D%20%7Bn+1%7D%20%5Cright%20%5Crfloor%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)(n+1)%7D%7B4%7D%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20ij%20-%20ij%20%5Cbmod%20(n+1)%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)(n+1)%7D%7B4%7D%20%5C%5C%0A%5Cleft(%20%5Cfrac%20%7Bn(n+1)%7D%7B2%7D%20%5Cright)%5E2%20-%20%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20ij%20%5Cbmod%20(n+1)%20=%20%5Cfrac%20%7Bn%5E2%20(n-1)(n+1)%7D%7B4%7D%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20ij%20%5Cbmod%20(n+1)%20=%20%5Cfrac%20%7Bn%5E2%20(n+1)%7D%20%7B2%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>考虑固定 <img src="https://latex.codecogs.com/png.latex?i">，研究 <img src="https://latex.codecogs.com/png.latex?j"> 变化下左式的情况。方便起见，我们将上式左侧 <img src="https://latex.codecogs.com/png.latex?j"> 的取值范围扩展至 <img src="https://latex.codecogs.com/png.latex?0"> 到 <img src="https://latex.codecogs.com/png.latex?n">： <img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=0%7D%5En%20ij%20%5Cbmod%20(n+1)%20=%20%5Cfrac%20%7Bn%5E2%20(n+1)%7D%20%7B2%7D%0A"> 细心的读者或许已经发现，当 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(i,n+1)%20=%201"> 恒成立，即 <img src="https://latex.codecogs.com/png.latex?n+1"> 为质数时，<img src="https://latex.codecogs.com/png.latex?ij%20%5Cbmod%20(n+1)"> 将取遍 <img src="https://latex.codecogs.com/png.latex?0"> 到 <img src="https://latex.codecogs.com/png.latex?n">，此时左右两式相等。下面我们证明这是上式相等的充分必要条件。</p>
<p>仍从 <img src="https://latex.codecogs.com/png.latex?ij%20%5Cbmod%20(n+1)"> 的取值下手，我们研究如下以 <img src="https://latex.codecogs.com/png.latex?j"> 和 <img src="https://latex.codecogs.com/png.latex?t"> 为变量的不定方程的解 <img src="https://latex.codecogs.com/png.latex?%0Aij%20+%20(n+1)%20t%20=%20m%20%5Cpod%7B0%20%5Cleq%20m%20%3C%20n+1%7D%0A"> 由裴蜀定理（Bézout’s identity），方程有解的充分必要条件为 <img src="https://latex.codecogs.com/png.latex?%5Cgcd(i,n+1)%20%5Cmid%20m">。不妨记 <img src="https://latex.codecogs.com/png.latex?d%20=%20%5Cgcd(i,n+1)">，<img src="https://latex.codecogs.com/png.latex?m%20=%20k%20d">，方程变为 <img src="https://latex.codecogs.com/png.latex?%0Aij%20+%20(n+1)%20t%20=%20kd%20%5Cpod%7B0%20%5Cleq%20k%20%3C%20%5Cfrac%20%7Bn+1%7D%20d%7D%0A"> 写出该不定方程的通解 <img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%20%5C%7B%0A%5Cbegin%7Baligned%7D%0Aj%20&amp;=%20j_0%20+%20s%20%5Ccdot%20%5Cfrac%7Bn+1%7D%7Bd%7D%5C%5C%0At%20&amp;=%20t_0%20-%20s%20%5Ccdot%20%5Cfrac%7Bi%7D%7Bd%7D%0A%5Cend%7Baligned%7D%0A%5Cright%20.%20%5Cpod%7Bs%20%5Cin%20%5Cmathbb%20Z%7D%0A"> 不难发现，对 <img src="https://latex.codecogs.com/png.latex?0%20%5Cle%20k%20%3C%20%5Cfrac%20n%20d">，上述不定方程在 <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20j%20%5Cleq%20n"> 的范围内总有 <img src="https://latex.codecogs.com/png.latex?d"> 个解，这意味着 <img src="https://latex.codecogs.com/png.latex?ij%20%5Cbmod%20(n+1)"> 将有 <img src="https://latex.codecogs.com/png.latex?d"> 次取到 <img src="https://latex.codecogs.com/png.latex?kd">。故我们有 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20%5Csum_%7Bj=1%7D%5En%20ij%20%5Cbmod%20(n+1)%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20d%20%5Csum_%7Bk=0%7D%5E%7B%5Cfrac%20%7Bn+1%7D%7Bd%7D%20-1%7D%20kd%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20d%5E2%20%5Csum_%7Bk=0%7D%5E%7B%5Cfrac%20%7Bn+1%7D%7Bd%7D%20-1%7D%20k%20%5C%5C%0A&amp;=%20%5Cfrac%201%202%20%5Csum_%7Bi=1%7D%5En%20d%5E2%20%5Cleft(%20%5Cfrac%20%7Bn+1%7D%20d%20-%201%20%5Cright)%20%5Cfrac%20%7Bn+1%7D%20d%20%5C%5C%0A&amp;=%20%5Cfrac%20%7Bn+1%7D%202%20%5Csum_%7Bi=1%7D%5En%20(n+1-d)%20=%20%5Cfrac%7Bn%5E2%20(n+1)%7D%7B2%7D%0A%5Cend%7Baligned%7D%0A"> 化简即得 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Csum_%7Bi=1%7D%5En%20(n+1-d)%20&amp;=%20n%5E2%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20d%20&amp;=%20n%20%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%5Cgcd(i,%20n+1)%20&amp;=%20n%0A%5Cend%7Baligned%7D%0A"> 显然上式等价于对任意 <img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20i%20%5Cleq%20n">，<img src="https://latex.codecogs.com/png.latex?%5Cgcd(i,%20n+1)%20=%201"> 恒成立。因此我们证明了 <img src="https://latex.codecogs.com/png.latex?n+1"> 是质数是原方程成立的充分必要条件。</p>


</section>

 ]]></description>
  <category>OI</category>
  <category>数学</category>
  <category>题解</category>
  <guid>https://blog.sun123zxy.top/posts/20230213-strwithmath/</guid>
  <pubDate>Sun, 12 Feb 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>算法竞赛向 C++ Standard Library 使用速查</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20230124-stl/</link>
  <description><![CDATA[ 




<p>本文旨在对算法竞赛所需 C++ Standard Library 做一个全面而相对严谨的总结。</p>
<p>全文主要参考以下文档：</p>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/container">Containers library - cppreference.com</a></li>
<li><a href="https://oi-wiki.org/lang/csl/">C++ 标准库简介 - OI Wiki</a></li>
</ul>
<p>如有能力，阅读原文可获得更深入的了解。</p>
<section id="stl-算法" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="stl-算法"><span class="header-section-number">1</span> STL 算法</h2>
<p>均在 <code>#include&lt;algorithm&gt;</code> 定义。</p>
<ul>
<li><p><code>std::sort(first,last,cmp)</code></p>
<p>排序为不降序列。</p>
<p>接受随机访问迭代器。可自定义比较函数。</p>
<p>平均时间复杂度 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)">，C++11 后严格 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)">。</p></li>
<li><p><code>std::stable_sort(first,last,cmp)</code></p>
<p>排序为不降序列，且保持相等元素的顺序。</p></li>
<li><p><code>std::lower_bound(first,last,val,cmp)</code></p>
<p>返回指向首个不小于 <code>val</code> 的元素的迭代器，如无，返回 <code>last</code>。</p>
<p>要求小于 <code>val</code> 的值和大于等于 <code>val</code> 的值分居区间两侧。</p>
<p>可自定义比较函数。若迭代器支持随机访问，对数时间复杂度，否则为线性。</p></li>
<li><p><code>std::upper_bound(first,last,val,cmp)</code></p>
<p>返回指向首个大于 <code>val</code> 的元素的迭代器，如无，返回 <code>last</code>。</p></li>
<li><p><code>std::unique(first,last,cmp)</code></p>
<p>保留区间中所有连续等值区间的首个元素组成新序列，返回处理后序列的尾迭代器。</p>
<p>接受前向迭代器，可自定义判断相等的函数。</p>
<p>线性时间复杂度。</p></li>
</ul>
</section>
<section id="基本或特殊容器" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="基本或特殊容器"><span class="header-section-number">2</span> 基本或特殊容器</h2>
<p>注：C++11 新引入的容器，大部分头文件名与容器名一致。</p>
<ul>
<li><code>pair</code> <code>#include&lt;utility&gt;</code> ：元素对。</li>
<li><code>tuple</code> (C++11) ：元组。</li>
<li><code>bitset</code> <code>#include&lt;bitset&gt;</code> ：定长压缩 01 串，可在 <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%20N%20K)"> 的时空复杂度内完成常见运算，<img src="https://latex.codecogs.com/png.latex?K"> 对应操作系统位数。</li>
<li><code>string</code> <code>#include&lt;string&gt;</code> ：字符串。</li>
</ul>
<section id="pair" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="pair"><span class="header-section-number">2.1</span> pair</h3>
<ul>
<li><code>operator=</code> ：重载了赋值运算符用于拷贝。</li>
<li><code>first</code> / <code>second</code> ：访问第一项或第二项。</li>
<li><code>std::make_pair(a,b)</code> ：新建元素对，自动检测类型。</li>
<li><code>operator&lt;=&gt;</code> ：重载了各种比较运算符，按第一关键字、第二关键字顺序比较。</li>
</ul>
</section>
<section id="tuple" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="tuple"><span class="header-section-number">2.2</span> tuple</h3>
<ul>
<li><code>operator=</code> ：重载了赋值运算符用于拷贝。</li>
<li><code>std::get&lt;i&gt;(tp)</code> ：获取元组的第 i 项。</li>
<li><code>std::get&lt;T&gt;(tp)</code> ：获取元组中类型为 T 的项。</li>
<li><code>std::tie(a,b,...)</code> ：构造一个变量引用构成的元组．用于在赋值时将等号右侧的元组解包到左侧的 <code>a,b,...</code> 等变量中。</li>
<li><code>std::make_tuple(a,b,c,...)</code>：新建元组，自动检测类型。</li>
<li><code>operator&lt;=&gt;</code> ：重载比较运算符，同样是顺序关键字比较。</li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>下面是一个应用 C++11 新引入的元组和列表初始化的 ExGCD 实现。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> Tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-2">Tuple exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb1-4">    ll x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> tie<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)=</span>exgcd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)*</span>y1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb1-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="string" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="string"><span class="header-section-number">2.3</span> string</h3>
<p>与 <code>vector</code> 类似。其余重要特性如下：</p>
<ul>
<li><code>c_str()</code> ：生成一个 C 风格字符串（尾部置 0）并返回其头部指针。</li>
<li><code>length()</code> ：<code>size()</code> 的同义函数。</li>
<li><code>append(str)</code> ：后方追加字符串，返回 <code>*this</code>。</li>
<li><code>append(first, last)</code> ：区间插入版本。</li>
<li><code>operator+</code> ：连接两个字符串。</li>
<li><code>compare(str)</code> ：字典序比较。返回一个 <code>int</code>，用 <code>&lt;0</code> / <code>==0</code> / <code>&gt;0</code> 判断该字符串小于 / 等于 / 大于参数字符串。</li>
<li><code>operator&lt;=&gt;</code> ：字典序比较的运算符重载。</li>
<li><code>substr(pos=0, count)</code>：返回 <code>[pos, min(pos+count, size()))</code> 的子串。时间复杂度与 <code>count</code> 成线性。</li>
<li><code>pop_back()</code> (C++11)</li>
<li><code>find(str)</code> / <code>rfind(str)</code> / <code>find_first_of(c)</code> / <code>find_first_not_of(c)</code> / <code>find_last_of(c)</code> / <code>find_last_not_of(c)</code>：找字符串或字符，返回位置。若无，返回 <code>npos=-1</code>。<strong>无时间复杂度保证</strong>，不建议使用。</li>
</ul>
</section>
<section id="bitset" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="bitset"><span class="header-section-number">2.4</span> bitset</h3>
<p><code>bitset&lt;N&gt; bs(val / str)</code>：声明一个长度为 N 的 <code>bitset</code> 并设定初值。</p>
<ul>
<li><code>&amp; / ! / ^ / ~ / &gt;&gt; / &lt;&lt;</code> ：支持 AND / OR / XOR / NOT / 右移 / 左移等位运算系列。</li>
<li><code>operator==</code> ：判断两个 <code>bitset</code> 是否相同。</li>
<li><code>test(idx) / operator[idx]</code> ：前者会做越界检查，抛出异常。</li>
<li><code>size()</code></li>
<li><code>count()</code> ：返回 1 的个数。</li>
<li><code>all()</code> (C++11) ：检查是否全为 1。</li>
<li><code>any() / none()</code> ：检查是否存在 1 / 没有 1。</li>
<li><code>set() / reset()</code> ：所有位赋 1 / 0。</li>
<li><code>flip()</code> ：翻转 0 / 1。</li>
</ul>
</section>
</section>
<section id="stl-容器概览" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="stl-容器概览"><span class="header-section-number">3</span> STL 容器概览</h2>
<p>以下部分均为 STL 容器相关内容。</p>
<section id="迭代器" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="迭代器"><span class="header-section-number">3.1</span> 迭代器</h3>
<p>声明：形如 <code>vector&lt;int&gt;::iterator iter = xxx.begin()</code>。C++11 后可用 <code>auto</code> 代替类型声明。</p>
<p><code>*iter</code> 取值，<code>iter++</code> 后继。</p>
<p>双向迭代器可 <code>iter--</code>，随机访问迭代器支持加减、比较运算。</p>
<ul>
<li><code>begin()</code>, <code>end()</code> ：返回迭代器。<code>end()</code> 常作为 NULL 使用。</li>
<li><code>cbegin()</code>, <code>cend()</code> (C++11) ：部分容器支持，返回只读迭代器。</li>
<li><code>rbegin()</code>, <code>rend()</code> ：部分容器支持，返回反向迭代器。</li>
<li><code>crbegin()</code>, <code>crend()</code> ：部分容器支持，返回只读反向迭代器。</li>
</ul>
</section>
<section id="公共性质" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="公共性质"><span class="header-section-number">3.2</span> 公共性质</h3>
<ul>
<li><code>[first, last)</code> 式迭代器构造，拷贝构造等。</li>
<li><code>operator=</code> ：重载了赋值运算符用于拷贝。</li>
<li><code>empty()</code> ：返回容器是否为空，即 <code>v.begin() == v.end()</code>。</li>
<li><code>size()</code> ：返回容器内元素个数。</li>
<li><code>clear()</code> ：清空容器。</li>
</ul>
</section>
</section>
<section id="序列式容器或容器适配器" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="序列式容器或容器适配器"><span class="header-section-number">4</span> 序列式容器或容器适配器</h2>
<p>序列式容器：</p>
<ul>
<li><code>array</code> (C++11) ：定长顺序表，常数随机访问。</li>
<li><code>vector</code> <code>#include&lt;vector&gt;</code>：顺序表，常数后段插入，常数随机访问。</li>
<li><code>deque</code> <code>#include&lt;deque&gt;</code> ：顺序表，常数双端插入，<strong>常数随机访问</strong>。</li>
<li><code>list</code> <code>#include&lt;list&gt;</code> ：链表，常数插入删除，双向迭代器。
<ul>
<li><code>forward_list</code> (C++11) ：单向版本。</li>
</ul></li>
</ul>
<p>容器适配器（均不支持迭代器）：</p>
<ul>
<li><code>queue</code> <code>#include&lt;queue&gt;</code>：队列（FIFO）。适配双向变长序列式容器，即 <code>deque</code>（默认）或 <code>list</code>。</li>
<li><code>stack</code> <code>#include&lt;stack&gt;</code>：栈（LIFO）。适配变长序列式容器，即 <code>deque</code>（默认）、<code>vector</code>或 <code>list</code>。</li>
<li><code>priority_queue</code> <code>#include&lt;queue&gt;</code>：大根堆。适配随机访问变长序列式容器，即 <code>vector</code>（默认）或 <code>deque</code>。</li>
</ul>
<section id="vector" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="vector"><span class="header-section-number">4.1</span> vector</h3>
<p>Construct:</p>
<ul>
<li><code>vector&lt;T&gt;(count,value)</code> ：初始化时放 <code>count</code> 个 <code>value</code> 的拷贝在里面。</li>
</ul>
<p>Access:</p>
<ul>
<li><code>crbegin()</code></li>
<li><code>at(idx)</code> / <code>operator[idx]</code> ：前者会做越界检查，抛出异常。</li>
<li><code>front()</code>, <code>back()</code> ：返回首尾元素引用。</li>
</ul>
<p>Modify:</p>
<ul>
<li><code>push_back(x)</code> / <code>pop_back()</code> ：均摊常数复杂度。</li>
<li><code>insert(iter, val)</code> ：于迭代器 <code>iter</code> 前插入，返回指向被插入元素的迭代器。 <code>insert(iter, first, last)</code> ：左闭右开区间插入，返回指向首个被插入元素的迭代器。 注意，此操作<strong>非常数时间复杂度</strong>。</li>
<li><code>erase(iter)</code> ：于迭代器 <code>iter</code> 处删除，返回指向被删除元素的后一个元素的迭代器。 <code>erase(first, last)</code> ：左闭右开区间删除，返回指向被删除元素的后一个元素的迭代器。 注意，此操作<strong>非常数时间复杂度</strong>。</li>
</ul>
<p>Size:</p>
<ul>
<li><code>resize(n)</code> ：改变长度，可指定补充元素默认值。</li>
<li><code>shrink_to_fit()</code> ：调整为恰好长度。</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><code>vector&lt;bool&gt;</code> 被特殊定义，使用方式较为复杂，<strong>不建议使用</strong>。</p>
</div>
</div>
</div>
</section>
<section id="deque" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="deque"><span class="header-section-number">4.2</span> deque</h3>
<ul>
<li><code>push_front(x)</code>, <code>pop_front()</code></li>
</ul>
<p>其余与 <code>vector</code> 类似。</p>
<section id="stack" class="level4">
<h4 class="anchored" data-anchor-id="stack">stack</h4>
<ul>
<li><code>top()</code></li>
<li><code>push(x)</code></li>
<li><code>pop()</code></li>
</ul>
</section>
<section id="queue" class="level4">
<h4 class="anchored" data-anchor-id="queue">queue</h4>
<ul>
<li><code>front()</code></li>
<li><code>push(x)</code></li>
<li><code>pop()</code></li>
</ul>
</section>
<section id="priority_queue" class="level4">
<h4 class="anchored" data-anchor-id="priority_queue">priority_queue</h4>
<ul>
<li><code>std::priority_queue&lt;TypeName&gt;</code> ：<code>Compare</code> 默认使用 <code>std::less&lt;T&gt;</code>，即以 <code>operator &lt;</code> 作为大根堆的比较依据。</li>
<li><code>std::priority_queue&lt;TypeName, Container, Compare&gt;</code> ：亦可自行指定底层容器和比较函数对象。</li>
</ul>
<p>例如，传入 <code>std::greater&lt;T&gt;</code> 将使用 <code>&gt;</code> 作为比较符号，进而构造出小根堆。</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>自定义比较函数对象，可仿照以下代码：</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb2-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;queue&gt;</span></span>
<span id="cb2-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;vector&gt;</span></span>
<span id="cb2-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb2-6">    ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-7">    Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){}</span></span>
<span id="cb2-8">    Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb2-9">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-10">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb2-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb2-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> vecCompare<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb2-13">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb2-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb2-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb2-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb2-17"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb2-18">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>priority_queue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;,</span> vecCompare <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-19">    H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb2-20">    H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb2-21">    Vec t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>H<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>top<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb2-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-23"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
</div>
</div>
<p>用法基本同 <code>queue</code>，但 <code>push() / pop()</code> 为对数时间复杂度。</p>
</section>
</section>
<section id="list" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="list"><span class="header-section-number">4.3</span> list</h3>
<ul>
<li>无随机访问接口。</li>
<li><code>insert(iter, val)</code> / <code>erase(iter)</code> ：插入与删除变为常数时间复杂度，参见 <code>vector</code>。</li>
<li><code>sort(cmp)</code> ：为链表特殊设计的 <img src="https://latex.codecogs.com/png.latex?O(n%20%5Clog%20n)"> 稳定排序算法。</li>
</ul>
<p>其余与 <code>deque</code> 类似。</p>
</section>
</section>
<section id="关联式容器" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="关联式容器"><span class="header-section-number">5</span> 关联式容器</h2>
<p>不支持随机访问，双向迭代器，大部分操作为对数时间复杂度，红黑树实现。</p>
<ul>
<li><code>set</code> / <code>multiset</code> <code>#include&lt;set&gt;</code>：元素有序。后者支持同值多元素。</li>
<li><code>map</code> / <code>multimap</code> <code>#include&lt;map&gt;</code>：键有序。后者支持同键值多元素。</li>
</ul>
<section id="set-multiset" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="set-multiset"><span class="header-section-number">5.1</span> set / multiset</h3>
<ul>
<li><code>set&lt;Key&gt;</code>：默认使用 <code>operator &lt;</code> 比较（升序）。</li>
<li><code>set&lt;Key, Compare&gt;</code>：也可使用类似 <code>priority_queue</code> 的方法自定义比较函数对象 <code>Compare</code>。</li>
</ul>
<p>Access：</p>
<ul>
<li><code>crbegin()</code></li>
<li><code>count(x)</code> ：返回值为 <code>x</code> 的元素数量。</li>
<li><code>lower_bound(x)</code> / <code>upper_bound(x)</code> ：为 <code>set</code> 特殊定制的对数时间复杂度 <code>lower_bound</code> 和 <code>upper_bound</code>。</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>没有 <code>nth_element()</code>，对数时间复杂度查询第 k 大需自行手写平衡树或使用 pbds 库。</p>
</div>
</div>
</div>
<p>Modify:</p>
<ul>
<li><code>insert(x)</code> ：插入元素 x。返回 <code>pair&lt;iterator, bool&gt;</code>，表示插入元素的迭代器与插入是否成功。 对于 <code>multiset</code>，由于插入不会失败，<code>insert</code> 只返回迭代器。</li>
<li><code>erase(x)</code> ：删除所有值为 x 的元素，返回删除元素的个数。 <code>erase(iter)</code> ：删除迭代器指向的元素，(C++11) 返回指向被删除元素的后一个元素的迭代器。 <code>erase(first, last)</code>：左闭右开区间删除，(C++11) 返回指向被删除元素的后一个元素的迭代器。</li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>删除单个值为 x 的元素，可按如下方法进行：</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">auto</span> it <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>find<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-2">s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>erase<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>it<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span></code></pre></div>
</div>
</div>
</div>
</section>
<section id="map-multimap" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="map-multimap"><span class="header-section-number">5.2</span> map / multimap</h3>
<p><code>map&lt;Key, T, Compare&gt;</code>：可自定义比较方式。</p>
<ul>
<li>对迭代器解引用得到 <code>pair&lt;Key, T&gt;</code>。</li>
<li><code>insert(pair&lt;Key, T&gt;)</code></li>
<li><code>at[key]</code> / <code>operator[key]</code>：前者会做越界检查，抛出异常。</li>
</ul>
<p>其余与 <code>set</code> 类似。</p>
</section>
</section>
<section id="无序关联式容器-c11" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="无序关联式容器-c11"><span class="header-section-number">6</span> 无序关联式容器 (C++11)</h2>
<p>单向迭代器，平均常数时间复杂度，Hash 实现。</p>
<p>若不支持 c++11，使用时需引入 TR1 扩展。例如，使用 <code>unordered_map</code> 需引入 <code>#include&lt;tr1/unordered_map&gt;</code> 头文件，使用时需写为 <code>std::tr1::unordered_map</code>。</p>
<ul>
<li><code>unordered_set</code> / <code>unordered_multiset</code> <code>#include&lt;unordered_set&gt;</code>：元素无序。</li>
<li><code>unorderep_map</code> / <code>unordered_multimap</code> <code>#include&lt;unordered_map&gt;</code>：键无序。</li>
</ul>
<p>只有单向迭代器，其余特性与有序版本类似。</p>
<p>此外，还可自行指定相等判定方式和 Hash 函数。</p>
<ul>
<li><code>unordered_set&lt;Key, Hash, KeyEqual&gt;</code></li>
<li><code>unordered_map&lt;Key, T, Hash, KeyEqual&gt;</code></li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Hash 函数的自定义方法也与 <code>priority_queue</code> 中的方法类似：</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb4-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb4-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;unordered_set&gt;</span></span>
<span id="cb4-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typedef</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">long</span> ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb4-5">  ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-6">    Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){}</span></span>
<span id="cb4-7">    Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>ll x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>ll y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-8">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-9">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb4-11"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">bool</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb4-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> vecHash<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb4-15">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">size_t</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb4-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>ll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1E9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)+</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">107897</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb4-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb4-19"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb4-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>unordered_set<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>vecHash<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> S<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-21">    S<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>insert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb4-22">    S<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>insert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb4-23">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>S<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>count<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vec<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb4-24"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>OI</category>
  <category>C++</category>
  <guid>https://blog.sun123zxy.top/posts/20230124-stl/</guid>
  <pubDate>Mon, 23 Jan 2023 16:00:00 GMT</pubDate>
</item>
<item>
  <title>Jekyll 2 Quarto: Academic Writing’s not All About PDF</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20221226-quarto-fantasia/</link>
  <description><![CDATA[ 




<section id="旅程继续" class="level2">
<h2 class="anchored" data-anchor-id="旅程继续">旅程继续</h2>
<p><a href="../..\posts/20210817-aboutblog">上回说到</a>，sun123zxy 同学完成了手撸 Jekyll 的伟大壮举，然后悠哉游哉地度过了他的高三生活。现在，静态博客的大厦已经基本落成，剩下的只是一些装修工作。然而，几朵不大不小的乌云却总让他感到不安。</p>
<p>sun123zxy 曾写过一篇相对严谨的学习笔记<a href="../..\posts/20200321-burnside">等价类计数：Burnside引理 &amp; Polya定理</a>，还有一篇关于行列式与生成树计数的笔记尚未发布。这些笔记里包含大量章节标号、定理与交叉引用。关于交叉引用，原生 Markdown 只支持在链接处以 section 的标题作为标签完成引用，显然对中文文档不大友好。不少人选择使用内嵌 HTML 解决问题，但死脑筋的 sun123zxy 认为这种方式背离了 Markdown 简化格式的初衷。后来他发现，<a href="https://michelf.ca/projects/php-markdown/extra/">PHP Markdown Extra</a> 格式的 Special Attributes 能解决部分交叉引用的问题，更惊喜的是 Pandoc 竟然兼容这种语法（当时 sun123zxy 对 Pandoc 还没有做深入了解，只局限于使用 jekyll-pandoc 渲染而已）。至于处理章节标号，只需对已经写好的目录系统脚本做一点改动即可，而且当时 sun123zxy 也并没有那么多篇严谨的学术向写作。总之，问题暂时得到解决。</p>
<p>另一朵乌云来自 LaTeX。众所周知，Markdown 的内嵌数学公式是 LaTeX Math Mode 的某个子集。sun123zxy 发现，自己在 LaTeX 上的不求甚解开始给他带来各种麻烦。比如，他无法解释为什么只有 <code>aligned</code> 环境能被正确渲染，而不少教程中提到的 <code>align*</code> 和支持标号的 <code>align</code> 却总是报错；再比如，由于使用了重视速度的 <a href="https://katex.org/">KaTeX</a> 而不是更加完备的 <a href="https://www.mathjax.org/">MathJax</a> 作为渲染引擎，他发现自己无法使用诸如 <code>\newcommand</code>、<code>\DeclareMathOperator</code> 的宏定义。而且，一些教程中提到的 <code>physics</code> 等需要自行导入的“宏包”也让他摸不着头脑。</p>
<p>最重要的是，sun123zxy 开启了他的大学生活，论文写作的需求使他产生了系统学习 LaTeX 的想法。他在网协大牛那里听说了 <a href="https://www.overleaf.com/">Overleaf</a>，并在间歇性热情驱使下疯狂啃食文档，最终写出了自己的文档类，覆盖常见中文社科、科技向论文写作需求。验之以文，效果拔群。学习过程中，sun123zxy 习得众多排版常识，掌握了各种 font family 的区别、衬线字体的使用情景、英文 dash 的分辨方式等技巧，姿势水平得到质的飞跃。</p>
<p>sun123zxy 发现自己有点沉迷 LaTeX 了。他在写集合论大作业时学习了 <code>amsthm</code> 宏包，现已完全抵挡不住“定理 2.3”、“推论 4.1.1”、“例题 3.2”、“图 3”、“表 1”自动标号和交叉引用的诱惑。曾经博客使用的加强版 Markdown 在完备的 LaTeX 面前不值一提。他突然感觉有点害怕，毕竟 PDF 格式的网络发布效果并不理想。他需要找到一种能兼取两种格式长处的解决方案，否则他的博客将成为历史的眼泪。</p>
<p>然而在这里他遇到了瓶颈。尽管已经有一系列形如 LaTeX2HTML 的项目存在，但因为 TeX/LaTeX 是为 PDF 等页面固定的展现方式而设计，在转换成尺寸动态变化的网页（HTML）时必然面临信息损失。<a href="https://yihui.org/en/2013/10/markdown-or-latex/">Markdown or LaTeX? - Yihui Xie | 谢益辉</a> 这篇文章详细的讨论了 Markdown 和 LaTeX 间不可调和的冲突。更好的思路是，利用轻巧且可读性优秀的 Markdown 作为写作语言直接输出 HTML，需要 PDF 时再使用其它程序处理得到 LaTeX 代码。<a href="https://ctan.org/pkg/markdown">markdown 宏包</a>就解决了这样的问题。</p>
<blockquote class="blockquote">
<p>「你喜爱的 Markdown 写作，现更以 LaTeX 呈现。」</p>
<p>——<a href="https://liam.page/2020/03/30/writing-manuscript-in-Markdown-and-typesetting-with-LaTeX/">以 Markdown 撰写文稿，以 LaTeX 排版 | 始终</a></p>
</blockquote>
<p>markdown 宏包提供的 hybrid 功能还提供了将 LaTeX 命令混入 Markdown 的功能，完美覆盖了上述使用情景。然而，Markdown 自身在学术写作方面的固有缺陷——难以交叉引用、无法自动编号、没有定理系统——仍然让 HTML 输出举步维艰。问题在这里似乎陷入了死结：既想要 Markdown 的可读性和 HTML 输出，又想要 LaTeX 的定理系统和 PDF 输出——这可能吗？</p>
<p>sun123zxy 询问了不少同时掌握 Markdown 和 LaTeX 的大佬，他们都没有研究过这样的问题。唯一的希望是：找到一种合适的方式扩展 Markdown 的语法。sun123zxy 想起了 <a href="https://pandoc.org/">Pandoc</a>——文档转换界的瑞士军刀。事实证明 Pandoc 确实对得起这个称呼。他离解决方案已经非常近了：<a href="https://pandoc.org/MANUAL.html#pandocs-markdown">Pandoc’s Markdown</a> 已经非常强大，强大到可以随意内嵌 LaTeX 代码（当然只对 LaTeX 输出有效），交叉引用几乎任何内容，甚至可以用 Markdown 风格的 fenced syntax 控制 HTML 中的 <code>div</code>、<code>span</code> 及其参数！再加上 <a href="https://github.com/tomduck/pandoc-xnos">pandoc-xnos</a> 插件提供的自动标号功能，问题几乎得到全部解决——而现在看来，定理系统也可以通过编写 Pandoc filter 实现。</p>
<p>当然，sun123zxy 是个懒人，在能搜到解决方案的情况下，他不会干重复造轮子的傻事。某日，sun123zxy 又开始他了的头脑风暴。通过 Google 新的关键字 <code>markdown</code>、<code>cross-reference</code>、<code>academic writing</code>，他发现了 <a href="https://rmarkdown.rstudio.com/">R Markdown</a>，进而发现了 <a href="https://quarto.org/">Quarto</a>。</p>
<blockquote class="blockquote">
<p>Quarto is an open-source scientific and technical publishing system built on Pandoc.</p>
<ul>
<li>Create dynamic content with Python, R, Julia, and Observable.</li>
<li>Author documents as plain text markdown or Jupyter notebooks.</li>
<li>Publish high-quality articles, reports, presentations, websites, blogs, and books in HTML, PDF, MS Word, ePub, and more.</li>
<li>Author with scientific markdown, including equations, citations, crossrefs, figure panels, callouts, advanced layout, and more.</li>
</ul>
<p>——几乎让我一下子跳起来的 Overview</p>
</blockquote>
<p>Quarto 是构建在 Pandoc 上的文档发布系统，对 Pandoc’s Markdown 做了进一步扩展以适应学术写作，其中就包含了 pandoc-xnos 的语法和——用 Pandoc’s Markdown 的 fenced syntax 实现的定理系统！此外，Quarto 甚至还支持 Jupyter Notebook 的动态计算，附上 Matplotlib 代码就可动态生成统计图表——而且同样也可以被交叉引用！更让人欣喜的是，除了直接输出 HTML 和 PDF/LaTeX，Quarto 还提供了类似 Jekyll 的生成静态网站的功能！</p>
<p>于是，长达数月的探索终于落下帷幕，语法学习、环境配置与博客迁移被提上日程。又是近一个月的辛勤劳动，sun123zxy 终于完成了写作流程的构建和博客的搭建工作。盯着桌前已经冷透了的保温杯，他陷入了沉思……</p>
</section>
<section id="主要成果" class="level2">
<h2 class="anchored" data-anchor-id="主要成果">主要成果</h2>
<ul>
<li>基于 Quarto 的 <a href="https://github.com/sun123zxy/sunquartex">SunQuarTeX</a> 多格式中文学术写作出版流程，内含适用于常见中文论文写作的 LaTeX 文档类及其示例文档。</li>
<li>Quarto 驱动的适应学术写作要求的<a href="https://blog.sun123zxy.top">新版博客</a>（<a href="https://github.com/sun123zxy/blog-quarto-code">sun123zxy/blog-quarto-code</a>）。</li>
</ul>
<p>上一个 Jekyll 博客，一砖一瓦都是自己搭出来的，有感情了（笑）。所以也没下线，放在 <a href="https://blog-jekyll.sun123zxy.top">blog-jekyll.sun123zxy.top</a> 上了。如果你也和我一样怀旧，可以去看看~</p>
<p>那么，依照惯例，聊聊学习与折腾中的一点心得体会。</p>
</section>
<section id="关于-latex" class="level2">
<h2 class="anchored" data-anchor-id="关于-latex">关于 LaTeX</h2>
<p>很多人说 LaTeX 不好学——的确。即使是 OIer 群体，对 LaTeX 的认知也大多停留在数学公式水平。然而比起客观的困难，更应该问的问题是——Why LaTeX? 不同人的答案或许有所不同，但应有以下几点：</p>
<ul>
<li>有学术写作或打印文档的需求（否则可直接使用 Markdown/HTML）</li>
<li>认同内容与样式分离的设计思想，希望对文档排版有清晰的控制，而不是所见即所得的富文本格式导致的混乱。</li>
<li>希望用相对不易损坏且可读性较高的代码式文档替代 <code>.docx</code> 式的黑箱存储。</li>
<li>需要使用章节标号、定理系统等交叉引用功能。</li>
<li>想用简洁的代码生成严谨美观的数学公式。</li>
<li><del>就是感觉 LaTeX 排出来的东西很牛逼</del></li>
</ul>
<p>学习 LaTeX 需要了解它的历史，理解它的开发理念，理清 TeX/LaTeX 的历史进程，弄清 pdfLaTeX、XeLaTeX、LuaLaTeX 各自的特点，在 MikeTeX、TeXLive 两个发行版中做出选择，学习 BibTeX 引用管理格式，还有对排版知识的初步了解——知识体系可谓庞大。此外，不少 LaTeX 教学文档、各种宏包的手册本身就是由 LaTeX 生成的，这意味它们都是 PDF 格式，无法在互联网上得到很好的传播。但请不要忘记，它们是学习 LaTeX 的第一手资料。例如，<a href="https://www.ctan.org/">CTAN</a> 上的手册是学习各类宏包的第一途径，<a href="https://www.latex-project.org/help/documentation/">LaTeX 官网</a>也提供了不少相对系统的 PDF 教程。当然，近年来网页渲染工具 <a href="https://www.overleaf.com/">Overleaf</a> 的出现降低了环境配置的难度，<a href="https://www.overleaf.com/learn">Overleaf 的 LaTeX 教学文档</a>也非常优秀。我还强烈推荐 <a href="https://liam.page/2014/09/08/latex-introduction/">一份其实很短的 LaTeX 入门文档 | 始终</a> 这篇文章作为入门，作者是一位参与维护 CTeX 宏集的大佬，之前提到的 markdown 宏包他也写过一篇详细的介绍，详见上文引用中的链接。</p>
<p>在互联网上碎片化的学习 LaTeX，一定要经常问自己——这功能是哪个宏包定义的？例如，关于交叉引用，<code>\label</code>、<code>\ref</code>、<code>\pageref</code> 均为原生自带，<code>\eqref</code> 是 <code>amsmath</code> 宏包定义的，而 <code>\autoref</code> <code>\href</code> <code>\url</code> 均为 <code>hyperref</code> 宏包的命令，引入 <code>hyperref</code> 的目的主要是让文章里的交叉引用都变成 PDF 里可点击跳转的超链接；再例如，定理系统是 LaTeX 原生支持的，但 <code>amsthm</code> 提供了无标号版本的定理、设置 <code>\theoremstyle</code> 的方式和自动添加 QED symbol 的 <code>proof</code> 环境。再次强调，不要错过宏包的 PDF 手册！阅读手册是整合碎片知识、查漏补缺的最佳途径。</p>
</section>
<section id="关于-ctex" class="level2">
<h2 class="anchored" data-anchor-id="关于-ctex">关于 CTeX</h2>
<p>此外，有必要对中文排版基础宏包 <a href="https://ctan.org/pkg/ctex">CTeX</a> 做进一步说明。</p>
<blockquote class="blockquote">
<p>最初，Knuth 在设计开发 TeX 的时候没有考虑到多国文字支持，特别是对多字节的中日韩表意文字的支持。这使得 TeX 以至后来的 LaTeX 对中文的支持一直不是很好。即使在 CJK 宏包解决了中文字符处理的问题以后，中文用户使用 LaTeX 仍然要面对许多困难。这些困难里，以章节标题的中文化为最。由于中文和西文书写习惯的差异，用户很难使用标准文档类中的代码结构来表达中文标题。于是，用户不得不对标准文档类做较大的修改。除此之外，日期格式、首行缩进、中文字号和字距等细节问题，也需要精细的调校。我们设计 CTeX 宏集的目的之一就是解决这些 LaTeX 文档的汉化难题。</p>
<p>另一方面，随着 TeX 引擎和 LaTeX 宏包的不断发展，LaTeX 的中文支持方式从早期的专用系统（如 CCT）发展为适用于不同引擎的多种方式。这些方式的适用情况和使用方式有不少细节上的差异，同时操作系统的不同、语言环境的不同等客观情况又进一步带来了更多的细节差异。我们设计 CTeX 宏集的另一个主要目的就是尽可能消除这些差异带来的影响，使用户能够以一个统一的接口来使用不同的中文支持方式，使得同一份文档能够在不同环境下交换使用。</p>
<p>——CTeX 宏集手册 - 第 1 节：介绍</p>
</blockquote>
<p>CTeX 的基础使用，我仍然推荐上面始终的入门文档。<a href="https://zhuanlan.zhihu.com/p/538459335">LaTeX 中文字体配置基础指南 - 知乎</a>对我的帮助也很大。如果打算进一步自定义样式建立自己的文档类，还得沉下心来研读手册。</p>
</section>
<section id="关于-pandoc" class="level2">
<h2 class="anchored" data-anchor-id="关于-pandoc">关于 Pandoc</h2>
<p>Pandoc 其实一直致力于扩展 Markdown 的语法使其适合学术写作。<a href="https://www.youtube.com/watch?v=T9uZJFO54iM">TUG 2020 — John MacFarlane — Pandoc for TeXnicians</a> 的演讲几乎涵盖了所有值得关心的问题。</p>
<p>我认为 Pandoc 已有能力成为下一代学术写作的终极解决方案。语法上，Markdown 简洁易读，语法天然与格式解耦（反例是 LaTeX），而 Pandoc’s Markdown 是 Markdown 方言的集大成者，交叉引用、文献引用、图表等 Markdown 原生痛点都有很好的支持，fenced syntax 甚至可以视为 LaTeX environment 的平替；技术上，Pandoc 已经是非常成熟的格式转换工具，而 Pandoc filter 好比 LaTeX 中的 documentclass 和 style 文件，事实上实现了 Markdown 中的“宏定义”。如社区进一步发展，大部分常用 filter 能像在 LaTeX 中引用 documentclass 一样轻松获取，我们就能真正告别格式的困扰，拥抱 Pandoc’s Markdown 治下的多格式学术写作。</p>
<p>从这角度来看，Quarto 似乎更像是 Jupyter、Jekyll 和一堆 Pandoc filter 的混合物（笑）</p>
</section>
<section id="关于-quarto" class="level2">
<h2 class="anchored" data-anchor-id="关于-quarto">关于 Quarto</h2>
<p>Quarto 首个 Release 距今不到 2 年，是相当年轻的项目。开发 Quarto 的团队之前主要维护 R Markdown，Quarto 是他们跳出 R 语言生态圈，将成果扩展至更广阔生态圈（如 Python）的尝试，这也意味着项目尚存不尽人意之处。把它调理成满意的模样，还真得花不少功夫。<del>甚至让笔者开了人生首个正经 issue</del></p>
<section id="sunquartex" class="level3">
<h3 class="anchored" data-anchor-id="sunquartex">SunQuarTeX</h3>
<p>使用 Quarto，我主要有两大需求——论文多格式输出和静态博客生成。两个需求相对独立，因此有必要将离线论文输出的功能单独抽象出来。折腾的结果就是 <a href="https://github.com/sun123zxy/sunquartex">SunQuarTeX</a>。Quarto 原生的 HTML 输出还不错，自带目录高亮还有引用提示，稍微改改就能用了。关于自定义，Quarto 使用 SCSS 作为 CSS 生成器，意味着可以直接通过修改变量或 <code>@extend</code> 完成大部分工作。参考以下文档：</p>
<ul>
<li><a href="https://quarto.org/docs/output-formats/html-themes.html">Quarto - HTML Theming</a></li>
<li><a href="https://quarto.org/docs/output-formats/html-themes-more.html">Quarto - More About Quarto Themes</a></li>
<li><code>quarto-cli</code> 下的 <code>/src/resources/formats/html/bootstrap/</code>：内有 Quarto 的 SCSS 定义，目录下还有各种官方主题的 SCSS 文件，可作参照。Tip: 善用 Github 搜索功能！</li>
</ul>
<p>我这边的修改主要是把定理做成了 callout 的样式，另外给 proof 尾部加了 QED symbol。</p>
<p>难绷的是 PDF，直接生成效果可谓一言难尽……还好，与 Pandoc 相似，Quarto 提供了设置 <code>template</code> 的功能，可使用稍加改动的 LaTeX 文件作为生成模板，从而完全控制文章 LaTeX 的生成方式，进而控制 PDF 输出的样式。可参考以下文档食用：</p>
<ul>
<li><a href="https://github.com/quarto-dev/quarto-cli/discussions/2543">complex thesis with quarto · Discussion #2543 · quarto-dev/quarto-cli · GitHub</a></li>
<li><a href="https://quarto.org/docs/journals/templates.html#templates">Quarto - Article Templates</a></li>
</ul>
<p>当然，这得在已有成熟 LaTeX 模板的前提下才能进行，所以还是得会 LaTeX（笑）。使用过程中笔者也发现生成的 LaTeX 的某些细节不太合理（如 <a href="https://github.com/quarto-dev/quarto-cli/issues/3736">Issue #3736</a>，详见 SunQuarTeX 仓库 README），当然也无伤大雅，且等开发团队慢慢完善吧。</p>
</section>
<section id="blog" class="level3">
<h3 class="anchored" data-anchor-id="blog">Blog</h3>
<p>有了前面的基础，再搭博客也就容易了。以笔者一贯的风格，博客样式都是要操刀大改的（上一个甚至直接从零手撸了 XD），这次工作却意外的少。一方面考虑到毕竟不在 CS 专业，写那么多祖传代码之后维护也是麻烦事；另一方面嘛……</p>
<blockquote class="blockquote">
<p>这，谁写的这 <code>darkly</code> 这主题，绿不拉几的</p>
<p>看一眼</p>
<p><code>#00bc8c</code>，啊这样</p>
<p>草</p>
<p>这样啊这样</p>
<p>加个背景</p>
<p>……</p>
<p>？</p>
<p>？？？</p>
<p>好像还挺配的？</p>
<p>——来自考试周还在摸鱼的 sun123zxy 的惊叹</p>
</blockquote>
<p>light mode 的 <code>flatly</code> 也还不错，直接丢上去没改了。唯一的缺憾是 <a href="https://github.com/quarto-dev/quarto-cli/issues/3705">Issue #3705</a>，按开发组成员的回复来看，短期内 light mode 和 dark mode 的相互分离还不能实现。</p>
<p>此外，关于代码高亮的自定义方式，可参考以下要点：</p>
<ul>
<li><a href="https://quarto.org/docs/output-formats/html-code.html#highlighting">Quarto - HTML Code Blocks # Highlighting</a></li>
<li><code>quarto-cli</code> 下的 <code>/src/resources/pandoc/highlight-styles/</code>：内有官方样式文件，可作为模板。</li>
<li>行内高亮不能在 <code>.theme</code> 中更改，可通过覆盖 SCSS 的 <code>$code-color</code> 设置。</li>
</ul>
</section>
</section>
<section id="画廊" class="level2">
<h2 class="anchored" data-anchor-id="画廊">画廊</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://blog.sun123zxy.top/posts/20221226-quarto-fantasia/quarto-begin.jpg" class="img-fluid figure-img"></p>
<figcaption>2022/12/26 上线前夕</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>站点相关</category>
  <category>web</category>
  <category>LaTeX</category>
  <category>回忆</category>
  <guid>https://blog.sun123zxy.top/posts/20221226-quarto-fantasia/</guid>
  <pubDate>Sun, 25 Dec 2022 16:00:00 GMT</pubDate>
</item>
<item>
  <title>有限覆盖定理与实数理论</title>
  <dc:creator>sun123zxy </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20221213-cover/</link>
  <description><![CDATA[ 




<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example 1</h2>
<p>为更好的证明本题，先引入 Bolzano-Weierstrass 定理的一种等价表述.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="def-accu" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (数列聚点)</strong></span> 对任意实数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D">，若实数 <img src="https://latex.codecogs.com/png.latex?a"> 满足：对 <img src="https://latex.codecogs.com/png.latex?a"> 的任意小邻域 <img src="https://latex.codecogs.com/png.latex?U(a,%20%5Cvarepsilon)%20=%20(a%20-%20%5Cvarepsilon,%20a%20+%20%5Cvarepsilon)">，都有无穷个 <img src="https://latex.codecogs.com/png.latex?x_n"> 满足 <img src="https://latex.codecogs.com/png.latex?x_n%20%5Cin%20U(a,%20%5Cvarepsilon)">，则称 <img src="https://latex.codecogs.com/png.latex?a"> 是数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的一个聚点.</p>
</div>
</div>
</div>
</div>
<p>请注意，这里我们没有使用建立在集合之上的标准的聚点定义. 对数列单独定义聚点，是考虑到数列允许重复的元素出现，如此定义更容易展开后面的讨论.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-accuequiv" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> 实数 <img src="https://latex.codecogs.com/png.latex?a"> 是数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D%20%5Csubset%20%5Cmathbb%20R"> 的聚点的充要条件是：存在 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的一个收敛子列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_%7Bn_k%7D%20%5C%7D">，其极限为 <img src="https://latex.codecogs.com/png.latex?a">.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>先证充分性. 用定义写开 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bk%20%5Cto%20%5Cinfty%7D%20%5C%7B%20x_%7Bn_k%7D%20%5C%7D%20=%20a">，就有 <img src="https://latex.codecogs.com/png.latex?%0A(%5Cforall%20%5Cvarepsilon%20%3E%200)(%5Cexists%20K%20%5Cin%20%5Cmathbb%20N_+)(%5Cforall%20k%20%3E%20K)(%7Cx_%7Bn_k%7D%20-%20a%7C%20%3C%20%5Cvarepsilon)%0A"> 故确有无穷项 <img src="https://latex.codecogs.com/png.latex?x_n"> 落在任意小的 <img src="https://latex.codecogs.com/png.latex?U(a,%20%5Cvarepsilon)"> 中，即 <img src="https://latex.codecogs.com/png.latex?a"> 是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的一个聚点，该方向得证.</p>
<p>下证必要性. 已知 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 有一聚点 <img src="https://latex.codecogs.com/png.latex?a">. 我们按如下方法构造子列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_%7Bn_k%7D%20%5C%7D">：</p>
<ol type="1">
<li>当 <img src="https://latex.codecogs.com/png.latex?k=1">，取 <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_1%20=%201">，因为 <img src="https://latex.codecogs.com/png.latex?a"> 是 <img src="https://latex.codecogs.com/png.latex?E"> 的一个聚点，<img src="https://latex.codecogs.com/png.latex?%5Cexists%20n_1%20%5Cin%20%5Cmathbb%20N_+">，<img src="https://latex.codecogs.com/png.latex?%7Cx_%7Bn_1%7D%20-%20a%7C%20%3C%20%5Cvarepsilon">.</li>
<li>当 <img src="https://latex.codecogs.com/png.latex?k%20%5Cgeqslant%202">，取 <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_k%20=%20%5Cfrac%201%20k">，因为 <img src="https://latex.codecogs.com/png.latex?a"> 是 <img src="https://latex.codecogs.com/png.latex?E"> 的一个聚点， <img src="https://latex.codecogs.com/png.latex?%5Cexists%20n_k%20%3E%20n_%7Bk-1%7D">，<img src="https://latex.codecogs.com/png.latex?%7Cx_%7Bn_k%7D%20-%20a%7C%20%3C%20%5Cvarepsilon">.</li>
</ol>
<p>这样，我们构造出 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的一个子列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_%7Bn_k%7D%20%5C%7D"> 满足 <img src="https://latex.codecogs.com/png.latex?%7Cx_%7Bn_k%7D%20-%20a%7C%20%3C%20%5Cvarepsilon_k%20=%20%5Cfrac%201%20k">. 因此其收敛于 <img src="https://latex.codecogs.com/png.latex?a">，该方向得证.</p>
</div>
<p>上述定理立刻证明了下定理与 Bolzano-Weierstrass 定理的等价性.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-bwequiv" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (数列聚点定理)</strong></span> 任意有界实数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 至少有一个聚点.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-finite2bw" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> 利用有限覆盖定理证明 Bolzano-Weierstrass 定理.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>命题等价于用有限覆盖定理证明数列聚点定理. 用反证法. 假设一有界实数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 不存在聚点，设其有上界 <img src="https://latex.codecogs.com/png.latex?L"> 和下界 <img src="https://latex.codecogs.com/png.latex?l">. 对任意 <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5Bl,L%5D">，它都不是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的聚点，因此总存在一个 <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon(a)%20%3E%200">，使得只有有限个 <img src="https://latex.codecogs.com/png.latex?x_n"> 落入 <img src="https://latex.codecogs.com/png.latex?U(a,%20%5Cvarepsilon(x_0))">. 这样，构造开区间族 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathscr%7BF%7D%20=%20%5C%7B%20U(a,%20%5Cvarepsilon(a))%20%5Cmid%20a%20%5Cin%20%5Bl,L%5D%20%5C%7D%0A"> 它显然是闭区间 <img src="https://latex.codecogs.com/png.latex?%5Bl,L%5D"> 的一个开覆盖. 由有限覆盖定理，只需取其中有限个开区间就可以覆盖住 <img src="https://latex.codecogs.com/png.latex?%5Bl,L%5D">，因此覆盖 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 也只需要有限个开区间. 然而由前述构造，每一个开区间中也只包含有限个 <img src="https://latex.codecogs.com/png.latex?x_n">，因此数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 只有有限项——这显然是荒谬的. 故 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 必有聚点，原命题得证.</p>
</div>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example 2</h2>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-lebesgue" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Lebesgue 覆盖定理)</strong></span> 设开区间族 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 是闭区间 <img src="https://latex.codecogs.com/png.latex?%5Ba,%20b%5D"> 的一个开覆盖，则必存在 <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%3E%200">，使得只要区间 <img src="https://latex.codecogs.com/png.latex?%5COmega%20%5Csubset%20%5Ba,%20b%5D"> 且 <img src="https://latex.codecogs.com/png.latex?%5COmega"> 的长度 <img src="https://latex.codecogs.com/png.latex?%7C%5COmega%7C%20%3C%20%5Csigma">，就必有 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 中的一个开区间包含 <img src="https://latex.codecogs.com/png.latex?%5COmega">. 其中 <img src="https://latex.codecogs.com/png.latex?%5Csigma"> 称为 Lebesgue 数.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>不妨只证 <img src="https://latex.codecogs.com/png.latex?%5COmega"> 是闭区间这种最强的情况.</p>
<p>用反证法. 假设命题不成立，则对任意 <img src="https://latex.codecogs.com/png.latex?%5Csigma%20%3E%200">，都存在一个长度小于 <img src="https://latex.codecogs.com/png.latex?%5Csigma"> 的闭区间 <img src="https://latex.codecogs.com/png.latex?%5COmega%20%5Csubset%20%5Ba,b%5D">，它不被任何 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 中的开区间包含. 因此，对所有自然数 <img src="https://latex.codecogs.com/png.latex?n">，可取 <img src="https://latex.codecogs.com/png.latex?%5Csigma_n%20=%20%5Cfrac%201%20n">，按上述方法就可构造出一列闭区间 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5COmega_n%20%5C%7D%20=%20%5C%7B%20%5Ba_n,%20b_n%5D%20%5C%7D%20%5Csubset%20%5Ba,b%5D"> 其中每一个闭区间都不被任何 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 中的开区间包含，且区间长度 <img src="https://latex.codecogs.com/png.latex?%7C%5COmega_n%7C%20%3C%20%5Csigma_n%20=%20%5Cfrac%201%20n">，即 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%7C%5COmega_n%7C%20=%200">.</p>
<p>因为 <img src="https://latex.codecogs.com/png.latex?%5COmega_n%20%5Csubset%20%5Ba,b%5D">，<img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_n%20%5C%7D"> 有界，由 Bolzano-Weierstrass 定理，其存在一收敛子列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20a_%7Bn_k%7D%20%5C%7D">，设其极限为 <img src="https://latex.codecogs.com/png.latex?x_0">，极限保序性表明 <img src="https://latex.codecogs.com/png.latex?x_0%20%5Cin%20%5Ba,b%5D">. 注意到 <img src="https://latex.codecogs.com/png.latex?b_%7Bn_k%7D%20=%20a_%7Bn_k%7D%20+%20%7C%5COmega_%7Bn_k%7D%7C">，两端取 <img src="https://latex.codecogs.com/png.latex?k%20%5Cto%20%5Cinfty"> 即得 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bk%20%5Cto%20%5Cinfty%7D%20b_%7Bn_k%7D%20=%20x_0">. 综上，我们说明了 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5COmega_%7Bn_k%7D%20%5C%7D"> 收缩于 <img src="https://latex.codecogs.com/png.latex?x_0">.</p>
<p>但，因为 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 是闭区间 <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> 的一个开覆盖，故总存在一个开区间 <img src="https://latex.codecogs.com/png.latex?I_%7Bx_0%7D%20=%20(a_0,%20b_0)%20%5Cin%20%5Cmathscr%20F"> 使得 <img src="https://latex.codecogs.com/png.latex?x_0%20%5Cin%20I_%7Bx_0%7D">，而 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5COmega_%7Bn_k%7D%20%5C%7D"> 又收缩于 <img src="https://latex.codecogs.com/png.latex?x_0">，故存在 <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20%5Cmathbb%20N">，<img src="https://latex.codecogs.com/png.latex?%5COmega_%7Bn_k%7D%20%5Csubset%20I_%7Bx_0%7D%20%5Cin%20%5Cmathscr%20F">，这与我们构造 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5COmega_%7Bn_k%7D%20%5C%7D"> 的方法矛盾. 故原命题成立.</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>证明过程与用 Bolzano-Weierstrass 定理证明闭区间一致连续性定理类似.</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-lebesgue2bw" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> 用 Lebesgue 覆盖定理证明有限覆盖定理.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>若 <img src="https://latex.codecogs.com/png.latex?%5Csigma"> 是覆盖 <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> 的开覆盖 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 的勒贝格数，令 <img src="https://latex.codecogs.com/png.latex?N%20=%20%5Clceil%20%5Cfrac%7B2(b-a)%7D%7B%5Csigma%7D%20%5Crceil">，<img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cfrac%20%7Bb-a%7D%7BN%7D%20%5Cleqslant%20%5Cfrac%20%5Csigma%202%20%3C%20%5Csigma">. 由 Lebesgue 覆盖定理，任意长度为 <img src="https://latex.codecogs.com/png.latex?L"> 的 <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> 内闭区间都包含于某个 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 中的开区间. 因此对 <img src="https://latex.codecogs.com/png.latex?n%20=%201,2,%5Cdots,N">，令 <img src="https://latex.codecogs.com/png.latex?%5COmega_n%20=%20%5Cleft%5B%20a%20+%20(n-1)L,%20a%20+%20nL%20%5Cright%5D">，总存在一个 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 中开区间 <img src="https://latex.codecogs.com/png.latex?I_n"> 满足 <img src="https://latex.codecogs.com/png.latex?%5COmega_n%20%5Csubset%20I_n">. 因为显然 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20%5COmega_n%20%5C%7D_%7Bn=1%7D%5EN"> 是 <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> 的一个覆盖，故 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20I_n%20%5C%7D_%7Bn=1%7D%5EN%20%5Csubset%20%5Cmathscr%20F"> 也是 <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> 的覆盖. 这样，我们就成功构造出了一个 <img src="https://latex.codecogs.com/png.latex?%5Cmathscr%20F"> 的有限子覆盖 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20I_n%20%5C%7D_%7Bn=1%7D%5EN">，命题得证.</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>在处理区间问题时，Lebsegue 覆盖定理很多时候比有限覆盖定理更好用. 例如处理闭区间一致连续性定理时，“落入两个有交点的相邻的这样的区间”<span class="citation" data-cites="lizhong">[1]</span>这种神乎其技的操作就可以省去了. （这种操作的严格叙述是：把单点连续性要求的区间半径改成 <img src="https://latex.codecogs.com/png.latex?2%20%5Cdelta_x">，但构造开覆盖还是用半径为 <img src="https://latex.codecogs.com/png.latex?%5Cdelta_x"> 的区间，这样可以有 <img src="https://latex.codecogs.com/png.latex?%7Cx_2%20-%20x%7C%20%5Cleqslant%20%7Cx_2%20-%20x_1%7C%20+%20%7Cx_1%20-%20x%7C%20%5Cleqslant%20%5Cdelta_%7Bm%7D%20+%20%5Cdelta_%7Bx%7D%20%5Cleqslant%202%20%5Cdelta_%7Bx%7D">，能把两个点放在同一个区间内了. 详细可参考 <a href="https://www.zhihu.com/question/56393706/answer/298562084" class="uri">https://www.zhihu.com/question/56393706/answer/298562084</a>. 事实上，Lebesgue 覆盖定理也可以用类似的方法证明.）</p>
</div>
<p>作为小结，下图展现了刚刚介绍的几个定理在整个实数完备性等价定理体系中的地位.</p>
<div id="fig-real" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-real-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="762pt" height="131.28pt" viewbox="0 0 508 87.52">
<style type="text/css">
@font-face{font-family:HBBRNP-FandolSong-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAABlAAAoAAAAAJnwAABj0AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAgXQKw0y0Vgs2AAE2AiQDNgQgBYMhByAbGh4jA8HGAQgUPAPxFwm2qdWOfKHDGhmGDmONhMGNlRs83PXzeAP8uf7NYWstbUsLY7U4VAujwoJWvqBr8YIXcXVQ3bkD8HHs6A4gtMunwm7zpdNeA85FQlsHCUPWZONZRy4xTlDySMKCS09pU+ywvd52f2Wv/PdvQgaRdCByS3FJqW7b+ozm+gvC5N6KIORII4mrhar/m8tsUgTVWkBlK9Xun1mYhCel2S0mW6KsKqGvZ+GqSCYlzlbdcXpA7tQ5fc+fsPpsDa0hxVx/Ry4RK6z57gGAFKAjAPD3z39s6Gc10KvHIJAOU5YyOKDMBHBp5lbkAPAxXa2e/5lDYXJADl0ACNG/fykXABOIIzYkgthSqPuMwWX7ETaDlRAVHKWLWhZ1Nj42cTKLlZWYVZJjmtNastcAL1dWXK0qakzobO8+2gMZcBl9PfppTJv0ugv+G1l8sfHfjTMbszYGrt48VTh5cXJmcnICvLCjP7rHpOt4Z7BxVcOeil5DlMGq+EueRx4x9z8ABHjRnngGtyDHnFpoEZsJnQwBGhggDCnHBKzjlTn8iX9XaQBPcSjSzpYWBPWamSTwCWWptqgM9nFiIx1wFkgLFtof7meODjXnQaH+Xu6WVKg1EkMOEBDEYS4SG3iYZKgQsSfXwtm09KWqXDfKw9SG/ig7SzrW0oNoA6Wi6TZQpAXdHmlhDYU6+QRDobr912KvXXMgmG3xOju7ZPFauzE7+5XbPAyzNZ412LyUsl11YQnlRvTTJ8uOqsawNkTKRWhxzjn+tG6zMCVlB6LQVIKIebBt4crOLcWFB8NfeY9GXyVPno7y26gftTzJTs466hP9NL/tZfanZJSahHRuyuU0aTjQxriTiNnqJeiobrxrLujq4vzIm0BVoGMzQIk+/1gmUrn1YG3oKOtiKZ06AhFFzyRqkE7qkZ0iwzbKkYIG1FBQ8boOIsDlDVOsF/2mu7RRJiiLW+RAw4ForU/LH+X9VPp2HIeKlTsZ9/w9agrtX1cBUGMORAzQo5pMJCO4yDk2pGdxoucdDGxTUqZSJBFokYBkt1hUys573TV6vY1jrxLGpGSk2rEfY46xnq+CxwzGC2v9Pwuxb5UoK3egFQQd9LfEPbH7v0qze2MpCKiKz/K+G5xns3yBJLsgASWXxE3RenKoJtPXE8kCkzKlluwc0a4vp9vdXOjRh5q7O/JiVfgbR5QVP9YMgl51DeIDWv7gXkXPn2RDQr8UY8keHTxmChEtt1bvGG58kP8HYXr7R5lSm6iOckQL/8R5pkDK0UzfTSFGwmoJod6RJ1nassa6rArJlO98GAv8EMULHOtSKu3pM7oL4t6S0WWKaKO1fNbK/TUgqq/cgVmDPYHPWn5Hac4zf72+bCa1VxWNhDQM8Y//gvg2o/wni16dB4XPlwJKaV+F9xjxh2TygmSrgbAypKCqnPP+dSEILK1YQXDqQc+93q8yUVAhuSRaCbsgkx9akNz9+WLdjefm/piMBJYApbr5ZRbl46/VM1QyxtI1M1HUlPrxG2ZnVVxaayYStXgbZSNkyCo+TamOiBAXrUrTNcFO73zvtJSyO+8FQZxibMj2ZZls190ewkhV6LUx5z09u08+nDgAv7GsP4Je/IDjD+FzhJBL0d3pWlme8eOPsjt/0KVDabwCYY5dMNOxelj+pMq9YqxnojF7dsGJ546duDP+HS6QdI1hemiGzQ+ppU6bBShpIKQo6nXKvsYLjYfnoNPc6DimPG8v/nGOThRM8fCS3zR2esabJ8sQORD7JYOlauYXP0o5tBQEbfRGCyWl2LJMsmJ0cKw1trcdF3msb/Hhzz8TeGsLWk3DzT0abHPtQ5UCK91zXezmX6VkagmiHNGvJ9JJ0uguBAmv9sYaxHr+aEPJTBW/s1137t5ogjTMGQAihADMKOfc1g1ZelXlKaBL3FIsb6kqZLW1etY3Su5SvKs3RO7YLIwXeL8hJXtXNbhUKczyGRfX0LjnzXUYuXafeaMQsbPTliV7aeZqYp6xmh74ZHHMgq64+buIVSp+06CcQ8SiuMItf8twPXPm181EoTxIAHAIm4KVOlouwxNeJzsrBgOvg9XH3dUidHzDdcHONs/YazZmmUnu3jz3wHC9y3tf3+tt5Ewyu34u5lTHHt8ld7Gwir6yxmEQVkI9qrEojWYJ0UHDxFXFAeS79NTRhuJAK0R8G6hKZ4VsNPaEjeCRB2Q6ICwOZbKHDMVHWrDLSUpW6SDxNvhQ+DhRtgzaduqXwRN4AmpO2XF2+9mehcwDPoxPY23xOxwnrLydAXQTIKs1zgBpKUAdKBku05ynSuNMC6vTgfFJri4UoRWzCV3K9h6UteYFVofFldOhOlzJzSSri8WK3/TOX0NbaA15RDVm8+04qqVIRnkhlfce6ydaWH1ZyvYrjFFsyE0pzSQpw4ykPCSRn94IR7P+Mi1F5Ntxd27UFLdnAFAVYtsMqDsqnGfwqxNamqlrUzUOsSNMMpnADAt/hwudB+2K6HoWXRlWnrNRO8Bb44PfMiaGA/bFr1I07Wg356i+JTfG2Lf/797V23a859yANLsjDNkcz4qRA2HsJVQNkfo4C/9n/5vs/unbqCnIZmpg8Cd/slxEiGfFYrVSKRnxuUfHeAa/K2UiokC7HewkGsDYrj6pvKjiAA4xEJkojGSN+1aEH4nWCQ+yZp1DhOpss5uSTOowjyga+Oy+lNeJ45//kePY2FnanZhIQKgdOjjxSEMIpmzNUegw8p5GO8vkavehbvXdiTLwPnQZFFN7TX9L3ry6F9jQi53ZkGRRvr1nHPAYHq7XUeF70VqNls/6huEuBUbXl0OVSUmjrGrkVdjBJy+ANWT6FmTLcUhjWH9o70hnQ/SpLIrxqfkaCEtdX2gcuNtajTkVP+6ev/ZHF+nCl4pmW4oL2PMe0YS4PVMD2yJTnPM1bmUNmboupQRXKCUj6kt792l8NPpQLPQNs2YJQgJ3Ia0Mnd3oGpaMFg7BkOdZiH+zKI/FMA2C4GDONUrItzCVaCDA1TzzvVhECcE5yyhZyk3PBCq2DCmTyTMREQO/XkY8qnpCVcjpKndvIaIv8mwB+EhaJllnEcK2UXlbC3H+ak4oDaBQt9EWTDthyyolGiWMJ9eFijfwjHePmiOrqzMg3JMjj6U8Q85xeqyW4loM2jXXXEFHSxlkQsfsxLf/an4v6sA1za+WvJdLoZMUXgBm5TrDyCo41sH0oQQdKw/GXW+uYz8gjfnNP45Q7kMe67T10q2jb7qynLpWODY5w8JOk0g7t4OWXj0Wdi02JklnQ5yyqRk2bCNDp1xtOhub1W624goef+1a+kN2rD3E6BMmSaSTAaLObpYau0zFKcSoPkaHyhx+/keYbd06Y6YmUqMT3dTEbJo6k4iXPj9q4BPIJXe8bnKFV9tZgkRhoVcypfTHyJFImCzrQUHuxrdC+JfNnL6hdKGPEWocxEZ6NGau+39JEX3lt8N74HW28FEd5QtiTWFKIMol21JoLidOQBfEEa+wf4S9cKI92WhJAYcDdc8UzNzCcME6rM0d4Mh8Hv+8VQ7iGVUSyKwTesepj6elhKpLUtsKqkvETUkr+bzsZ5govhPpaKU6V570Ux6Sok5k2BzqQQ5tUSur+3xXC2Xn124DbqVUfaC+yuCAGz/AKlRBijwnVkwJVchZR916qa91Jeb0Cxvjrmvw2t/sM0ygSh0qkkhwswez4VXJL2GdxWCr6apDZZAQ1oeRD8Efej/QeoBeAA+MALgbVZXCMQ8dMFM+H1jxXEFMpkVVVMDLd+JtL5FJs7dQbB/oGs0MNHEbGTUOEOxe5793HL+uRjvnmDoQnDF/JhE3rryE1WyC6Oey8FGkeiH4V6nVDs1hTcw8Gj/AgFsNawJ9dfj4uKCk4FeBIf/TrIaTkL15noBiTrwUzQsrS1RSnZ8nipyawt+ifbYlobdK/F78igUOHkqm682GsIVWRfYCB478Af8KH5ZjPoB+bwHdeF4lYr6gjFgSk4iK/MS92TLXZFdbk3gEOv2kzCya0MB10DI/rEo+H9ygxmXQv56IF+TY1JyiJOO1aFGzaasPMgFl5iHhKnd3SnWkGFuh1lQcA0nUAwNXBx5Zc3eReHNewm9UjYu+oRlws+rJUYWktm1YGvh2PR/8a2O0Q6x3Bnb73u5/y16Kxe1MmCzsvSo8x19ibYNu/fRn3cw85QLYyMbOMHnVjWRusMAOHp4AT/wnBmqalWyTsNNoC6tKun2SF24kwY8Xp4qYG0F3TG5XtsjbvLMU+fWe3sie00OxdWbmzgKBBU66CilQjd0CPj+MnRCBjqQg4yWRXnPAT3s17RoohxXkr+CyD60/y6Gyb2LYDK5MsF6G1J1YyuRKJAtZCIfrJ3eCSqDx5kjf47Kbp03XW8jwkRyyyknhrrFSl8aJOwXqQumiK0j8iKMRmkxprUro0FLfeGv7y9Y4b9PJKwJLMWVODXeLToTW6+HCoNUVy20Y1mdpBrApwxJIydASd5iOl9S3M0+AyyPdrpjxtwHWELCIdxOSAvzKDu3o9uUl6JwBGr77PLUYJUZnwnnVe1gpT9b03qVXHn5jm2kmiqR8NTu+P2wVSRnK62aiqy3SXNZ55ph95AdE0aOd8F6o2giWRtATJ+XNF0c4cXI5hzWqL4MXr1FsK/Z4GHYQeaSYY/a1LKDmFGRZOcPv3C3Ho4OeNWVLw+Nrx+bFLohPzVsmrlq6QxbwH6XJavOMq3OxYypSlQOhKBrMlJY1WM4G01rTMIXnatv51XTVBOZ3G/1BQCp8bq/Yn+Qkw2hsxreuA07/PkeyuGf/KDGCGKJ2jGp2eQeWoD1tPc86uL+PdpwfZIhbZrbBXoZfD0DjiVwf+amA3PsYz0l2lI7WAhutDV93EPARhAsuMC01Ns3mMt9FVtbp1Xf/+4z8ETX9v0wXzeVGLtX1EBT7G3CmfKTYSn6pMLRhiV26XRsUA+DX6TZl8iRs2Hc9iTYlApeMX8dtAz2Ef1S6Y2wjcf65YKetTrgvS6jaz3sLNziDwLMfyA7XOflrswi7MSWUR88cJQ3gz8rwV3H5RZpk258iCWhqITRL51aTO7l/wUrpJMviEuVc9qZbQNWfc+HLlFFitmY/VFPK5GfnaD4wzwTKyOk73mLqLlfei1Tv2BNwLPVApK4KzghMD9yHhZWNLDRKk+ZFM3EauwqFeRyXKA/UXaOo6KSCMLu4Gsv0WJ/V8JENjiJixpxSIJqIhlXZGHe1EPKbzqXbHc7gOuHcLch4pzcvk/OMKTp1YWApadPxDf7oLGLXxkIlFF/NAuzrE0e7G8+5y1+zd1Tlx0PdUs5bzUR7mMLnFrPT5wUI9uyNh78DvGuCkqJCK0LBauCl299qi1CargaosDgep7NamAwsBnH1vbAGo0gVo04WoSOTm5NxycZk4AyKTnYQScH6LlhJAqUFFn1iM+tNKPe2BDHdpHYLazyKS1wBHZk8AntXD6mFqmHrS4lKD06yYbdfsvoQWmlgq93mEKN9wR3YtzL/XZhWeCf0HDTGNPfNgavNog1fpSoCrdnBHRdkwjcfhaSDMF7u8qCEhlFv3SLublNuS+K7rismWCExs0eZq6G0YDPeyQZZmafxhKTi5eO0qFxnyFddOgEhSrXNdP5ZDGwOfQhPDEXzmgR+HXGYLtEBr1jOsRiv7s/w9hTiSUTbk1xTtYTfYW/WsuHC76e7rG5kjkATaxa+gTD2+71SLIdXDn1Ye3X/1QX7AhrdPML3Pkhdg/XrERScWIvct9B5UhJm3ox0X3E/ujOZktY6ld6xOF99/MjFKtWSLYjnDCA2zj5IREAEk+opzWlmeqyp9YpZxJsOicmQGXlV1Ks4ROfbpaL1pyuL5dsP2MSBKFurvQimMvDSjUavX39gtTawVimde3fUDA42tpAgpSJjyNDGBcVh3Lc6kw9bR4IEfPE5pnnSZfv/thnXGPHGrcZjJUNrhgZxW4e2ArhEHnZzTnetL/c4Z2UspPAZJI9PvSLge/4AT81BtQs7zDjnlr0SeBf5Fjs0WyADHwWtUTmsE4FQkUuTNDenoLs4dZjmSJ5132Ct2xlvCb4tyD9PCpOZu9yuFRpJTzNmW2fxs4ZZpOX11uv464brkbfiXJ5YX0t5CZYyuJC0u4B9VhIo6zqiWup2TH3kFszwCRQYHMY7wDJBKY7doJfZlW2wXWC3YKttuV05sgSfAOYbjggklblpoM/VF+PF2TnZ4GJPgTP/nYo1iji+Oz/nvwSuUGQHqaq+yObyK93AMIkBlySVBmAR+zLEay/FSR2LXzlcdUtbVfcbcFsVt5b9PzrCkUOId3t9jRdeybJY4VpyFMddk35T7GPxGTrvCDK4XIcshLX/8NI+qhpNLGeXh7rWSUIqWktAEeApoE0h7QqSR9O13qm0PVrKVdCNA0zVso3i4HbcsVYii6+ddHo+DvtXb+dV1DShCD58QK1GEautDg5XwgoI3rCRovZ4jlNUhHY8in75gKZllh43YzQdb+9qxDX21O6gD3cN44Z7hgE+Qe3Fpwt8T3yRevrBmlY3SwsSXNoyFBTygco6cNRWAaeSBKsnp5gTxgt9yE43QyjPPWslhx83Y45gBUfxRxOP4o6mHDW/FH4hn1eSuvzbs+fkplN5IpX364NJFEV1qshgkoEnz6U83meLctttK3s3UZE6Kft1g7IcrCLFeAFZmhMo1Jpm0rNSeree2WQlt7NE5Cf5I4bBbhj3mtIs7tL0XL6IUJBO1NPGGaIZ2lJ5NmR/79YOOPxAaFxxsSDWhPERM3MRVkVVBI3ls4BUP4k0MPKWOX7sDycjhO9oVP4HzL9zWw9e3hnGb2cjwpSDnyoMsHJ9oPKApwvB6xnuCKgj1O10JRl2XBhc9n01dSAyQTUHj15wAJZzsj+dwf2VK2dcyY77zyd294B+4FTKIv0i3CLloosZ+gn9qejfiiCZ8vlbAbakKT48yX8aTb0aECWSusuWFRRa/KO7Yjd07PY/mrfliMEn3GDR6QKUGCKBoK1NlSFD+BRqDLGZVG7rZHBsZhJbX/6SU+1fmlXdRlEJYyZGi2i2H9seZZOHharSlVzbX5BxVAAKiWWimIDd6nFz2GfDyIIwfph0vObI/RRhCNqHUT0WwVAwq20jArbcR4VWX28eF3sERL6KRpVlaOTgkK3QYq0rArLP91o/6N2k4LKRMnvKe61ADrMFgJjqt9yQAJbJe6B5G0vA4TJiTPyDsQB99KRrfHjF/7Db5fz4pAlprp/uPXE/IdzXZ4pZevbNi+0PQCZn780yDagQt59mcvJKA89vb/kDIkeE5+1tlGAsUzEPzwU4HDkCxAKJ5r2E2GJF5Py5DbyQtTdcBNYKRGaoF1ADXh/9BVxg5LlsWD2bGwLVqlyvQcbSJIwTby1NTSa6ZGW3KjywP4OmvrwlCp3ATvOhIt8e5mD4et1qWHoXJJ5PrmvbPDg+CNxo+42EtZ/w4frrHSPeODlIsen3FMApkAzoR0S6OF+d/oBS77Cn8QOFSj81ISyIdDXXbDaaZ1gkp/6FDCT43V+jN7vzxTBBzgQ/AqanBMXUaUe+V3dipphMg03lELjjBZC4aFc7rEkSUFdq3xophz+ZPgR4cYP82SYE27mfW7Vw9J5UcFgjLCb9b8aVuSbgHSR7OTgp9LsLsN8VKOqEd3DhNXq6ifXOuxmQktOg7bWhPyWEOruqtgGEgfPdkfeFNYzMYScowN8BFXR+DBlnt2OyRpHJ4cVA0DvKnGt0Vj5eSJGV9zOj636UgJvRMtATVXQxN7VwiXdsNIRD4NOfw4w7rmFpsTbOTlnpfBSowfa4wwW7kDSgwHMtYl8Gbb6p4QsNMn1sHB6wLtcnijtqSG4v7Qu38r2t2QsfewptEtH+A84KaAbThZmucP2fcPYdD/6djXdwt4Gld6ruBGSIfHfDym/uc+05lomue/btJ6bafIiE3w3XwxjlL4DOsbTBm/1amV8wG9BefDNz2rxqamOIbvvjxh484KzUzoSNuKb0AqBhxPC+zfnH4X3tiFa5T/MeIcNots2oFVLGUGPF92CVt59uIm7/7qQ99l3D4bJWcoUxsQMRl5MaBNj3McJMr8PIKKakT+61aAljYt6wpm9F0pJ1LbSH51z/wwOdMKPcE4FOw0/gsYEIeAlErnvaqr/p0SGfTSBQgHY9slmnYev9FS0yAOk+wARYEH+L7hgoAMMy3204EkrKyU6GIHQU7owTC4k9BwH8Dk7Gc+AuzJ2EhUFULEvRPGbvNKBltbzvMFM/E9DbTKAGCs+sBsacO4FTpveQGXuSbxn21AO0yWlzDZS/8hoYO2sIfM486GaG4a04rSizuOCvPuwn5fMj1Vr6Ppn+71lCP4m1uT3evtGW/Kz93/6tityyipxCl7S3v7c/IJamSKZiBaIUK5JDio8vkpoW3RF6BJLFsnIFNDhfjKxHvEzu82C78OPNNyleIhYlx9IYWJJJLF31o2GmCrnKWI7CXcMBvPk/NkD4xkAAAAA=) format('woff2');}
@font-face{font-family:IDLUEF-LMRoman10-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAm4AAoAAAAAELwAAAlsAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAgVwKmAyRdgsyAAE2AiQDYAQgBYMYByAbwwxRVI1qAD8TbLqnCyyghlYijOTrA2E7Ezd/sOzn6bTe/xOo1M2kQlghYCXdpqu0ayl3K4kH4t69P2bbNlEXWGAJdflYOq1AAtsap/U/QLbv+ddp6t+x5KQkChEe0bd0wE4B2F7tqa8Ch8gOEXx43TpsnTq189wv9Sra6PDoCDKta10gFc+35wO7b6t+HgkWpbPTRYEdiE8HCHuIN1xs6cQugAi+gIlAB/iKz/2xhQmND72qVECK2AAMBtBCIFk5665h6O4LPXHfn6sA0CTIjy/wl0UDFhMAbJ0oJdOcDAqASo/XnB8EgYJSohxlylWoUqNWnUbNWrTr0KmLQY/WUfOVaeGIla50xhAv1aOT3K4N3gJq1G8IOB0tWASiUMQNT/vDaU5k3QQcxnACJZDI3L3ObUeaE48n5YdK2KsRxPgwS77km/QW+1aSRYyqDA1Pk1/ZnUQhJIJQlVIXzyNkRX9Z/XQbRhAhJ5AoVRxEiTck04WtGNsswOdzhKAFcK5e//P1PSwLfDC2tiCI8eNmorATXX4MR+kjR5h9xt2dk/gcwdiSRJTi70zV3gSqYhynmoIpM7rmNERClImrWxBBbMXXtnMoVY3Orx/6DqWvlVMZ1tnld07nehX1AVT92bMV+NTNesTnULiup5L1iZ41WXj0RKmbyEQVTKl+oTq+WleOrWUvemLFvwGh6zvhTfTGLs0BhLDOrdjxfr4hcyK4nV6h97pbZUZrjNJ7QwAHAUJBjfuYTvlVbRD/UvZ8c08lUM+Y9ArGsJkkrygelKjx0K4Ly9bJw4RBatMT3ZFzkBCFUtWFw5R3M3pjegg/UUhaARcJ8zmdVDU5QbfVSlu4l8cY6lq0xY2Tuvez9Bxplg3Aq9SH1/mPVHty8zv4vruD9fg7YkRjLXYeI6htxGtuwd4fZZ3EGMstyEnCHas5npH2QckzEtxOVe963uyu0NkP64P9B6o7pni3HOgO0oX+Ku+sVB/wqK1a3IDs2FJgI8b0DQWCdW8waCbZTgSZhs4rDNY00d0f1VN1fFvoxmRe7XgOBzoLynzOGXf3lef2vkhPT9Ogq9tHcmHnGjqvKIee1WEG6ZV5NoRmyc+pJ8mEde4l9iE/N07q3+dch5S+7+5y9jh6JXENMdzdHMdsQJXg5oudt7Ui2LGRHxuriVoAqBNMP4yrNk9BW744E72xE78Q3kRVcz0uxpQkU2ZqRdEQ64PFAQXt+VVAWePbcXq/zY4qO2SORznLApoxCjiGY9gzWpDQmOVajQDcGxAghSQb4kgEoOtFv4bhqk2qgmbEdrqvfG1sJT7sQ5kTB8H1vdx4kL3to3dKkzQk4/FKqqIyxphsL6uS5MiO6gC0dAQY0vssQZBVfby8ztdwmKr3/+XYv36V+jxWDei2MGUBLVEw9fW7NSK3+Ozllf9gOPihAjy3/R3BxOA4jGA5fPrq2v9oaOv9f27cfCsCXBb0/IcZ/71Z+CZTN8Nc+/nT98/8ESrn/RkQ6K/lySHf14Cfa0DV5afKDV+F++TVLz5c8TPt64lBFGL+0jNxcomDW7iyJoE45MACypiEU0pg5RvIHiaGqDSdtGFEebZVdiWejCdlVWCqLHsY1qKcsH2ShP0Kk98HC52Dhm3Z1m9wJoi/DhfKQvR4Lp4dqhfIp30TZ8PQblazhQkyMlem3WgdXSJekY5JvuapH58FVGYzHvZgmoOMUIHsPPfe6BtHcm2tbchVrJVMuHZnOnpMreQAHK/FZOkuL9elX8dtt9caxizE/3UJlnyeeS2CDR0t0oCF/8Ob/IArfFGf8JFSUoO0OdFYoDUwKnit3kipiPV1fphvJeY4H1mY7J4T9y4RvViz1vwc/Xm7cTknwnk1raY/M78oiBGbiJJjwO4WUdlnLEJtCumSZKdy28sicjJXfUAlWpSPenpTy4E7porUmFI7fO9vB4/NYtcnqPHEESwlNwVWGtj1kyzy0okCNKAXV6Ayw8gyHFMUYSPYeMSfI3x4Q8M1bjpzGxuIrnOq54vuJ/s4qNlmrWJYaYBbY/b0pBL5qK8X16Dyf4fk42Kc2w3J9engxmNlZbsuL5287vIiFw2vXGbgbc1a2vpw87xRncwaeDcPJbIWBdgyFprMT3VDv0mWDt1reHiggHA6PiQR7uWwU/xd5NyAPs2+wToH6uudwXIiem3cdmRWmKVFlvOYZovfmcq3DrAZ1cEcYorJ2+ztYj3KP4/ZcS8mb4lXe0bk4I+n5Sja/R3BLoqZA8Uj8GzHHZiibsMbnqvifnBmBkrZC68tqXbcjinL12A75/YMlT+1TIY3aufWseUg+9JrW+F3PW7hewkb2tF35HhuP1cjhOltDy4svcs+KHkL9Clu1bM4A7y2HCbEeukJ3MYSXaQxqTP3b+Byo7EYFaLeQbgSlQ8aVYaLsXF4epE5M4kfINdR99MwM96cy0y1Tj/k7nONr2booXPH3Mof7udOLZwU25I832VKqB31UQ4dyS9yHLdtSrS+3HIItK5ZSek5yHKfIIySUibfEf7vNlqZKWRJ7xZ2+gQr0svE+oUVi2g8bXIh2ph7yWKWuNTkV+P/PjWNzno2oVqHZSDkOSdTx+lTZqx8AxlzqSAz7dDi72OIdJccez3j9jml074p5BS3f7qTjx1xrWOFO4PnFE5hYFE2qkRnayPBdxaST+gjp3EzHW+aeuU5oLrbHpOR07mNtpdEwLz8ty1py9agONX71iKCMdWyLNzsu+3VMdEHafKvObO6ZiaIyArcjMl3tda0ojab6p+JXL8PZC72SYfZ+632py9BtuvcervSIESOkpw5S3WbLaz3uRgNWRCZQORBx4XymmR9IoUlFtGfWQQNAAAe2q5KgVX+RisIyAELljSfKxYGwGXBMSmgsykUIpNoD5X9ahEoC7jhZfDCD8NJbAR3SWBrDEDhCHBDJ8DDkd0waEYAH7mBuyFswPvRJNd2CpBoPNjYoBvYyDhdhip1hBLEFEingWMQxAFmQ5GdJulmh+V0XHw5gyME9uVwBhUCmrqoNRRbOY0IWuV09rBQziCC7W05guFJYtI3EUPFIr0qMUutCcK5g/4nar51OD2xgG3Es+Fqld11Hd01TZRUIOm+OUiUJF2LJmWaiUEEeiqJsqhpBDXhIEg/u7Z3JW3LtMtWVQfrtHDZqXS0BZrAWmeztmCZTtheaYPlDJB6pW51OoI1mnBlKQhAUk2f0AEAAA==) format('woff2');}

</style>
<g id="page1">
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="288.4577" y="-98.662245" transform="matrix(.999739 0 0 .999739 -211.894 110.06699)">有限覆盖定理</text>
<text font-family="IDLUEF-LMRoman10-Regular" font-size="9.96" x="500.576327" y="-98.662245" transform="matrix(.999739 0 0 .999739 -223.75002 110.06699)">Lab<tspan x="517.587987">esgue</tspan></text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="544.20094" y="-98.662245" transform="matrix(.999739 0 0 .999739 -223.75002 110.06699)">覆盖定理</text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="206.168181" y="-63.606396" transform="matrix(.999739 0 0 .999739 -201.93199 110.06699)">确界原理</text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="288.4577" y="-63.606396" transform="matrix(.999739 0 0 .999739 -211.894 110.06699)">单调有界定理<tspan x="388.590561">闭区间套定理</tspan></text>
<text font-family="IDLUEF-LMRoman10-Regular" font-size="9.96" x="500.576327" y="-63.606396" transform="matrix(.999739 0 0 .999739 -217.42902 110.06699)">(</text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="504.450316" y="-63.606396" transform="matrix(.999739 0 0 .999739 -217.42902 110.06699)">数列</text>
<text font-family="IDLUEF-LMRoman10-Regular" font-size="9.96" x="524.371116" y="-63.606396" transform="matrix(.999739 0 0 .999739 -217.42902 110.06699)">)</text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="531.562239" y="-63.606396" transform="matrix(.999739 0 0 .999739 -217.42902 110.06699)">聚点定理</text>
<text font-family="IDLUEF-LMRoman10-Regular" font-size="9.96" x="630.166499" y="-63.606396" transform="matrix(.999739 0 0 .999739 -237.38898 110.06699)">Bolzano-W<tspan x="677.616012">eierstrass</tspan></text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="720.981792" y="-63.606396" transform="matrix(.999739 0 0 .999739 -237.38898 110.06699)">定理</text>
<text font-family="IDLUEF-LMRoman10-Regular" font-size="9.96" x="388.590561" y="-28.23163" transform="matrix(.999739 0 0 .999739 -219.78 110.06699)">Cauc<tspan x="410.452754">h</tspan><tspan x="415.711651">y</tspan></text>
<text font-family="HBBRNP-FandolSong-Regular" font-size="9.96" x="424.277245" y="-28.23163" transform="matrix(.999739 0 0 .999739 -219.78 110.06699)">收敛原理</text>
<path d="M87.50686 16.989497L45.95433 34.686677" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M48.614251 36.152476C47.703851 34.980984 46.662296 34.68832 45.77104 34.764738C46.443709 34.175084 46.954413 33.221317 46.74059 31.753154" stroke="#000" fill="none" stroke-width=".39847" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M57.4264 31.267657H75.66821V20.564687H57.4264Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 -122.429 56.215997)">反证</text>
<path d="M106.52821 16.989497V34.454287" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M108.91912 32.581386C107.48454 32.959956 106.80714 33.803566 106.52821 34.653516C106.24928 33.803566 105.57188 32.959956 104.1373 32.581386" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M97.40729 31.272617H115.64911V20.569647H97.40729Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 -82.448 56.220994)">反证</text>
<path d="M129.67497 16.989497L180.22133 34.681297" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M179.243465 31.805991C179.126868 33.285033 179.699312 34.203055 180.40937 34.747087C179.515028 34.729574 178.49504 35.09024 177.663839 36.319168" stroke="#000" fill="none" stroke-width=".398464" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M146.01528 31.252697H164.257101V20.549727H146.01528Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 -33.839998 56.200998)">反证</text>
<path d="M140.90971 14.571077L278.3962 37.306317" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M276.938475 34.642026C277.077948 36.119078 277.799722 36.924983 278.59275 37.338808C277.708724 37.475345 276.765955 38.006031 276.158464 39.359578" stroke="#000" fill="none" stroke-width=".398462" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M200.72861 31.322677H218.97043V20.619707H200.72861Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 20.874 56.270998)">反证</text>
<path d="M272.46793 8.886297H141.3082" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M143.18108 11.277205C142.80251 9.842625 141.9589 9.165225 141.10895 8.886295C141.9589 8.607365 142.80251 7.929965 143.18108 6.495385" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M197.56792 14.307507H215.80974V3.465067H197.56792Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 17.713002 39.297994)">构造</text>
<path d="M48.63461 43.952257H71.74823" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M69.875337 41.561347C70.253907 42.995927 71.097517 43.673327 71.947467 43.952257C71.097517 44.231187 70.253907 44.908587 69.875337 46.343167" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M140.90971 43.952257H171.90885" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M170.03595 41.561347C170.41452 42.995927 171.25813 43.673327 172.10808 43.952257C171.25813 44.231187 170.41452 44.908587 170.03595 46.343167" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M241.07034 43.952257H278.39082" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M276.51794 41.561347C276.89651 42.995927 277.74012 43.673327 278.59007 43.952257C277.74012 44.231187 276.89651 44.908587 276.51794 46.343167" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M250.80892 49.373477H269.050739V38.531037H250.80892Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 70.954 74.36399)">构造</text>
<path d="M192.63164 52.075377C140.51647 82.171417 90.42911 82.180197 38.65263 52.294497" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M39.079483 55.301451C39.468761 53.869757 39.076768 52.861361 38.480089 52.194898C39.355642 52.378215 40.4249 52.21326 41.469915 51.16006" stroke="#000" fill="none" stroke-width=".398475" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M106.35109 80.074397H124.59291V69.231956H106.35109Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 -73.504 105.064998)">构造</text>
<path d="M358.62094 43.952257H388.05593" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M386.18304 41.561347C386.56161 42.995927 387.40522 43.673327 388.25517 43.952257C387.40522 44.231187 386.56161 44.908587 386.18304 46.343167" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M415.0669 34.952407L350.09587 17.382417" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M351.279677 20.179226C351.288716 18.695622 350.651209 17.821527 349.90357 17.330416C350.796827 17.28303 351.787977 16.84935 352.527876 15.563383" stroke="#000" fill="none" stroke-width=".398464" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M373.26816 31.466907H391.50998V20.763937H373.26816Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 193.413 56.414995)">反证</text>
<path d="M393.47956 51.985717L249.35011 73.094977" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M251.54955 75.189166C250.967151 73.82464 250.034342 73.276643 249.15299 73.12381C249.953519 72.724696 250.690045 71.932254 250.85676 70.458033" stroke="#000" fill="none" stroke-width=".398461" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M388.45441 43.952257H359.01941" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M360.89233 46.343167C360.51376 44.908587 359.67015 44.231187 358.8202 43.952257C359.67015 43.673327 360.51376 42.995927 360.89233 41.561347" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M364.41676 49.373477H382.65857V38.531037H364.41676Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 184.562 74.36399)">构造</text>
<path d="M181.15796 70.317247L129.86655 52.198137" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M130.836104 55.076167C130.95696 53.597505 130.387179 52.677861 129.67871 52.131799C130.572974 52.151888 131.593972 51.794173 132.42869 50.567676" stroke="#000" fill="none" stroke-width=".398454" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M146.2035 66.542837H164.44532V55.839867H146.2035Z" fill="#fff"></path>
<text font-family="HBBRNP-FandolSong-Regular" font-size="6.97" x="181.902828" y="-28.223613" transform="matrix(.999455 0 0 .999455 -33.652 91.491)">反证</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-real-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: 实数完备性定理等价关系示意图
</figcaption>
</figure>
</div>
</section>
<section id="example-3" class="level2">
<h2 class="anchored" data-anchor-id="example-3">Example 3</h2>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-ulaccu" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> 设数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 有界，其上极限 <img src="https://latex.codecogs.com/png.latex?%5Cvarlimsup_%7Bn%20%5Cto%20%5Cinfty%7D%20x_n%20=%20L">，下极限 <img src="https://latex.codecogs.com/png.latex?%5Cvarliminf_%7Bn%20%5Cto%20%5Cinfty%7D%20x_n%20=%20l">，则 <img src="https://latex.codecogs.com/png.latex?L"> 是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的最大聚点，<img src="https://latex.codecogs.com/png.latex?l"> 是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的最小聚点.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Theorem&nbsp;1 中，我们已经知道，一个数列的收敛子列的极限也是该数列的一个聚点. 结合上下极限的子列式定义即可证明上述定理.</p>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-ullim" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> 设数列 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 有界且 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D(x_%7Bn+1%7D%20%E2%88%92%20x_n)%20=%200">，分别记 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的上下极限为 <img src="https://latex.codecogs.com/png.latex?L"> 和 <img src="https://latex.codecogs.com/png.latex?l">. 证明 <img src="https://latex.codecogs.com/png.latex?%5Bl,%20L%5D"> 上的任意点可作为 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 某个子列的极限.</p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>反证. 假设 <img src="https://latex.codecogs.com/png.latex?%5Bl,%20L%5D"> 上有一点 <img src="https://latex.codecogs.com/png.latex?a"> 不是任何 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的收敛子列的极限，则根据 Theorem&nbsp;1，<img src="https://latex.codecogs.com/png.latex?a"> 不是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的聚点，即存在 <img src="https://latex.codecogs.com/png.latex?a"> 的一个邻域 <img src="https://latex.codecogs.com/png.latex?U(a,%5Cvarepsilon)">，使得只有有限个 <img src="https://latex.codecogs.com/png.latex?x_n"> 落入该邻域，换句话说，存在某个 <img src="https://latex.codecogs.com/png.latex?N%20%5Cin%20%5Cmathbb%20N_+">，当 <img src="https://latex.codecogs.com/png.latex?n%3EN"> 时，就有 <img src="https://latex.codecogs.com/png.latex?x_n%20%5Cnotin%20U(a,%5Cvarepsilon)">.</p>
<p>又，考虑到 Theorem&nbsp;4 表明上下极限 <img src="https://latex.codecogs.com/png.latex?L"> 和 <img src="https://latex.codecogs.com/png.latex?l"> 都是 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 的聚点，<img src="https://latex.codecogs.com/png.latex?L,l%20%5Cnotin%20U(a,%5Cvarepsilon)"> 显然成立，且第 <img src="https://latex.codecogs.com/png.latex?N"> 项后的 <img src="https://latex.codecogs.com/png.latex?%5C%7B%20x_n%20%5C%7D"> 完全由满足 <img src="https://latex.codecogs.com/png.latex?x_n%20%3E%20a+%5Cvarepsilon"> 和 <img src="https://latex.codecogs.com/png.latex?x_n%20%3C%20a-%5Cvarepsilon"> 的两种 <img src="https://latex.codecogs.com/png.latex?x_n"> 构成，且它们均有无穷多项. 这样，对于任意的 <img src="https://latex.codecogs.com/png.latex?M%3EN">，总可以找到一个 <img src="https://latex.codecogs.com/png.latex?m%20%3E%20M"> 使得 <img src="https://latex.codecogs.com/png.latex?x_m"> 和 <img src="https://latex.codecogs.com/png.latex?x_%7Bm+1%7D"> 分属 <img src="https://latex.codecogs.com/png.latex?U(a,%20%5Cvarepsilon)"> 的两侧，故 <img src="https://latex.codecogs.com/png.latex?%7Cx_m%20-%20x_%7Bm+1%7D%7C%20%5Cgeqslant%202%20%5Cvarepsilon">，这就与条件 <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D(x_%7Bn+1%7D%20%E2%88%92%20x_n)%20=%200"> 产生矛盾. 故不存在这样的 <img src="https://latex.codecogs.com/png.latex?a">，定理得证.</p>
</div>
</section>


<div id="quarto-appendix" class="default"><section id="acknowledgments" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Acknowledgments</h2><div class="quarto-appendix-contents">

<p>感谢史老师主持研讨课并指出讲稿的多处错误，特别是原来聚点定理的证明中数列元素可重的 bug. 史老师还提供了标准聚点定义的另一种叙述.</p>



</div></section><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-lizhong" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">李忠 and 方丽萍, <em>数学分析教程</em>. 北京: 高等教育出版社, 2008, pp. 257–258.</div>
</div>
</div></section></div> ]]></description>
  <category>数学</category>
  <category>题解</category>
  <category>讲稿</category>
  <guid>https://blog.sun123zxy.top/posts/20221213-cover/</guid>
  <pubDate>Mon, 12 Dec 2022 16:00:00 GMT</pubDate>
</item>
<item>
  <title>SunQuarTeX-cnart 测试文档</title>
  <dc:creator>sun123zxy </dc:creator>
  <dc:creator>佚名 </dc:creator>
  <link>https://blog.sun123zxy.top/posts/20221223-quarto-test/</link>
  <description><![CDATA[ 




<section id="前言" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="前言"><span class="header-section-number">1</span> 前言</h2>
<p>具体使用方法参见 <a href="https://github.com/sun123zxy/sunquartex">sun123zxy/sunquartex</a>．</p>
</section>
<section id="文章结构测试" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="文章结构测试"><span class="header-section-number">2</span> 文章结构测试</h2>
<p>这一节测试文章结构．</p>
<section id="文章分节" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="文章分节"><span class="header-section-number">2.1</span> 文章分节</h3>
<p>非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
<section id="sec-test" class="level4">
<h4 class="anchored" data-anchor-id="sec-test">文章分分节</h4>
<p>Quarto 支持交叉引用．比如这一节的标题就已经被打上了标签．</p>
<section id="分分分节" class="level5">
<h5 class="anchored" data-anchor-id="分分分节">分分分节</h5>
<p>本节中我们测试交叉引用 小节&nbsp;2.1.1．</p>
<section id="分分分分节" class="level6">
<h6 class="anchored" data-anchor-id="分分分分节">分分分分节</h6>
<p>这是最小的一级了．</p>
</section>
</section>
</section>
</section>
</section>
<section id="图片表格列表测试" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="图片表格列表测试"><span class="header-section-number">3</span> 图片、表格、列表测试</h2>
<p>这是 Quarto 的图标．</p>
<div id="fig-quarto" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quarto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://blog.sun123zxy.top/posts/20221223-quarto-test/index-quarto.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quarto-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;1: 这是一张插图
</figcaption>
</figure>
</div>
<p>交叉引用 图&nbsp;1 当然也是可以的．</p>
<p>这是一个紧凑列表．</p>
<ul>
<li>自反性．</li>
<li>反对称性一个和非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</li>
<li>传递性．</li>
</ul>
<p>这是一个宽松列表．</p>
<ul>
<li><p>自反性．</p></li>
<li><p>反对称性一个和非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
<p>还多加了一段．</p></li>
<li><p>传递性．</p></li>
</ul>
<p>这是一个定义列表．</p>
<dl>
<dt>自反性</dt>
<dd>
<p><img src="https://latex.codecogs.com/png.latex?a%20%5Csim%20a"></p>
</dd>
<dt>反对称性</dt>
<dd>
<p><img src="https://latex.codecogs.com/png.latex?a%20%5Cleq%20b%20%5Cland%20b%20%5Cleq%20a%20%5Cimplies%20a=b"></p>
</dd>
<dt>传递性</dt>
<dd>
<p><img src="https://latex.codecogs.com/png.latex?a%20%5Cleq%20b%20%5Cland%20b%20%5Cleq%20c%20%5Cimplies%20a%20%5Cleq%20c"></p>
</dd>
</dl>
<p>当然也可以使用 Markdown 表格．例如 表&nbsp;1 (a).</p>
<p>多表格并列．加上 表&nbsp;1 (b)，它们共同组成了 表&nbsp;1．</p>
<div id="tbl-panel-unsolved" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-panel-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel-unsolved" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-cartesian-unsolved" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<div aria-describedby="tbl-cartesian-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?L_i%20%5Ctimes%20C_j"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?4"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;">?</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-cartesian-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 笛卡尔积
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-panel-unsolved" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-power-unsolved" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<div aria-describedby="tbl-power-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?L_i%5E%7BC_j%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?4"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?2%5E%7B%5Cmathbb%20R%7D"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20N"></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R"></td>
<td style="text-align: center;">?</td>
<td style="text-align: center;">?</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-power-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 集合幂
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-panel-unsolved-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;1: 相关集合的势（不完整版）
</figcaption>
</figure>
</div>
</section>
<section id="数学公式定理系统测试" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="数学公式定理系统测试"><span class="header-section-number">4</span> 数学公式、定理系统测试</h2>
<p>这一节我们测试数学相关内容．直接在源文件中写 raw LaTeX 就可声明公式所需的宏定义．由于 <code>\DeclareMathOperator</code> 只能在 LaTeX 的导言区使用，这里我们用 <code>\newcommand</code> + <code>\operatorname</code> 的方式替代．</p>
<p>下面的公式使用了上面定义的 macro． <img src="https://latex.codecogs.com/png.latex?%0A%5Coperatorname%7Bran%7DA%20:=%20%5C%7B%20y%20%5Cmid%20(x,y)%20%5Cin%20A%20%5C%7D%0A"></p>
<p>两个集合 <img src="https://latex.codecogs.com/png.latex?A,%20B"> 的笛卡尔积定义为 <img src="https://latex.codecogs.com/png.latex?%0AA%20%5Ctimes%20B%20=%20%5C%7B%5Clangle%20x,y%20%5Crangle%20%5Cmid%20x%20%5Cin%20A%20%5Cland%20y%20%5Cin%20B%20%5C%7D%0A"></p>
<p>显然，笛卡尔积不满足交换律和结合律. 在势的视角下，它的表现如何呢？</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="thm-cartesian-preserve" class="theorem">
<p><span class="theorem-title"><strong>定理 1 (笛卡尔积的保势性)</strong></span> 这是一个有 caption 的定理.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20%5Cpreccurlyeq%20C%20%5Cland%20B%20%5Cpreccurlyeq%20D%20%5Cimplies%20A%20%5Ctimes%20B%20%5Cpreccurlyeq%20C%20%5Ctimes%20D%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>建立单射 <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cvarphi:%20A%20%5Ctimes%20B%20&amp;%5Cto%20C%20%5Ctimes%20D%20%5C%5C%0A%5Clangle%20x,y%20%5Crangle%20&amp;%5Cmapsto%20%5Clangle%20f(x),%20g(y)%20%5Crangle%0A%5Cend%7Baligned%7D%0A"> 即可，其中 <img src="https://latex.codecogs.com/png.latex?f"> 和 <img src="https://latex.codecogs.com/png.latex?g"> 是由 <img src="https://latex.codecogs.com/png.latex?A%20%5Cpreccurlyeq%20C"> 和 <img src="https://latex.codecogs.com/png.latex?B%20%5Cpreccurlyeq%20D"> 确定的单射.</p>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="cor-random" class="theorem corollary">
<p><span class="theorem-title"><strong>推论 1</strong></span> 等势意义下可用等势的集合替换参与笛卡尔积运算的集合，即 <img src="https://latex.codecogs.com/png.latex?%0AA%20%5Capprox%20C%20%5Cland%20B%20%5Capprox%20D%20%5Cimplies%20A%20%5Ctimes%20B%20%5Capprox%20C%20%5Ctimes%20D%0A"></p>
<p>这是一个没有 caption 的定理.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<div id="exm-rtimesn" class="theorem example">
<p><span class="theorem-title"><strong>例 1</strong></span> 证明 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20R%20%5Ctimes%20%5Cmathbb%20N%20%5Capprox%20%5Cmathbb%20N%20%5Ctimes%20%5Cmathbb%20R%20%5Capprox%20%5Cmathbb%20R%0A"></p>
</div>
</div>
</div>
</div>
<div class="proof">
<p><span class="proof-title"><em>证明</em>. </span>利用 定理&nbsp;1 对 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R%20%5Ctimes%202"> 和 <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%20R%20%5Ctimes%20%5Cmathbb%20R"> 夹逼，立刻得到 <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%20R%20%5Capprox%20%5Cmathbb%20R%20%5Ctimes%202%20%5Cpreccurlyeq%20%5Cmathbb%20R%20%5Ctimes%20%5Cmathbb%20N%20%5Cpreccurlyeq%20%5Cmathbb%20R%20%5Ctimes%20%5Cmathbb%20R%20%5Capprox%20%5Cmathbb%20R%0A%5Cimplies%20%5Cmathbb%20R%20%5Ctimes%20%5Cmathbb%20N%20%5Capprox%20%5Cmathbb%20N%20%5Ctimes%20%5Cmathbb%20R%20%5Capprox%20%5Cmathbb%20R%0A"></p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>解</em>. </span>这是一个解．</p>
</div>
<div class="proof remark">
<p><span class="proof-title"><em>注记</em>. </span>这是一个注记．</p>
</div>
</section>
<section id="数据可视化table-figure-diagram" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="数据可视化table-figure-diagram"><span class="header-section-number">5</span> 数据可视化（Table, Figure &amp; Diagram）</h2>
<p>Quarto 的另一大卖点．</p>
<div id="cell-fig-polar" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"></span>
<span id="cb1-4">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb1-5">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r</span>
<span id="cb1-6">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(</span>
<span id="cb1-7">  subplot_kw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'projection'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'polar'</span>} </span>
<span id="cb1-8">)</span>
<span id="cb1-9">fig.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-10">ax.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-11"></span>
<span id="cb1-12">ax.plot(theta, r)</span>
<span id="cb1-13">ax.set_rticks([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb1-14">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-15">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-polar" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://blog.sun123zxy.top/posts/20221223-quarto-test/index_files/figure-html/fig-polar-output-1.png" width="450" height="439" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-polar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;2: A line plot on a polar axis
</figcaption>
</figure>
</div>
</div>
</div>
<p>交叉引用 图&nbsp;2 当然也是可以的.</p>
<p>这里再测试一些较复杂的并列效果．（表&nbsp;2, 表&nbsp;2 (a), 表&nbsp;2 (b), 图&nbsp;3, 图&nbsp;3 (a), 图&nbsp;3 (b)）</p>
<div id="27813e09" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Markdown, display</span>
<span id="cb2-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tabulate <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tabulate</span>
<span id="cb2-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-6"></span>
<span id="cb2-7">R <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">900</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb2-8"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1110</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1120</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1130</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1140</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1150</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1160</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1170</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1180</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1190</span>,</span>
<span id="cb2-9"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1200</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1210</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1220</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1230</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1240</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1260</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1270</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1280</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1290</span>,</span>
<span id="cb2-10"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1400</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4000</span>,math.inf])</span>
<span id="cb2-11">U <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">24.2E-3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.386</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.747</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.104</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.460</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.813</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.16</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.51</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.86</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.19</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.48</span>,</span>
<span id="cb2-12"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.70</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.75</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.77</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.78</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.80</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.81</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.83</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.84</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.85</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.86</span>,</span>
<span id="cb2-13"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.87</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.90</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.92</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.94</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.96</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.97</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.98</span>,</span>
<span id="cb2-14"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.99</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.08</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.16</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.39</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.66</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.85</span>])</span>
<span id="cb2-15">I <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>,</span>
<span id="cb2-16"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>,</span>
<span id="cb2-17"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1</span>,</span>
<span id="cb2-18"><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.130</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">47.7E-3</span>])</span>
<span id="cb2-19">P <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> U<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>I</span></code></pre></div>
</details>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[R[i], U[i], I[i], P[i]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">34</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>]]</span>
<span id="cb3-2">display(Markdown(tabulate(table, headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R (Ω)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U (V)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I (mA)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P (mW)"</span>])))</span>
<span id="cb3-3">table <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[R[i], U[i], I[i], P[i]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>)]</span>
<span id="cb3-4">display(Markdown(tabulate(table, headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R (Ω)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U (V)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I (mA)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P (mW)"</span>])))</span></code></pre></div>
</details>
<div id="tbl-light-on" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-light-on-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display cell-output-markdown quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-light-on" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-light-on-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<div aria-describedby="tbl-light-on-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-light-on-1" class="do-not-create-environment table">
<thead>
<tr class="header">
<th style="text-align: right;">R (Ω)</th>
<th style="text-align: right;">U (V)</th>
<th style="text-align: right;">I (mA)</th>
<th style="text-align: right;">P (mW)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0242</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">0.08712</td>
</tr>
<tr class="even">
<td style="text-align: right;">100</td>
<td style="text-align: right;">0.386</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">1.3896</td>
</tr>
<tr class="odd">
<td style="text-align: right;">200</td>
<td style="text-align: right;">0.747</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">2.6892</td>
</tr>
<tr class="even">
<td style="text-align: right;">300</td>
<td style="text-align: right;">1.104</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">3.9744</td>
</tr>
<tr class="odd">
<td style="text-align: right;">400</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">5.256</td>
</tr>
<tr class="even">
<td style="text-align: right;">500</td>
<td style="text-align: right;">1.813</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">6.3455</td>
</tr>
<tr class="odd">
<td style="text-align: right;">600</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">7.56</td>
</tr>
<tr class="even">
<td style="text-align: right;">700</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">8.785</td>
</tr>
<tr class="odd">
<td style="text-align: right;">800</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">10.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">900</td>
<td style="text-align: right;">3.19</td>
<td style="text-align: right;">3.5</td>
<td style="text-align: right;">11.165</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">3.48</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">11.832</td>
</tr>
<tr class="even">
<td style="text-align: right;">1100</td>
<td style="text-align: right;">3.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.21</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1200</td>
<td style="text-align: right;">3.87</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.384</td>
</tr>
<tr class="even">
<td style="text-align: right;">1300</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11.97</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1400</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: right;">11.832</td>
</tr>
<tr class="even">
<td style="text-align: right;">1500</td>
<td style="text-align: right;">4.16</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">11.232</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: right;">4.39</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">9.658</td>
</tr>
<tr class="even">
<td style="text-align: right;">4000</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">5.2658</td>
</tr>
<tr class="odd">
<td style="text-align: right;">inf</td>
<td style="text-align: right;">4.85</td>
<td style="text-align: right;">0.0477</td>
<td style="text-align: right;">0.231345</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-light-on-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) （粗）
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display cell-output-markdown quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-light-on" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-light-on-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<div aria-describedby="tbl-light-on-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-light-on-2" class="do-not-create-environment table">
<thead>
<tr class="header">
<th style="text-align: right;">R (Ω)</th>
<th style="text-align: right;">U (V)</th>
<th style="text-align: right;">I (mA)</th>
<th style="text-align: right;">P (mW)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1110</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">12.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">1120</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">12.818</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1130</td>
<td style="text-align: right;">3.78</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">12.852</td>
</tr>
<tr class="even">
<td style="text-align: right;">1140</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">3.4</td>
<td style="text-align: right;">12.92</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1150</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.573</td>
</tr>
<tr class="even">
<td style="text-align: right;">1160</td>
<td style="text-align: right;">3.83</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.639</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1170</td>
<td style="text-align: right;">3.84</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.672</td>
</tr>
<tr class="even">
<td style="text-align: right;">1180</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.705</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1190</td>
<td style="text-align: right;">3.86</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">12.738</td>
</tr>
<tr class="even">
<td style="text-align: right;">1200</td>
<td style="text-align: right;">3.87</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.384</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1210</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.48</td>
</tr>
<tr class="even">
<td style="text-align: right;">1220</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.544</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1230</td>
<td style="text-align: right;">3.93</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.576</td>
</tr>
<tr class="even">
<td style="text-align: right;">1240</td>
<td style="text-align: right;">3.94</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.608</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1250</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">1260</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">12.64</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1270</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">12.276</td>
</tr>
<tr class="even">
<td style="text-align: right;">1280</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">12.307</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1290</td>
<td style="text-align: right;">3.98</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">12.338</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-light-on-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) （细）
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-light-on-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;2: 太阳能电池的负载特性
</figcaption>
</figure>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb4-2">fig.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-3">ax.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-4"></span>
<span id="cb4-5">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"U (V)"</span>)</span>
<span id="cb4-6">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"I (mA)"</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">ax.plot(U, I, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>)</span>
<span id="cb4-9">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-10">ax.set_xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-11">ax.set_ylim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-12"></span>
<span id="cb4-13">plt.show()</span>
<span id="cb4-14"></span>
<span id="cb4-15"></span>
<span id="cb4-16">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb4-17">fig.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-18">ax.patch.set_alpha(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-19"></span>
<span id="cb4-20">ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R (Ω)"</span>)</span>
<span id="cb4-21">ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P (mW)"</span>)</span>
<span id="cb4-22"></span>
<span id="cb4-23">ax.plot(R, P, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>)</span>
<span id="cb4-24">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-25">ax.set_xlim((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>))</span>
<span id="cb4-26">ax.set_ylim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-27"></span>
<span id="cb4-28">plt.show()</span></code></pre></div>
</details>
<div id="fig-light-on" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-light-on-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-light-on" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-light-on-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-light-on-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://blog.sun123zxy.top/posts/20221223-quarto-test/index_files/figure-html/fig-light-on-output-1.png" data-ref-parent="fig-light-on" width="589" height="429" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-light-on-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 输出电流与电压关系曲线
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-light-on" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-light-on-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-light-on-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://blog.sun123zxy.top/posts/20221223-quarto-test/index_files/figure-html/fig-light-on-output-2.png" data-ref-parent="fig-light-on" width="602" height="429" class="figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-light-on-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 输出功率与负载电阻关系曲线
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-light-on-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;3: 太阳能电池的负载特性
</figcaption>
</figure>
</div>
</section>
<section id="diagrams" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="diagrams"><span class="header-section-number">6</span> Diagrams</h2>
<p>Quarto 原生支持使用 GraphViz 或 Mermaid 绘制有向图或流程图．我们还额外支持 TikZ / <code>tikzcd</code> 的渲染！</p>
<div id="fig-tikzcd-han" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tikzcd-han-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="573.195pt" height="201.165pt" viewbox="0 0 382.13 134.11">
<style type="text/css">
@font-face{font-family:MSDCVE-FandolSong-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAbAAAoAAAAACjgAAAZ0AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqNCIpUCwwAATYCJAMMBCAFgyEHIBtGCCCO1FZzFElyEw/Efet1XIfd3O1p0e+DBZaHcdyE7d7jS7yLS9DwdPPf5V013uJgJE6nwQ3+VJ+uTzF8Af///dSfK4oCarGp/mr8d2uM0lmJJuCo7dGi7QHPdiZmW2R3OizyDbE4iFwBneiNcvEfAqYGB3rjGiA54gJYIkkizdHjqW8zYAQ3Buynvvz3FIAKHySuisDh53/gi/LFqHWsR2SIZnMuKy0qGtww1TeaBuzvYKh2x4bIBUvmLRmj7SVPAwl6FgOILgrzt6UZp2oS7AMp0VIIS+zmlqBhMlxiab40WhYnq7IGt1qQEGyDLYfndDr9y9Yd20bAE0LycG4+OWnD9trtJLAJBA4HYbNhgHgkepjk+FrtbbgbiVvNMAeEdYuGhGAQPlKqfnoCEmLin41cu1BgWcGbxRPN24Tz7aEr7WvnLlixQiRb56iA4BNISB4OEbjV24yEAHZQbLXAGCAbGMW8YU/K/HnrdHx8J3+2iGozEE4cp2I8crPTKRaPsM4evZdTMHa8cSXIwN7iVgvM8bUKE9faccS5q/Y5dF3kBy/RhAjXyU/2hydkVGSynSSMlbKDSRLG2RC8BMFsSIWyxg1JiVPcKHGMrw5akIjcbbEVMcMwN5D+CSkmCAYHCvnGlSBvUcwbsHnz1oWlQfbdEASD9xSS2mcVKpwyp0KLkzdtcwQRfjYBxjs+gxWSamASDGykHdiWwCdhox1ctQOJOOTgxa1Rtebk+WT6MhjDF9qF/Xiztm3K42t3rl2IxHBR3IpYEE7uWgsMY9qVa72tC1Zk5WVhezCek7wURvDtqc7ofI4NQfKUA0iIwNlOsRiOIfZD09SwIiGAW/3XthLJAPhQA3EyrYgZCZFw5bgVIFNgnrMHE81aR/DtE1dDEOcIIjFtiuLbNy7cMIvnF2ezpchWH46Ph0H48zzZkLQL2XFOXmaubNg5J16SbFT2O/H364WXI3wNPL/7N6uhlreS1FfI1wvGms7moI7IHd6VgLtjaxYM4m3K1UUbIs8bd3r5NXtfzZ7ZdkOWVR3r6JaGDuGXQSsSJEZ9MIsZvpte/svkzug6Pu8cvebfbHqvi5tyX5QZd7eaVjkS7dpuM0uiBili379qUQoP31HHpneb6BrwqiNakw8uJT9O2CENl6+BGulDyoLr6NTZixdEMnn70+lTwMWmiMqO3HYkifY2WNP/C1fvMq7/aEp4UURuvFKHnDB0QQEqxToVOaN4UHhZUjMai4q289K0U0Sq9MbM4jv9ps76Xcal5L7gnpZLCDUr5pre8UE4oLiay5azVu1416JWRUoCVC1LPT/Gd7d2mx8v6RtXp81QTl3cc6BsaRH2bEIqFlO8TFtGre1eyxxEKRyx9s/KvxbYn26kSLyB99+numFJxxm2q0X5tIaC0OeM1dVlZpyGE2EW5ujpNfnH//UNorJXDZNvv9WU7nJfGJntP8w8rBmVBJ0Doj0nbfaIAe4cjdCzL35+Eafc/bjnyFvX0BbG9MDU9beabwluNdx6/a08SZ1tMDofGvO5Sowp90ggjsdpTvkGqNOm+c9NZunLo0YyKJaLYhNPteWNVoWHM3vyF7mSYtND2VJDsVmf9XzPOGkiXjuoh16hMhn6JCYagwZxtV5d7J5DfdTutSZvrA64XlaneCbuLn/OubiSsMiGSCX7QindM1MpjQxRl1okXBFfMxMqeDrIGFViCq7oniVPkbSqA3Mnxk1VJKsU99Vg5JeQTxQ0lTFoL6O9OPp0mEYm3XtBkkT3mkDX4QE7+C8q17xdQG0kg3iIfgxNxw7wp/S7EUhdvncAmiKPPk1dv/t5yLw4qVe/vAEKQV6la6hvyO1+sv52ugDsG9uWF8ef/qhrZ/gSv0H+MbErAtf3O/OBWlILkhHRyO9dWxg1bjlfWVQawEv/yNqSSuepauGL9fmdttihsOPfEafJM/ZOCkB8r2BM5PRw2km4A2YPJqRy1rmVGqllJeM64GRCzkBNYjbudlaXGlUk7gIi6upwMm6mTzKhabWaxOxBVNbCe1VdV0O3jjeEVxlRhZxQxjYzY3/lJ161T5cYlwA28lwGr6Fva6++zZ0ByXFJcUlApU6XBt10QHWj0MwoDleQIyjFAjVilWh00EcHAPRENGj11EsryHoHSBQnoVekWu/qXXad3ho1QL0BFdkN+mrVC5p1Nmoli5Pk0lQgI3kAAAAA) format('woff2');}
@font-face{font-family:RSGHQW-MSBM10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJoAAoAAAAABCwAAAIfAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBdIFqCwYAATYCJAMIBCAFgkoHIBtpA0Aeg23bOI5zhhhiqMkQkZ8iCC5zdr+UkioQCvYCGK8ewWoQkxf/+2Hd++6bg6Ao3uAkN6lBh7g21xX7/+BNnsgGdO2ElNi1dwQfaKBFEWaBnEtpQCkH4uk23aXHEIvC9nRFO5SyFhlVIf/yYT02klH8kWEfbACroED0/NFUDAyHtdLuOg6wJXZPPVgEiRLGqAJjNLtAWVngsIi8+Nc7ugLKfO8V8AJAGVDaZ/CaAf3hrC6JJCIIwxKwxFk5njhA+k+j6Myzyz3mhCVtmhFJZPKWOZk4feeK3hmia+rT0/KB2QRksmlkmgcj/okgkklyZXeLl8CniDRjg2yDbZ/jkLwj+I1q3bScYfPoMmpgl8v1++UP/fi0pkTZ0wIFh+NJySnUrdLaU/ICVuBTC8+rNR/C/btefU1cxE8waPQmpKL3JOcwZcskZSCyM/fbzf1dTQ+QaAp6MAYgEHzVwvayhR7/rBINYCXbiIPVqUKe5itQlyC49YFcMWKcp+4gT+hrEaQr1I5QRdMnBKDi7HBZRwVXtAxxVcfWdNOSGaoosyE0HRkuW4rCFVMluGqp62rTnpnjxorCurj44JDYZMvIeL9IW5vXcd/WyqbT+PMcK2gqrW8qrtSxt7IbHxYCNapQqE6ceMFCxEpmKVI8P5Fs2UhSqE69UtWq6LBlxUYBgt0qFZ+rQaGCO3la6SjQpFS9JsUq6bBnxW6mVNAFAA==) format('woff2');}
@font-face{font-family:TPLXCN-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJYAAoAAAAABGQAAAINAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqBdIFbCwwAATYCJAMSBCAFgmIHIBuMAwAeg23bKbrdumWPeETFK5zgNIL6sd/esy+GebSm0yF1CImmiUoo9EoK9/f7+879InaTGoGGSEQytJ0OPsy2DW2TUIbs/3uL/xv4BnSqT3C2Lo0CKvAEM7vxuCm/wQMPOLB0m6LiFSGNZl1B9DVAjUE0B3TKH+X6T2a2e2gTIDLYAA9I8Covb4NNwHCtokKiCl5tJkBBxZ6v2UNzC0xNFdwoU5EJXKPb/p9yP/cgANDBHA1PwCsADRD2uCMVi1UzOkEUEoSVIItIcnJPhmEF2FOBerkOx/IxbCKUJFk4RhR6VpSrk3gBjtdw2FyYD24Vi4O4TA7KfZ0f1NaEKl1F2gMePJ+u2/NDtQ31Cu5FRXXSNzEchyrrnq3gTIwlct5teU3KT/xs5L6kpYutiC1fpxxoOWXqpu60DjYTbOAGgEDwvrr8rNrEvrIqDeBfdpDrvwVSUWGqgKBKFA4pIx8QAKAVIH6hPqYhKnQwQgmhO4JASMHcNwM2KMJmaYNpt3BKh6XL+rkTEaiisSFcSBfaHGml3YFxOhxZi+YenR9u/XXnyvzs9OK4TH9cRm44dGdOhAOhqdhDaFr9YEvfYFOHKTIQkUdDnC4dug3o16CXSYYu9fr1OuXLlq5YnEx+cTLkCgsp1KBXnxZdOpmEBYQqIMl0VpmanaDerzUykusNatFX1KSDSaSAiFCkAgAA) format('woff2');}
@font-face{font-family:XBHJXX-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAWYAAoAAAAACIAAAAVOAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqJeIc3CxAAATYCJAMcBCAFgmgHIBuABiMR9mJygiH+Q4ImcTVczSNSy26rjbVDILGKNMJexqinVhVbwbAebb/6ybhM4P9A4Nb/ChPiKfHwz71638saFA1oPKHBYx9foqstSLloFRvzeP0fylWTnEB0ILtVdXiQk7f24U+7Ac4/3s53vt7zNNDoo6wQszjBfthfvkE+4v+D3e4GKruuKSttjaE5A2gIAFDGCdABX4fXQeQ1p5wmkFFMUfPQEz/op3QTVrJiLsPySH3k9g5Ls8KKf1pPqJk8/XTd9Z3/a+pF2zVHAlja3TJA1/jp3kCbuMqiaGLjGcl8dx8lKGlY22Nf4j7uCaXMRO0QB/Il+vnLhaNlo56qDbjBACBVgfwA3nXuzo2DeBExVzHwnxIEFBRdFCzZKgE9LaWH0K810YtBLBLqYSDmCtA8QB0LEIwuByWIqaG6sg1y4xkg/qJyjiwboeGLUS2UtYqXsvCGYlW4ZqBFUiCVNjpdXR9rII/XZHFYuJ09/JRfI9LjfwAH1yy4fHBRKUvacv6mv/ZtXQdcJO3s+Oi3RHuisvYVeBj4kS+KAOL3yVnFCGwznKVemyhsEU1eBVBC6fyFof7nmS3jyTnMe5JbrQDhnLODvLVPOTwj6iui5rq3SQuOcHmEU7LNI4IVGBPrH7LOMae2Km5tGVoMd1/YkCoBsW6DX63MIVD7X+xgZWpZS+t8OCHZEpQbyGs1BQUuHhDBNR4tqpRNR5bcAFEf98/OtqpA2WF59QEH2wTvZBnpCM/B4ae4YVzPmvXnYctQp6eWtU2e7uhPgXHU6KmWQaDB57f4pAdarsr9gQv+Bfovss7x4SqbXDMwfP29lbs+SQEhsm6j7OGvfB1lH0/xGGsFbQEtSlqvATXIHWEHiSWQR1NS5/SP7+jLsYUXrLLhmeHAfSWV7Insi4IZqjsHq2VscyoizmGZ+yiS6Ks77tVkdUX3JzqDFi3+YI6OHnrScFnbemBxMl9G6xJD90iIyRjyTJyyNGazqLFtu90PBGbga9uqlb+iTjA1YIiOGnopWtt44HKjD5iL4ruDM61YGPCZTOfxP0+57VyhDTwh89Kc9G3zFd96lm3FbhWhKmz+0bVC/4KJNYvl9E3kk1p0iHthZjYPm0UIx0j9GRIpk8bkPOu2Oi77egad38fv4KI2IeHJxSzGw+YRzD3/T9cIfmebN7izfSaZ/jc4n+w432jxD8MOY1ER43AZIVM/X3cPGyrejymSqGtUKZMmbF7IOaNHbl/+rW3csBjXG8lS+2JxHbsWKeHACB+/7RsquzWHDR1cu8dV5hf8PMmmUx67UF+lW1/QlYklMqHnJqy8zaqpCG23wPxijnQ7B8ODDtpG25X6+RKZCgfCCYKZvIKOsLTSE3YTGg+3oOUmLmeWWVClT0TMq3yXD39J6Ubh0izcB170D1EufwdHaB4R47Dz4bLjnXZ1Xfww1brjZOJOZPnTgj06Wjjn28HB0RLnRuXZlrPh/KCYI8Lq/EA+xAqtBSagRcyse5agK6vjayZmVo0BIIAA+7tfepjN+CtiYgHwmTvlOT1bDHByUgDUYWB4tiyQFynFIW45DeB8KvtgYwOQ+Eo3nkN6mpWD8pBSRcCCQ6jVVApRCjBbyBplLNiMCibCRhULuctNghwMlZMAEVWcQU3QZNDgtRi0BF1tRto2bN5kwx/VnQ5pTJZQiKm1280o8kKcR1mIKPHdf1tNX2N3X30rhsvidC+Dtr21o7entgtjb69hd7WFNCZLyCtMrX3QjCIBpVp3I2C5bRiUhSTYGLXBosrN4Jpa1eDEWdPX2H2ovhXDZXHi6DEEAA==) format('woff2');}
@font-face{font-family:JMBNVH-LMRoman10-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAPcAAoAAAAABpgAAAORAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAXAqFUIQ5CxAAATYCJAMcBCAFgxgHIBtCBQAeg22zOZcMw0iQwfE+GfevEQG1lvXM8ebqVEgRqlRkFMEjKgBQgMIQK0QF7JDkl/8vT/+XW/4Z8OASqGhYcQ/UwFdMTxUxPbWnvh7b/wDzuwfOqZslb0BRALhRUwOvMRJ0CMXNE7nw7VR+Pojf3KUWL601c46HD8kJqXArLMEC8Xh89U8Bi9UIvytDWOAB4FlABPAYFm3srAK2TB3p0X+vQXp3aMed+i+IQAoox4D8WUzZQAkXZskG1GjSqmNUM3YPs9E6Ky23NMQgOVAJVCD4ARBqAUvzApwBdNsdFoGUL1BNsLYlrz5PT05d0Ebi5bOGMsx//XR6Amv2EmVAJ+WImH9Zl1l/iZ8gsW/t9IOK++WvXs388nrWp5fTD62YWFzzibr4MOJQVNV5++rd9Hrrcd2tzF3RyCcRdDm6ed6U2nwpPNjxmotZzuED48/t23R4/l7fixdE10+8sn1O5r2cfuWF9uhL6upDYv6b11+WHt0zb9/IfnXljY+WY94qpwTSz8Dm11l3L4qnoxczP9sOq26NC6+78njDzYzbr2eFzYH/52JW81NdrjrP2QS9dYjDcGRBdY1OrEPJVVng+DP151A9WRp3j8ekJma5vlq/IqbaHAp7euDD/PO9xYyZaHQXXoq8XWMzsRM7OqGwtIqxyK2gDbvcyw6+3KofKnqTewQnZuxo/n5s49x2ThX8r41NmJT8IU/f+G1eRGwzDEPUaPmVs+7PvCtdv3x9F73Dw040G41sx37kHZzrwU48vL90johTYJmWMkJ+nRI5uSKCUywrfWJtfVM/mM2B9n2cO/X7pzSQW5Ymrp24SX8gsoL8m6Jttl8mK3/ZWbuQWL88fnSBZAzGH+DPnz5nJvKjB8u6YfIx1Lt41HyImK55/3ZXih3S7yle9NSuIlYpXnQCCEAAdcdNt13i+H9cBhMAPxUXS/3M/+MWfAZsVWmkuN0j8RQjJQIG1DBeLpgRUWu4zRiMPhxhayljjAELBORQjB3iJwYhMXlwfpoGr01mECxklsb05YROOgaU5gEi40wkU7BmkkVlC8kW7FSaL9yv/AlPMqshwbkTUgvpbCqmUt+ZSSeXfiE2WONqesi/paats6qBDLOF2o+DfAVKNWng0ShEsFwFUhWiZaP0G00pFVClQz2PVrSAVm1qNGlECmFjArPkRja2R7sAv+PV47H9OtVom6vSgBTGJrT0ZzAAAA==) format('woff2');}
@font-face{font-family:FITJZZ-MSBM7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJkAAoAAAAABCQAAAIaAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBdIFqCwYAATYCJAMIBCAFgkQHIBtjAwCOwradMw6rCCsJCMVDPMSvtTezfw8xDZFEdKk0umi70qFUYrxKiCc/+mcvbQ8URjEHT9IqbVCSP3Y7r3d0k0/kA7of1kBKbNocAgkEHEUYx2MCJRbGgXqq59YDh8hS0T4usUOVrzGhJn/zsatsfEXxNzlOIQFpIAVyT++tZSBq/4Ui6LQpJYuu7vUAgkQlTuMLRIF1oEC4+1qDGQUvBE9JUFDhAngGoACqXVHpb3hecmORpbJQQpJJyoIKTRnmguYwnn9xfyCuJHXHkqVyabtWXMrcvQe+N8GbWnNzKsMLyWhm0NSi0GmMX2IsjePWD3alk0d44zoJoQ5hDi+JqPAPflDdRmb+mFVcJT+k6X4jvPoROTmuL1frb4fi/anUtHT+brX5kLZMiv0b4GWj/kPu6GbASIfKyyRvt/gxJXlhqlukWvsMbzjyHo+6rII8LI5RXOK9SQCBYK7d1MqT8/7v5xfQUt5O5BPQ+8+zfAP6JTj3PpAtpszyrDuZJ4UWIV3gd4TSDGpCCbWzx2JYjbUhE9gwbHl60CJzfFEGhEF7gcW8aKzNKsaGeZ0XB+2YCmmpLmkMjUiOzMy0iUkKjHF7HvccbO2PWn+e9xe3VjS1ltXoO9k62jpCiBbVSjQKFSFZpEyZbMRIEiiGm1R8rUmFOrX0ObBl74Awt9YlFmhWorgu1MHEYq0qNI2VqaHPiS3HxvigCwAA) format('woff2');}
@font-face{font-family:JKBFZS-CMEX10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIsAAoAAAAAA8wAAAHhAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAp4gQELBgABNgIkAwgEIAWCaAcgGx4DAC4HbGMY1oc42d1DDs8sNuX9oWs+Qwx1MIKH/XD3vk3U6zxKNmlL82xWmoc4pBIqoZFI1EVI+v/fu/v+aExcdLW5dI4FkhZ3wg+cJZxgYGXLs4IiCjgs4SjEaEDTCe68TwHL5v4fgI/aDoCXtJqixA3c/93k/w7wDnQ3SQNMPNtgAY35PMHMNkidBRpZogF53xS3REJKKe3bCWnaGXc5yWvyv0Y3yeKdBRMhxFNA5oBr7+Q4Al5/XY1W/BwD/GDFBwHAfyBBika0QCNGL5DJBP11f/CT3y8AJCBDoB8YByADRP/x9JF1BdFu/+3d1H6QPSm+tQATkq/lopbP/WeE3nrXSt92G1c07/myqoqYxa/XfHa/nG0Lt9DcLGnUpd8ePgGB4P2dbMn9V2kZ+MFdR1q//6YESiUgGMcgm+XmycCwQpJ4hSDRj4Cg8nL3CDUoikyVGp/mKnTSQpURjXLt7GiRlQndkoBm2s1prtmVFto9y3KTXosWfKP5OBrzBqs5gy8RKFvMB+zUYjTHRs+Sc/3jZHccLdBmtOrL4LOysHawN7CFElb69H2XomK8gqpyDHwSAsoszIoGtnYmVpaQhZG5BkLhsi7sdIP+na4L1Hc0sXM0soBsjKyW0+ALAAAAAA==) format('woff2');}
@font-face{font-family:ARMYCO-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAREAAoAAAAABtwAAAP5AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqGdIUfCwwAATYCJAMUBCAFgmIHIBtKBQC+DHCHMsIvBCnVbZygiKOaFia2YlzJvVuxfiQCaj9+e/fNvRkuXb0yhApJvdJIFpJ4VEma4A2fp/9ScpIzqIPyhYlsMxEn6fZxktdbe0iu0OSnANFGq6+yRonmyURJUgyxN1EiI6/eqfr6lxQ4f4UQmz2V3fVl+T834//CvICmegKT2lgCbR1LKIxs8bw1+fSEjw7wCOnMXTZ4SYvckR8esoGU2A4dl0Y8E/9/6ooZzjQjIQssHTzwVbYcTg0DBDvFpoAEKQJuNElARApKA+eZOJ2A9GgQ7RaLlndKIzn1cVBpSjYnJtQBEJYwaKp3E0VByBmm9iM+UeiG0tAYNO5VjT5DkHaIWyvPAzpF80UKDNs1t10WL6RRoYCACSn0WrnqyrCdii2tWqjahuPSpUx7FLpSyTdVB2PsqWQ/ZT3TEhLQBaQjX+jRdVInLx5UI0+rGhXPR5UGqfIyqg4j23dVd8C5KbueP63KVxLLymoE8CKnFuFV+XwhITGx/Fbl5TtZgYCKLcItUqjahGPlrQJfUiDSdeuc5dCRyjHIvBQI+JR2QkR/Srm9KIQgsrLtEJ9RGdiRQptFRPj8O8327bubpuk7F7kJnHpCM2IdHeDcav5CKk9lCkQlu5E71z5ncvDs/rnKgAC0eWBgSMIjDw8ODDoz8Y2aZueltgPi9v4s1UKZNa49k93rS2IcuI6j60szWLCy0k7MTvRTErklO6XFZhf4El7eENbevzSNEwW7g66mKSM1HBh0ebibynTYyruLvU6uA6lhNYn26tP6A+PePcvm/SxGHPnbOOSRwoEiPwztx5Qw93xhAHY3Q9BvSAz2MQp8Kgn0yn0V6Zv/PtjjZR7i8zb3p/eff5ddqeWOEfk+6K/h2aQTQSlYTcb9O8NmkaqDgTB9pg+fsbg9WaHqk36YCiZv/jHYSuZTK/lnVv7LjNLnZ6ngyLTG1PZkEEv4S+N5wyQcWd/ry+Da0Qs3O0BwV/CrIItf1cYsqrMU1ljbqS+Sn5WbkmKzG3wJcTfwdNWZS6J1b38Uthd2YLEN+grcLSfPo20y1xuu5c3YAgACAtf6b0yrf1JSwTujfnVa0h+vxOfIFDFbUySIT9GEqAvMk9IiwgWD4R1xH168MghCmo0jVYiT7SjIQwESnFS5CtpEmhw1RLpc7ePZqhnACqlZgnqejkhVKZJIU66QSFcJdbONmtmaSS+vCV+YTsDe2jCP52Z64qnp6+h1Fa6x24JTI5JSw2LkDHUM7NYAFidGvBTJQiSSwxMnWK+JZc8Pz2Mwb9pgPDxuTAVhPi1JhDix5OjToccAFyWWpbyeCYLtNzJqzGCpIiQNhYkhx5AOg8QSCwAA) format('woff2');}
@font-face{font-family:KNEOIY-CMSY7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAHQAAoAAAAAA4QAAAGJAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAo0RwsGAAE2AiQDCAQgBYJiByAb3gIArgpsY1LYw3bbODUefbGQpx+NwtEIov3Yz94TRCWRJGoLdO3WiCbZU8NDI1Gp+Bez3bpl/LctwEFS2nkXJRhImmCWY4fXvoUPZDygr6bh+jNzBBq8AaS+oOX/u/n/3uLvw4FeOJr4ACc+O+rmwHqBJhhCeJwUaGSZ3t8Ut0RCcijt2wxZuo0dBeksPf1rtSWKN+ZMRRVKCV5gCItrjza84eYKD/2ZRHxg9owA4D+QkKEVC7SKBpFcLhhu/uBPXhYAEsgRqEU9IAdE7VL9weXWVVvD8cXm+XfsbSezTlwDAkHdxsSrYea9MsvBa+uNtCEbjh6kUgLBUPKuZWs2LCDyJOMUE0mtAEEV1dYRGoxPcrUaSKFGDynVGu+u1s2wyKuEfgVIrtMkhXaLlDqdstq0uy7mM8ytaeGXMUGetwRfoQ2FhGpPi9fdePrz0TMkGIzcara5XaQDqFaCdFikCr5SjEBcrkVgjXQ49VYLoEAqINulytJOIPZ0PzA8eqeHNgMJmGUMWgA=) format('woff2');}
@font-face{font-family:WNGSVK-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAALoAAoAAAAABRwAAAKcAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqDNIJdCwwAATYCJAMUBCAFglwHIBsKBMguBnIy7FViqbs+oQUtNnllGT+G0hLAz/neS5p+Qp4dKyILKAFQAbNSbDehZ9fh92fv7e+EBHiC2glsgqOjEK9BbWl7zd7/ANaI61h64pr8kfYNlOov+BRND9hgVYBPOmtsHNluNh6NZm6j4BccMqMcCGMYri4brNak8oA4+hp6JUQ3o5v/5XqGFxaFseAAn0YI/JT12yuzgK0+zBhkIhb8sxlBhBjl+dFyaMOAbNki9MFiZiwSZpNLgZKJ07lI4zDgqQml3pYgEkT1dR4+zs7roqHr525Wxc6Xnx59VlGAXL11/kZ55HLtyZHHldunDLef4+6Xvy7dfg14bZo233tLfFt1/X3g/Pvqozfzwhts5fSro2+YyWfjnP+Hlzz06Is8JytXGgzQ6fyr2uT0WwQ8+qleGdpfyDaKmMvlOPv7Y5ZTdfteR9qs3e62M7uzGjVztudlFc2rzFZsCVj5OFiIFMUBfxpMNfaKykp7+bbA1U+jnELkbC32RFhN0/9Fi4ZKBM1IwUzcUb7sb05in7sitnYdnR82e+64ykeYzpF7rAu7OjJRakVBGMK7pNae3INl2Zh2WFYxwFkDIy2WhbOu9tO7T94Pnd6Lebb/D4CAwIXST79Jbox/2XEK/C1f0/VSZjElWiOunEDknzhmDDGmgIgVOfHCSAzPKEYNRGKE0KN5rkOgAxTpSUzJUwQkSC2QRjrO56qFgQipHEEjGcSUStlAgjQCaWSwyDVu/bLQ/4adMqvEepM8frZSR77X1yMJGKP1gt22vjKnrDKrIGgsATcfB3xFChSrUC5DqSBKRdLhiUJmKmJ6JnLx+JR0yEycbymTo0ihIFgJMGeA2CwkmSl0ID1KVVOdrlKOskNZCgTBS4CrGhEAAAAA) format('woff2');}
@font-face{font-family:TUXCQI-LMRoman7-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAALoAAoAAAAABSwAAAKeAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqDFIJaCwoAATYCJAMQBCAFgw8HIBs2BCAehenGng3CZIgbb33Mr8h/rHv/3CRPmbZflaev9RRWPgiuqJ20Ig/fzverBALLvEhq5xMf8QQ30unyvxdg6qY2LIoK6BvqiUZjUuBj6xYNJMC0eJtmAXUBTi7zVi1GTMamc599krQAPB2kBajALnb3n7P5S6WPxkB82ADCDCTBMdDlGNYdZgVUGf/vAYiTImDGf8JgAI7tjCPYR4gBWFkxQIEi6pc02Rn7C44JkrXXJwK2bn4zwBBqzmERo++rJc73lQNps3d7mlbvkpIcHzRd6vJAPWp27qGUs1Z4iBVLNW32o+zdjwbLhw+VnLXEA9p7uZnG5KNLSmLFTk1Ds0nS2mC0bDbxYdq2hwkFSxQ66cOxInklAQafXt0q16KHKUuczyjZvEHcxBZsZrM2e5+2U9PYErtHymYPF8/NKR5BS6ayds3+3hudus1g0zOaZvaOyxuvvzYHWr7oE7K7R4Sc07vj5O1A2bOmzTAs0L9YfncuwzHK0Z11yjlehs5f2FMYZD/EV3NivJHnpr+yd0Zs3Ay0VVua5LntzTNvuPC9IzUJExUR9kETbi7Y9ohKEdaEBn4/0IvN6drczTxUd3l/BAAgAIF+L7zTvkHGLysXAIB3zjvrwhjv7DSUzAIIyr4JX4iVkENBYEb4AcbT0w+k5gLEIoAQRVLitjQOCWxFyRbcWFNgovEDZm7C+yVPuTgqNpCGWjcgGHoDE1crgZlhf1hK8KKi8jliIlk1bZFfWxo1paiPvPgze5VYIwaUu5M98y7Deg4e1r2vf7wRZ8ShQqU6/fXVUT/JlKZayFerVNR4J6PU6aq7ofroaJBmuhpksJ7668dfLEMMDVws9KNidzREV13MTkYG7C6G6WlwV3d9+YtniFOOHAAA) format('woff2');}
@font-face{font-family:ERKKAC-LMRoman5-Regular;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIsAAoAAAAABAgAAAHjAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqBAHoLCAABNgIkAwwEIAWDDwcgG0oDIL4NN8ZACM0egl2YToIgUNEHE4ru+tHXVwMv/VCTisXEw/8f6n1/ZWBOwMbEiZCABainvLFg1VrFCxbgjg3P15q+fwFClZR2CwjC1HXOVXjSaNvxBI4tacLxMaZD51rTBA5klNytEfmfCzbNOQPJnv/KtK1w8YQtIaVMkqoyuuBkk4JpqhCcp27yi/zz71JPNNpgCeRLfAtmgW3rEstobCLKdqZXIqnEubHXzKyHHJWIivRg/MdWuLErrMMFsAEFlud4ejuIoDSW1f8h5UKCAMA/kCDDkIXAkFUVNFbCoDT+Q8r/L14KZ/AfkGAEM4ACEKQUDqT4Ahdj3G3Cs3abrlev9cWzO+6jt1+ybF97LKUY4p88qdZzaMnTnuJAhUNfReXKzS4yRwMEBC4Hn7NAzyvUCjh7XEakfTqGLgMIbEdFembFTO36BSBHAXG2StfcC8gKBAjp9S0BLCesmSLBSYDKQzKvSaghQF/aIJQUFyJofuRW2iK3idvhdtq5363FX7NP9ALsaGhZgkSZpT630s+xSRp1Ayh2T1lnvsP1dgto1k1l5cxwhDaLwoo1KmSxCCQUAKjz2eg8ZoVTqnG6DDYroJHWQAM0Y6VSF26NesqCP8D0GlxenQXQTGtqGi0AAA==) format('woff2');}

</style>
<g id="page1">
<text font-family="RSGHQW-MSBM10" font-size="9.96" x="234.51778" y="-118.960946" transform="matrix(.999739 0 0 .999739 -128.28202 131.06)">C</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="241.711903" y="-118.960946" transform="matrix(.999739 0 0 .999739 -128.28202 131.06)">[</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="244.47817" y="-118.960946" transform="matrix(.999739 0 0 .999739 -128.28202 131.06)">x</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="250.170694" y="-118.960946" transform="matrix(.999739 0 0 .999739 -128.28202 131.06)">]</text>
<text font-family="MSDCVE-FandolSong-Regular" font-size="9.96" x="352.299034" y="-118.960946" transform="matrix(.999739 0 0 .999739 -157.91501 131.06)">离散</text>
<text font-family="JMBNVH-LMRoman10-Regular" font-size="9.96" x="375.535969" y="-118.960946" transform="matrix(.999739 0 0 .999739 -157.91501 131.06)">F<tspan x="381.213177">ourier</tspan></text>
<text font-family="MSDCVE-FandolSong-Regular" font-size="9.96" x="410.047959" y="-118.960946" transform="matrix(.999739 0 0 .999739 -157.91501 131.06)">变换</text>
<text font-family="RSGHQW-MSBM10" font-size="9.96" x="460.200867" y="-118.960946" transform="matrix(.999739 0 0 .999739 -125.435009 131.06)">C</text>
<text font-family="FITJZZ-MSBM7" font-size="6.97" x="467.261282" y="-122.54019" transform="matrix(.999455 0 0 .999455 -125.435009 131.06)">C</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="139.450597" y="-81.744661" transform="matrix(.999739 0 0 .999739 -128.766 131.06)">f</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="145.399044" y="-81.744661" transform="matrix(.999739 0 0 .999739 -128.766 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="149.272023" y="-81.744661" transform="matrix(.999739 0 0 .999739 -128.766 131.06)">x</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="154.964537" y="-81.744661" transform="matrix(.999739 0 0 .999739 -128.766 131.06)">)</text>
<text font-family="JKBFZS-CMEX10" font-size="9.96" x="234.51778" y="-89.214711" transform="matrix(.999739 0 0 .999739 -141.766 131.06)">∑</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962448" y="-86.727717" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="249.883755" y="-86.727717" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="256.107362" y="-86.727717" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962428" y="-78.734075" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">i</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="247.778883" y="-78.734075" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">=0</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="262.308516" y="-81.744661" transform="matrix(.999739 0 0 .999739 -141.766 131.06)">a</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="267.497152" y="-80.22726" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">i</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="270.889256" y="-81.744661" transform="matrix(.999739 0 0 .999739 -141.766 131.06)">x</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="276.503222" y="-85.334476" transform="matrix(.999455 0 0 .999455 -141.766 131.06)">i</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="460.200867" y="-81.744661" transform="matrix(.999739 0 0 .999739 -143.156 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="464.073856" y="-81.744661" transform="matrix(.999739 0 0 .999739 -143.156 131.06)">f</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="470.022333" y="-81.744661" transform="matrix(.999739 0 0 .999739 -143.156 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="473.896322" y="-81.744661" transform="matrix(.999739 0 0 .999739 -143.156 131.06)">ω</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="479.959329" y="-80.22726" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">k</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="484.996425" y="-81.744661" transform="matrix(.999739 0 0 .999739 -143.156 131.06)">))</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="492.603436" y="-85.980124" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="497.524783" y="-85.980124" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="503.74836" y="-85.980124" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="492.603436" y="-78.717084" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">k</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="497.004067" y="-78.717084" transform="matrix(.999455 0 0 .999455 -143.156 131.06)">=0</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="139.450597" y="-44.013511" transform="matrix(.999739 0 0 .999739 -135.19602 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="143.323586" y="-44.013511" transform="matrix(.999739 0 0 .999739 -135.19602 131.06)">f<tspan x="149.259727">g</tspan></text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="154.3797" y="-44.013511" transform="matrix(.999739 0 0 .999739 -135.19602 131.06)">)(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="162.126668" y="-44.013511" transform="matrix(.999739 0 0 .999739 -135.19602 131.06)">x</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="167.819182" y="-44.013511" transform="matrix(.999739 0 0 .999739 -135.19602 131.06)">)</text>
<text font-family="JKBFZS-CMEX10" font-size="9.96" x="234.51778" y="-51.483561" transform="matrix(.999739 0 0 .999739 -165.54001 131.06)">∑</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962448" y="-49.007282" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="249.883755" y="-49.007282" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="256.107362" y="-49.007282" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962428" y="-41.01364" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">k</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="249.363029" y="-41.01364" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">=0</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="262.308516" y="-44.01351" transform="matrix(.999739 0 0 .999739 -165.54001 131.06)">x</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="267.924919" y="-47.614041" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">k</text>
<text font-family="JKBFZS-CMEX10" font-size="9.96" x="274.561327" y="-51.48356" transform="matrix(.999739 0 0 .999739 -165.54001 131.06)">∑</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="284.993623" y="-41.013637" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">i</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="287.811087" y="-41.013637" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">+</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="293.923745" y="-41.013637" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">j</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="297.621739" y="-41.013637" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">=</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="303.733406" y="-41.013637" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">k</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="310.380967" y="-44.013506" transform="matrix(.999739 0 0 .999739 -165.54001 131.06)">a</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="315.555941" y="-42.506822" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">i</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="318.961697" y="-44.013506" transform="matrix(.999739 0 0 .999739 -165.54001 131.06)">b</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="323.143784" y="-42.506822" transform="matrix(.999455 0 0 .999455 -165.54001 131.06)">j</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="460.200867" y="-44.013511" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="464.073856" y="-44.013511" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">f</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="470.022333" y="-44.013511" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="473.896322" y="-44.013511" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">ω</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="480.316175" y="-47.614046" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">k<tspan x="479.959379" y="-41.539358">n</tspan></text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="485.517309" y="-44.013518" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">)</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="489.390298" y="-44.013518" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">g</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="494.498944" y="-44.013518" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="498.371903" y="-44.013518" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">ω</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="504.785794" y="-47.614049" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">k<tspan x="504.427989" y="-41.539362">n</tspan></text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="509.992869" y="-44.013521" transform="matrix(.999739 0 0 .999739 -155.658 131.06)">))</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="517.592812" y="-48.259699" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="522.515128" y="-48.259699" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="528.738735" y="-48.259699" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="517.592812" y="-40.996663" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">k</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="521.994412" y="-40.996663" transform="matrix(.999455 0 0 .999455 -155.658 131.06)">=0</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="139.450597" y="-4.94271" transform="matrix(.999739 0 0 .999739 -128.34601 131.06)">g</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="144.558264" y="-4.94271" transform="matrix(.999739 0 0 .999739 -128.34601 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="148.431243" y="-4.94271" transform="matrix(.999739 0 0 .999739 -128.34601 131.06)">x</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="154.123757" y="-4.94271" transform="matrix(.999739 0 0 .999739 -128.34601 131.06)">)</text>
<text font-family="JKBFZS-CMEX10" font-size="9.96" x="234.51778" y="-12.41276" transform="matrix(.999739 0 0 .999739 -142.15201 131.06)">∑</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962448" y="-9.947577" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="249.883755" y="-9.947577" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="256.107362" y="-9.947577" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="244.962428" y="-1.953935" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">j</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="248.659422" y="-1.953935" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">=0</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="262.308516" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.15201 131.06)">b</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="266.506692" y="-3.448121" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">j</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="270.779305" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.15201 131.06)">x</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="276.393302" y="-8.554336" transform="matrix(.999455 0 0 .999455 -142.15201 131.06)">j</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="460.200867" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.73601 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="464.073856" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.73601 131.06)">g</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="469.182523" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.73601 131.06)">(</text>
<text font-family="XBHJXX-CMMI10" font-size="9.96" x="473.055512" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.73601 131.06)">ω</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="479.118767" y="-3.44812" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">k</text>
<text font-family="TPLXCN-CMR10" font-size="9.96" x="484.155604" y="-4.94271" transform="matrix(.999739 0 0 .999739 -142.73601 131.06)">))</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="491.762884" y="-9.200983" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">n</text>
<text font-family="KNEOIY-CMSY7" font-size="6.97" x="496.68518" y="-9.200983" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">−</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="502.907808" y="-9.200983" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">1</text>
<text font-family="ARMYCO-CMMI7" font-size="6.97" x="491.762884" y="-1.937943" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">k</text>
<text font-family="WNGSVK-CMR7" font-size="6.97" x="496.163465" y="-1.937943" transform="matrix(.999455 0 0 .999455 -142.73601 131.06)">=0</text>
<path d="M142.69961 46.80281H312.27736" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M310.40447 44.4119C310.78304 45.84648 311.62665 46.52388 312.4766 46.80281C311.62665 47.08174 310.78304 47.75914 310.40447 49.19372" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="TUXCQI-LMRoman7-Regular" font-size="6.97" x="119.002121" y="-4.941306" transform="matrix(.999455 0 0 .999455 100.207 49.401)">DFT</text>
<path d="M115.51053 56.1315V73.284" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray=".39848 1.99255"></path>
<path d="M117.90144 71.4111C116.46686 71.78967 115.78946 72.63328 115.51053 73.48323C115.2316 72.63328 114.5542 71.78967 113.11962 71.4111" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M341.25504 56.14798V74.0313" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M343.64596 72.1584C342.21138 72.53697 341.53398 73.38058 341.25505 74.23053C340.97612 73.38058 340.29872 72.53697 338.86414 72.1584" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M300.1739 84.54436H166.87215" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M168.74505 86.93527C168.36648 85.50069 167.52287 84.82329 166.67292 84.54436C167.52287 84.26543 168.36648 83.58803 168.74505 82.15345" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="TUXCQI-LMRoman7-Regular" font-size="6.97" x="119.002121" y="-4.941306" transform="matrix(.999455 0 0 .999455 102.722 87.142)">DFT</text>
<text font-family="ERKKAC-LMRoman5-Regular" font-size="4.98" x="135.859535" y="-7.947925" transform="matrix(.999739 0 0 .999739 102.722 87.142)">-1</text>
<path d="M143.08534 123.62547H312.69768" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M310.82477 121.23456C311.20334 122.66914 312.04695 123.34654 312.8969 123.62547C312.04695 123.9044 311.20334 124.5818 310.82477 126.01638" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="TUXCQI-LMRoman7-Regular" font-size="6.97" x="119.002121" y="-4.941306" transform="matrix(.999455 0 0 .999455 100.61 126.223)">DFT</text>
<path d="M115.51053 112.7636V95.62755" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray=".39848 1.99255"></path>
<path d="M113.11962 97.500448C114.5542 97.121878 115.2316 96.278268 115.51053 95.428318C115.78946 96.278268 116.46686 97.121878 117.90144 97.500448" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M341.25504 113.5109V94.288" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M338.86414 96.160878C340.29872 95.782308 340.97612 94.938698 341.25505 94.088748C341.53398 94.938698 342.21138 95.782308 343.64596 96.160878" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tikzcd-han-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;4: 带中文的 tikzcd 测试图片
</figcaption>
</figure>
</div>
<div id="fig-tikzcd-quiver" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tikzcd-quiver-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="341.13pt" height="102.735pt" viewbox="0 0 227.42 68.49">
<style type="text/css">
@font-face{font-family:ILKCQI-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAK4AAoAAAAABLgAAAJvAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqCYIIzCwgAATYCJAMMBCAFgmgHIBvUAwiOwziGXGKJLUqZfOMBmuP37m4bIiqJ9qHiUdSjVJJ6wiNUImxoXB5entiWQL2kNIhtbnOdQ9wvtJW2wZs8zgtoDySkhO7RAXdBE3wGH88FyTCMkNK5lUsSN/YxZASbmWD1gBTvhgNy4qn48n99mysMfyahX6DCFwiBT1lfkXACkjH6EiiRhOxsWYKIhPrI10fQGiCTaQ0YW5YYUwI+FHASgWI+xybAEUDGz0apdyqrzlrkPaxYPdpAP3VZ7frJIw0VstxjDaePN7h83EyhYMiOpq52OGywF8vorPbg9aJqGqVxmjbwynae+fPRhw/zyWwDs77Y1aOl79vLqv1+XnQ+s7Dq1ZXGOu+/qfLrH6l2f8t6ubGmhorVuS13ZeVYxsvoCjSJQr1k9qMLrds7VraTBiB/9rP9a+v3nszv0RuREt1VqXWvSu13Jx7/bi0G57P2tHCbrflo/vd98TJoFrXF0UmHhDVGlfApcOpQ7//0EZux/6Ek8+bAu3PjjxliNAwHceW4Pjj3veeIX7amjfEE5Gf3mjWMPiY075NTawIBgd0vfnQxsjv+Vk4Z+FX/dj7fKv+lIn5BZREEriiurD2UCoHDS8Nqn3y7G4hkCAyVdahqKwiCWppkaqjlwVw1zWGhhk7zVTXVAAtZFUFLAg9mmvLBXEMLsNDUWVpVfy8dQf0ANj06Md4vHq0cx+eP1vbu3uU+PXvHhYdq2/qEO5pw+sv79exrTusX5BcSF2MXUY4vyOZ1BYyaMK6fWOhK/fj4Ua0aiiSLcpdYQHnUtEqNgmEnUHXMB4GNWaSJtklwiw45+ZWrV6VOJGIA) format('woff2');}
@font-face{font-family:BIHZCP-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAT8AAoAAAAAB8AAAASyAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqIUIZZCw4AATYCJAMYBCAFgmIHIBsIBggehel2mgVOTuJPMqk/3s16SShbCOJ1p1SNVIxqjnBaU1mldAfW3ENzYv61wsPn7e3/Kc02gd0NEooSygNJMMQ0K6cG+f/ncnr/xqTReH4bwBrfmlgYrgEUcBsD39a2NgY0JlmAHHjqpiqCHiqEorQEEd9eg+3dEYBFK7IGLAB6oY9ey2D1iCO/NhuEFA6Ahw28IwBpKN87q1SOyjyOwRufAAQzBcKbNzIAmscAyLQ+6WTxBsCuRqCq8ziRqMxjseeNcbskYAMvzQHIhsQjAAALD4dQ/LFYD5RnB0occLcqHWm9VbVMJ88+djRewE856E3uern8DGNHURR35+Y9cpxh7I4w+Nwjh+Wz3NOOS1u8lhSeO/ea7El8z6adijadiSZPrjgar+Bz+2yGl909duG77sQcOGJHPSVXVrQMZfRiqFOPbAwHvOZ22egoK4PycOpuWnWQPEpfC5tj/AyGOt0RJs38aJvMpJIdtTaZwOQx9yLEiMv1G/2XvS/eeN8RK7stFONmPB5+k/ZflpGkvfWGndzd+xG7IoNhiTu7pDAYcOrMKVmT+ZCV/oLdCC7Xy4efhu58HHyRvgcOXMxsfkvv4MJQBoNcrt9IWtOkdrPj9pXU3XTsVdpm+FnKLqZrKx15zgw0ucGdJm+vOOo27FYUbSH89pszk7vd3TfI9HKPOStq82MunbfBWu2rnwfbzDjDUCPHPU9yT55GjHc85k7JLzBb10fFCDNUb9aXqEa99Sg/QZ7vZvH9zz9+9WWIc6a7vSHgX4E2+7nY88t8gVam+1ib5OHmcxLjByo6///H/x2R6EN9v81C0Qux15fgfDRdXmx9uwv96n1ZDM9ZIS5A8c9sTiIuqvN+Z4uaFO+WpmOJoJtILlqeqPlakE7o0GbiVqBexM+FtWzlWSU3VB2yRu31b4owUQg5s9gxyf3K5XpIvDWRR/ODh1NY8Sd4DjFy3/NX14hdjjldtheL1+azm3ZbBLzwHrTk+T55IU+Sq0WyvJZjuequ7zIlGU4DE72bazkilJ+ymoh1/Mmd8w9HwKwi2CfUOASe2NvUjjVBF3DJmnyOxPXayPOw413BafB2KapE0rGSlBwsIY+oRDVQvfAsWxCPQruK3Jo1a/NZNinDjulrazGdIDgpUHd9a7ZrdpXDMDe03vmrDheYIpQZ2s5a7wIlVqtRv7GjIsvhaWbov8miyGv41nFRSniWd3mi+m0stSjz7u8TW4v/ypdbFWuNNwRDylxs9R/PgtJEBCEKEPEyiNhidGgRaXHtGfospPmCxHb+qO/UzZe+Jd5B/Irb6y0sEsb+Z4mxAADgG9k+Uq59E4CeRJ8DgCWURs9PQD/w/5+iJwu6FiKFNsjCtH8cBA2hJYQBgjW2bFgdxMhzDUJMIMSZwcIjNCzg7Aw2Hs/NXLaCYZDKAYSj7GCwWKs1LCiMGmzWlgtcoY4+LvHvuJXqjPR3iLwAQqPJiHizdQUpVeuaj/hp5Z01bZ1VDc4hymA4GQhNGjTr0K5CK2caTcrTOY3UMqR7ByFPAIKGRoYIWlu6TY0mc/+cBVFSUZAWaiRDJcegPFmqRzjLdarRtqhKA2chlIKxcUwFAA==) format('woff2');}
@font-face{font-family:OZQSKN-MSAM10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIoAAoAAAAAA9QAAAHcAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAqBHIEhCwYAATYCJAMIBCAFgkoHIBsgAyCeBXbDdREJ0bZoLbdM3iPzI55+rO37JyJ4iPh0KN1LpnVaM4uUfgyNy/tBfCNSGJTWjATWhcK4Btel1SHCbvUiCDDmSOLME6wi+J92xl0aBvpalHiAEffv4YkEMsGZDfij4UQGPtIf5FR9XCKImGfXsgkqka1TTnnadFnxlD/jMEo9Wh28D0j3aywKasbPrio3aKCa/AACwH9QUMFUpSBW2QdUy3Dw1mN/JAiAAqoIDgEXAKgCMp1mK3dnYavb3Lj9YWk8ejc/Pw+13z572+jtHosJu7m93YO3mJBdZwPbGCthp3vn1n22PZX6+Gqa/5WLfrd5iiER9FjilmIlGPmJG+iQmCff/tHpI0rB0RLPuFrc21yYE7Oa8+2whmERiyrgMQCAIDwttdRetbL+61IFf12PJlZUbq7RVEC4LZVzzDyCINrqwCkQFIcgIKJrewDUYIqqnpqW1HSMU90I7qyhbQ2vUlpLtF1CqtY0pGYuRurW5ta2ndgVl1PhgtahNyo1JLWRr6ZRX7VDGplK769yLDQWL45F01AGmZ4uLBArSwkr0HLQM1LSIFEz4lOjobIIKyiKy8qAoiGjrgCpzayJfiVhoS0Bk6BCxsQVjYlKg2IgoxdWCUYAAAAA) format('woff2');}
@font-face{font-family:WOIFMI-CMSY7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAHsAAoAAAAAA6wAAAGlAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANApcdwsGAAE2AiQDCAQgBYJiByAbDgMArgYcY4kejlvd+/dHSHfdnGIQougUD/8ce+97P6KWQUU+kHn6xBpsqDuzApuVRWub/ccaoV4oqDQVT4RCpURaeM0ESOeSbO4QJPZ/NfA/eYsnMMAPRzjQib22vk+oy+IuocAC7TyQbhZGH0GgedYtmnklVtdUKyLSrw0KeRgpkc/5b+ibksgoJwG+DFwD5vzmOoNu+6uDHzvYg4URAPwHiQKGeIEhjTVQVBRsf42zXxcIQIIiElNwBKAIyGbzQhDKklSV5Zoo1qG06pV8oZtar3eH2vR+UheNqjcmXWrMop1egvR3AASCO51Rzxj8NiiC9+FLOXtkJd5QlSDYhIU8Q04+9cGyTDP6hDT1HikeqbtFIHQQoKipI0BJwwKBsqYd2qNuzo4XxZqwIg2oaGqJSsY+qGzq19ad+h8v+3nm1VouEc0kTKFMqeG5tU5sZuvQ4CnymPF1cbrONsxhtpvtCNnZ2Ls4mzhiMnbG/HtbNTkJURkJJiEZJQ0eVRNHJws7W4yNmdUDxNzWyw1WAuM9Qw/M2NXCydXMBuNgZq8JD0IA) format('woff2');}
@font-face{font-family:GPZIEZ-CMR5;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAHsAAoAAAAAA6wAAAGjAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANApkbgsGAAE2AiQDCAQgBYJcByAb/wIAnoNx41zitC2itfpadkK5lDuCZNlm9wql9Xi6cGAMEocD33RpEo96TzWmCofFYrnBuR3xJJ6WaBt4oolYE/WoEipEQrZMg164+WqWC6fpljs+eNAC+hWGmvjPAwssCSixiPMwaVngkWQagWS3TCmLBLky0g8/oci92KrI+/yfY2MhftWyHh2oGh249o9aaYxsta3QoBC4YdOARIFhXhlGNA9TKgVWmyb7kOZdAEhQIjAHswgDJSDmDojXFwYed+jPDVzX+ZuI9PwtpkfXwy7/4+x0mSvUbIcCPrbf7QMqHASxrxcYhCzmP/pl5QcEgtbhjFCf5q+dUIIfzs0nJ3I7W2iXICg0yGd3zlI4AEAm4kogzcGB4GKnY0Kf1Fzq0oeKJlHTyrjTJCmCKDuEWZaaS6MyqGiEmo6p04b7VpVPs3pGV8Ssj0Ct3aO6VWsZknaK98dXk2hl6610ESiQHMkxrbKiiqaGpBrAriwhqabEyCXCTC8C0rLzUAlIqqnLKisBZBApHsa8JKkmOgWJnZguIKElq64lrQhQQOTREMALAAAA) format('woff2');}

</style>
<g id="page1">
<text font-family="ILKCQI-CMMI10" font-size="9.96" x="50.018943" y="-39.109791" transform="matrix(.999739 0 0 .999739 -45.739999 75.408)">B</text>
<text font-family="ILKCQI-CMMI10" font-size="9.96" x="114.175195" y="-39.109791" transform="matrix(.999739 0 0 .999739 -45.447999 75.408)">A</text>
<text font-family="OZQSKN-MSAM10" font-size="9.96" x="155.379439" y="-39.109791" transform="matrix(.999739 0 0 .999739 -46.692998 75.408)">⇝</text>
<text font-family="ILKCQI-CMMI10" font-size="9.96" x="196.876607" y="-39.109791" transform="matrix(.999739 0 0 .999739 -45.73999 75.408)">B</text>
<text font-family="ILKCQI-CMMI10" font-size="9.96" x="261.032859" y="-39.109791" transform="matrix(.999739 0 0 .999739 -45.448007 75.408)">A</text>
<path d="M64.26486 33.79724H17.24067" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M19.113573 36.188149C18.735003 34.753569 17.891393 34.076169 17.041443 33.797239C17.891393 33.518309 18.735003 32.840909 19.113573 31.406329" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M36.33807 38.12355H44.76899V29.47093H36.33807Z" fill="#fff"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 -3.224998 73.741)">g</text>
<path d="M67.73092 40.13705C50.03301 63.68553 30.78178 63.68553 13.3232 40.45558" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M12.537178 43.389149C13.456515 42.224661 13.491191 41.143328 13.203529 40.296319C13.937133 40.808176 14.985457 41.075573 16.359669 40.516327" stroke="#000" fill="none" stroke-width=".398469" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 -3.636002 104.108)">f</text>
<path d="M66.35865 25.63095C50.03301 3.90893 30.78178 3.90893 14.69549 25.31242" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M17.731979 25.251719C16.35776 24.692445 15.309419 24.959828 14.575798 25.47168C14.863477 24.624666 14.828818 23.543319 13.909488 22.378802" stroke="#000" fill="none" stroke-width=".398474" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 -3.635002 46.113)">h</text>
<path d="M213.2562 25.63095C196.93054 3.90893 177.6793 3.90893 161.59304 25.31242" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M164.629541 25.251719C163.255322 24.692445 162.206981 24.959828 161.47336 25.47168C161.761039 24.624666 161.72638 23.543319 160.80705 22.378802" stroke="#000" fill="none" stroke-width=".398474" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 143.263 46.113)">h</text>
<path d="M214.62847 40.13705C196.93054 63.68553 177.6793 63.68553 160.22076 40.45558" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M159.434729 43.389149C160.354066 42.224661 160.388742 41.143328 160.10108 40.296319C160.834684 40.808176 161.883008 41.075573 163.25722 40.516327" stroke="#000" fill="none" stroke-width=".398469" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 143.262 104.108)">f</text>
<path d="M40.43577 53.11615L40.51173 40.66876" stroke="#000" fill="none" stroke-width="2.33075" stroke-miterlimit="10"></path>
<path d="M40.43577 53.11615L40.51173 40.66876" stroke="#fff" fill="none" stroke-width="1.53377" stroke-miterlimit="10"></path>
<path d="M37.9438 41.947681C39.300083 41.327995 40.469649 39.644467 40.52383 38.678709C40.566244 39.645056 41.715218 41.342705 43.063852 41.978864" stroke="#000" fill="none" stroke-width=".398463" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 1.116997 86.419)">α</text>
<path d="M40.5256 29.11502L40.44839 16.21098" stroke="#000" fill="none" stroke-width="2.33075" stroke-miterlimit="10"></path>
<path d="M40.5256 29.11502L40.44839 16.21098" stroke="#fff" fill="none" stroke-width="1.53377" stroke-miterlimit="10"></path>
<path d="M37.896091 17.520777C39.244801 16.88478 40.393978 15.18727 40.436508 14.220929C40.490572 15.186693 41.659936 16.87036 43.016144 17.490208" stroke="#000" fill="none" stroke-width=".398463" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 1.116997 62.432)">β</text>
<path d="M187.3049 49.1308V20.19647" stroke="#000" fill="none" stroke-width="2.33075" stroke-miterlimit="10"></path>
<path d="M187.3049 49.1308V20.19647" stroke="#fff" fill="none" stroke-width="1.53377" stroke-miterlimit="10"></path>
<path d="M184.74472 21.491059C186.09726 20.863099 187.2566 19.172409 187.3049 18.206299C187.3532 19.172409 188.51254 20.863099 189.86508 21.491059" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="41.687272" y="-39.098684" transform="matrix(.999455 0 0 .999455 147.94101 74.432)">β</text>
<text font-family="WOIFMI-CMSY7" font-size="6.97" x="46.560615" y="-39.098684" transform="matrix(.999455 0 0 .999455 147.94101 74.432)">◦</text>
<text font-family="GPZIEZ-CMR5" font-size="4.98" x="50.654777" y="-38.11305" transform="matrix(.999739 0 0 .999739 147.94101 74.432)">1</text>
<text font-family="BIHZCP-CMMI7" font-size="6.97" x="54.526273" y="-39.098684" transform="matrix(.999455 0 0 .999455 147.94101 74.432)">α</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tikzcd-quiver-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;5: quiver 风格的 tikzcd 测试图片
</figcaption>
</figure>
</div>
<div id="fig-tikzcd-another" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tikzcd-another-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="tikz">
<!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="253.425pt" height="83.085pt" viewbox="0 0 168.95 55.39">
<style type="text/css">
@font-face{font-family:XDQECR-CMR7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAGkAAoAAAAAA2QAAAFdAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAocNwsGAAE2AiQDCAQgBYJcByAbyAIAngV2i3OIYmiVsRw22+9m2OOh/t737L79KbWAlerxAFULxptoRD5BJkLRRtHc/1nngaX9dkl4Xd6cQIbqklaYqUVhaLbjh4EW0K6yUBPfeWCBJQElFkceSBp4lFhEeXrDlneJRLmUfCZ0uRsvPfItP/55aowvWtRgUQPoxHf/eBgilP4BnYZOQADQGkh0mIMLzCFsQZQS6LfGXruC9kO5geIhoABRD2Mx/nOCg4BA8L7x2py8+BvqCnxakR0pryGGJAg6DXmpph6/UABAZsUVFKkECCaNeAImJeYyahI9WsEA7ccRmbEEFzUsbAjBZcEIPXpggH55xIH/eMjzy6O6XXCsIm8lRXPpbGVBQnVI/DW9w3h7GM5BFRRBQSxLcyt7O30bILHU07exUGcrcFiKeJZEkamqb2NrbGkByARSPbxyoW+j3QW9lY4z0HMwtnUwNAdUAsUbHIIA) format('woff2');}
@font-face{font-family:BDRNHS-CMMI10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAPIAAoAAAAABjgAAAN9AAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqFSIQtCwoAATYCJAMQBCAFgmgHIBviBCiOwrZtE8OZTL7OElRFPPQu258ku9cKrSi6qkodSB4K4fAogTFYUY2c4d/TXpqCA531pNHlYKZHtteO4sH/xvzfjP/Lel48JkhICa6pCfzA2kIBBphtbGNCaUDdoCOm250seaw1SVpriXOn5LVDLTbQXYCjfGLW/8uAO+RDb5EH6EECsB48+Clv75lRAG8ju4JEFcrJTFBQsZ2IbVi3T4aGCjbCZGf2dfmVlXkDhNHGGcbqHxBb8rUpQqxcEG4ch/LokXHrI+jAWW/B1pYv4tbva6IKGmVA1E6p36QL5WUFsqiJQpst/0iD3giLp6xeWgmVzrDIHAVB/yLKl2Mx5B7K8YSy863KQTzykbpyO9r+PnOPsRdVskLu2zPp2gPo9GGBg/wqWygrQE/xddYYBwfQI3ar8SP2/LaqaIx8vUWJVyrfGsXQEAG0ff4RW0iRFQDUQqQwxhjYUOIbtNle31Ar7dS/UY826QhkdQd31R89gipGdBr2GHy5Pf4O6KXGk+zGfaR092jjsqpoaKAF4rXqN8jpzZnItBWlW1PSbAHjTPeVEkMFtkbsb1htvbl32+iy7REj+WMxiCJVQkGDZU/p8bIi0rjbi/zuYh2lS/A5Ccd278s0lXVbKNdaTJNqd0F1IZmHQTHJVgTxg627O243j0mqeM2oHHzUjgQ5z5A17GpHt7cEgot90spVLkdvVitnaZtPfuwp3+s6ZRvrWa3wZEVRFAR7QMxQR0zIOU+spotdACb5YyeGkRf3xOAZY16A+ah1Y+6QhLLwvNcxJXcKLdiKKLNV+/G2FbyVWK7Y0SWtc1eS9DqZesdoTPvXJ00Jw0mVGKVUOSVnUO15VMVDuSrYCi+zXSNRZAUnW6meu8DqmfqnJ3YyWIcmM+lDfINIc5ycAYBA8Prk/ixI/NQ3IowF8L3dzKRI/lccZgwAJ0ICN4tH4BRccSBUtItm+SZGgFFxAmogNC9zChiOfYAALJCAzcxiwHQmjpnezOX02KFDYNFIIJxyD0xzKJ7p7LrM9A6VhWOPBs4l+RvauLWtt7ujj6mNm5sTYnGHlBEzCzHzXG4Kz4xJy4xK0KCbWdbDwEaSBMkypIuQSoObJOFwLpE1W97cOfJhyoYbN04QFli6b00TI0kiDQgzFibgYCUarZB1IDwIldMKw2WKkdYXJYEGOjOWWSIMAAA=) format('woff2');}
@font-face{font-family:TGPXCP-CMR10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAJ8AAoAAAAABLQAAAIxAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAATAqCNIIACw4AATYCJAMWBCAFgmIHIBu9AwCeg3HjXEK0TOakqLnI65WLUCL4/t53z33l95KCzTsGpIJ0sFAHygeJSWLBUIAyHsD38+Py/RO1ugbJqawd2xDyklAGtwwTxMADf15TF//fTf4id0BT/QTPRqVRYHkvSjCzto2NYQn28ijN0m0qSRBEiKNZr3Q0QRYrtAoF6QPz9s+DleWhnxyERQNUgoNXuX/orgGCHUUZVMgEr7UKJGQY274xnCOgqS5JdjkVKKrCDr7d5e2uW0E7ogRtFDgFHgHIASFXn4sY9frN6Lw/2+/X+uUEAgs8nvcsbyhLvFXx6830eueRMCB7zJ9t2RbuLPiyfL6G3l3dtWRbOnBgvBJvlTXJLc2ydUWiRKvWjMtviqC8zFVsypHe0eBk7VSf6SqvqhRQP4uuY35genojUHHFuxaMFTC28Gk/hWVxv2jyLP0/IZGtRY3JOY3wFeR/xVar2egcVMurRe9b8VzhPDljFwACwfmK/VDSC/8mYXPwx7vLYv9QSTKoSyDIVEjMCOMbEBctEmIF9+MTx4mjWIc+QgilOQSCBk1vDOgpTHJtPVJoWSOltq32piUPrMgbwqZEIbm5elKYGielud2wac9rNaA++6rNjEnNjUi1RySlu11FdsrtcG0lXk6zKrvrOrprmlRhDo+fDRFaNGnVpVOVdipJWlTizGaZYqTKFSECezxJOjeXbM7TOtRp0UzFzcGVATG6OUuX3QSVfrm+SKzUrU5HWY0mKmEcPF0SCwAA) format('woff2');}
@font-face{font-family:XCTVRY-CMEX10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAKgAAoAAAAABLwAAAJXAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAPAqCVIIcCwoAATYCJAMQBCAFgmgHIBvJAwgeBe6eIhDDsBg2bThgEy13PDwcy/evojasJC3h46lPaDzBvBhXe4Ifoqa7Kik5UfmTCGz32w18GEtiXSahhFHz3Xxt0nlgY3FICUZtLO0dN+mol+CYmFj9gWPaVvv2Oz8KihS6nuuS0Wz4279CMtNiCtIkDvLqj22yefFdBWyDAJgMysATeOhtNRQC1m5BQ/H+9iDZpHsWcNP/P0ggiRaU8GK0HZDJh4T9giYYOzf5/3z92wWk6Nz8GXgnfk8IMZTy5jnugnGB63H3lHj/nLh4zVvkzLNvHqDrNv721n2++OYhbk6/zqZ93uF9RhO67xLu7jwWEOUZwzzH/faxmYy4/xDiVk8SEAy4ORJgl47jwTLI6OfCumWznp+XZ9+a3efJQ1baSqFGzMPhrx4z+nZqTqbyNIi2SPdXtCaN+diC4x2H0RI7V1dfU8KwoTm6X1KsWUSsBS4X5U0JY3FxWOHU3mXgpeByH4pAG8gG9AgNsYYQhIUYDnbonH6Qnv4HIBAct8VtJs3tP5dEA3yxN+Lnh75TkmNwCuQkQHA19WVilhyDABipgMS3jLhlok1nEqYsCGVtH6DgiIKqIKWUsio2rWjEZpRtDxcM2EGJIkCYiEBsykAZm9YxwGYMrEUFZ3bfAv3fr/1JvnEJMcnmvuH+SdZW73bV2sLKLn2iLuU1FNc2FJbLbS1supvBV6VyVerVyVdDLlylPBRUSOJujZMgRjJzvsL5S2LNSkJCaxWrVEFutbVgpeGBZoVqZh/E84IczZM4T4NitdsKlZOzZcEmakQB) format('woff2');}
@font-face{font-family:BIHLAP-CMMI7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAANoAAoAAAAABYwAAAMfAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAARAqEIINJCwoAATYCJAMQBCAFgmIHIBt4BBEVm98AfiTYNm8yTMPC4Z3Rj0lsiYfP2/v7a7cbDy3SSDIKI0wgyAKdz5dX/ar0WE5PhtJSbhz33YUbgqhcs0xlQAfwT9xMGwuogKZ6AtPGsqhwTNAuoQADzObPYU9vPknxVefIQggcQMNYqw+HeniFzAZZgQyUp6/+a2N52OQzcuBFFACyAXUC9zrau6ohK4p5zIAHiYAGO7h4QAEJJu1XEwLugE4eBTvKmcc873Xxt/k9f0NAgKiDoVr7AvzR5xIIOjcP1f6cjQ1F3c26ekYSSfacKF3EbtUXGYiFYk4q5bYo6Wzatu+IfKcr5TAUh+jc0gmKOag+/lhbYzvfretH3sVsirN7krVl0yaMJFu/ZBNAiBN2F14RW+y8qjh33HD0TCm7c+vBg4cNN5txlPKoNGrLFp1NeIa2yFx7r84+sdCLO8CdcfvAPXIDEXvUvofZPlJOL/+nRt/HStibIp+fD0LhWq28L0PeWBlcSVMeSVyLzEvK0eM6PFXTdJmuWK9oTxYlONdlWWemvlqq4Vx1KS182mb/PDmxiwzTSa7ZLy7VszdtmeYx77POFySk3ip9j7vTbN1d20R7cbXJiKJHWMmPF9r8vf3uCVlV/T3SdqaYFtbGMKUxqdQsI7qG3uVsrWijluqIQGMMUfJ6U/2X+tQXBHTVbVOZblltrJX9yNGPl39kyDMzAbH/HD5r6ZfGs0r6enHf7WKFbwsyBWfjUxFD69PYnoMlMX1UOwbDTGbop+QIkuJQm56G2HxXkzIAAgQ8h4M2FasF/5FnBABe7WPC9cJlyZTQ94COKg0cs/AQxn8MtVcOiBbjIp4qIozR4lh+FXaVGsiGIRAGqAZHVilT8+mNEiO6UWZ7eDCEJxikCiBMkZxoAX3U0TJ0MUbL0sfWXFHj7eyDjPqfsoWRCfHJEekuUSkpCX7vBw0PV/dQ5aNvX0VXbXtXdaO5l6sn3owozRq16NShUhtzKZpV2CNNIiWIlyxCOhdRUqRI4Ceb82rtajVrYs6DK3cFGKc1qbTSO4EVXpneFb9Cl1rtU9UamfPiyrMIZAA=) format('woff2');}
@font-face{font-family:JFMKOI-CMSY7;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAIgAAoAAAAAA8wAAAHVAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAp8gQkLBgABNgIkAwgEIAWCYgcgGyADAC4PuDlhHixhcEiixRd3L/az0giqNbJnDx4YHGtyHyT7PoguFRdHNqxQGQJLwhFczG2ipX0oM8SbilSt0OD6InjJkKTg2NtFBgZgA1QBd++Lr0ddeQWtPf3N53dpGOjCKPEAE9u0tq3zLtAEQwhkbFyD6H/zlnuMYlJtu4mI9KuCLF2Jg4J0M73/tdo3IyrBXLDQSpAlCGn96KyOUMOVGXzozyxET8s+CAD+/wcJGVrhAq0IgxC5XDBcyZXh9P8UABLIERiHWISAHBDjB2t/r3fVHO9cut1e/d89XaK3riGSN/m+2llnDT375Vq3Oh23Z9dG7+3p5VTYHo2nsV1a7z5wvrJO+RUNHp4OKks/6kPXR+4DgeDe1bU7Npi+VmY5+Nj6IPNW/x8nOQUgKiUQbAu1RV8/yQLGTRg/QZGMQ0HowmoXABqg+CZXq0GAQo0eKCjVGoeCat0UcJFXCf08Nprr1EIL7VZoqdMprTbvfuDE7zSXumxet9/JrW4KJ7X32MKMh3KPk8usn2iOZ/UuzEkz6+samJqoGgFefRXM6XGx8XLzc+KYeYUlacU4/zbW1NcDJDwxA9jlXpZcXAlU5pQsgYqZprGZui6gxFOMOA6MAAAAAA==) format('woff2');}
@font-face{font-family:TAIASK-CMSY10;src:url(data:application/x-font-woff2;base64,d09GMgABAAAAAAHUAAoAAAAAA4gAAAGLAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAANAo0RwsGAAE2AiQDCAQgBYJoByAb5AIArgZsYyL2EJZ5XozxycFi5HcwgxCri+cfDn/nvv9/Yw8unAb59AUSReEm+2JRWBrNoWt+Cx9/NMgiij6iQaYDmfB8TNcJGpfXCrI5U4OnkwL9/X9v8ffhQC8cTXyAE5/dXRxYL9AEQwiPkwLNEgwo8exmx1siIXms1n7boFG3gaTu6x8fTfkUzk5A6QAfQYTji9ZDqJWRFu7PNkRubIwA8A9BoYExuGAMYQmiqSmsjECIZ7wtAAo0EfRhANAEpO9k4O7l5nV8sOfrp4cPusfc44/vEASC8N3y2uDeVxfeBO/c+ES1MwHRpUBYSp5zd6+2IKpS8QqK0icgTN3jkmDQxKSp3yBp6TVHOvTbHO8xQ4VLs1ss2IM0zYhJy4Q36TDj2/TY9Tsu5jPMw9fRanTZcJPd5SWJ19C+xIu5zuPin2u3QdV6CVB4mZeRiUwi16g5SsBOxuYopa5GVkYuNjgTOxcvEtGdo1QJZFKAhCf2wMKmfdaYBvYV0wCwtQKVlicBKHiyZzhoAQAA) format('woff2');}

</style>
<g id="page1">
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="61.56093" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">R</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="69.200935" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">[</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="71.967213" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">x</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="77.659727" y="-80.475992" transform="matrix(.999739 0 0 .999739 -21.911999 92.53)">]</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="169.919643" y="-80.475992" transform="matrix(.999739 0 0 .999739 -19.648005 92.53)">R</text>
<text font-family="BIHLAP-CMMI7" font-size="6.97" x="177.508234" y="-84.067167" transform="matrix(.999455 0 0 .999455 -19.648005 92.53)">C</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="61.56093" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">R</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="69.200935" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">[</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="71.967213" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">x</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="77.659727" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">]/</text>
<text font-family="XCTVRY-CMEX10" font-size="9.96" x="87.06628" y="-52.362331" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">(<tspan y="-51.764487">∏</tspan></text>
<text font-family="BIHLAP-CMMI7" font-size="6.97" x="101.00993" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">c</text>
<text font-family="JFMKOI-CMSY7" font-size="6.97" x="104.56799" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">∈</text>
<text font-family="BIHLAP-CMMI7" font-size="6.97" x="109.934065" y="-41.294487" transform="matrix(.999455 0 0 .999455 -57.284997 92.53)">C</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="116.664555" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">(</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="120.537544" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">x</text>
<text font-family="TAIASK-CMSY10" font-size="9.96" x="128.443471" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">−</text>
<text font-family="BDRNHS-CMMI10" font-size="9.96" x="138.40387" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">c</text>
<text font-family="TGPXCP-CMR10" font-size="9.96" x="142.713745" y="-44.294437" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">)</text>
<text font-family="XCTVRY-CMEX10" font-size="9.96" x="146.586734" y="-52.362331" transform="matrix(.999739 0 0 .999739 -57.284997 92.53)">)</text>
<path d="M63.02864 9.54155H145.42525" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M143.55237 7.15064C143.93094 8.58522 144.77455 9.26262 145.6245 9.54155C144.77455 9.82048 143.93094 10.49788 143.55237 11.93246" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="BIHLAP-CMMI7" font-size="6.97" x="12.469202" y="-44.281858" transform="matrix(.999455 0 0 .999455 89.33 50.144998)">φ</text>
<path d="M49.1002 18.37206V35.50807" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10"></path>
<path d="M51.491108 33.63517C50.056528 34.01374 49.379128 34.85735 49.100198 35.7073C48.821268 34.85735 48.143868 34.01374 46.709288 33.63517" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<path d="M78.52072 35.90656L145.44579 13.55992" stroke="#000" fill="none" stroke-width=".39848" stroke-miterlimit="10" stroke-dasharray="2.78941 1.59395"></path>
<path d="M142.912154 11.885318C143.725556 13.12611 144.740244 13.501446 145.63475 13.496829C144.916918 14.03057 144.331295 14.940249 144.426557 16.420827" stroke="#000" fill="none" stroke-width=".398466" stroke-miterlimit="10" stroke-linejoin="round" stroke-linecap="round"></path>
<text font-family="XDQECR-CMR7" font-size="6.97" x="13.746505" y="-44.281858" transform="matrix(.999455 0 0 .999455 92.11 65.274)">¯</text>
<text font-family="BIHLAP-CMMI7" font-size="6.97" x="12.469202" y="-44.281858" transform="matrix(.999455 0 0 .999455 92.11 65.274)">φ</text>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tikzcd-another-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;6: 小心多 SVG 可能产生的样式冲突
</figcaption>
</figure>
</div>
</section>
<section id="layout" class="level2 page-columns page-full" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="layout"><span class="header-section-number">7</span> Layout</h2>
<p>如 <a href="https://quarto.org/docs/authoring/article-layout.html">Quarto - Article Layout</a> 所述，有时可让文章某些部分超出常规的宽度限制．此功能主要在 HTML 中使用，PDF 中部分生效，其它格式不生效．</p>
<div class="column-page">
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?n"> 个球</th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?r"> 个盒</th>
<th style="text-align: center;">空盒</th>
<th style="text-align: center;">递推或封闭形式</th>
<th style="text-align: center;">生成函数</th>
<th style="text-align: center;">备注</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">有标号</td>
<td style="text-align: center;">无标号</td>
<td style="text-align: center;">不允许</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%7Bn%20%5Cbrace%20r%7D%20=%20r%20%7Bn-1%20%5Cbrace%20r%7D%20+%20%7Bn-1%20%5Cbrace%20r-1%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cmathrm%7BEGF%7D(x)=%5Cfrac%20%7B(e%5Ex%20-%201)%5Er%7D%7Br!%7D"></td>
<td style="text-align: center;">第二类 Stirling 数</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="代码块和引用" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="代码块和引用"><span class="header-section-number">8</span> 代码块和引用</h2>
<p>下面是代码块．</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb5-3"></span>
<span id="cb5-4">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arange(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb5-5">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r</span>
<span id="cb5-6">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(</span>
<span id="cb5-7">  subplot_kw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'projection'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'polar'</span>} </span>
<span id="cb5-8">)</span>
<span id="cb5-9">ax.plot(theta, r)</span>
<span id="cb5-10">ax.set_rticks([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb5-11">ax.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-12">plt.show()</span></code></pre></div>
<p>下面是引用块和一个非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
<blockquote class="blockquote">
<p>这是一个引用块和一个非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
</blockquote>
</section>
<section id="html-专用测试" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="html-专用测试"><span class="header-section-number">9</span> HTML 专用测试</h2>
<p>目前暂未处理 LaTeX/PDF 格式的 callout，MS Word 格式可兼容但效果不佳．本节后续内容将不会在 LaTeX/PDF 格式下被渲染．</p>
<section id="callouts" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="callouts"><span class="header-section-number">9.1</span> Callouts</h3>
<p>Quarto 具有 5 种 callout 类型：<code>note</code>，<code>warning</code>，<code>important</code>，<code>tip</code>，和 <code>caution</code>．</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>普通的 note callout．</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>这是 warning callout 和一个和非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
</div>
</div>
<p>这是两个 callout 中间的一个段落．</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>这是 important callout．</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
有 caption 的 callout
</div>
</div>
<div class="callout-body-container callout-body">
<p>这是有 caption 的 callout．</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
可折叠的 callout
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>开启 collapse 的可折叠 caution callout．</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>simple 风格的 callout 和一个和非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>minimal 风格的 callout 和一个和非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常非常长的句子．</p>
</div>
</div>
</div>
</section>
</section>
<section id="引用脚注测试" class="level2 page-columns page-full" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="引用脚注测试"><span class="header-section-number">10</span> 引用、脚注测试</h2>
<p>这是一个脚注<sup>1</sup>．</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;参见 <a href="https://quarto.org/docs/authoring/footnotes-and-citations.html">Quarto - Citations &amp; Footnotes</a></p></div></div><p>人脸识别是以人面部特征作为识别个体身份的一种个体生物特征识别方法 <span class="citation" data-cites="define">[1]</span>．……人脸识别的研究最早可追溯到上世纪 60 年代，Bledsoe and Chan 研究了编程计算机识别人脸的方法<span class="citation" data-cites="history">[2]</span>．随后，萌芽期的人脸识别技术经历多轮蜕变，在发展中逐渐完善．然而，人脸识别的主要难点在于不同个体的人脸结构并无大异，而同一个体的人脸在不同表情、年龄、妆饰、光照等干扰因素下又往往差异显著<span class="citation" data-cites="technical">[3]</span>，这要求人脸识别技术既要克服类内因素的干扰，同时又要加强类间差距的显著性，而早期人脸识别方法关注人脸几何特征，识别效果不尽人意．为此，以 Eigenfaces<span class="citation" data-cites="eigenfaces">[4]</span> 为代表的子空间学习识别方法和 Gabor<span class="citation" data-cites="gabor">[5]</span>、LBP<span class="citation" data-cites="lbp">[6]</span> 等局部特征分析的滤波器提取方法在各自领域都有所突破．2014 年，应用新兴的深度卷积神经网络技术，DeepFace<span class="citation" data-cites="deepface">[7]</span> 横空出世，以 97.35% 的 LFW 基准数据集识别准确率重塑了人脸识别领域的研究格局．随后，人脸识别技术迎来爆发式增长，并逐渐走进人们的日常生活之中．……个体层面，要加强公众的权利意识，塑造个人的“数字理性”<span class="citation" data-cites="guochunzhen">[8]</span>．</p>



</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0">
<div id="ref-define" class="csl-entry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">全国信息安全标准化技术委员会, <span>《《信息安全技术远程人脸识别系统技术要求》（GB/T38671-2020）》</span>. <a href="https://std.samr.gov.cn/gb/search/gbDetailed?id=A47A713B767814ABE05397BE0A0ABB25" class="uri">https://std.samr.gov.cn/gb/search/gbDetailed?id=A47A713B767814ABE05397BE0A0ABB25</a>, 2020年.</div>
</div>
<div id="ref-history" class="csl-entry">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">W. W. Bledsoe 和 H. Chan, <span>《A man-machine facial recognition system—some preliminary results》</span>, <em>Panoramic Research, Inc, Palo Alto, California., Technical Report PRI A</em>, 卷 19, 页 1965, 1965.</div>
</div>
<div id="ref-technical" class="csl-entry">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">余璀璨 和 李慧斌, <span>《基于深度学习的人脸识别方法综述》</span>, <em>工程数学学报</em>, 卷 38, 期 4, 页 19, 2021.</div>
</div>
<div id="ref-eigenfaces" class="csl-entry">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">M. Turk 和 A. Pentland, <span>《Eigenfaces for Recognition》</span>, <em>Journal of Cognitive Neuroscience</em>, 卷 3, 期 1, 页 71–86.</div>
</div>
<div id="ref-gabor" class="csl-entry">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">C. Liu 和 H. Wechsler, <span>《A Gabor feature classifier for face recognition》</span>, 收入 <em>Proceedings Eighth IEEE International Conference on Computer Vision. ICCV 2001</em>, IEEE, 2001, 页 270–275.</div>
</div>
<div id="ref-lbp" class="csl-entry">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">T. Ahonen, A. Hadid, 和 M. Pietikäinen, <span>《Face recognition with local binary patterns》</span>, 收入 <em>European conference on computer vision</em>, Springer, 2004, 页 469–481.</div>
</div>
<div id="ref-deepface" class="csl-entry">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">Y. Taigman, M. Yang, M. Ranzato, 和 L. Wolf, <span>《Closing the gap to human-level performance in face verification. deepface》</span>, 收入 <em>Proceedings of the IEEE Computer Vision and Pattern Recognition (CVPR)</em>, 页 6.</div>
</div>
<div id="ref-guochunzhen" class="csl-entry">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">郭春镇, <span>《数字人权时代人脸识别技术应用的治理》</span>, <em>现代法学</em>, 卷 42, 期 4, 页 18, 2020.</div>
</div>
</div></section></div> ]]></description>
  <category>web</category>
  <category>LaTeX</category>
  <category>站点相关</category>
  <guid>https://blog.sun123zxy.top/posts/20221223-quarto-test/</guid>
  <pubDate>Tue, 06 Dec 2022 16:00:00 GMT</pubDate>
</item>
<item>
  <title>关于泰勒展开拉格朗日余项中值点的渐进性</title>
  <link>https://blog.sun123zxy.top/posts/20221110-taylor/</link>
  <description><![CDATA[ 




<p>之前学拉格朗日中值定理的时候做到一道涉及到特定函数中值渐进性的题，感觉似乎有一般的结论，推广了一下就是这样了。</p>
<p>感谢刘导拯救 <img src="https://latex.codecogs.com/png.latex?n=1"> 都不会证的我，感谢王佬指出这是中科大《数学分析教程》第三版问题 4.3.1。</p>
<blockquote class="blockquote">
<p>设函数 <img src="https://latex.codecogs.com/png.latex?f(x)"> 在区间 <img src="https://latex.codecogs.com/png.latex?I"> 上有 <img src="https://latex.codecogs.com/png.latex?n+1"> 阶导数，<img src="https://latex.codecogs.com/png.latex?x_0%20%5Cin%20I">，<img src="https://latex.codecogs.com/png.latex?f%5E%7B(n+1)%7D(x_0)%20%5Cnot%20=%200">；定义函数 <img src="https://latex.codecogs.com/png.latex?T_n(x)"> 为 <img src="https://latex.codecogs.com/png.latex?f(x)"> 在 <img src="https://latex.codecogs.com/png.latex?x=x_0"> 处的 <img src="https://latex.codecogs.com/png.latex?n"> 阶泰勒多项式：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AT(x)%20=%20T_n(x_0+h)%20=%20%5Csum_%7Bk=0%7D%5En%20%5Cfrac%7Bf%5E%7B(k)%7D(x_0)%7D%7Bk!%7D%20h%5Ek%0A"></p>
<p>求证： <img src="https://latex.codecogs.com/png.latex?f(x)"> 在 <img src="https://latex.codecogs.com/png.latex?x=x_0"> 处带拉格朗日余项的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶泰勒展开</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20f(x_0+h)%20=%20T_%7Bn-1%7D(x_0+h)%20+%20%5Cfrac%7Bf%5E%7B(n)%7D(x_0+%5Ctheta%20h)%7D%7Bn!%7D%20h%5En%20%5Cqquad%20%5Ctheta%20%5Cin%20(0,1)%0A"></p>
<p>中的 <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> 满足：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bh%20%5Cto%200%7D%20%5Ctheta%20=%20%5Cfrac%201%20%7Bn+1%7D%0A"></p>
</blockquote>
<p>非常漂亮的结论啊。</p>
<p>理一下思路。关键点在于怎么构造出 <img src="https://latex.codecogs.com/png.latex?%5Ctheta">，得想办法把它从 <img src="https://latex.codecogs.com/png.latex?f%5E%7B(n)%7D(x_0+%5Ctheta%20h)"> 这样的形式中拿出来。或许我们能想到构造</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bf%5E%7B(n)%7D(x_0+%5Ctheta%20h)%20-%20f%5E%7B(n)%7D(x_0)%7D%7B%5Ctheta%20h%7D%20%5Cto%20f%5E%7B(n+1)%7D(x_0)%20%5Cqquad%20(h%20%5Cto%200)%0A"></p>
<p>这样 <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> 就可以拿出来单独求极限了。<img src="https://latex.codecogs.com/png.latex?f%5E%7B(n)%7D(x_0+%5Ctheta%20h)"> 可以从 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶泰勒展开的拉格朗日余项中得到，而 <img src="https://latex.codecogs.com/png.latex?f%5E%7B(n)%7D(x_0)"> 和 <img src="https://latex.codecogs.com/png.latex?f%5E%7B(n+1)%7D(x_0)"> 也可以从 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的 <img src="https://latex.codecogs.com/png.latex?n+1"> 阶带皮亚诺余项的泰勒展开中拿到。于是，下面的证明就十分自然了。</p>
<p><strong>证明：</strong> 考虑 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的 <img src="https://latex.codecogs.com/png.latex?n-1"> 阶带拉格朗日余项的泰勒展开</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x_0%20+%20h)%20=%20T_%7Bn-1%7D(x_0%20+%20h)%20+%20%5Cfrac%7Bf%5E%7B(n)%7D(x_0+%5Ctheta%20h)%7D%7Bn!%7D%20h%5En%0A"></p>
<p>和 <img src="https://latex.codecogs.com/png.latex?f(x)"> 的 <img src="https://latex.codecogs.com/png.latex?n+1"> 阶带皮亚诺余项的泰勒展开</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x_0%20+%20h)%20=%20T_%7Bn+1%7D(x_0%20+%20h)%20+%20o(h%5E%7Bn+1%7D)%20=%20T_%7Bn-1%7D(x_0%20+%20h)%20+%20%5Cfrac%7Bf%5E%7B(n)%7D(x_0)%7D%7Bn!%7D%20h%5En%20+%20%5Cfrac%7Bf%5E%7B(n+1)%7D(x_0)%7D%7B(n+1)!%7D%20h%5E%7Bn+1%7D%20+%20o(h%5E%7Bn+1%7D)%0A"></p>
<p>两式相减得</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Bf%5E%7B(n)%7D(x_0+%5Ctheta%20h)%7D%7Bn!%7D%20h%5En%20=%20%5Cfrac%7Bf%5E%7B(n)%7D(x_0)%7D%7Bn!%7D%20h%5En%20+%20%5Cfrac%7Bf%5E%7B(n+1)%7D(x_0)%7D%7B(n+1)!%7D%20h%5E%7Bn+1%7D%20+%20o(h%5E%7Bn+1%7D)%0A"></p>
<p>移项整理得</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta%20%5Ccdot%20%5Cfrac%7Bf%5E%7B(n)%7D(x_0+%5Ctheta%20h)-f%5E%7B(n)%7D(x_0)%7D%7B%5Ctheta%20h%7D%20=%20%5Cfrac%7Bf%5E%7B(n+1)%7D(x_0)%7D%7Bn+1%7D%20+%20n!%20%5Ccdot%20%5Cfrac%20%7Bo(h%5E%7Bn+1%7D)%7D%7Bh%5E%7Bn+1%7D%7D%0A"></p>
<p>两侧同时取 <img src="https://latex.codecogs.com/png.latex?h%20%5Cto%200"> 即得</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bh%20%5Cto%200%7D%20%5Ctheta%20%5Ccdot%20f%5E%7B(n+1)%7D(x_0)%20=%20%5Cfrac%7Bf%5E%7B(n+1)%7D(x_0)%7D%7Bn+1%7D%0A"></p>
<p>于是由 <img src="https://latex.codecogs.com/png.latex?f%5E%7B(n+1)%7D(x_0)%20%5Cnot%20=%200">，我们有</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bh%20%5Cto%200%7D%20%5Ctheta%20=%20%5Cfrac%7B1%7D%7Bn+1%7D%0A"></p>
<p>得证。</p>
<hr>
<p>备考：</p>
<pre><code>Azpeitia A G. On the Lagrange remainder of the Taylor formula[J]. The American Mathematical Monthly, 1982, 89(5): 311-312.
Abel U. On the Lagrange remainder of the Taylor formula[J]. The American mathematical monthly, 2003, 110(7): 627-633.</code></pre>
<p>这两篇论文似乎对这种渐进性有更深入的讨论。</p>



 ]]></description>
  <category>数学</category>
  <category>题解</category>
  <guid>https://blog.sun123zxy.top/posts/20221110-taylor/</guid>
  <pubDate>Tue, 01 Nov 2022 16:00:00 GMT</pubDate>
</item>
<item>
  <title>关于 Python 的 import</title>
  <link>https://blog.sun123zxy.top/posts/20220714-import/</link>
  <description><![CDATA[ 




<p>好久以前就被 Python 的相对与绝对导入所困扰。去年粗浅探究后自以为完全理解，近来又因 <code>sys.path[0]</code> 和 <code>os.getcwd()</code> 的不一致而刷新了认知…</p>
<p>Python 官方文档 <a href="https://docs.python.org/3/reference/import.html">5. The import system — Python 3.10.5 documentation</a> 当然是最好的学习指南，但全部看完对我来说还是有点难度。这里只选择一些要点讨论。</p>
<section id="from-import" class="level2">
<h2 class="anchored" data-anchor-id="from-import">from import</h2>
<p><code>import A</code>、<code>import A as B</code>、<code>from A import B</code> 结构中，<code>A</code> 最小只能到 module。因此，只有使用 <code>from import</code> 结构才可以单独获取 module 里的属性。另外，相对引用必须使用 <code>from import</code> 结构。</p>
<p><code>from module import *</code> 将导入 <code>module</code> 中的所有成员（有单双下划线前导的成员除外）。对于 package 可在 <code>__init__.py</code> 中定义 <code>__all__ = ["module", "module", ...]</code> 来手动控制的实际导入内容。</p>
</section>
<section id="package-与-__init__.py" class="level2">
<h2 class="anchored" data-anchor-id="package-与-__init__.py">Package 与 __init__.py</h2>
<p>Python 3.3 以后的 package 不再硬性需要 <code>__init__.py</code>，普通文件夹等同于 <code>__init__.py</code> 留空的 namespace package。（关于 regular package 和 namespace package 的区别，参见 <a href="https://docs.python.org/3/reference/import.html#regular-packages">5. The import system — Python 3.10.5 documentation</a>）</p>
<p><code>__init__.py</code> 的作用在于当我们直接导入一个 package 的时候，实际上是执行了 <code>__init__.py</code>。换句话说，直接导入一个 package 就是把它看做一个逻辑写在 <code>__init__.py</code> 里的 module。</p>
<p>需要注意的是，对于形如 <code>A.B.C</code> 的导入，<code>A</code>、<code>A.B</code>、<code>A.B.C</code> 对应的 <code>__init__.py</code> 都会被执行。也就是说，只要导入路径经过该 package，该 package 的 <code>__init__.py</code> 就会被执行。</p>
</section>
<section id="submodules" class="level2">
<h2 class="anchored" data-anchor-id="submodules">Submodules</h2>
<blockquote class="blockquote">
<p>When a submodule is loaded using any mechanism (e.g.&nbsp;<code>importlib</code> APIs, the <code>import</code> or <code>import-from</code> statements, or built-in <code>__import__()</code>) a binding is placed in the parent module’s namespace to the submodule object. For example, if package <code>spam</code> has a submodule <code>foo</code>, after importing <code>spam.foo</code>, <code>spam</code> will have an attribute <code>foo</code> which is bound to the submodule.</p>
<p>…</p>
<p>Given Python’s familiar name binding rules this might seem surprising, but it’s actually a fundamental feature of the import system. The invariant holding is that if you have <code>sys.modules['spam']</code> and <code>sys.modules['spam.foo']</code> (as you would after the above import), the latter must appear as the <code>foo</code> attribute of the former.</p>
<p>— <a href="https://docs.python.org/3/reference/import.html#submodules">5. The import system — Python 3.10.5 documentation</a></p>
</blockquote>
<p>这是说，import 进来的 module 会被挂载到本 module 上作为其属性。</p>
<p>这个性质可以弄出来很多看上去很奇怪的玩意儿，比如说自己导入自己后可以 <code>me.me.me.me...</code> 无限嵌套之类的…</p>
<hr>
<p>另外，对于形如 <code>import A.B.C</code> 的导入，<code>A</code>、<code>A.B</code>、<code>A.B.C</code> 都会被挂载到本 module 上。然而，<code>from A.B import C</code> 却只会挂载 <code>C</code>，而 <code>import A.B.C as D</code> 也只会挂载 <code>D</code> ，即使 <code>A</code>、<code>A.B</code> 都被执行且都在 <code>sys.modules</code> 里。</p>
</section>
<section id="sys.path" class="level2">
<h2 class="anchored" data-anchor-id="sys.path">sys.path</h2>
<blockquote class="blockquote">
<p>A list of strings that specifies the search path for modules. Initialized from the environment variable <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPATH"><code>PYTHONPATH</code></a>, plus an installation-dependent default.</p>
<p>As initialized upon program startup, the first item of this list, <code>path[0]</code>, is the directory containing the script that was used to invoke the Python interpreter. If the script directory is not available (e.g.&nbsp;if the interpreter is invoked interactively or if the script is read from standard input), <code>path[0]</code> is the empty string, which directs Python to search modules in the current directory first. Notice that the script directory is inserted <em>before</em> the entries inserted as a result of <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONPATH"><code>PYTHONPATH</code></a>.</p>
<p>A program is free to modify this list for its own purposes. Only strings and bytes should be added to <a href="https://docs.python.org/3/library/sys.html#sys.path" title="sys.path"><code>sys.path</code></a>; all other data types are ignored during import.</p>
<p>— <a href="https://docs.python.org/3/library/sys.html#sys.path">sys — System-specific parameters and functions — Python 3.10.5 documentation</a></p>
</blockquote>
<p><code>sys.path</code> 是 Python 搜索 module 的基准目录（即绝对导入）。其由环境变量 <code>PYTHONPATH</code> 和一些默认路径（和安装环境有关，参见 <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHOME">PYTHONHOME</a>）组成，而在运行 script 时，<strong>script 的所在目录会被临时加入 <code>sys.path[0]</code> 中</strong>。如果运行的并不是 script（例如是交互式运行或从 stdin 中读取脚本代码），<strong><code>sys.path[0]</code> 则被设置为空字符串，代表当前工作目录</strong>。</p>
<p><code>sys.path</code> 有优先级，排在前面的优先级高。</p>
<hr>
<p>需要特别注意的是，<strong>script 的所在目录不是当前工作目录</strong>。例如，在 <code>D:\test</code> 下执行</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> path/to/file.py</span></code></pre></div>
<p>时，<code>sys.path[0]</code> 为 <code>D:\test\path\to\file.py</code>，而当前工作目录则是 <code>D:\test</code>（也即 <code>os.getcwd()</code>）。</p>
<p>当前工作目录是 Python 寻找其他文件时的基准路径，而所有绝对导入操作都只与 <code>sys.path</code> 有关，两者是完全不同的。</p>
<p><code>python -m</code> 的情况稍有不同，参见后文。</p>
</section>
<section id="python--m" class="level2">
<h2 class="anchored" data-anchor-id="python--m">python -m</h2>
<blockquote class="blockquote">
<p>Search <a href="https://docs.python.org/3/library/sys.html#sys.path" title="sys.path"><code>sys.path</code></a> for the named module and execute its contents as the <a href="https://docs.python.org/3/library/__main__.html#module-__main__" title="__main__: The environment where top-level code is run. Covers command-line interfaces, import-time behavior, and ``__name__ == '__main__'``."><code>__main__</code></a> module.</p>
<p>Since the argument is a <em>module</em> name, you must not give a file extension (<code>.py</code>). The module name should be a valid absolute Python module name, but the implementation may not always enforce this (e.g.&nbsp;it may allow you to use a name that includes a hyphen).</p>
<p>Package names (including namespace packages) are also permitted. When a package name is supplied instead of a normal module, the interpreter will execute <code>&lt;pkg&gt;.__main__</code> as the main module. This behaviour is deliberately similar to the handling of directories and zipfiles that are passed to the interpreter as the script argument.</p>
<blockquote class="blockquote">
<p>Note</p>
<p>This option cannot be used with built-in modules and extension modules written in C, since they do not have Python module files. However, it can still be used for precompiled modules, even if the original source file is not available.</p>
</blockquote>
<p>If this option is given, the first element of <a href="https://docs.python.org/3/library/sys.html#sys.argv" title="sys.argv"><code>sys.argv</code></a> will be the full path to the module file (while the module file is being located, the first element will be set to <code>"-m"</code>). As with the <a href="https://docs.python.org/3/using/cmdline.html#cmdoption-c"><code>-c</code></a> option, the current directory will be added to the start of <a href="https://docs.python.org/3/library/sys.html#sys.path" title="sys.path"><code>sys.path</code></a>.</p>
<p><a href="https://docs.python.org/3/using/cmdline.html#cmdoption-I"><code>-I</code></a> option can be used to run the script in isolated mode where <a href="https://docs.python.org/3/library/sys.html#sys.path" title="sys.path"><code>sys.path</code></a> contains neither the current directory nor the user’s site-packages directory. All <code>PYTHON*</code> environment variables are ignored, too.</p>
<p>Many standard library modules contain code that is invoked on their execution as a script. An example is the <a href="https://docs.python.org/3/library/timeit.html#module-timeit" title="timeit: Measure the execution time of small code snippets."><code>timeit</code></a> module:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> timeit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'setup here'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'benchmarked code here'</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> timeit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for details</span></span></code></pre></div>
<p>Raises an <a href="https://docs.python.org/3/library/sys.html#auditing">auditing event</a> <code>cpython.run_module</code> with argument <code>module-name</code>.</p>
<blockquote class="blockquote">
<p>See also</p>
<p><a href="https://docs.python.org/3/library/runpy.html#runpy.run_module" title="runpy.run_module"><code>runpy.run_module()</code></a></p>
<p>Equivalent functionality directly available to Python code</p>
</blockquote>
<p><a href="https://www.python.org/dev/peps/pep-0338">PEP 338</a> – Executing modules as scripts</p>
<p>Changed in version 3.1: Supply the package name to run a <code>__main__</code> submodule.</p>
<p>Changed in version 3.4: namespace packages are also supported</p>
<p>— <a href="https://docs.python.org/3/using/cmdline.html#cmdoption-m">1. Command line and environment — Python 3.10.5 documentation</a></p>
</blockquote>
<p>在 <code>sys.path</code> 指定的目录中寻找 module 并以 <code>__main__</code> module 的身份执行指定 module。</p>
<p>注意不要在名字后面加 <code>.py</code>，因为我们已经把执行的文件当作 module 来看待。</p>
<p>如果指定的是一个 Package name（即目录名），将会执行 <code>&lt;pkg&gt;.__main__</code>（即 <code>&lt;pkg&gt;/__main__.py</code>）。</p>
<p>另外，如果使用 <code>python -m a.b.module</code>，<code>sys.argv</code> 的首位将被设置为被执行 module 文件的<strong>完整路径</strong>（与之相对，<code>python a/b/module.py</code> 中 <code>sys.argv[0]</code> 将会是<strong>相对当前工作目录的路径</strong>，即 <code>a/b/module.py</code>）；同时，<strong>当前工作目录</strong>会被加入 <code>sys.path</code> 的首位。</p>
<hr>
<p><code>python -m A.B.module</code> 将顺次执行 <code>A</code>、<code>A.B</code> 的 <code>__init__.py</code>，即使该 module 没有任何导入行为。</p>
<p><code>python -m</code> 对于直接执行 package 内部的代码是必要的。若直接以 script 方式运行，一旦涉及到任何高于该 script 所在目录（含该目录）的相对导入，Python 就会抛出如下错误：</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1">ImportError: attempted relative import with no known parent package</span></code></pre></div>
<p>而一个 module 也不能导入超过 <code>python -m</code> 参数指定的最顶层结构的 module，否则会抛出错误：</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb4-1">ImportError: attempted relative import beyond top-level package</span></code></pre></div>
</section>
<section id="sys.modules" class="level2">
<h2 class="anchored" data-anchor-id="sys.modules">sys.modules</h2>
<blockquote class="blockquote">
<p>The first place checked during import search is <a href="https://docs.python.org/3/library/sys.html#sys.modules" title="sys.modules"><code>sys.modules</code></a>. This mapping serves as a cache of all modules that have been previously imported, including the intermediate paths. So if <code>foo.bar.baz</code> was previously imported, <a href="https://docs.python.org/3/library/sys.html#sys.modules" title="sys.modules"><code>sys.modules</code></a> will contain entries for <code>foo</code>, <code>foo.bar</code>, and <code>foo.bar.baz</code>. Each key will have as its value the corresponding module object.</p>
<p>During import, the module name is looked up in <a href="https://docs.python.org/3/library/sys.html#sys.modules" title="sys.modules"><code>sys.modules</code></a> and if present, the associated value is the module satisfying the import, and the process completes. However, if the value is <code>None</code>, then a <a href="https://docs.python.org/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError"><code>ModuleNotFoundError</code></a> is raised. If the module name is missing, Python will continue searching for the module.</p>
<p><a href="https://docs.python.org/3/library/sys.html#sys.modules" title="sys.modules"><code>sys.modules</code></a> is writable. Deleting a key may not destroy the associated module (as other modules may hold references to it), but it will invalidate the cache entry for the named module, causing Python to search anew for the named module upon its next import. The key can also be assigned to <code>None</code>, forcing the next import of the module to result in a <a href="https://docs.python.org/3/library/exceptions.html#ModuleNotFoundError" title="ModuleNotFoundError"><code>ModuleNotFoundError</code></a>.</p>
<p>Beware though, as if you keep a reference to the module object, invalidate its cache entry in <a href="https://docs.python.org/3/library/sys.html#sys.modules" title="sys.modules"><code>sys.modules</code></a>, and then re-import the named module, the two module objects will <em>not</em> be the same. By contrast, <a href="https://docs.python.org/3/library/importlib.html#importlib.reload" title="importlib.reload"><code>importlib.reload()</code></a> will reuse the <em>same</em> module object, and simply reinitialise the module contents by rerunning the module’s code.</p>
<p>— <a href="https://docs.python.org/3/reference/import.html#the-module-cache">5. The import system — Python 3.10.5 documentation</a></p>
</blockquote>
<p><code>sys.modules</code> 是一个 <code>dict</code>，Python 在导入之前会去检查 <code>sys.module</code> 里是否已经存有需要的 module 的 module object。如果有，就直接用这个；如果值为 <code>None</code>（意思是以前找过但没找到），就直接报错；如果该键值对不存在，就继续搜索过程。总之，<code>sys.modules</code> 扮演了一个类似 cache 的角色。</p>
<p>对于形如 <code>A.B.C</code> 的导入，Python 会顺次导入 <code>A</code>、<code>A.B</code> 和 <code>A.B.C</code> 并把他们加入 <code>sys.modules</code>。</p>
</section>
<section id="参考" class="level2">
<h2 class="anchored" data-anchor-id="参考">参考</h2>
<ul>
<li><p><a href="https://docs.python.org/3/reference/import.html">5. The import system — Python 3.10.5 documentation</a></p></li>
<li><p><a href="https://docs.python.org/3/tutorial/modules.html">6. Modules — Python 3.10.5 documentation</a></p></li>
<li><p><a href="https://www.pythonforthelab.com/blog/complete-guide-to-imports-in-python-absolute-relative-and-more/">Python for the Lab | Complete Guide to Imports in Python: Absolute, Relative, and More</a></p></li>
<li><p><a href="https://www.cnblogs.com/gaowengang/p/8543840.html">Python 包内的导入问题（绝对导入和相对导入） - Anonymous596 - 博客园</a></p></li>
</ul>


</section>

 ]]></description>
  <category>Python</category>
  <guid>https://blog.sun123zxy.top/posts/20220714-import/</guid>
  <pubDate>Wed, 13 Jul 2022 16:00:00 GMT</pubDate>
</item>
<item>
  <title>从台体的体积公式谈起</title>
  <link>https://blog.sun123zxy.top/posts/20220327-frustum/</link>
  <description><![CDATA[ 




<p>前些天做到一个猜圆台体两端电阻阻值公式的题，刚想积分乱搞时突然想起——台体不是有体积公式的吗…</p>
<p>于是就有下面的内容了。</p>
<p>台体本质上是锥体被一个平行与底面的平面所截而形成的几何体，所以可以把锥体补出来再研究。考虑从微积分的角度思考。设台体高度为 <img src="https://latex.codecogs.com/png.latex?h">，上、下底面面积分别为 <img src="https://latex.codecogs.com/png.latex?S_1,%20S_2">，上底面到锥体顶点的距离为 <img src="https://latex.codecogs.com/png.latex?x">。锥体的若干底面互相相似，而它们的的“半径”又与它们各自到锥体顶点的距离成正比，因此容易发现底面面积与该距离的平方成正比，即</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ak%20=%20%5Cfrac%7BS_1%7D%7Bx%5E2%7D%20=%20%5Cfrac%7BS_2%7D%7B(x+h)%5E2%7D%0A"></p>
<p>这是在三维空间里的情况。可以类比的写出 <img src="https://latex.codecogs.com/png.latex?n"> 维台体的式子：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ak%20=%20%5Cfrac%7BS_1%7D%7Bx%5E%7Bn-1%7D%7D%20=%20%5Cfrac%7BS_2%7D%7B(x+h)%5E%7Bn-1%7D%7D%0A"></p>
<p>（当然这里的 <img src="https://latex.codecogs.com/png.latex?S_1,S_2"> 就是“超面积”了）</p>
<p>进一步的，可以将超面积写成关于与顶点距离的函数形式：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AS_1%20&amp;=%20S(x)%20=%20k%20x%5E%7Bn-1%7D%20%5C%5C%0AS_2%20&amp;=%20S(x+h)%20=%20k%20(x+h)%5E%7Bn-1%7D%0A%5Cend%7Baligned%7D%0A"></p>
<p>而我们要求的“超体积”，就可以顺理成章的表示为面积函数 <img src="https://latex.codecogs.com/png.latex?S(x)"> 在垂直轴线上的积分了</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AV%20=%20%5Cint_%7Bx%7D%5E%7Bx+h%7D%20S(x)%20%5Cmathrm%20d%20x%20=%20k%20%5Cint_%7Bx%7D%5E%7Bx+h%7D%20x%5E%7Bn-1%7D%20%5Cmathrm%20d%20x%20=%20%5Cfrac%20k%20n%20%5Cleft(%20%5Cleft(x+h%20%5Cright)%5En%20-%20x%5En%20%5Cright)%0A"></p>
<p>这就是用微积分求到的台体体积公式。</p>
<p>那么问题来了——这种形式的台体体积公式和几何法得到的</p>
<blockquote class="blockquote">
<p><img src="https://latex.codecogs.com/png.latex?%0AV%20=%20%5Cfrac%7B1%7D%7B3%7D%20h%20(S_1%20+%20%5Csqrt%7BS_1%20S_2%7D%20+%20S_2)%0A"></p>
</blockquote>
<p>有什么联系呢？</p>
<p>随便玩一下吧，<img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%203"> 毋庸置疑和三维有关，换成 <img src="https://latex.codecogs.com/png.latex?%5Cfrac%201%20n"> 就好；后面那一坨挺对称的还蛮好看，写个求和符号让它更好看吧（</p>
<p>于是猜测台体体积公式的 <img src="https://latex.codecogs.com/png.latex?n"> 维扩展：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AV%20=%20%5Cfrac%201%20n%20h%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20S_1%5E%7B%5Cfrac%7Bi%7D%7Bn-1%7D%7D%20S_2%5E%7B1-%5Cfrac%7Bi%7D%7Bn-1%7D%7D%0A"></p>
<p>用 <img src="https://latex.codecogs.com/png.latex?S(x)"> 函数的形式替换 <img src="https://latex.codecogs.com/png.latex?S_1,%20S_2">，得</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AV%20=%20%5Cfrac%20k%20h%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%0A"></p>
<p>哎！与前面积分得出的台体体积公式比较，发现只需证明</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(x+h)%5En%20-%20x%5En%20=%20h%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%0A"></p>
<p>试着证明一下吧。观察发现 <img src="https://latex.codecogs.com/png.latex?h"> 可以拆成 <img src="https://latex.codecogs.com/png.latex?(x+h)-x">，故右式可以写成</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0Ah%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%20&amp;=%20((x+h)-x)%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%20%5C%5C%0A&amp;=%20(x+h)%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%20-%20x%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-i%7D%20-%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20x%5Ei%20(x+h)%5E%7Bn-i%7D%20%5C%5C%0A&amp;=%20(x+h)%5En%20-%20x%5En%0A%5Cend%7Baligned%7D%0A"></p>
<p>得证。</p>
<p>暂时不知道这个定理有什么具体的名字，知道的大佬请告诉我（</p>
<p>所以这玩意有什么用呢？</p>
<p>首先当然是证明（超）台体体积公式，这个上面已经提到。</p>
<p>还有一个用途就是证明 <img src="https://latex.codecogs.com/png.latex?n%20%5Cin%20%5Cmathrm%7BN_+%7D"> 的幂函数 <img src="https://latex.codecogs.com/png.latex?x%5En"> 的导数公式。</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cmathrm%20d%7D%7B%5Cmathrm%20d%20x%7D%20x%5En%20=%20%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7B(x+h)%5En%20-%20x%5En%7D%7Bh%7D%20=%20%5Clim_%7Bh%20%5Cto%200%7D%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20x%5Ei%20(x+h)%5E%7Bn-1-i%7D%20=%20n%20x%5E%7Bn-1%7D%0A"></p>
<p>看上去很方便的来着呢。</p>



 ]]></description>
  <category>数学</category>
  <category>意识流</category>
  <guid>https://blog.sun123zxy.top/posts/20220327-frustum/</guid>
  <pubDate>Sat, 26 Mar 2022 16:00:00 GMT</pubDate>
</item>
</channel>
</rss>
