---
title: On the Rank and the Span Rank of Modules
author: sun123zxy
date: 2025/11/18
date-modified: 2025/12/01
lang: en

bibliography: index.bib

categories:
  - math
  - algebra

format:
  html: default
---

\newcommand{\rank}{\operatorname{rank}}
\newcommand{\spanrank}{\operatorname{spanrank}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\coker}{\operatorname{coker}}

We work over a commutative ring $R$ with unity. The rank $\rank_R M$ of a module $R$-module $M$ is defined as the maximal cardinality of a $R$-linearly independent subset of $M$. A homologist might write this as an exact sequence
$$
0 \longrightarrow R^{\oplus n} \longrightarrow M
$$
where $n$ is as large as possible.

It's also tempting to define the rank in other ways. For example, if $R$ is an integral domain with field of fractions $k$, one might define the rank of an $R$-module $M$ as the dimension of the $k$-vector space $k \otimes_R M$. Are these two definitions equivalent?

:::{#prp-rank-eq-fraction-dim}

Let $R$ be an integral domain with field of fractions $k$. For any $R$-module $M$, $\rank_R M = \dim_k (k \otimes_R M)$.
:::

:::{.proof}

To see this, consider the following commutative diagram, where downward arrows are given by tensoring with $k$:

:::{#fig-rank-fraction}
```{tikz}
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJSXm4iXSxbMSwwLCJNIl0sWzAsMSwia15uIl0sWzEsMSwiayBcXG90aW1lc19SIE0iXSxbMCwyXSxbMiwzXSxbMSwzXSxbMCwxXV0=
\begin{tikzcd}
	{R^{\oplus n}} & M \\
	{k^{\oplus n}} & {k \otimes_R M}
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=2-2]
	\arrow[from=2-1, to=2-2]
\end{tikzcd}
```
:::

It suffices to show that the top arrow is injective if and only if the bottom arrow is injective.

For the downward direction, note that $k$ is a flat $R$-module, so tensoring with $k$ preserves injections.

For the upward direction, suppose the bottom arrow is injective. Consider an element $(a_i)_{i=1}^n \in R^{\oplus n}$ that maps to zero in $M$. Its image in $k^{\oplus n}$ also maps to zero in $k \otimes_R M$. Since the bottom arrow is injective, the image in $k^{\oplus n}$ must be zero, which means each $a_i$ is zero in $k$. Since $R$ is an integral domain, the localization $R \to k$ is injective, hence each $a_i$ is zero in $R$, indicating that the the top arrow is injective.
:::

:::{.remark}

## Generalizing to localizations

Note that we have only used the flatness of $k$ and that $R$ is an integral domain. Since every localization of a ring is flat, the same proof shows that as long as $R$ is an integral domain, localzation does not change the rank of a module.

Indeed, $\rank$, as a function over $\Spec R$, is locally constant. [TODO]
:::

Another possible definition of rank is the minimal number of generators of a module. We call this the span rank $\spanrank_R M$ of an $R$-module $M$. A homologist might write this as an exact sequence
$$
R^{\oplus m} \longrightarrow M \longrightarrow 0
$$
where $m$ is as small as possible.

Clearly, $\rank$ and $\spanrank$ are equal for free modules, since the definition of a basis requires both linear independence and spanning. For finitely generated modules over a PID, having the structure theorem in hand, the $\rank$ is exactly the free rank, while the $\spanrank$ is the number of the direct summands in the decomposition. We see that $\spanrank M \geq \rank M$ in this case. This is in general true:

:::{#prp-rank-leq-spanrank}

For any $R$-module $M$, we have $\rank_R M \leq \spanrank_R M$.
:::

:::{.proof}

Consider the following commutative diagram with exact rows:

:::{#fig-rank-leq-spanrank}
```{tikz}
% https://q.uiver.app/#q=WzAsNixbMCwwLCIwIl0sWzEsMCwiUl5uIl0sWzIsMCwiTSJdLFsyLDEsIk0iXSxbMSwxLCJSXm0iXSxbMywxLCIwIl0sWzAsMV0sWzEsMl0sWzQsM10sWzMsNV0sWzIsMywiIiwwLHsibGV2ZWwiOjIsInN0eWxlIjp7ImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSw0LCIiLDAseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XV0=
\begin{tikzcd}
	0 & {R^n} & M \\
	& {R^m} & M & 0
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[dashed, from=1-2, to=2-2]
	\arrow[equals, from=1-3, to=2-3]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-3, to=2-4]
\end{tikzcd}
```
:::

where $R^n \to R^m$ is constructed by the projective nature of $R^n$. $R^n \to M$ is injective, hence so do $R^n \to R^m \to M$ and in turn $R^n \to R^m$. Thus, we have an injection $R^n \to R^m$. Tensoring with any residue field of $R$, we get an injection of vector spaces over that field, which implies $n \leq m$.
:::

Regarding [@prp-rank-eq-fraction-dim], one might wonder if there is an analogous result for $\spanrank$. Let's say $\mathfrak m$ is a maximal ideal of $R$ and the residue field $k := R/\mathfrak m$. Tensoring the exact sequence
$$
R^{\oplus m} \longrightarrow M \longrightarrow 0
$$
with $k$, we get an exact sequence
$$
k^{\oplus m} \longrightarrow k \otimes_R M \longrightarrow 0
$$

Above derivation of exact sequence shows that $\spanrank_R M \geq \dim_k (k \otimes_R M)$. Sadly, the reversed inequality is not true in general. We shall provide some examples to illustrate this irregularity. Before that, let's briefly discuss the geometric intuition behind this construction.

Consider the ring homomorphism $A \to B$, we view $B$ as a $A$-module via this homomorphism. Fix a maximal ideal $\mathfrak m$ of $A$ and write the residue field $k = k(\mathfrak m) = A/\mathfrak m$, then the tensor product of $A$-algebras $k(\mathfrak m) \otimes_A B$ corresponds to looking at the fiber of this homomorphism over the point $\mathfrak m$: precisely speaking, $\Spec \left( k(\mathfrak m) \otimes_A B \right)$ is cannonically isomorphic to $(\Spec f)^{-1}(\mathfrak m)$ [@AM1969, {exercise 21}]. $\dim_k \left( k \otimes_A B \right)$ thus measures the "size" of the fiber.

:::{#exm-spanrank-arith-1}

## An arithmetic counterexample

Let $R = \mathbb Z$ and $M = \mathbb Z/2\mathbb Z$. Then $\spanrank_{\mathbb Z} M = 1$ but $\mathbb Z/2\mathbb Z \otimes_{\mathbb Z} \mathbb Z/3\mathbb Z \cong 0$.
:::

:::{#exm-spanrank-geo-min}

## A minimal geometric counterexample

Let $R = \mathbb C[x]$ and $M = \mathbb C[x] / (x)$. Then $\spanrank M = 1$. But the $\mathbb C$-dimension of $\mathbb C[x] / (x) \otimes_{\mathbb C[x]} \mathbb C[x] / (x - a)$ is $0$ for any $a \neq 0$.
:::

:::{#exm-spanrank-geo-x2-y2}

## A good projection

Let $k$ be an algebraically closed field and $A = k[x]$, $B = k[x,y] / (x^2 - y^2)$. Define an $A$-module structure on $B$ via multiplication. As an $A$-module, $B$ is generated by $1$, $y$, hence $\spanrank_A B = 2$.

Let's compute the fibers of $\Spec \varphi$ over different maximal ideals of $A$. Pick a maximal ideal $\mathfrak m := (x - x_0)$ of $A$, then the residue field $k(\mathfrak m) = k[x] / (x - x_0)$. The fiber over $\mathfrak m$ corresponds to the $A$-algebra
$$
k(\mathfrak m) \otimes_A B \cong k[x] / (x - x_0) \otimes_{k[x]} k[x,y] / (x^2 - y^2) \cong k[x,y] / (x^2 - y^2, x - x_0) \cong k[y] / (y^2 - x_0^2)
$$
In effect, we have substituted $x$ with $x_0$ in $B$; now any $f(x) \in k[x]$ act on $k[y] / (y^2 - x_0^2)$ via scalar multiplication by $f(x_0)$. Hence $\dim_{k(\mathfrak m)} \left( k(\mathfrak m) \otimes_A B \right)$ is $2$ constantly for all maximal ideals $\mathfrak m$ of $A$. Geometrically, this corresponds to projecting the algebraic variety $V(x^2 - y^2)$ onto the $x$-axis, i.e. $\Spec \varphi : (x,y) \mapsto x$. Any fiber consist of $2$ points (counted with multiplicity).

If $k$ is not algebraically closed, will this still hold? Let's try an example. If $k = \mathbb R$ and we pick $\mathfrak m = (x^2 + 1)$ with residue field $k(\mathfrak m) = \mathbb R[x] / (x^2 + 1)$, then the fiber over $\mathfrak m$ corresponds to the $A$-algebra
$$
\mathbb R[x] / (x^2 + 1) \otimes_A \mathbb R[x,y] / (x^2 - y^2) \cong \mathbb R[x,y] / (x^2 - y^2, x^2 + 1) = \mathbb R[x,y] / (x^2 + 1, y^2 + 1)
$$
$1, y$ form a basis of this $k(\mathfrak m)$-algebra. Hence $\dim_{k(\mathfrak m)} \left( k(\mathfrak m) \otimes_A B \right) = 2$ still holds.

So its tempting to conjecture that in this example, $\spanrank_A B = \dim_{k(\mathfrak m)} \left( k(\mathfrak m) \otimes_A B \right)$ for any maximal ideal $\mathfrak m$ of $A$. This is indeed true: clever readers might have already noticed that $B$ is a free $A$-module with basis $\{x+y, x-y\}$. As $k$-algebra, $k[x,y] / (x^2-y^2) \cong k[x,y] / (x-y) \times k[x,y] / (x+y)$.
:::

:::{#exm-spanrank-geo-xy}

## A non-flat projection with varying fiber dimensions

Let $k$ be a field and $A = k[t]$, $B = k[x,y] / (xy)$. Define an $A$-module structure on $B$ via the homomorphism $\varphi: A \to B$, $t \mapsto x$. As an $A$-module, $B$ is generated by $1$, $y$, $y^2$, $\ldots$, hence $\spanrank_A B = +\infty$.

Let's compute the fibers of $\Spec \varphi$ over different maximal ideals of $A$. For the maximal ideal $\mathfrak t := (t - t_0)$ of $A$, then the fiber over $\mathfrak t$ is given by
$$
k[t] / (t - t_0) \otimes_{k[t]} k[x,y] / (xy) \cong k[x,y] / (xy, x - t_0) \cong k[y] / (t_0 y).
$$
it is isomorphic to $k$ if $t_0 \neq 0$ and to $k[y]$ if $t_0 = 0$. Geometrically, this corresponds to projecting the union of two coordinate axes $\Spec B$ onto the $x$-axis, i.e. $\Spec \varphi : (x,y) \mapsto x$. The fiber over the origin $(0,0)$ is the entire $y$-axis, while fibers over other points are singletons.

Note that $B$ is not a flat $A$-module. This is because, if we pick $\mathfrak t := (t)$ an maximal ideal of $A$, then $y$ is a $t$-torsion element in $B$ (by $t \cdot y = \varphi(t) y = xy = 0$). That is, $t \otimes_{\mathfrak t} y$ is a nonzero element in the kernel of the multiplication map $\mathfrak t \otimes_A B \to B$. Geometrically, picking $\mathfrak t = (t)$ corresponds to looking at the fibers around $t=0$. This "jumping" of fiber dimension is reflected algebraically by the non-flatness of $B$ as an $A$-module.

:::::{#fig-spanrank-geo-xy}

```{tikz}
\begin{tikzpicture}[>=stealth]
  % Left: target line
  \begin{scope}[shift={(-6,0)}]
    \draw[->] (-1.5,0) -- (1.5,0) node[below right] {$t$};
    \fill (0,0) circle (1.2pt) node[below=3pt] {$0$};
    \fill (1.0,0) circle (1.2pt) node[below=3pt] {$t_0$};
  \end{scope}

  % Projection label (x,y) -> x
  \draw[<-] (-3.5,0) -- (-2.5,0) node[midway,above] {$\operatorname{Spec} \varphi$};

  % Right: Spec B = V(xy) in A^2
  \draw[->] (-1.5,0) -- (1.5,0) node[below right] {$x$};
  \draw[->] (0,-1.5) -- (0,1.5) node[left] {$y$};

  % Fiber over 0: entire y-axis
  \draw[blue, very thick, dashed] (0,-1.5) -- (0,1.5);

  % Fiber over t0 != 0: a single point (t0,0)
  \draw[blue, very thick, dashed] (1.0,-1.5) -- (1.0,1.5);
  \fill[blue] (1.0,0) circle (1.4pt);
  \node[above right] at (1.0,0) {$t_0$};
\end{tikzpicture}
```

$\Spec \varphi$ and its fibers
:::::

:::

:::{#exm-flat-char-ag-inj}

## A non-flat parametrization

Let $k$ be a field and $A = k[x,y] / (x^3-y^2)$, $B=k[t]$. Define an $A$-module structure on $B$ via the homomorphism $\varphi: A \to B$, $(x,y) \mapsto (t^2, t^3)$. $B$ is generated by $1$, $t$ as an $A$-module, hence $\spanrank_A B = 2$.

Geometrically, this corresponds to the fact that the parametrized curve $\Spec \varphi : t \mapsto (t^2, t^3)$ has a cusp at the origin. 

Pick the maximal ideal $\mathfrak m := (x,y)$ of $A$, then the fiber over $\mathfrak m$ corresponds to the $A$-algebra
$$
k(\mathfrak m) \otimes_A B \cong k[x,y] / (x, y) \otimes_{A} k[t] \cong k[t] / (t^2, t^3) \cong k[t] / (t^2)
$$
which has $k$-dimension $2$. On the other hand, for the maximal ideal $\mathfrak m := (x - 1, y - 1)$ of $A$, the fiber over $\mathfrak m$ corresponds to the $A$-algebra
$$
k(\mathfrak m) \otimes_A B \cong k[x,y] / (x - 1, y - 1) \otimes_{A} k[t] \cong k[t] / (t^2 - 1, t^3 - 1) \cong k
$$
which has $k$-dimension $1$. Hence, varies over different maximal ideals of $A$.

Note that $B$ is not a flat $A$-module. This is because, if we pick $\mathfrak m := (x,y)$ an ideal of $A$, then $x \cdot t = y \cdot 1_B$ becomes a nontrivial $\mathfrak m$-relation in $B$, i.e. $x \otimes_A t - y \otimes_A 1_B$ is a nonzero element in the kernel of the multiplication map $\mathfrak m \otimes_A B \to B$. Geometrically, picking $\mathfrak m = (x,y)$ corresponds to looking at the fibers of this map around the origin. [TODO] Understand this thoroughly.

:::::{#fig-flat-char-ag-inj}

```{tikz}
\begin{tikzpicture}

  % left: parameter line (the t-axis)
  \begin{scope}[shift={(-4,0)}]
    \draw[->] (-1.5,0) -- (1.5,0) node[below right] {$t$};
    \coordinate (T) at (-1.00, 0);
    \fill (T) circle (1.2pt) node[below=3pt] {$t$};
    \fill (0,0) circle (1.2pt) node[below=3pt] {$0$};
  \end{scope}

  % arrow indicating the map
  \draw[->] (-1.8,0) -- (-0.8,0) node[midway,above] {$\operatorname{Spec} \varphi$};

  % right: (x,y)-plane
  \draw[->] (-0.1,0) -- (2.0,0) node[below] {$x$};
  \draw[->] (0,-1.2) -- (0,1.2) node[left] {$y$};

  % cusp curve y^2 = x^3 via param t -> (t^2, t^3)
  \draw[thick,domain=-1.2:1.2,smooth,variable=\t]
    plot ({\t*\t},{\t*\t*\t});
  \node[right] at (1.4,1.65) {$y^2=x^3$};

  % image of a sample parameter t
  \coordinate (P) at ({1.00*1.00},{-1.00*1.00*1.00});
  \fill (P) circle (1.4pt) node[above right] {$(t^2,t^3)$};

\end{tikzpicture}
```

$\Spec \varphi$
:::::
:::

From the above examples, one might notice that this irregularity is mostly constituted from the choice of residue fields, i.e. the choice of fibers over different maximal ideals. Luckily, it turns out that this is almost the only obstruction. Once we restrict ourselves to a local ring, the world becomes much nicer:

:::{#prp-spanrank-eq-residue-dim-of-local-of-fg}

Let $(R, \mathfrak m)$ be a local ring with residue field $k = R/\mathfrak m$. For any finitely generated $R$-module $M$, we have $\spanrank_R M = \dim_k (k \otimes_R M)$.
:::

:::{.proof}

Lifting the exact sequence
$$
k^{\oplus m} \longrightarrow k \otimes_R M \longrightarrow 0
$$
to
$$
R^{\oplus m} \longrightarrow M \longrightarrow 0
$$
is a direct consequence of Nakayama's lemma. cf. [@AM1969, {theorem 2.8}] for example.
:::

:::{.remark}

## Necessity of finite generation

At most of the time, we work in Noetherian rings, hence the finitely generated condition is rather mild.

Nevertheless, it is indeed necessary. Consider the following example:

Let $M = k[[x]]$ be the formal power series ring over a field $k$, regarded as a module over $R = k[x]$. Then as $k[x]$-modules,
$$
k[x] / (x) \otimes_{k[x]} k[[x]] \cong k[[x]] / x k[[x]]
$$
has dimension $1$ over $k$, while $\spanrank_{k[x]} k[[x]]$ is infinite.

Localizing $R = k[x]$ at the maximal ideal $(x)$ does not change any statements above, providing an counterexample over a local ring.
:::

:::{#exr-various}

Here are some exercises:

- What can we say about the module $M$ given that $\rank_R M = \spanrank_R M$?

- Show that the $\mathbb Z$-module $\mathbb Q$ is a counterexample of the following statement:

  Let $M$ be a flat $R$-module. Is it true that for any maximal ideal $\mathfrak m$ of $R$ with residue field $k = R/\mathfrak m$, we have $\spanrank_R M = \dim_k (k \otimes_R M)$?
:::

We close our discussion with some well-known properties of homomorphisms between finitely generated free modules:

:::{#prp-various}

Let $R$ be a ring, then:

1. Any $R^{\oplus n} \to R^{\oplus n}$ epimorphism $\varphi$ must be an isomorphism. [@AM1969, {exercise 3.15}]

2. An $R^{\oplus n} \to R^{\oplus n}$ monomorphism $\varphi$ may not be an isomorphism in general.

   Is it true when $R$ is a local ring? [TODO]

3. An $R^{\oplus n} \to R^{\oplus m}$ epimorphism $\varphi$ implies $n \geq m$. [@AM1969, {exercise 2.11}]

4. An $R^{\oplus n} \to R^{\oplus m}$ isomorphism $\varphi$ implies $n = m$. [@AM1969, {exercise 2.11}]

5. An $R^{\oplus n} \to R^{\oplus m}$ monomorphism $\varphi$? [TODO] [@AM1969, {exercise 2.11}]

   It is at least true for $R$ an integral domain.
:::

:::{.proof}

1. Obtain a split monomorphism (a right inverse of $\varphi$) from the fact that $R^{\oplus n}$ is projective. Use the determinant to conclude.

   [TODO] There is also a proof using residue fields and Nakayama's lemma. See [@AM1969, {exercise 3.15}].

2. Consider $\varphi: \mathbb Z \to \mathbb Z$, $z \mapsto 2z$. 

3. Tensor with any residue field of $R$. Right side is still exact, hence a vector space epimorphism.

4. Do the same as (3) again with the inverse map.

5. When $R$ is an integral domain, tensoring with the field of fractions of $R$ does not destroy the injectivity, hence (5) holds in this case.
:::