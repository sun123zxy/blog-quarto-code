---
title: 分析力学乱炖
author: sun123zxy
date: 2025/09/21
date-modified: 2025/12/18
lang: zh
# bibliography: index.bib

number-sections: true

draft: true
categories:
  - math 
  - analysis
  - physics

format:
  html:
    include-in-header:
      text: |
        \(\require{physics}\)
---

## 速通

Newton 力学的基本假设是质点的运动服从 *Newton 第二定律*
$$
m \ddot{\vb* q} = -\pdv{U}{\vb* q}
$$
这里 $U(\vb* q)$ 是质点在位置 $\vb* q$ 处的势能．物理学实践似乎表明这种形式下的力学方程长相往往比较丑陋，不易于守恒量的发现．考虑到光学中光路传播的最短路径原理具有优美统一的数学形式，物理学家们开始尝试将力学方程也写成某种变分原理的形式．这种尝试推动了 Lagrange 力学和 Hamilton 力学的发展，也最终将经典力学、光学和量子力学统一在同一框架下．

Lagrange 力学的核心作用量是 Lagrangian
$$
\begin{aligned}
L: \mathbb R \times T Q &\to \mathbb R \\
(t, \vb* q, \dot{\vb* q}) &\mapsto L(t, \vb* q, \dot{\vb* q})
\end{aligned}
$$
这里 $Q$ 是系统的*构型空间（configuration space）*，$T Q$ 是 $Q$ 的*切丛（tangent bundle）*．在 Newton 力学中，我们取 $Q = \mathbb R^3$，并构造 Lagrangian 为动能减势能 $L = \frac 1 2 m \dot{\vb* q}^2 - U(\vb* q)$，这样 Lagrangian $L$ 就是时间 $t$、位置 $\vb* q$ 和速度 $\dot{\vb* q}$ 的函数．

Lagrange 力学的基本假设是，物理系统的演化满足所谓的*最小作用量原理*——即粒子的运动路径 $\vb* q(t)$ 应当使得 Lagrangian 沿其积分极小．数学上我们理解为吃进 $\vb* q: [t_1, t_2] \to Q$，吐出一个数的泛函
$$
J[\vb* q] = \int_{t_1}^{t_2} L(t, \vb* q, \dot{\vb* q}) \dd{t}
$$
的变分 $\var{J[\vb* q]}$ 应为零——即对任意路径上的不改变起点和终点的扰动（perturbation）$\vb* \eta$，有
$$
\fdv{J}{\vb* \eta} = \lim_{\varepsilon \to 0} \frac 1 \varepsilon \left( J[\vb* q + \varepsilon \vb* \eta] - J[\vb* q] \right) = 0
$$
使用一点分部积分和泛函分析的套话，根据上述变分方程可以解出著名的 *Euler--Lagrange 方程*
$$
\pdv{t} \pdv{L}{\dot{\vb* q}} = \pdv{L}{\vb* q}
$$

:::{.proof}

## Euler--Lagrange 方程的推导

$$
\begin{aligned}
J[\vb* q + \varepsilon \vb* \eta] - J[\vb* q]
&= \int_{t_1}^{t_2} \left( L(t, \vb* q + \varepsilon \vb* \eta, \dot{\vb* q} + \varepsilon \dot{\vb* \eta}) - L(t, \vb* q, \dot{\vb* q}) \right) \dd{t} \\
&= \int_{t_1}^{t_2} \left( \pdv{L}{\vb* q} \vdot \varepsilon \vb* \eta + \pdv{L}{\dot{\vb* q}} \vdot \dot{\vb* \varepsilon \eta} + O(\varepsilon^2) \right) \dd{t} \\
&= \varepsilon \int_{t_1}^{t_2} \left( \pdv{L}{\vb* q} \vdot \vb* \eta + \pdv{L}{\dot{\vb* q}} \vdot \dot{\vb* \eta} \right) \dd{t} + O(\varepsilon^2) \\
\end{aligned}
$$
按照变分要求，$\varepsilon$ 的系数应为零，即
$$
\int_{t_1}^{t_2} \left( \pdv{L}{\vb* q} \vdot \vb* \eta + \pdv{L}{\dot{\vb* q}} \vdot \dot{\vb* \eta} \right) \dd{t} = 0
$$
对第二项分部积分，并注意到微扰不改变路径端点：$\vb* \eta(t_1) = \vb* \eta(t_2) = 0$，可得
$$
\int_{t_1}^{t_2} \left( \pdv{L}{\vb* q} - \pdv{t} \pdv{L}{\dot{\vb* q}} \right) \vdot \vb* \eta \dd{t} = 0
$$
利用 $\vb* \eta$ 的任意性和泛函分析套话，就有
$$
\pdv{t} \pdv{L}{\dot{\vb* q}} = \pdv{L}{\vb* q}
$$
:::

特别地，在 Newton 力学中，Euler--Lagrange 方程恰为 Newton 第二定律，因此我们认为 Lagrange 力学是 Newton 力学的推广——这个推广的核心是通过构造恰当的 Lagrangian 将 Newton 第二定律实现为最小作用量原理．

Hamilton 力学是 Lagrange 力学的某种对偶的“坐标变换”．通过对 Lagrange 量关于 $\dot{\vb* q}$ 做 *Legendre 变换*【TODO】，我们得到 Hamiltonian
$$
\begin{aligned}
H: \mathbb R \times T^* Q &\to \mathbb R \\
(t, \vb* q, \vb* p) &\mapsto \vb* p \vdot \dot{\vb* q} - L(t, \vb* q, \dot{\vb* q})
\end{aligned}
$$
这里 $\vb* p := \pdv{L}{\dot{\vb* q}}$ 是（广义）动量．重点是，我们认为 Hamiltonian $H$ 是时间 $t$、位置 $\vb* q$ 和动量 $\vb* p$ 的函数，而不再直接接受速度 $\dot{\vb* q}$ 作为参数——定义里出现的 $\dot{\vb* q}$ 应当根据 $\vb* p = \pdv{L}{\dot{\vb* q}}$ 反解出来．$\vb* q$ 和 $\vb* p$ 构成的空间一般被称为*相空间（phase space）*，数学这边认为相空间是构型空间 $Q$ 的*余切丛（cotangent bundle）*$T^* Q$——某种程度上刻画了广义动量 $\vb* p := \pdv{L}{\dot{\vb* q}}$ 偏导的形式：它表现了 $L$ 在切空间内的微小扰动下产生的线性变化量．

在 Newton 力学中，计算可得 $H = \frac{\vb* p^2}{2m} + U(\vb* q)$，即系统的总能量——事实上，Hamilton 量恰为系统的总能量的这一观察在其它系统中也往往也富有意义．

利用 Euler--Lagrange 方程，容易导出 Hamilton 方程
$$
\left\{
\begin{aligned}
\dot{\vb* q} &= \pdv{H}{\vb* p} \\
\dot{\vb* p} &= -\pdv{H}{\vb* q}
\end{aligned}
\right.
$$
对应于 Newton 力学中的 Newton 第二定律和 Lagrange 力学中的 Euler--Lagrange 方程，这是 Hamilton 力学中决定系统演化的基本方程．物理学实践似乎表明 Hamilton 方程的形式一般更简单，从而更容易发现守恒量．在 Newton 力学中，该方程写作
$$
\left\{
\begin{aligned}
\dot{\vb* q} &= \frac{\vb* p}{m} \\
\dot{\vb* p} &= -\pdv{U}{\vb* q}
\end{aligned}
\right.
$$

让我们以一种更有趣的方式写出 Hamilton 方程：
$$
\pdv{t}
\begin{pmatrix}
\vb* q \\
\vb* p 
\end{pmatrix}
=
\begin{pmatrix}
0 & I \\
-I & 0
\end{pmatrix}
\begin{pmatrix}
\pdv{H}{\vb* q} \\
\pdv{H}{\vb* p}
\end{pmatrix}
$$
这使我们看到了 Hamilton 力学的*辛结构*【TODO】．

## 一些例子

### Newton 力学

已经平行地介绍过了．

### Kepler 定律

设力场中心在原点，位置用极坐标形式 $\vb* q = r \hat{\vb* r} = (r \cos \theta, r \sin \theta)$ 表达．考察质量为 $m$ 的质点在一中心力场 $\vb* F(\vb* q) = \vb* F(r) \hat{\vb* r}$ 中运动的情形．我们知道中心力场一定是保守场【TODO】，因此存在仅与 $r$ 有关的势能函数 $U(r)$．

我们首先构造 Lagrangian 为极坐标形式的动能减势能
$$
L(t, r, \theta, \dot{r}, \dot{\theta}) := \frac 1 2 m (\dot{r}^2 + r^2 \dot{\theta}^2) - U(r)
$$
并写出 Euler--Lagrange 方程
$$
\left\{
\begin{aligned}
m \ddot{r} &= m r \dot{\theta}^2 - \pdv{U}{r} \\
\dv{t} (m r^2 \dot{\theta}) &= 0
\end{aligned}
\right.
$$
我们观察到了一个守恒量 $p_\theta := m r^2 \dot{\theta}$！这正是角动量．不过另一个式子仍是一个难搞的二阶微分方程．

让我们转入 Hamilton 力学．根据套路定义广义动量
$$
\begin{aligned}
p_r &:= \pdv{L}{\dot{r}} = m \dot{r} \\
p_\theta &:= \pdv{L}{\dot{\theta}} = m r^2 \dot{\theta}
\end{aligned}
$$
算出 Hamiltonian
$$
H(t, r, \theta, p_r, p_\theta) = \frac{1}{2m} \left( p_r^2 + \frac{p_\theta^2}{r^2} \right) + U(r)
$$
上式与时间 $t$ 无关．根据 Hamiltonian 的在 Newton 力学中的物理意义，我们得到了极坐标形式的机械能守恒．

写出 Hamilton 方程
$$
\left\{
\begin{aligned}
\dot{r} &= \frac{p_r}{m} \\
\dot{\theta} &= \frac{p_\theta}{m r^2} \\
\dot{p}_r &= \frac{p_\theta^2}{m r^3} - \pdv{U}{r} \\
\dot{p}_\theta &= 0
\end{aligned}
\right.
$$
我们再次看到了角动量 $p_\theta$ 守恒，且方程变得易于求解．剩下的事情是取 $U(r) = -\frac{k}{r}$ 后嗯算积分，我们不再赘述【TODO】．

### 能量小寄巧

当 Lagrangian $L$ 与时间 $t$ 无关时，最小化 $L$ 的路径积分与最小化 $L^2$ 的路径积分等价：
$$
\begin{aligned}
\pdv{L^2}{\vb* q} &= 2 L \pdv{L}{\vb* q} \\
\pdv{t}\pdv{L^2}{\dot{\vb* q}} &= 2 L \pdv{t} \pdv{L}{\dot{\vb* q}} \\
\pdv{t} \pdv{L^2}{\dot{\vb* q}} = \pdv{L^2}{\vb* q}
&\iff \pdv{t} \pdv{L}{\dot{\vb* q}} = \pdv{L}{\vb* q}
\end{aligned}
$$
于是往往取 $L^2 / 2$（或类似物）作为新的 Lagrangian 简化运算，并称其为某种能量．

### 测地线

测地线，即曲面上连接两点的最短路径，在微分几何和广义相对论中均有大量应用．下面假设读者具有识别微分几何黑话和记号系统的能力．以下来自 Gemini 2.5 Flash，不代表本人观点．

:::{.solution}

## E-L 方程导出测地线方程

假设曲面 $S$ 的参数方程为 $\vb*{r}(u^1, u^2)$．曲面上的第一基本形式为：
$$
\dd{s}^2 = g_{ij} \dd{u}^i \dd{u}^j
$$
其中 $g_{ij} = \pdv{\vb*{r}}{u^i} \cdot \pdv{\vb*{r}}{u^j}$ 是度量张量．

为了简化计算，我们在弧长参数化下最小化曲线的能量．定义拉格朗日函数 $L$ 为：
$$
L(u^k, \dot{u}^k) = \frac{1}{2} g_{ij}(u^k) \dot{u}^i \dot{u}^j
$$
其中 $\dot{u}^i = \dv{u^i}{t}$．我们要找的是使泛函 $J = \int L \dd{t}$ 取极值的曲线．

对于坐标 $u^k$ ($k=1,2$)，其对应的 E-L 方程为：
$$
\dv{t} \qty(\pdv{L}{\dot{u}^k}) = \pdv{L}{u^k}
$$

1. 对速度的偏导：
   由于 $g_{ij}$ 对 $\dot{u}^k$ 是常数且具有对称性：
   $$\pdv{L}{\dot{u}^k} = \frac{1}{2} g_{kj} \dot{u}^j + \frac{1}{2} g_{ik} \dot{u}^i = g_{kj} \dot{u}^j$$

2. 对时间的全导数：
   根据链式法则（注意 $g_{kj}$ 是坐标 $u^i$ 的函数）：
   $$\dv{t} (g_{kj} \dot{u}^j) = \pdv{g_{kj}}{u^i} \dot{u}^i \dot{u}^j + g_{kj} \ddot{u}^j$$

3. 对坐标的偏导：
   $$\pdv{L}{u^k} = \frac{1}{2} \pdv{g_{ij}}{u^k} \dot{u}^i \dot{u}^j$$

将上述结果代入 E-L 方程：
$$
g_{kj} \ddot{u}^j + \pdv{g_{kj}}{u^i} \dot{u}^i \dot{u}^j - \frac{1}{2} \pdv{g_{ij}}{u^k} \dot{u}^i \dot{u}^j = 0
$$
利用指标对称性 $\pdv{g_{kj}}{u^i} \dot{u}^i \dot{u}^j = \frac{1}{2} \qty( \pdv{g_{kj}}{u^i} + \pdv{g_{ki}}{u^j} ) \dot{u}^i \dot{u}^j$，我们可以将方程改写为：
$$
g_{kj} \ddot{u}^j + \frac{1}{2} \qty( \pdv{g_{kj}}{u^i} + \pdv{g_{ki}}{u^j} - \pdv{g_{ij}}{u^k} ) \dot{u}^i \dot{u}^j = 0
$$
引入第一类 Christoffel 符号 $[ij, k] = \frac{1}{2} (g_{kj,i} + g_{ki,j} - g_{ij,k})$，上式即为：
$$
g_{kj} \ddot{u}^j + [ij, k] \dot{u}^i \dot{u}^j = 0
$$

两边同时乘以逆度量张量 $g^{mk}$，得到标准的测地线微分方程：
$$
\ddot{u}^m + \Gamma^m_{ij} \dot{u}^i \dot{u}^j = 0
$$
其中 $\Gamma^m_{ij}$ 是第二类 Christoffel 符号．
:::

:::{.solution}

## 与测地曲率的联系

回忆测地曲率的出处：曲线 $\gamma(s)$ 的加速度向量 $\ddot{\vb*{r}}$（弧长参数化下）可以分解为：
$$
\ddot{\vb*{r}} = \vb*{k}_g + \vb*{k}_n = \kappa_g \vb*{g} + \kappa_n \vb*{n}
$$

1. 曲线的二阶导数可以展开为：
   $$
   \ddot{\vb*{r}} = \dv{s} \qty( \pdv{\vb*{r}}{u^i} \dot{u}^i ) = \pdv{\vb*{r}}{u^i}{u^j} \dot{u}^i \dot{u}^j + \pdv{\vb*{r}}{u^i} \ddot{u}^i
   $$

2. 用活动标架分解 $\pdv{\vb*{r}}{u^i}{u^j} = \Gamma^k_{ij} \pdv{\vb*{r}}{u^k} + b_{ij} \vb*{n}$ 代入上式：
   $$
   \ddot{\vb*{r}} = \qty( \ddot{u}^k + \Gamma^k_{ij} \dot{u}^i \dot{u}^j ) \pdv{\vb*{r}}{u^k} + (b_{ij} \dot{u}^i \dot{u}^j) \vb*{n}$$

3. 由 E-L 方程导出的测地线方程正是要求上式中切平面分量（即 $\pdv{\vb*{r}}{u^k}$ 的系数）为 $0$：
   $$
   \ddot{u}^k + \Gamma^k_{ij} \dot{u}^i \dot{u}^j = 0
   $$

4. 因此，满足 E-L 方程的曲线，其加速度向量 $\ddot{\vb*{r}}$ 只有法向分量 $\vb*{k}_n$，而切向分量 $\vb*{k}_g = \vb*{0}$．根据定义，测地曲率是加速度向量在切平面投影的长度，故：$\kappa_g = 0$
:::

### 光学

光学中，光线的传播路径满足 Fermat 原理——即光线在两点间传播的路径使得光程（optical path length）极小．设空间中某点处的折射率为 $n(\vb* r)$，则光程定义为路径积分【TODO】
$$
\int n(\vb* r) \dd{s} = \int n(\vb* r) \abs{\dot{\vb* r}} \dd{t}
$$
这里 $\dd{s}$ 是路径元．

#### 折射定律

可以由同介质中光线直线传播，并移动交界点求导算得
$$
n_1 \sin \theta_1 = n_2 \sin \theta_2
$$

#### 透镜成像

【TODO】

![](img/optic-sphere.svg)

$$
\frac 1 {u} + \frac 1 {v} = \frac{1}{f}
$$